Thu Nov 21 15:36:24 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   27C    P0    52W / 149W |    353MiB / 12206MiB |     10%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35026      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:36:26 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   27C    P0    53W / 149W |    353MiB / 12206MiB |      7%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35026      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:36:27 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   27C    P0    53W / 149W |    353MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35026      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:36:29 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   27C    P0    52W / 149W |    353MiB / 12206MiB |     10%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35026      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:36:31 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   28C    P0    53W / 149W |    353MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35026      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:36:32 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   28C    P0    53W / 149W |    353MiB / 12206MiB |     12%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35026      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:36:34 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   28C    P0    53W / 149W |    353MiB / 12206MiB |     12%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35026      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:36:35 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   29C    P0    53W / 149W |    353MiB / 12206MiB |     10%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35026      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:36:37 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   29C    P0    53W / 149W |    353MiB / 12206MiB |     12%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   31C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35026      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:36:39 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   29C    P0    53W / 149W |    353MiB / 12206MiB |      9%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35026      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
{'dataset': 'cora', 'config_file': 'cora.yaml', 'layer_num': 2, 'epoch_num': [60, 60]}
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8252, device='cuda:0')
batch 2 loss: tensor(1.5931, device='cuda:0')
batch 3 loss: tensor(1.3182, device='cuda:0')
batch 4 loss: tensor(1.0453, device='cuda:0')
batch 5 loss: tensor(0.8343, device='cuda:0')
batch 6 loss: tensor(0.6260, device='cuda:0')
batch 7 loss: tensor(0.5488, device='cuda:0')
batch 8 loss: tensor(0.3786, device='cuda:0')
batch 9 loss: tensor(0.3406, device='cuda:0')
batch 10 loss: tensor(0.2823, device='cuda:0')
batch 11 loss: tensor(0.2104, device='cuda:0')
batch 12 loss: tensor(0.1555, device='cuda:0')
batch 13 loss: tensor(0.1590, device='cuda:0')
batch 14 loss: tensor(0.1495, device='cuda:0')
batch 15 loss: tensor(0.1029, device='cuda:0')
batch 16 loss: tensor(0.0901, device='cuda:0')
batch 17 loss: tensor(0.0787, device='cuda:0')
batch 18 loss: tensor(0.0631, device='cuda:0')
batch 19 loss: tensor(0.0607, device='cuda:0')
batch 20 loss: tensor(0.0557, device='cuda:0')
batch 21 loss: tensor(0.0477, device='cuda:0')
batch 22 loss: tensor(0.0395, device='cuda:0')
batch 23 loss: tensor(0.0367, device='cuda:0')
batch 24 loss: tensor(0.0335, device='cuda:0')
batch 25 loss: tensor(0.0340, device='cuda:0')
batch 26 loss: tensor(0.0309, device='cuda:0')
batch 27 loss: tensor(0.0328, device='cuda:0')
batch 28 loss: tensor(0.0292, device='cuda:0')
batch 29 loss: tensor(0.0227, device='cuda:0')
batch 30 loss: tensor(0.0217, device='cuda:0')
batch 31 loss: tensor(0.0236, device='cuda:0')
batch 32 loss: tensor(0.0153, device='cuda:0')
batch 33 loss: tensor(0.0180, device='cuda:0')
batch 34 loss: tensor(0.0193, device='cuda:0')
batch 35 loss: tensor(0.0167, device='cuda:0')
batch 36 loss: tensor(0.0135, device='cuda:0')
batch 37 loss: tensor(0.0166, device='cuda:0')
batch 38 loss: tensor(0.0153, device='cuda:0')
batch 39 loss: tensor(0.0117, device='cuda:0')
batch 40 loss: tensor(0.0151, device='cuda:0')
batch 41 loss: tensor(0.0106, device='cuda:0')
batch 42 loss: tensor(0.0122, device='cuda:0')
batch 43 loss: tensor(0.0123, device='cuda:0')
batch 44 loss: tensor(0.0089, device='cuda:0')
batch 45 loss: tensor(0.0134, device='cuda:0')
batch 46 loss: tensor(0.0074, device='cuda:0')
batch 47 loss: tensor(0.0087, device='cuda:0')
batch 48 loss: tensor(0.0093, device='cuda:0')
batch 49 loss: tensor(0.0079, device='cuda:0')
batch 50 loss: tensor(0.0074, device='cuda:0')
batch 51 loss: tensor(0.0084, device='cuda:0')
batch 52 loss: tensor(0.0076, device='cuda:0')
batch 53 loss: tensor(0.0050, device='cuda:0')
batch 54 loss: tensor(0.0071, device='cuda:0')
batch 55 loss: tensor(0.0068, device='cuda:0')
batch 56 loss: tensor(0.0057, device='cuda:0')
batch 57 loss: tensor(0.0068, device='cuda:0')
batch 58 loss: tensor(0.0050, device='cuda:0')
batch 59 loss: tensor(0.0063, device='cuda:0')
batch 60 loss: tensor(0.0053, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(1.7833, device='cuda:0')
batch 2 loss: tensor(0.6562, device='cuda:0')
batch 3 loss: tensor(0.4322, device='cuda:0')
batch 4 loss: tensor(0.2827, device='cuda:0')
batch 5 loss: tensor(0.1757, device='cuda:0')
batch 6 loss: tensor(0.1166, device='cuda:0')
batch 7 loss: tensor(0.0811, device='cuda:0')
batch 8 loss: tensor(0.0729, device='cuda:0')
batch 9 loss: tensor(0.0821, device='cuda:0')
batch 10 loss: tensor(0.0561, device='cuda:0')
batch 11 loss: tensor(0.0470, device='cuda:0')
batch 12 loss: tensor(0.0539, device='cuda:0')
batch 13 loss: tensor(0.0404, device='cuda:0')
batch 14 loss: tensor(0.0435, device='cuda:0')
batch 15 loss: tensor(0.0302, device='cuda:0')
batch 16 loss: tensor(0.0347, device='cuda:0')
batch 17 loss: tensor(0.0346, device='cuda:0')
batch 18 loss: tensor(0.0254, device='cuda:0')
batch 19 loss: tensor(0.0405, device='cuda:0')
batch 20 loss: tensor(0.0344, device='cuda:0')
batch 21 loss: tensor(0.0223, device='cuda:0')
batch 22 loss: tensor(0.0360, device='cuda:0')
batch 23 loss: tensor(0.0246, device='cuda:0')
batch 24 loss: tensor(0.0240, device='cuda:0')
batch 25 loss: tensor(0.0185, device='cuda:0')
batch 26 loss: tensor(0.0244, device='cuda:0')
batch 27 loss: tensor(0.0166, device='cuda:0')
batch 28 loss: tensor(0.0253, device='cuda:0')
batch 29 loss: tensor(0.0203, device='cuda:0')
batch 30 loss: tensor(0.0167, device='cuda:0')
batch 31 loss: tensor(0.0220, device='cuda:0')
batch 32 loss: tensor(0.0209, device='cuda:0')
batch 33 loss: tensor(0.0165, device='cuda:0')
batch 34 loss: tensor(0.0187, device='cuda:0')
batch 35 loss: tensor(0.0162, device='cuda:0')
batch 36 loss: tensor(0.0215, device='cuda:0')
batch 37 loss: tensor(0.0226, device='cuda:0')
batch 38 loss: tensor(0.0166, device='cuda:0')
batch 39 loss: tensor(0.0183, device='cuda:0')
batch 40 loss: tensor(0.0239, device='cuda:0')
batch 41 loss: tensor(0.0149, device='cuda:0')
batch 42 loss: tensor(0.0190, device='cuda:0')
batch 43 loss: tensor(0.0197, device='cuda:0')
batch 44 loss: tensor(0.0141, device='cuda:0')
batch 45 loss: tensor(0.0102, device='cuda:0')
batch 46 loss: tensor(0.0185, device='cuda:0')
batch 47 loss: tensor(0.0181, device='cuda:0')
batch 48 loss: tensor(0.0115, device='cuda:0')
batch 49 loss: tensor(0.0106, device='cuda:0')
batch 50 loss: tensor(0.0200, device='cuda:0')
batch 51 loss: tensor(0.0154, device='cuda:0')
batch 52 loss: tensor(0.0102, device='cuda:0')
batch 53 loss: tensor(0.0095, device='cuda:0')
batch 54 loss: tensor(0.0164, device='cuda:0')
batch 55 loss: tensor(0.0117, device='cuda:0')
batch 56 loss: tensor(0.0061, device='cuda:0')
batch 57 loss: tensor(0.0187, device='cuda:0')
batch 58 loss: tensor(0.0145, device='cuda:0')
batch 59 loss: tensor(0.0155, device='cuda:0')
batch 60 loss: tensor(0.0089, device='cuda:0')
accuracy in val: 0.858
accuracy in test: 0.836
average epoch time: 0.0059844970703125
total time: 0.7181396484375
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8342, device='cuda:0')
batch 2 loss: tensor(1.5841, device='cuda:0')
batch 3 loss: tensor(1.2862, device='cuda:0')
batch 4 loss: tensor(1.0399, device='cuda:0')
batch 5 loss: tensor(0.7980, device='cuda:0')
batch 6 loss: tensor(0.6630, device='cuda:0')
batch 7 loss: tensor(0.4945, device='cuda:0')
batch 8 loss: tensor(0.4001, device='cuda:0')
batch 9 loss: tensor(0.2992, device='cuda:0')
batch 10 loss: tensor(0.2560, device='cuda:0')
batch 11 loss: tensor(0.1846, device='cuda:0')
batch 12 loss: tensor(0.1876, device='cuda:0')
batch 13 loss: tensor(0.1566, device='cuda:0')
batch 14 loss: tensor(0.1277, device='cuda:0')
batch 15 loss: tensor(0.1066, device='cuda:0')
batch 16 loss: tensor(0.0705, device='cuda:0')
batch 17 loss: tensor(0.0924, device='cuda:0')
batch 18 loss: tensor(0.0755, device='cuda:0')
batch 19 loss: tensor(0.0702, device='cuda:0')
batch 20 loss: tensor(0.0517, device='cuda:0')
batch 21 loss: tensor(0.0448, device='cuda:0')
batch 22 loss: tensor(0.0386, device='cuda:0')
batch 23 loss: tensor(0.0325, device='cuda:0')
batch 24 loss: tensor(0.0362, device='cuda:0')
batch 25 loss: tensor(0.0320, device='cuda:0')
batch 26 loss: tensor(0.0269, device='cuda:0')
batch 27 loss: tensor(0.0326, device='cuda:0')
batch 28 loss: tensor(0.0241, device='cuda:0')
batch 29 loss: tensor(0.0196, device='cuda:0')
batch 30 loss: tensor(0.0219, device='cuda:0')
batch 31 loss: tensor(0.0155, device='cuda:0')
batch 32 loss: tensor(0.0182, device='cuda:0')
batch 33 loss: tensor(0.0162, device='cuda:0')
batch 34 loss: tensor(0.0189, device='cuda:0')
batch 35 loss: tensor(0.0135, device='cuda:0')
batch 36 loss: tensor(0.0139, device='cuda:0')
batch 37 loss: tensor(0.0177, device='cuda:0')
batch 38 loss: tensor(0.0136, device='cuda:0')
batch 39 loss: tensor(0.0131, device='cuda:0')
batch 40 loss: tensor(0.0113, device='cuda:0')
batch 41 loss: tensor(0.0101, device='cuda:0')
batch 42 loss: tensor(0.0116, device='cuda:0')
batch 43 loss: tensor(0.0109, device='cuda:0')
batch 44 loss: tensor(0.0101, device='cuda:0')
batch 45 loss: tensor(0.0083, device='cuda:0')
batch 46 loss: tensor(0.0086, device='cuda:0')
batch 47 loss: tensor(0.0116, device='cuda:0')
batch 48 loss: tensor(0.0083, device='cuda:0')
batch 49 loss: tensor(0.0098, device='cuda:0')
batch 50 loss: tensor(0.0104, device='cuda:0')
batch 51 loss: tensor(0.0072, device='cuda:0')
batch 52 loss: tensor(0.0058, device='cuda:0')
batch 53 loss: tensor(0.0063, device='cuda:0')
batch 54 loss: tensor(0.0097, device='cuda:0')
batch 55 loss: tensor(0.0057, device='cuda:0')
batch 56 loss: tensor(0.0064, device='cuda:0')
batch 57 loss: tensor(0.0058, device='cuda:0')
batch 58 loss: tensor(0.0071, device='cuda:0')
batch 59 loss: tensor(0.0049, device='cuda:0')
batch 60 loss: tensor(0.0069, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(2.1314, device='cuda:0')
batch 2 loss: tensor(1.2265, device='cuda:0')
batch 3 loss: tensor(0.6950, device='cuda:0')
batch 4 loss: tensor(0.6165, device='cuda:0')
batch 5 loss: tensor(0.3942, device='cuda:0')
batch 6 loss: tensor(0.2780, device='cuda:0')
batch 7 loss: tensor(0.2395, device='cuda:0')
batch 8 loss: tensor(0.1762, device='cuda:0')
batch 9 loss: tensor(0.1495, device='cuda:0')
batch 10 loss: tensor(0.1448, device='cuda:0')
batch 11 loss: tensor(0.1106, device='cuda:0')
batch 12 loss: tensor(0.1097, device='cuda:0')
batch 13 loss: tensor(0.0798, device='cuda:0')
batch 14 loss: tensor(0.0868, device='cuda:0')
batch 15 loss: tensor(0.0833, device='cuda:0')
batch 16 loss: tensor(0.0750, device='cuda:0')
batch 17 loss: tensor(0.0604, device='cuda:0')
batch 18 loss: tensor(0.0748, device='cuda:0')
batch 19 loss: tensor(0.0538, device='cuda:0')
batch 20 loss: tensor(0.0547, device='cuda:0')
batch 21 loss: tensor(0.0849, device='cuda:0')
batch 22 loss: tensor(0.0480, device='cuda:0')
batch 23 loss: tensor(0.0580, device='cuda:0')
batch 24 loss: tensor(0.0567, device='cuda:0')
batch 25 loss: tensor(0.0476, device='cuda:0')
batch 26 loss: tensor(0.0403, device='cuda:0')
batch 27 loss: tensor(0.0531, device='cuda:0')
batch 28 loss: tensor(0.0398, device='cuda:0')
batch 29 loss: tensor(0.0462, device='cuda:0')
batch 30 loss: tensor(0.0424, device='cuda:0')
batch 31 loss: tensor(0.0399, device='cuda:0')
batch 32 loss: tensor(0.0381, device='cuda:0')
batch 33 loss: tensor(0.0316, device='cuda:0')
batch 34 loss: tensor(0.0251, device='cuda:0')
batch 35 loss: tensor(0.0360, device='cuda:0')
batch 36 loss: tensor(0.0434, device='cuda:0')
batch 37 loss: tensor(0.0282, device='cuda:0')
batch 38 loss: tensor(0.0270, device='cuda:0')
batch 39 loss: tensor(0.0329, device='cuda:0')
batch 40 loss: tensor(0.0268, device='cuda:0')
batch 41 loss: tensor(0.0359, device='cuda:0')
batch 42 loss: tensor(0.0227, device='cuda:0')
batch 43 loss: tensor(0.0233, device='cuda:0')
batch 44 loss: tensor(0.0217, device='cuda:0')
batch 45 loss: tensor(0.0261, device='cuda:0')
batch 46 loss: tensor(0.0281, device='cuda:0')
batch 47 loss: tensor(0.0267, device='cuda:0')
batch 48 loss: tensor(0.0239, device='cuda:0')
batch 49 loss: tensor(0.0231, device='cuda:0')
batch 50 loss: tensor(0.0256, device='cuda:0')
batch 51 loss: tensor(0.0160, device='cuda:0')
batch 52 loss: tensor(0.0232, device='cuda:0')
batch 53 loss: tensor(0.0156, device='cuda:0')
batch 54 loss: tensor(0.0197, device='cuda:0')
batch 55 loss: tensor(0.0203, device='cuda:0')
batch 56 loss: tensor(0.0231, device='cuda:0')
batch 57 loss: tensor(0.0237, device='cuda:0')
batch 58 loss: tensor(0.0175, device='cuda:0')
batch 59 loss: tensor(0.0175, device='cuda:0')
batch 60 loss: tensor(0.0168, device='cuda:0')
accuracy in val: 0.852
accuracy in test: 0.842
average epoch time: 0.005885094404220581
total time: 0.7062113285064697
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8051, device='cuda:0')
batch 2 loss: tensor(1.5128, device='cuda:0')
batch 3 loss: tensor(1.2891, device='cuda:0')
batch 4 loss: tensor(1.0640, device='cuda:0')
batch 5 loss: tensor(0.8679, device='cuda:0')
batch 6 loss: tensor(0.6130, device='cuda:0')
batch 7 loss: tensor(0.4957, device='cuda:0')
batch 8 loss: tensor(0.4207, device='cuda:0')
batch 9 loss: tensor(0.3355, device='cuda:0')
batch 10 loss: tensor(0.3106, device='cuda:0')
batch 11 loss: tensor(0.2000, device='cuda:0')
batch 12 loss: tensor(0.1520, device='cuda:0')
batch 13 loss: tensor(0.1591, device='cuda:0')
batch 14 loss: tensor(0.1037, device='cuda:0')
batch 15 loss: tensor(0.1173, device='cuda:0')
batch 16 loss: tensor(0.0898, device='cuda:0')
batch 17 loss: tensor(0.0730, device='cuda:0')
batch 18 loss: tensor(0.0617, device='cuda:0')
batch 19 loss: tensor(0.0555, device='cuda:0')
batch 20 loss: tensor(0.0454, device='cuda:0')
batch 21 loss: tensor(0.0448, device='cuda:0')
batch 22 loss: tensor(0.0470, device='cuda:0')
batch 23 loss: tensor(0.0363, device='cuda:0')
batch 24 loss: tensor(0.0486, device='cuda:0')
batch 25 loss: tensor(0.0334, device='cuda:0')
batch 26 loss: tensor(0.0235, device='cuda:0')
batch 27 loss: tensor(0.0323, device='cuda:0')
batch 28 loss: tensor(0.0283, device='cuda:0')
batch 29 loss: tensor(0.0271, device='cuda:0')
batch 30 loss: tensor(0.0306, device='cuda:0')
batch 31 loss: tensor(0.0260, device='cuda:0')
batch 32 loss: tensor(0.0178, device='cuda:0')
batch 33 loss: tensor(0.0171, device='cuda:0')
batch 34 loss: tensor(0.0154, device='cuda:0')
batch 35 loss: tensor(0.0170, device='cuda:0')
batch 36 loss: tensor(0.0186, device='cuda:0')
batch 37 loss: tensor(0.0146, device='cuda:0')
batch 38 loss: tensor(0.0188, device='cuda:0')
batch 39 loss: tensor(0.0161, device='cuda:0')
batch 40 loss: tensor(0.0114, device='cuda:0')
batch 41 loss: tensor(0.0077, device='cuda:0')
batch 42 loss: tensor(0.0110, device='cuda:0')
batch 43 loss: tensor(0.0114, device='cuda:0')
batch 44 loss: tensor(0.0124, device='cuda:0')
batch 45 loss: tensor(0.0096, device='cuda:0')
batch 46 loss: tensor(0.0098, device='cuda:0')
batch 47 loss: tensor(0.0103, device='cuda:0')
batch 48 loss: tensor(0.0070, device='cuda:0')
batch 49 loss: tensor(0.0088, device='cuda:0')
batch 50 loss: tensor(0.0073, device='cuda:0')
batch 51 loss: tensor(0.0097, device='cuda:0')
batch 52 loss: tensor(0.0067, device='cuda:0')
batch 53 loss: tensor(0.0072, device='cuda:0')
batch 54 loss: tensor(0.0069, device='cuda:0')
batch 55 loss: tensor(0.0074, device='cuda:0')
batch 56 loss: tensor(0.0076, device='cuda:0')
batch 57 loss: tensor(0.0069, device='cuda:0')
batch 58 loss: tensor(0.0069, device='cuda:0')
batch 59 loss: tensor(0.0067, device='cuda:0')
batch 60 loss: tensor(0.0063, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(2.2214, device='cuda:0')
batch 2 loss: tensor(1.4855, device='cuda:0')
batch 3 loss: tensor(1.0245, device='cuda:0')
batch 4 loss: tensor(0.6181, device='cuda:0')
batch 5 loss: tensor(0.4220, device='cuda:0')
batch 6 loss: tensor(0.2974, device='cuda:0')
batch 7 loss: tensor(0.1951, device='cuda:0')
batch 8 loss: tensor(0.1200, device='cuda:0')
batch 9 loss: tensor(0.0748, device='cuda:0')
batch 10 loss: tensor(0.0733, device='cuda:0')
batch 11 loss: tensor(0.0546, device='cuda:0')
batch 12 loss: tensor(0.0384, device='cuda:0')
batch 13 loss: tensor(0.0429, device='cuda:0')
batch 14 loss: tensor(0.0398, device='cuda:0')
batch 15 loss: tensor(0.0317, device='cuda:0')
batch 16 loss: tensor(0.0200, device='cuda:0')
batch 17 loss: tensor(0.0317, device='cuda:0')
batch 18 loss: tensor(0.0297, device='cuda:0')
batch 19 loss: tensor(0.0282, device='cuda:0')
batch 20 loss: tensor(0.0222, device='cuda:0')
batch 21 loss: tensor(0.0166, device='cuda:0')
batch 22 loss: tensor(0.0221, device='cuda:0')
batch 23 loss: tensor(0.0214, device='cuda:0')
batch 24 loss: tensor(0.0124, device='cuda:0')
batch 25 loss: tensor(0.0171, device='cuda:0')
batch 26 loss: tensor(0.0172, device='cuda:0')
batch 27 loss: tensor(0.0122, device='cuda:0')
batch 28 loss: tensor(0.0138, device='cuda:0')
batch 29 loss: tensor(0.0184, device='cuda:0')
batch 30 loss: tensor(0.0132, device='cuda:0')
batch 31 loss: tensor(0.0217, device='cuda:0')
batch 32 loss: tensor(0.0187, device='cuda:0')
batch 33 loss: tensor(0.0117, device='cuda:0')
batch 34 loss: tensor(0.0151, device='cuda:0')
batch 35 loss: tensor(0.0073, device='cuda:0')
batch 36 loss: tensor(0.0069, device='cuda:0')
batch 37 loss: tensor(0.0191, device='cuda:0')
batch 38 loss: tensor(0.0143, device='cuda:0')
batch 39 loss: tensor(0.0171, device='cuda:0')
batch 40 loss: tensor(0.0153, device='cuda:0')
batch 41 loss: tensor(0.0104, device='cuda:0')
batch 42 loss: tensor(0.0118, device='cuda:0')
batch 43 loss: tensor(0.0157, device='cuda:0')
batch 44 loss: tensor(0.0074, device='cuda:0')
batch 45 loss: tensor(0.0098, device='cuda:0')
batch 46 loss: tensor(0.0099, device='cuda:0')
batch 47 loss: tensor(0.0100, device='cuda:0')
batch 48 loss: tensor(0.0105, device='cuda:0')
batch 49 loss: tensor(0.0155, device='cuda:0')
batch 50 loss: tensor(0.0094, device='cuda:0')
batch 51 loss: tensor(0.0081, device='cuda:0')
batch 52 loss: tensor(0.0105, device='cuda:0')
batch 53 loss: tensor(0.0163, device='cuda:0')
batch 54 loss: tensor(0.0066, device='cuda:0')
batch 55 loss: tensor(0.0079, device='cuda:0')
batch 56 loss: tensor(0.0081, device='cuda:0')
batch 57 loss: tensor(0.0068, device='cuda:0')
batch 58 loss: tensor(0.0126, device='cuda:0')
batch 59 loss: tensor(0.0091, device='cuda:0')
batch 60 loss: tensor(0.0123, device='cuda:0')
accuracy in val: 0.856
accuracy in test: 0.849
average epoch time: 0.004790210723876953
total time: 0.5748252868652344
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8124, device='cuda:0')
batch 2 loss: tensor(1.5204, device='cuda:0')
batch 3 loss: tensor(1.2735, device='cuda:0')
batch 4 loss: tensor(1.0545, device='cuda:0')
batch 5 loss: tensor(0.7584, device='cuda:0')
batch 6 loss: tensor(0.6084, device='cuda:0')
batch 7 loss: tensor(0.4534, device='cuda:0')
batch 8 loss: tensor(0.3980, device='cuda:0')
batch 9 loss: tensor(0.2736, device='cuda:0')
batch 10 loss: tensor(0.2475, device='cuda:0')
batch 11 loss: tensor(0.1958, device='cuda:0')
batch 12 loss: tensor(0.1411, device='cuda:0')
batch 13 loss: tensor(0.1310, device='cuda:0')
batch 14 loss: tensor(0.1106, device='cuda:0')
batch 15 loss: tensor(0.0680, device='cuda:0')
batch 16 loss: tensor(0.0880, device='cuda:0')
batch 17 loss: tensor(0.0652, device='cuda:0')
batch 18 loss: tensor(0.0795, device='cuda:0')
batch 19 loss: tensor(0.0562, device='cuda:0')
batch 20 loss: tensor(0.0492, device='cuda:0')
batch 21 loss: tensor(0.0411, device='cuda:0')
batch 22 loss: tensor(0.0432, device='cuda:0')
batch 23 loss: tensor(0.0385, device='cuda:0')
batch 24 loss: tensor(0.0299, device='cuda:0')
batch 25 loss: tensor(0.0293, device='cuda:0')
batch 26 loss: tensor(0.0281, device='cuda:0')
batch 27 loss: tensor(0.0278, device='cuda:0')
batch 28 loss: tensor(0.0275, device='cuda:0')
batch 29 loss: tensor(0.0272, device='cuda:0')
batch 30 loss: tensor(0.0208, device='cuda:0')
batch 31 loss: tensor(0.0201, device='cuda:0')
batch 32 loss: tensor(0.0199, device='cuda:0')
batch 33 loss: tensor(0.0243, device='cuda:0')
batch 34 loss: tensor(0.0201, device='cuda:0')
batch 35 loss: tensor(0.0184, device='cuda:0')
batch 36 loss: tensor(0.0113, device='cuda:0')
batch 37 loss: tensor(0.0172, device='cuda:0')
batch 38 loss: tensor(0.0134, device='cuda:0')
batch 39 loss: tensor(0.0141, device='cuda:0')
batch 40 loss: tensor(0.0120, device='cuda:0')
batch 41 loss: tensor(0.0130, device='cuda:0')
batch 42 loss: tensor(0.0128, device='cuda:0')
batch 43 loss: tensor(0.0099, device='cuda:0')
batch 44 loss: tensor(0.0070, device='cuda:0')
batch 45 loss: tensor(0.0112, device='cuda:0')
batch 46 loss: tensor(0.0098, device='cuda:0')
batch 47 loss: tensor(0.0084, device='cuda:0')
batch 48 loss: tensor(0.0108, device='cuda:0')
batch 49 loss: tensor(0.0084, device='cuda:0')
batch 50 loss: tensor(0.0119, device='cuda:0')
batch 51 loss: tensor(0.0069, device='cuda:0')
batch 52 loss: tensor(0.0093, device='cuda:0')
batch 53 loss: tensor(0.0081, device='cuda:0')
batch 54 loss: tensor(0.0059, device='cuda:0')
batch 55 loss: tensor(0.0061, device='cuda:0')
batch 56 loss: tensor(0.0060, device='cuda:0')
batch 57 loss: tensor(0.0073, device='cuda:0')
batch 58 loss: tensor(0.0059, device='cuda:0')
batch 59 loss: tensor(0.0060, device='cuda:0')
batch 60 loss: tensor(0.0079, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(1.7832, device='cuda:0')
batch 2 loss: tensor(0.8916, device='cuda:0')
batch 3 loss: tensor(0.5312, device='cuda:0')
batch 4 loss: tensor(0.2123, device='cuda:0')
batch 5 loss: tensor(0.1713, device='cuda:0')
batch 6 loss: tensor(0.1061, device='cuda:0')
batch 7 loss: tensor(0.0713, device='cuda:0')
batch 8 loss: tensor(0.0662, device='cuda:0')
batch 9 loss: tensor(0.0542, device='cuda:0')
batch 10 loss: tensor(0.0424, device='cuda:0')
batch 11 loss: tensor(0.0394, device='cuda:0')
batch 12 loss: tensor(0.0348, device='cuda:0')
batch 13 loss: tensor(0.0254, device='cuda:0')
batch 14 loss: tensor(0.0247, device='cuda:0')
batch 15 loss: tensor(0.0236, device='cuda:0')
batch 16 loss: tensor(0.0229, device='cuda:0')
batch 17 loss: tensor(0.0230, device='cuda:0')
batch 18 loss: tensor(0.0173, device='cuda:0')
batch 19 loss: tensor(0.0166, device='cuda:0')
batch 20 loss: tensor(0.0189, device='cuda:0')
batch 21 loss: tensor(0.0205, device='cuda:0')
batch 22 loss: tensor(0.0164, device='cuda:0')
batch 23 loss: tensor(0.0123, device='cuda:0')
batch 24 loss: tensor(0.0150, device='cuda:0')
batch 25 loss: tensor(0.0168, device='cuda:0')
batch 26 loss: tensor(0.0148, device='cuda:0')
batch 27 loss: tensor(0.0167, device='cuda:0')
batch 28 loss: tensor(0.0142, device='cuda:0')
batch 29 loss: tensor(0.0117, device='cuda:0')
batch 30 loss: tensor(0.0175, device='cuda:0')
batch 31 loss: tensor(0.0101, device='cuda:0')
batch 32 loss: tensor(0.0094, device='cuda:0')
batch 33 loss: tensor(0.0116, device='cuda:0')
batch 34 loss: tensor(0.0171, device='cuda:0')
batch 35 loss: tensor(0.0118, device='cuda:0')
batch 36 loss: tensor(0.0101, device='cuda:0')
batch 37 loss: tensor(0.0146, device='cuda:0')
batch 38 loss: tensor(0.0111, device='cuda:0')
batch 39 loss: tensor(0.0152, device='cuda:0')
batch 40 loss: tensor(0.0141, device='cuda:0')
batch 41 loss: tensor(0.0165, device='cuda:0')
batch 42 loss: tensor(0.0137, device='cuda:0')
batch 43 loss: tensor(0.0096, device='cuda:0')
batch 44 loss: tensor(0.0160, device='cuda:0')
batch 45 loss: tensor(0.0118, device='cuda:0')
batch 46 loss: tensor(0.0116, device='cuda:0')
batch 47 loss: tensor(0.0089, device='cuda:0')
batch 48 loss: tensor(0.0082, device='cuda:0')
batch 49 loss: tensor(0.0111, device='cuda:0')
batch 50 loss: tensor(0.0137, device='cuda:0')
batch 51 loss: tensor(0.0120, device='cuda:0')
batch 52 loss: tensor(0.0073, device='cuda:0')
batch 53 loss: tensor(0.0091, device='cuda:0')
batch 54 loss: tensor(0.0103, device='cuda:0')
batch 55 loss: tensor(0.0068, device='cuda:0')
batch 56 loss: tensor(0.0098, device='cuda:0')
batch 57 loss: tensor(0.0115, device='cuda:0')
batch 58 loss: tensor(0.0072, device='cuda:0')
batch 59 loss: tensor(0.0079, device='cuda:0')
batch 60 loss: tensor(0.0060, device='cuda:0')
accuracy in val: 0.8399999999999999
accuracy in test: 0.842
average epoch time: 0.005124908685684204
total time: 0.6149890422821045
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8462, device='cuda:0')
batch 2 loss: tensor(1.6184, device='cuda:0')
batch 3 loss: tensor(1.3805, device='cuda:0')
batch 4 loss: tensor(1.0629, device='cuda:0')
batch 5 loss: tensor(0.8707, device='cuda:0')
batch 6 loss: tensor(0.6553, device='cuda:0')
batch 7 loss: tensor(0.4846, device='cuda:0')
batch 8 loss: tensor(0.3410, device='cuda:0')
batch 9 loss: tensor(0.2993, device='cuda:0')
batch 10 loss: tensor(0.2520, device='cuda:0')
batch 11 loss: tensor(0.1955, device='cuda:0')
batch 12 loss: tensor(0.1233, device='cuda:0')
batch 13 loss: tensor(0.1474, device='cuda:0')
batch 14 loss: tensor(0.1118, device='cuda:0')
batch 15 loss: tensor(0.1032, device='cuda:0')
batch 16 loss: tensor(0.0879, device='cuda:0')
batch 17 loss: tensor(0.0592, device='cuda:0')
batch 18 loss: tensor(0.0598, device='cuda:0')
batch 19 loss: tensor(0.0420, device='cuda:0')
batch 20 loss: tensor(0.0485, device='cuda:0')
batch 21 loss: tensor(0.0491, device='cuda:0')
batch 22 loss: tensor(0.0358, device='cuda:0')
batch 23 loss: tensor(0.0324, device='cuda:0')
batch 24 loss: tensor(0.0384, device='cuda:0')
batch 25 loss: tensor(0.0357, device='cuda:0')
batch 26 loss: tensor(0.0207, device='cuda:0')
batch 27 loss: tensor(0.0310, device='cuda:0')
batch 28 loss: tensor(0.0239, device='cuda:0')
batch 29 loss: tensor(0.0254, device='cuda:0')
batch 30 loss: tensor(0.0256, device='cuda:0')
batch 31 loss: tensor(0.0182, device='cuda:0')
batch 32 loss: tensor(0.0156, device='cuda:0')
batch 33 loss: tensor(0.0169, device='cuda:0')
batch 34 loss: tensor(0.0240, device='cuda:0')
batch 35 loss: tensor(0.0159, device='cuda:0')
batch 36 loss: tensor(0.0134, device='cuda:0')
batch 37 loss: tensor(0.0133, device='cuda:0')
batch 38 loss: tensor(0.0133, device='cuda:0')
batch 39 loss: tensor(0.0167, device='cuda:0')
batch 40 loss: tensor(0.0119, device='cuda:0')
batch 41 loss: tensor(0.0121, device='cuda:0')
batch 42 loss: tensor(0.0082, device='cuda:0')
batch 43 loss: tensor(0.0125, device='cuda:0')
batch 44 loss: tensor(0.0107, device='cuda:0')
batch 45 loss: tensor(0.0096, device='cuda:0')
batch 46 loss: tensor(0.0085, device='cuda:0')
batch 47 loss: tensor(0.0077, device='cuda:0')
batch 48 loss: tensor(0.0087, device='cuda:0')
batch 49 loss: tensor(0.0084, device='cuda:0')
batch 50 loss: tensor(0.0061, device='cuda:0')
batch 51 loss: tensor(0.0072, device='cuda:0')
batch 52 loss: tensor(0.0092, device='cuda:0')
batch 53 loss: tensor(0.0063, device='cuda:0')
batch 54 loss: tensor(0.0071, device='cuda:0')
batch 55 loss: tensor(0.0089, device='cuda:0')
batch 56 loss: tensor(0.0074, device='cuda:0')
batch 57 loss: tensor(0.0061, device='cuda:0')
batch 58 loss: tensor(0.0052, device='cuda:0')
batch 59 loss: tensor(0.0063, device='cuda:0')
batch 60 loss: tensor(0.0057, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(3.5179, device='cuda:0')
batch 2 loss: tensor(1.9520, device='cuda:0')
batch 3 loss: tensor(1.2977, device='cuda:0')
batch 4 loss: tensor(1.0351, device='cuda:0')
batch 5 loss: tensor(0.7598, device='cuda:0')
batch 6 loss: tensor(0.3958, device='cuda:0')
batch 7 loss: tensor(0.3534, device='cuda:0')
batch 8 loss: tensor(0.3095, device='cuda:0')
batch 9 loss: tensor(0.2079, device='cuda:0')
batch 10 loss: tensor(0.1619, device='cuda:0')
batch 11 loss: tensor(0.1577, device='cuda:0')
batch 12 loss: tensor(0.0928, device='cuda:0')
batch 13 loss: tensor(0.0916, device='cuda:0')
batch 14 loss: tensor(0.0824, device='cuda:0')
batch 15 loss: tensor(0.0787, device='cuda:0')
batch 16 loss: tensor(0.0589, device='cuda:0')
batch 17 loss: tensor(0.0643, device='cuda:0')
batch 18 loss: tensor(0.0554, device='cuda:0')
batch 19 loss: tensor(0.0430, device='cuda:0')
batch 20 loss: tensor(0.0498, device='cuda:0')
batch 21 loss: tensor(0.0372, device='cuda:0')
batch 22 loss: tensor(0.0356, device='cuda:0')
batch 23 loss: tensor(0.0405, device='cuda:0')
batch 24 loss: tensor(0.0378, device='cuda:0')
batch 25 loss: tensor(0.0266, device='cuda:0')
batch 26 loss: tensor(0.0224, device='cuda:0')
batch 27 loss: tensor(0.0327, device='cuda:0')
batch 28 loss: tensor(0.0246, device='cuda:0')
batch 29 loss: tensor(0.0259, device='cuda:0')
batch 30 loss: tensor(0.0297, device='cuda:0')
batch 31 loss: tensor(0.0165, device='cuda:0')
batch 32 loss: tensor(0.0246, device='cuda:0')
batch 33 loss: tensor(0.0296, device='cuda:0')
batch 34 loss: tensor(0.0197, device='cuda:0')
batch 35 loss: tensor(0.0177, device='cuda:0')
batch 36 loss: tensor(0.0245, device='cuda:0')
batch 37 loss: tensor(0.0236, device='cuda:0')
batch 38 loss: tensor(0.0200, device='cuda:0')
batch 39 loss: tensor(0.0271, device='cuda:0')
batch 40 loss: tensor(0.0317, device='cuda:0')
batch 41 loss: tensor(0.0306, device='cuda:0')
batch 42 loss: tensor(0.0251, device='cuda:0')
batch 43 loss: tensor(0.0174, device='cuda:0')
batch 44 loss: tensor(0.0209, device='cuda:0')
batch 45 loss: tensor(0.0194, device='cuda:0')
batch 46 loss: tensor(0.0178, device='cuda:0')
batch 47 loss: tensor(0.0185, device='cuda:0')
batch 48 loss: tensor(0.0116, device='cuda:0')
batch 49 loss: tensor(0.0171, device='cuda:0')
batch 50 loss: tensor(0.0314, device='cuda:0')
batch 51 loss: tensor(0.0189, device='cuda:0')
batch 52 loss: tensor(0.0179, device='cuda:0')
batch 53 loss: tensor(0.0111, device='cuda:0')
batch 54 loss: tensor(0.0156, device='cuda:0')
batch 55 loss: tensor(0.0228, device='cuda:0')
batch 56 loss: tensor(0.0167, device='cuda:0')
batch 57 loss: tensor(0.0107, device='cuda:0')
batch 58 loss: tensor(0.0186, device='cuda:0')
batch 59 loss: tensor(0.0107, device='cuda:0')
batch 60 loss: tensor(0.0243, device='cuda:0')
accuracy in val: 0.856
accuracy in test: 0.856
average epoch time: 0.0046425402164459225
total time: 0.5571048259735107
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8684, device='cuda:0')
batch 2 loss: tensor(1.6099, device='cuda:0')
batch 3 loss: tensor(1.3308, device='cuda:0')
batch 4 loss: tensor(1.0432, device='cuda:0')
batch 5 loss: tensor(0.8433, device='cuda:0')
batch 6 loss: tensor(0.6604, device='cuda:0')
batch 7 loss: tensor(0.5529, device='cuda:0')
batch 8 loss: tensor(0.4351, device='cuda:0')
batch 9 loss: tensor(0.3120, device='cuda:0')
batch 10 loss: tensor(0.2502, device='cuda:0')
batch 11 loss: tensor(0.1851, device='cuda:0')
batch 12 loss: tensor(0.1556, device='cuda:0')
batch 13 loss: tensor(0.0945, device='cuda:0')
batch 14 loss: tensor(0.1108, device='cuda:0')
batch 15 loss: tensor(0.0814, device='cuda:0')
batch 16 loss: tensor(0.0706, device='cuda:0')
batch 17 loss: tensor(0.0765, device='cuda:0')
batch 18 loss: tensor(0.0614, device='cuda:0')
batch 19 loss: tensor(0.0526, device='cuda:0')
batch 20 loss: tensor(0.0398, device='cuda:0')
batch 21 loss: tensor(0.0409, device='cuda:0')
batch 22 loss: tensor(0.0448, device='cuda:0')
batch 23 loss: tensor(0.0317, device='cuda:0')
batch 24 loss: tensor(0.0270, device='cuda:0')
batch 25 loss: tensor(0.0346, device='cuda:0')
batch 26 loss: tensor(0.0277, device='cuda:0')
batch 27 loss: tensor(0.0319, device='cuda:0')
batch 28 loss: tensor(0.0265, device='cuda:0')
batch 29 loss: tensor(0.0214, device='cuda:0')
batch 30 loss: tensor(0.0205, device='cuda:0')
batch 31 loss: tensor(0.0193, device='cuda:0')
batch 32 loss: tensor(0.0170, device='cuda:0')
batch 33 loss: tensor(0.0150, device='cuda:0')
batch 34 loss: tensor(0.0164, device='cuda:0')
batch 35 loss: tensor(0.0201, device='cuda:0')
batch 36 loss: tensor(0.0167, device='cuda:0')
batch 37 loss: tensor(0.0123, device='cuda:0')
batch 38 loss: tensor(0.0135, device='cuda:0')
batch 39 loss: tensor(0.0107, device='cuda:0')
batch 40 loss: tensor(0.0152, device='cuda:0')
batch 41 loss: tensor(0.0096, device='cuda:0')
batch 42 loss: tensor(0.0126, device='cuda:0')
batch 43 loss: tensor(0.0120, device='cuda:0')
batch 44 loss: tensor(0.0101, device='cuda:0')
batch 45 loss: tensor(0.0097, device='cuda:0')
batch 46 loss: tensor(0.0089, device='cuda:0')
batch 47 loss: tensor(0.0101, device='cuda:0')
batch 48 loss: tensor(0.0077, device='cuda:0')
batch 49 loss: tensor(0.0061, device='cuda:0')
batch 50 loss: tensor(0.0077, device='cuda:0')
batch 51 loss: tensor(0.0067, device='cuda:0')
batch 52 loss: tensor(0.0070, device='cuda:0')
batch 53 loss: tensor(0.0061, device='cuda:0')
batch 54 loss: tensor(0.0059, device='cuda:0')
batch 55 loss: tensor(0.0080, device='cuda:0')
batch 56 loss: tensor(0.0068, device='cuda:0')
batch 57 loss: tensor(0.0046, device='cuda:0')
batch 58 loss: tensor(0.0053, device='cuda:0')
batch 59 loss: tensor(0.0058, device='cuda:0')
batch 60 loss: tensor(0.0055, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(1.7234, device='cuda:0')
batch 2 loss: tensor(0.7994, device='cuda:0')
batch 3 loss: tensor(0.5719, device='cuda:0')
batch 4 loss: tensor(0.3528, device='cuda:0')
batch 5 loss: tensor(0.2364, device='cuda:0')
batch 6 loss: tensor(0.1735, device='cuda:0')
batch 7 loss: tensor(0.1164, device='cuda:0')
batch 8 loss: tensor(0.0812, device='cuda:0')
batch 9 loss: tensor(0.0587, device='cuda:0')
batch 10 loss: tensor(0.0617, device='cuda:0')
batch 11 loss: tensor(0.0575, device='cuda:0')
batch 12 loss: tensor(0.0288, device='cuda:0')
batch 13 loss: tensor(0.0246, device='cuda:0')
batch 14 loss: tensor(0.0321, device='cuda:0')
batch 15 loss: tensor(0.0363, device='cuda:0')
batch 16 loss: tensor(0.0256, device='cuda:0')
batch 17 loss: tensor(0.0283, device='cuda:0')
batch 18 loss: tensor(0.0210, device='cuda:0')
batch 19 loss: tensor(0.0200, device='cuda:0')
batch 20 loss: tensor(0.0209, device='cuda:0')
batch 21 loss: tensor(0.0227, device='cuda:0')
batch 22 loss: tensor(0.0146, device='cuda:0')
batch 23 loss: tensor(0.0238, device='cuda:0')
batch 24 loss: tensor(0.0216, device='cuda:0')
batch 25 loss: tensor(0.0211, device='cuda:0')
batch 26 loss: tensor(0.0147, device='cuda:0')
batch 27 loss: tensor(0.0192, device='cuda:0')
batch 28 loss: tensor(0.0086, device='cuda:0')
batch 29 loss: tensor(0.0157, device='cuda:0')
batch 30 loss: tensor(0.0167, device='cuda:0')
batch 31 loss: tensor(0.0151, device='cuda:0')
batch 32 loss: tensor(0.0157, device='cuda:0')
batch 33 loss: tensor(0.0162, device='cuda:0')
batch 34 loss: tensor(0.0155, device='cuda:0')
batch 35 loss: tensor(0.0096, device='cuda:0')
batch 36 loss: tensor(0.0112, device='cuda:0')
batch 37 loss: tensor(0.0103, device='cuda:0')
batch 38 loss: tensor(0.0163, device='cuda:0')
batch 39 loss: tensor(0.0197, device='cuda:0')
batch 40 loss: tensor(0.0112, device='cuda:0')
batch 41 loss: tensor(0.0097, device='cuda:0')
batch 42 loss: tensor(0.0085, device='cuda:0')
batch 43 loss: tensor(0.0157, device='cuda:0')
batch 44 loss: tensor(0.0155, device='cuda:0')
batch 45 loss: tensor(0.0122, device='cuda:0')
batch 46 loss: tensor(0.0075, device='cuda:0')
batch 47 loss: tensor(0.0079, device='cuda:0')
batch 48 loss: tensor(0.0093, device='cuda:0')
batch 49 loss: tensor(0.0084, device='cuda:0')
batch 50 loss: tensor(0.0081, device='cuda:0')
batch 51 loss: tensor(0.0108, device='cuda:0')
batch 52 loss: tensor(0.0135, device='cuda:0')
batch 53 loss: tensor(0.0114, device='cuda:0')
batch 54 loss: tensor(0.0086, device='cuda:0')
batch 55 loss: tensor(0.0100, device='cuda:0')
batch 56 loss: tensor(0.0067, device='cuda:0')
batch 57 loss: tensor(0.0095, device='cuda:0')
batch 58 loss: tensor(0.0065, device='cuda:0')
batch 59 loss: tensor(0.0102, device='cuda:0')
batch 60 loss: tensor(0.0088, device='cuda:0')
accuracy in val: 0.864
accuracy in test: 0.835
average epoch time: 0.005570652087529501
total time: 0.66847825050354
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8260, device='cuda:0')
batch 2 loss: tensor(1.5409, device='cuda:0')
batch 3 loss: tensor(1.2894, device='cuda:0')
batch 4 loss: tensor(1.0368, device='cuda:0')
batch 5 loss: tensor(0.8628, device='cuda:0')
batch 6 loss: tensor(0.6768, device='cuda:0')
batch 7 loss: tensor(0.5531, device='cuda:0')
batch 8 loss: tensor(0.4158, device='cuda:0')
batch 9 loss: tensor(0.3696, device='cuda:0')
batch 10 loss: tensor(0.2812, device='cuda:0')
batch 11 loss: tensor(0.2037, device='cuda:0')
batch 12 loss: tensor(0.1927, device='cuda:0')
batch 13 loss: tensor(0.1285, device='cuda:0')
batch 14 loss: tensor(0.1124, device='cuda:0')
batch 15 loss: tensor(0.1047, device='cuda:0')
batch 16 loss: tensor(0.0851, device='cuda:0')
batch 17 loss: tensor(0.0891, device='cuda:0')
batch 18 loss: tensor(0.0830, device='cuda:0')
batch 19 loss: tensor(0.0669, device='cuda:0')
batch 20 loss: tensor(0.0504, device='cuda:0')
batch 21 loss: tensor(0.0458, device='cuda:0')
batch 22 loss: tensor(0.0503, device='cuda:0')
batch 23 loss: tensor(0.0341, device='cuda:0')
batch 24 loss: tensor(0.0329, device='cuda:0')
batch 25 loss: tensor(0.0341, device='cuda:0')
batch 26 loss: tensor(0.0311, device='cuda:0')
batch 27 loss: tensor(0.0288, device='cuda:0')
batch 28 loss: tensor(0.0280, device='cuda:0')
batch 29 loss: tensor(0.0234, device='cuda:0')
batch 30 loss: tensor(0.0174, device='cuda:0')
batch 31 loss: tensor(0.0303, device='cuda:0')
batch 32 loss: tensor(0.0256, device='cuda:0')
batch 33 loss: tensor(0.0123, device='cuda:0')
batch 34 loss: tensor(0.0185, device='cuda:0')
batch 35 loss: tensor(0.0153, device='cuda:0')
batch 36 loss: tensor(0.0186, device='cuda:0')
batch 37 loss: tensor(0.0151, device='cuda:0')
batch 38 loss: tensor(0.0117, device='cuda:0')
batch 39 loss: tensor(0.0195, device='cuda:0')
batch 40 loss: tensor(0.0118, device='cuda:0')
batch 41 loss: tensor(0.0170, device='cuda:0')
batch 42 loss: tensor(0.0102, device='cuda:0')
batch 43 loss: tensor(0.0107, device='cuda:0')
batch 44 loss: tensor(0.0094, device='cuda:0')
batch 45 loss: tensor(0.0087, device='cuda:0')
batch 46 loss: tensor(0.0167, device='cuda:0')
batch 47 loss: tensor(0.0098, device='cuda:0')
batch 48 loss: tensor(0.0078, device='cuda:0')
batch 49 loss: tensor(0.0102, device='cuda:0')
batch 50 loss: tensor(0.0119, device='cuda:0')
batch 51 loss: tensor(0.0091, device='cuda:0')
batch 52 loss: tensor(0.0074, device='cuda:0')
batch 53 loss: tensor(0.0087, device='cuda:0')
batch 54 loss: tensor(0.0098, device='cuda:0')
batch 55 loss: tensor(0.0067, device='cuda:0')
batch 56 loss: tensor(0.0078, device='cuda:0')
batch 57 loss: tensor(0.0057, device='cuda:0')
batch 58 loss: tensor(0.0058, device='cuda:0')
batch 59 loss: tensor(0.0062, device='cuda:0')
batch 60 loss: tensor(0.0115, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(2.2409, device='cuda:0')
batch 2 loss: tensor(1.2122, device='cuda:0')
batch 3 loss: tensor(0.8285, device='cuda:0')
batch 4 loss: tensor(0.3794, device='cuda:0')
batch 5 loss: tensor(0.2658, device='cuda:0')
batch 6 loss: tensor(0.1599, device='cuda:0')
batch 7 loss: tensor(0.0971, device='cuda:0')
batch 8 loss: tensor(0.0753, device='cuda:0')
batch 9 loss: tensor(0.0470, device='cuda:0')
batch 10 loss: tensor(0.0657, device='cuda:0')
batch 11 loss: tensor(0.0507, device='cuda:0')
batch 12 loss: tensor(0.0416, device='cuda:0')
batch 13 loss: tensor(0.0383, device='cuda:0')
batch 14 loss: tensor(0.0517, device='cuda:0')
batch 15 loss: tensor(0.0365, device='cuda:0')
batch 16 loss: tensor(0.0311, device='cuda:0')
batch 17 loss: tensor(0.0339, device='cuda:0')
batch 18 loss: tensor(0.0371, device='cuda:0')
batch 19 loss: tensor(0.0327, device='cuda:0')
batch 20 loss: tensor(0.0288, device='cuda:0')
batch 21 loss: tensor(0.0443, device='cuda:0')
batch 22 loss: tensor(0.0235, device='cuda:0')
batch 23 loss: tensor(0.0269, device='cuda:0')
batch 24 loss: tensor(0.0300, device='cuda:0')
batch 25 loss: tensor(0.0228, device='cuda:0')
batch 26 loss: tensor(0.0228, device='cuda:0')
batch 27 loss: tensor(0.0342, device='cuda:0')
batch 28 loss: tensor(0.0275, device='cuda:0')
batch 29 loss: tensor(0.0199, device='cuda:0')
batch 30 loss: tensor(0.0275, device='cuda:0')
batch 31 loss: tensor(0.0207, device='cuda:0')
batch 32 loss: tensor(0.0207, device='cuda:0')
batch 33 loss: tensor(0.0171, device='cuda:0')
batch 34 loss: tensor(0.0289, device='cuda:0')
batch 35 loss: tensor(0.0223, device='cuda:0')
batch 36 loss: tensor(0.0188, device='cuda:0')
batch 37 loss: tensor(0.0171, device='cuda:0')
batch 38 loss: tensor(0.0224, device='cuda:0')
batch 39 loss: tensor(0.0238, device='cuda:0')
batch 40 loss: tensor(0.0178, device='cuda:0')
batch 41 loss: tensor(0.0153, device='cuda:0')
batch 42 loss: tensor(0.0164, device='cuda:0')
batch 43 loss: tensor(0.0203, device='cuda:0')
batch 44 loss: tensor(0.0160, device='cuda:0')
batch 45 loss: tensor(0.0241, device='cuda:0')
batch 46 loss: tensor(0.0218, device='cuda:0')
batch 47 loss: tensor(0.0200, device='cuda:0')
batch 48 loss: tensor(0.0142, device='cuda:0')
batch 49 loss: tensor(0.0181, device='cuda:0')
batch 50 loss: tensor(0.0201, device='cuda:0')
batch 51 loss: tensor(0.0198, device='cuda:0')
batch 52 loss: tensor(0.0120, device='cuda:0')
batch 53 loss: tensor(0.0220, device='cuda:0')
batch 54 loss: tensor(0.0136, device='cuda:0')
batch 55 loss: tensor(0.0133, device='cuda:0')
batch 56 loss: tensor(0.0177, device='cuda:0')
batch 57 loss: tensor(0.0126, device='cuda:0')
batch 58 loss: tensor(0.0146, device='cuda:0')
batch 59 loss: tensor(0.0117, device='cuda:0')
batch 60 loss: tensor(0.0163, device='cuda:0')
accuracy in val: 0.848
accuracy in test: 0.847
average epoch time: 0.004873047272364299
total time: 0.5847656726837158
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8013, device='cuda:0')
batch 2 loss: tensor(1.4991, device='cuda:0')
batch 3 loss: tensor(1.2744, device='cuda:0')
batch 4 loss: tensor(0.9857, device='cuda:0')
batch 5 loss: tensor(0.8096, device='cuda:0')
batch 6 loss: tensor(0.6690, device='cuda:0')
batch 7 loss: tensor(0.5171, device='cuda:0')
batch 8 loss: tensor(0.3152, device='cuda:0')
batch 9 loss: tensor(0.3181, device='cuda:0')
batch 10 loss: tensor(0.2433, device='cuda:0')
batch 11 loss: tensor(0.2038, device='cuda:0')
batch 12 loss: tensor(0.1605, device='cuda:0')
batch 13 loss: tensor(0.1553, device='cuda:0')
batch 14 loss: tensor(0.0955, device='cuda:0')
batch 15 loss: tensor(0.1066, device='cuda:0')
batch 16 loss: tensor(0.0791, device='cuda:0')
batch 17 loss: tensor(0.0576, device='cuda:0')
batch 18 loss: tensor(0.0667, device='cuda:0')
batch 19 loss: tensor(0.0546, device='cuda:0')
batch 20 loss: tensor(0.0553, device='cuda:0')
batch 21 loss: tensor(0.0450, device='cuda:0')
batch 22 loss: tensor(0.0495, device='cuda:0')
batch 23 loss: tensor(0.0365, device='cuda:0')
batch 24 loss: tensor(0.0289, device='cuda:0')
batch 25 loss: tensor(0.0331, device='cuda:0')
batch 26 loss: tensor(0.0303, device='cuda:0')
batch 27 loss: tensor(0.0235, device='cuda:0')
batch 28 loss: tensor(0.0309, device='cuda:0')
batch 29 loss: tensor(0.0191, device='cuda:0')
batch 30 loss: tensor(0.0227, device='cuda:0')
batch 31 loss: tensor(0.0196, device='cuda:0')
batch 32 loss: tensor(0.0165, device='cuda:0')
batch 33 loss: tensor(0.0166, device='cuda:0')
batch 34 loss: tensor(0.0151, device='cuda:0')
batch 35 loss: tensor(0.0135, device='cuda:0')
batch 36 loss: tensor(0.0146, device='cuda:0')
batch 37 loss: tensor(0.0134, device='cuda:0')
batch 38 loss: tensor(0.0155, device='cuda:0')
batch 39 loss: tensor(0.0082, device='cuda:0')
batch 40 loss: tensor(0.0116, device='cuda:0')
batch 41 loss: tensor(0.0111, device='cuda:0')
batch 42 loss: tensor(0.0092, device='cuda:0')
batch 43 loss: tensor(0.0108, device='cuda:0')
batch 44 loss: tensor(0.0088, device='cuda:0')
batch 45 loss: tensor(0.0103, device='cuda:0')
batch 46 loss: tensor(0.0094, device='cuda:0')
batch 47 loss: tensor(0.0081, device='cuda:0')
batch 48 loss: tensor(0.0093, device='cuda:0')
batch 49 loss: tensor(0.0112, device='cuda:0')
batch 50 loss: tensor(0.0132, device='cuda:0')
batch 51 loss: tensor(0.0112, device='cuda:0')
batch 52 loss: tensor(0.0082, device='cuda:0')
batch 53 loss: tensor(0.0070, device='cuda:0')
batch 54 loss: tensor(0.0073, device='cuda:0')
batch 55 loss: tensor(0.0067, device='cuda:0')
batch 56 loss: tensor(0.0100, device='cuda:0')
batch 57 loss: tensor(0.0045, device='cuda:0')
batch 58 loss: tensor(0.0083, device='cuda:0')
batch 59 loss: tensor(0.0040, device='cuda:0')
batch 60 loss: tensor(0.0056, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(1.5449, device='cuda:0')
batch 2 loss: tensor(0.9389, device='cuda:0')
batch 3 loss: tensor(0.5737, device='cuda:0')
batch 4 loss: tensor(0.2878, device='cuda:0')
batch 5 loss: tensor(0.1619, device='cuda:0')
batch 6 loss: tensor(0.1070, device='cuda:0')
batch 7 loss: tensor(0.0759, device='cuda:0')
batch 8 loss: tensor(0.0631, device='cuda:0')
batch 9 loss: tensor(0.0499, device='cuda:0')
batch 10 loss: tensor(0.0453, device='cuda:0')
batch 11 loss: tensor(0.0373, device='cuda:0')
batch 12 loss: tensor(0.0340, device='cuda:0')
batch 13 loss: tensor(0.0291, device='cuda:0')
batch 14 loss: tensor(0.0270, device='cuda:0')
batch 15 loss: tensor(0.0319, device='cuda:0')
batch 16 loss: tensor(0.0255, device='cuda:0')
batch 17 loss: tensor(0.0236, device='cuda:0')
batch 18 loss: tensor(0.0219, device='cuda:0')
batch 19 loss: tensor(0.0211, device='cuda:0')
batch 20 loss: tensor(0.0202, device='cuda:0')
batch 21 loss: tensor(0.0173, device='cuda:0')
batch 22 loss: tensor(0.0164, device='cuda:0')
batch 23 loss: tensor(0.0239, device='cuda:0')
batch 24 loss: tensor(0.0285, device='cuda:0')
batch 25 loss: tensor(0.0162, device='cuda:0')
batch 26 loss: tensor(0.0174, device='cuda:0')
batch 27 loss: tensor(0.0228, device='cuda:0')
batch 28 loss: tensor(0.0190, device='cuda:0')
batch 29 loss: tensor(0.0155, device='cuda:0')
batch 30 loss: tensor(0.0139, device='cuda:0')
batch 31 loss: tensor(0.0113, device='cuda:0')
batch 32 loss: tensor(0.0143, device='cuda:0')
batch 33 loss: tensor(0.0131, device='cuda:0')
batch 34 loss: tensor(0.0123, device='cuda:0')
batch 35 loss: tensor(0.0182, device='cuda:0')
batch 36 loss: tensor(0.0119, device='cuda:0')
batch 37 loss: tensor(0.0163, device='cuda:0')
batch 38 loss: tensor(0.0165, device='cuda:0')
batch 39 loss: tensor(0.0083, device='cuda:0')
batch 40 loss: tensor(0.0115, device='cuda:0')
batch 41 loss: tensor(0.0138, device='cuda:0')
batch 42 loss: tensor(0.0119, device='cuda:0')
batch 43 loss: tensor(0.0126, device='cuda:0')
batch 44 loss: tensor(0.0085, device='cuda:0')
batch 45 loss: tensor(0.0111, device='cuda:0')
batch 46 loss: tensor(0.0101, device='cuda:0')
batch 47 loss: tensor(0.0102, device='cuda:0')
batch 48 loss: tensor(0.0061, device='cuda:0')
batch 49 loss: tensor(0.0117, device='cuda:0')
batch 50 loss: tensor(0.0149, device='cuda:0')
batch 51 loss: tensor(0.0103, device='cuda:0')
batch 52 loss: tensor(0.0085, device='cuda:0')
batch 53 loss: tensor(0.0057, device='cuda:0')
batch 54 loss: tensor(0.0101, device='cuda:0')
batch 55 loss: tensor(0.0116, device='cuda:0')
batch 56 loss: tensor(0.0057, device='cuda:0')
batch 57 loss: tensor(0.0115, device='cuda:0')
batch 58 loss: tensor(0.0104, device='cuda:0')
batch 59 loss: tensor(0.0068, device='cuda:0')
batch 60 loss: tensor(0.0068, device='cuda:0')
accuracy in val: 0.868
accuracy in test: 0.851
average epoch time: 0.004793941974639893
total time: 0.5752730369567871
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8230, device='cuda:0')
batch 2 loss: tensor(1.5156, device='cuda:0')
batch 3 loss: tensor(1.2471, device='cuda:0')
batch 4 loss: tensor(0.9959, device='cuda:0')
batch 5 loss: tensor(0.7977, device='cuda:0')
batch 6 loss: tensor(0.5878, device='cuda:0')
batch 7 loss: tensor(0.5079, device='cuda:0')
batch 8 loss: tensor(0.3763, device='cuda:0')
batch 9 loss: tensor(0.3065, device='cuda:0')
batch 10 loss: tensor(0.2303, device='cuda:0')
batch 11 loss: tensor(0.1763, device='cuda:0')
batch 12 loss: tensor(0.1733, device='cuda:0')
batch 13 loss: tensor(0.1132, device='cuda:0')
batch 14 loss: tensor(0.1107, device='cuda:0')
batch 15 loss: tensor(0.1011, device='cuda:0')
batch 16 loss: tensor(0.0821, device='cuda:0')
batch 17 loss: tensor(0.0677, device='cuda:0')
batch 18 loss: tensor(0.0706, device='cuda:0')
batch 19 loss: tensor(0.0530, device='cuda:0')
batch 20 loss: tensor(0.0407, device='cuda:0')
batch 21 loss: tensor(0.0464, device='cuda:0')
batch 22 loss: tensor(0.0426, device='cuda:0')
batch 23 loss: tensor(0.0460, device='cuda:0')
batch 24 loss: tensor(0.0304, device='cuda:0')
batch 25 loss: tensor(0.0328, device='cuda:0')
batch 26 loss: tensor(0.0290, device='cuda:0')
batch 27 loss: tensor(0.0268, device='cuda:0')
batch 28 loss: tensor(0.0349, device='cuda:0')
batch 29 loss: tensor(0.0220, device='cuda:0')
batch 30 loss: tensor(0.0187, device='cuda:0')
batch 31 loss: tensor(0.0160, device='cuda:0')
batch 32 loss: tensor(0.0191, device='cuda:0')
batch 33 loss: tensor(0.0166, device='cuda:0')
batch 34 loss: tensor(0.0175, device='cuda:0')
batch 35 loss: tensor(0.0192, device='cuda:0')
batch 36 loss: tensor(0.0199, device='cuda:0')
batch 37 loss: tensor(0.0148, device='cuda:0')
batch 38 loss: tensor(0.0099, device='cuda:0')
batch 39 loss: tensor(0.0130, device='cuda:0')
batch 40 loss: tensor(0.0149, device='cuda:0')
batch 41 loss: tensor(0.0121, device='cuda:0')
batch 42 loss: tensor(0.0113, device='cuda:0')
batch 43 loss: tensor(0.0104, device='cuda:0')
batch 44 loss: tensor(0.0123, device='cuda:0')
batch 45 loss: tensor(0.0115, device='cuda:0')
batch 46 loss: tensor(0.0096, device='cuda:0')
batch 47 loss: tensor(0.0076, device='cuda:0')
batch 48 loss: tensor(0.0109, device='cuda:0')
batch 49 loss: tensor(0.0069, device='cuda:0')
batch 50 loss: tensor(0.0095, device='cuda:0')
batch 51 loss: tensor(0.0062, device='cuda:0')
batch 52 loss: tensor(0.0094, device='cuda:0')
batch 53 loss: tensor(0.0076, device='cuda:0')
batch 54 loss: tensor(0.0068, device='cuda:0')
batch 55 loss: tensor(0.0066, device='cuda:0')
batch 56 loss: tensor(0.0073, device='cuda:0')
batch 57 loss: tensor(0.0055, device='cuda:0')
batch 58 loss: tensor(0.0073, device='cuda:0')
batch 59 loss: tensor(0.0050, device='cuda:0')
batch 60 loss: tensor(0.0060, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(3.4797, device='cuda:0')
batch 2 loss: tensor(1.5079, device='cuda:0')
batch 3 loss: tensor(0.7262, device='cuda:0')
batch 4 loss: tensor(0.2941, device='cuda:0')
batch 5 loss: tensor(0.1814, device='cuda:0')
batch 6 loss: tensor(0.1245, device='cuda:0')
batch 7 loss: tensor(0.0929, device='cuda:0')
batch 8 loss: tensor(0.0624, device='cuda:0')
batch 9 loss: tensor(0.0466, device='cuda:0')
batch 10 loss: tensor(0.0317, device='cuda:0')
batch 11 loss: tensor(0.0302, device='cuda:0')
batch 12 loss: tensor(0.0342, device='cuda:0')
batch 13 loss: tensor(0.0259, device='cuda:0')
batch 14 loss: tensor(0.0333, device='cuda:0')
batch 15 loss: tensor(0.0301, device='cuda:0')
batch 16 loss: tensor(0.0279, device='cuda:0')
batch 17 loss: tensor(0.0294, device='cuda:0')
batch 18 loss: tensor(0.0223, device='cuda:0')
batch 19 loss: tensor(0.0279, device='cuda:0')
batch 20 loss: tensor(0.0182, device='cuda:0')
batch 21 loss: tensor(0.0207, device='cuda:0')
batch 22 loss: tensor(0.0170, device='cuda:0')
batch 23 loss: tensor(0.0156, device='cuda:0')
batch 24 loss: tensor(0.0164, device='cuda:0')
batch 25 loss: tensor(0.0210, device='cuda:0')
batch 26 loss: tensor(0.0235, device='cuda:0')
batch 27 loss: tensor(0.0194, device='cuda:0')
batch 28 loss: tensor(0.0186, device='cuda:0')
batch 29 loss: tensor(0.0185, device='cuda:0')
batch 30 loss: tensor(0.0118, device='cuda:0')
batch 31 loss: tensor(0.0184, device='cuda:0')
batch 32 loss: tensor(0.0168, device='cuda:0')
batch 33 loss: tensor(0.0124, device='cuda:0')
batch 34 loss: tensor(0.0139, device='cuda:0')
batch 35 loss: tensor(0.0099, device='cuda:0')
batch 36 loss: tensor(0.0172, device='cuda:0')
batch 37 loss: tensor(0.0160, device='cuda:0')
batch 38 loss: tensor(0.0134, device='cuda:0')
batch 39 loss: tensor(0.0153, device='cuda:0')
batch 40 loss: tensor(0.0113, device='cuda:0')
batch 41 loss: tensor(0.0094, device='cuda:0')
batch 42 loss: tensor(0.0115, device='cuda:0')
batch 43 loss: tensor(0.0121, device='cuda:0')
batch 44 loss: tensor(0.0120, device='cuda:0')
batch 45 loss: tensor(0.0133, device='cuda:0')
batch 46 loss: tensor(0.0095, device='cuda:0')
batch 47 loss: tensor(0.0107, device='cuda:0')
batch 48 loss: tensor(0.0175, device='cuda:0')
batch 49 loss: tensor(0.0181, device='cuda:0')
batch 50 loss: tensor(0.0146, device='cuda:0')
batch 51 loss: tensor(0.0152, device='cuda:0')
batch 52 loss: tensor(0.0098, device='cuda:0')
batch 53 loss: tensor(0.0122, device='cuda:0')
batch 54 loss: tensor(0.0099, device='cuda:0')
batch 55 loss: tensor(0.0086, device='cuda:0')
batch 56 loss: tensor(0.0113, device='cuda:0')
batch 57 loss: tensor(0.0077, device='cuda:0')
batch 58 loss: tensor(0.0146, device='cuda:0')
batch 59 loss: tensor(0.0073, device='cuda:0')
batch 60 loss: tensor(0.0086, device='cuda:0')
accuracy in val: 0.852
accuracy in test: 0.844
average epoch time: 0.005842892328898112
total time: 0.7011470794677734
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8382, device='cuda:0')
batch 2 loss: tensor(1.5633, device='cuda:0')
batch 3 loss: tensor(1.3226, device='cuda:0')
batch 4 loss: tensor(1.0475, device='cuda:0')
batch 5 loss: tensor(0.8406, device='cuda:0')
batch 6 loss: tensor(0.6472, device='cuda:0')
batch 7 loss: tensor(0.4720, device='cuda:0')
batch 8 loss: tensor(0.4059, device='cuda:0')
batch 9 loss: tensor(0.3435, device='cuda:0')
batch 10 loss: tensor(0.2693, device='cuda:0')
batch 11 loss: tensor(0.2400, device='cuda:0')
batch 12 loss: tensor(0.1991, device='cuda:0')
batch 13 loss: tensor(0.1224, device='cuda:0')
batch 14 loss: tensor(0.1192, device='cuda:0')
batch 15 loss: tensor(0.0951, device='cuda:0')
batch 16 loss: tensor(0.1121, device='cuda:0')
batch 17 loss: tensor(0.0796, device='cuda:0')
batch 18 loss: tensor(0.0782, device='cuda:0')
batch 19 loss: tensor(0.0583, device='cuda:0')
batch 20 loss: tensor(0.0475, device='cuda:0')
batch 21 loss: tensor(0.0609, device='cuda:0')
batch 22 loss: tensor(0.0509, device='cuda:0')
batch 23 loss: tensor(0.0318, device='cuda:0')
batch 24 loss: tensor(0.0395, device='cuda:0')
batch 25 loss: tensor(0.0406, device='cuda:0')
batch 26 loss: tensor(0.0284, device='cuda:0')
batch 27 loss: tensor(0.0197, device='cuda:0')
batch 28 loss: tensor(0.0292, device='cuda:0')
batch 29 loss: tensor(0.0239, device='cuda:0')
batch 30 loss: tensor(0.0262, device='cuda:0')
batch 31 loss: tensor(0.0207, device='cuda:0')
batch 32 loss: tensor(0.0266, device='cuda:0')
batch 33 loss: tensor(0.0295, device='cuda:0')
batch 34 loss: tensor(0.0154, device='cuda:0')
batch 35 loss: tensor(0.0205, device='cuda:0')
batch 36 loss: tensor(0.0188, device='cuda:0')
batch 37 loss: tensor(0.0155, device='cuda:0')
batch 38 loss: tensor(0.0145, device='cuda:0')
batch 39 loss: tensor(0.0154, device='cuda:0')
batch 40 loss: tensor(0.0125, device='cuda:0')
batch 41 loss: tensor(0.0112, device='cuda:0')
batch 42 loss: tensor(0.0175, device='cuda:0')
batch 43 loss: tensor(0.0144, device='cuda:0')
batch 44 loss: tensor(0.0143, device='cuda:0')
batch 45 loss: tensor(0.0075, device='cuda:0')
batch 46 loss: tensor(0.0111, device='cuda:0')
batch 47 loss: tensor(0.0105, device='cuda:0')
batch 48 loss: tensor(0.0080, device='cuda:0')
batch 49 loss: tensor(0.0124, device='cuda:0')
batch 50 loss: tensor(0.0086, device='cuda:0')
batch 51 loss: tensor(0.0086, device='cuda:0')
batch 52 loss: tensor(0.0082, device='cuda:0')
batch 53 loss: tensor(0.0095, device='cuda:0')
batch 54 loss: tensor(0.0082, device='cuda:0')
batch 55 loss: tensor(0.0061, device='cuda:0')
batch 56 loss: tensor(0.0074, device='cuda:0')
batch 57 loss: tensor(0.0076, device='cuda:0')
batch 58 loss: tensor(0.0062, device='cuda:0')
batch 59 loss: tensor(0.0062, device='cuda:0')
batch 60 loss: tensor(0.0063, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(2.4615, device='cuda:0')
batch 2 loss: tensor(1.3439, device='cuda:0')
batch 3 loss: tensor(0.7538, device='cuda:0')
batch 4 loss: tensor(0.3033, device='cuda:0')
batch 5 loss: tensor(0.1736, device='cuda:0')
batch 6 loss: tensor(0.1015, device='cuda:0')
batch 7 loss: tensor(0.0909, device='cuda:0')
batch 8 loss: tensor(0.0823, device='cuda:0')
batch 9 loss: tensor(0.0475, device='cuda:0')
batch 10 loss: tensor(0.0474, device='cuda:0')
batch 11 loss: tensor(0.0488, device='cuda:0')
batch 12 loss: tensor(0.0446, device='cuda:0')
batch 13 loss: tensor(0.0500, device='cuda:0')
batch 14 loss: tensor(0.0284, device='cuda:0')
batch 15 loss: tensor(0.0292, device='cuda:0')
batch 16 loss: tensor(0.0298, device='cuda:0')
batch 17 loss: tensor(0.0393, device='cuda:0')
batch 18 loss: tensor(0.0414, device='cuda:0')
batch 19 loss: tensor(0.0257, device='cuda:0')
batch 20 loss: tensor(0.0308, device='cuda:0')
batch 21 loss: tensor(0.0318, device='cuda:0')
batch 22 loss: tensor(0.0315, device='cuda:0')
batch 23 loss: tensor(0.0289, device='cuda:0')
batch 24 loss: tensor(0.0186, device='cuda:0')
batch 25 loss: tensor(0.0223, device='cuda:0')
batch 26 loss: tensor(0.0239, device='cuda:0')
batch 27 loss: tensor(0.0290, device='cuda:0')
batch 28 loss: tensor(0.0200, device='cuda:0')
batch 29 loss: tensor(0.0193, device='cuda:0')
batch 30 loss: tensor(0.0265, device='cuda:0')
batch 31 loss: tensor(0.0220, device='cuda:0')
batch 32 loss: tensor(0.0204, device='cuda:0')
batch 33 loss: tensor(0.0218, device='cuda:0')
batch 34 loss: tensor(0.0239, device='cuda:0')
batch 35 loss: tensor(0.0191, device='cuda:0')
batch 36 loss: tensor(0.0216, device='cuda:0')
batch 37 loss: tensor(0.0172, device='cuda:0')
batch 38 loss: tensor(0.0172, device='cuda:0')
batch 39 loss: tensor(0.0201, device='cuda:0')
batch 40 loss: tensor(0.0187, device='cuda:0')
batch 41 loss: tensor(0.0110, device='cuda:0')
batch 42 loss: tensor(0.0162, device='cuda:0')
batch 43 loss: tensor(0.0171, device='cuda:0')
batch 44 loss: tensor(0.0171, device='cuda:0')
batch 45 loss: tensor(0.0213, device='cuda:0')
batch 46 loss: tensor(0.0148, device='cuda:0')
batch 47 loss: tensor(0.0165, device='cuda:0')
batch 48 loss: tensor(0.0172, device='cuda:0')
batch 49 loss: tensor(0.0102, device='cuda:0')
batch 50 loss: tensor(0.0165, device='cuda:0')
batch 51 loss: tensor(0.0196, device='cuda:0')
batch 52 loss: tensor(0.0154, device='cuda:0')
batch 53 loss: tensor(0.0175, device='cuda:0')
batch 54 loss: tensor(0.0167, device='cuda:0')
batch 55 loss: tensor(0.0181, device='cuda:0')
batch 56 loss: tensor(0.0095, device='cuda:0')
batch 57 loss: tensor(0.0175, device='cuda:0')
batch 58 loss: tensor(0.0159, device='cuda:0')
batch 59 loss: tensor(0.0175, device='cuda:0')
batch 60 loss: tensor(0.0112, device='cuda:0')
accuracy in val: 0.852
accuracy in test: 0.83
average epoch time: 0.004850892225901285
total time: 0.5821070671081543

0.8431999999999998 0.628304123878479
0.00754718490564529 0.06000724042143213
Thu Nov 21 15:36:52 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   30C    P0    53W / 149W |    353MiB / 12206MiB |     11%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35104      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:36:54 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   30C    P0    53W / 149W |    353MiB / 12206MiB |     11%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35104      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:36:56 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   30C    P0    53W / 149W |    353MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35104      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:36:59 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   30C    P0    53W / 149W |    353MiB / 12206MiB |     10%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35104      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:01 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   31C    P0    53W / 149W |    353MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35104      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:03 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   31C    P0    53W / 149W |    353MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35104      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:05 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   31C    P0    53W / 149W |    353MiB / 12206MiB |     10%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35104      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:07 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   31C    P0    53W / 149W |    353MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35104      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:09 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   31C    P0    53W / 149W |    353MiB / 12206MiB |      8%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35104      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:11 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   31C    P0    53W / 149W |    353MiB / 12206MiB |      9%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35104      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
{'dataset': 'cora', 'config_file': 'cora.yaml', 'layer_num': 2, 'epoch_num': [80, 80]}
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8252, device='cuda:0')
batch 2 loss: tensor(1.5931, device='cuda:0')
batch 3 loss: tensor(1.3182, device='cuda:0')
batch 4 loss: tensor(1.0453, device='cuda:0')
batch 5 loss: tensor(0.8343, device='cuda:0')
batch 6 loss: tensor(0.6260, device='cuda:0')
batch 7 loss: tensor(0.5488, device='cuda:0')
batch 8 loss: tensor(0.3786, device='cuda:0')
batch 9 loss: tensor(0.3406, device='cuda:0')
batch 10 loss: tensor(0.2823, device='cuda:0')
batch 11 loss: tensor(0.2104, device='cuda:0')
batch 12 loss: tensor(0.1555, device='cuda:0')
batch 13 loss: tensor(0.1590, device='cuda:0')
batch 14 loss: tensor(0.1495, device='cuda:0')
batch 15 loss: tensor(0.1029, device='cuda:0')
batch 16 loss: tensor(0.0901, device='cuda:0')
batch 17 loss: tensor(0.0787, device='cuda:0')
batch 18 loss: tensor(0.0631, device='cuda:0')
batch 19 loss: tensor(0.0607, device='cuda:0')
batch 20 loss: tensor(0.0557, device='cuda:0')
batch 21 loss: tensor(0.0477, device='cuda:0')
batch 22 loss: tensor(0.0395, device='cuda:0')
batch 23 loss: tensor(0.0367, device='cuda:0')
batch 24 loss: tensor(0.0335, device='cuda:0')
batch 25 loss: tensor(0.0340, device='cuda:0')
batch 26 loss: tensor(0.0309, device='cuda:0')
batch 27 loss: tensor(0.0328, device='cuda:0')
batch 28 loss: tensor(0.0292, device='cuda:0')
batch 29 loss: tensor(0.0227, device='cuda:0')
batch 30 loss: tensor(0.0217, device='cuda:0')
batch 31 loss: tensor(0.0236, device='cuda:0')
batch 32 loss: tensor(0.0153, device='cuda:0')
batch 33 loss: tensor(0.0180, device='cuda:0')
batch 34 loss: tensor(0.0193, device='cuda:0')
batch 35 loss: tensor(0.0167, device='cuda:0')
batch 36 loss: tensor(0.0135, device='cuda:0')
batch 37 loss: tensor(0.0166, device='cuda:0')
batch 38 loss: tensor(0.0153, device='cuda:0')
batch 39 loss: tensor(0.0117, device='cuda:0')
batch 40 loss: tensor(0.0151, device='cuda:0')
batch 41 loss: tensor(0.0106, device='cuda:0')
batch 42 loss: tensor(0.0122, device='cuda:0')
batch 43 loss: tensor(0.0123, device='cuda:0')
batch 44 loss: tensor(0.0089, device='cuda:0')
batch 45 loss: tensor(0.0134, device='cuda:0')
batch 46 loss: tensor(0.0074, device='cuda:0')
batch 47 loss: tensor(0.0087, device='cuda:0')
batch 48 loss: tensor(0.0093, device='cuda:0')
batch 49 loss: tensor(0.0079, device='cuda:0')
batch 50 loss: tensor(0.0074, device='cuda:0')
batch 51 loss: tensor(0.0084, device='cuda:0')
batch 52 loss: tensor(0.0076, device='cuda:0')
batch 53 loss: tensor(0.0050, device='cuda:0')
batch 54 loss: tensor(0.0071, device='cuda:0')
batch 55 loss: tensor(0.0068, device='cuda:0')
batch 56 loss: tensor(0.0057, device='cuda:0')
batch 57 loss: tensor(0.0068, device='cuda:0')
batch 58 loss: tensor(0.0050, device='cuda:0')
batch 59 loss: tensor(0.0063, device='cuda:0')
batch 60 loss: tensor(0.0053, device='cuda:0')
batch 61 loss: tensor(0.0043, device='cuda:0')
batch 62 loss: tensor(0.0043, device='cuda:0')
batch 63 loss: tensor(0.0063, device='cuda:0')
batch 64 loss: tensor(0.0047, device='cuda:0')
batch 65 loss: tensor(0.0055, device='cuda:0')
batch 66 loss: tensor(0.0048, device='cuda:0')
batch 67 loss: tensor(0.0049, device='cuda:0')
batch 68 loss: tensor(0.0034, device='cuda:0')
batch 69 loss: tensor(0.0043, device='cuda:0')
batch 70 loss: tensor(0.0047, device='cuda:0')
batch 71 loss: tensor(0.0027, device='cuda:0')
batch 72 loss: tensor(0.0048, device='cuda:0')
batch 73 loss: tensor(0.0035, device='cuda:0')
batch 74 loss: tensor(0.0039, device='cuda:0')
batch 75 loss: tensor(0.0042, device='cuda:0')
batch 76 loss: tensor(0.0036, device='cuda:0')
batch 77 loss: tensor(0.0060, device='cuda:0')
batch 78 loss: tensor(0.0029, device='cuda:0')
batch 79 loss: tensor(0.0037, device='cuda:0')
batch 80 loss: tensor(0.0031, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(1.8691, device='cuda:0')
batch 2 loss: tensor(0.7077, device='cuda:0')
batch 3 loss: tensor(0.4227, device='cuda:0')
batch 4 loss: tensor(0.2397, device='cuda:0')
batch 5 loss: tensor(0.1238, device='cuda:0')
batch 6 loss: tensor(0.1199, device='cuda:0')
batch 7 loss: tensor(0.0817, device='cuda:0')
batch 8 loss: tensor(0.0715, device='cuda:0')
batch 9 loss: tensor(0.0584, device='cuda:0')
batch 10 loss: tensor(0.0451, device='cuda:0')
batch 11 loss: tensor(0.0419, device='cuda:0')
batch 12 loss: tensor(0.0432, device='cuda:0')
batch 13 loss: tensor(0.0370, device='cuda:0')
batch 14 loss: tensor(0.0376, device='cuda:0')
batch 15 loss: tensor(0.0333, device='cuda:0')
batch 16 loss: tensor(0.0318, device='cuda:0')
batch 17 loss: tensor(0.0393, device='cuda:0')
batch 18 loss: tensor(0.0291, device='cuda:0')
batch 19 loss: tensor(0.0259, device='cuda:0')
batch 20 loss: tensor(0.0333, device='cuda:0')
batch 21 loss: tensor(0.0228, device='cuda:0')
batch 22 loss: tensor(0.0283, device='cuda:0')
batch 23 loss: tensor(0.0300, device='cuda:0')
batch 24 loss: tensor(0.0201, device='cuda:0')
batch 25 loss: tensor(0.0155, device='cuda:0')
batch 26 loss: tensor(0.0272, device='cuda:0')
batch 27 loss: tensor(0.0244, device='cuda:0')
batch 28 loss: tensor(0.0196, device='cuda:0')
batch 29 loss: tensor(0.0153, device='cuda:0')
batch 30 loss: tensor(0.0305, device='cuda:0')
batch 31 loss: tensor(0.0205, device='cuda:0')
batch 32 loss: tensor(0.0164, device='cuda:0')
batch 33 loss: tensor(0.0147, device='cuda:0')
batch 34 loss: tensor(0.0223, device='cuda:0')
batch 35 loss: tensor(0.0161, device='cuda:0')
batch 36 loss: tensor(0.0089, device='cuda:0')
batch 37 loss: tensor(0.0233, device='cuda:0')
batch 38 loss: tensor(0.0182, device='cuda:0')
batch 39 loss: tensor(0.0185, device='cuda:0')
batch 40 loss: tensor(0.0114, device='cuda:0')
batch 41 loss: tensor(0.0098, device='cuda:0')
batch 42 loss: tensor(0.0139, device='cuda:0')
batch 43 loss: tensor(0.0176, device='cuda:0')
batch 44 loss: tensor(0.0105, device='cuda:0')
batch 45 loss: tensor(0.0163, device='cuda:0')
batch 46 loss: tensor(0.0133, device='cuda:0')
batch 47 loss: tensor(0.0141, device='cuda:0')
batch 48 loss: tensor(0.0119, device='cuda:0')
batch 49 loss: tensor(0.0111, device='cuda:0')
batch 50 loss: tensor(0.0093, device='cuda:0')
batch 51 loss: tensor(0.0167, device='cuda:0')
batch 52 loss: tensor(0.0110, device='cuda:0')
batch 53 loss: tensor(0.0087, device='cuda:0')
batch 54 loss: tensor(0.0087, device='cuda:0')
batch 55 loss: tensor(0.0132, device='cuda:0')
batch 56 loss: tensor(0.0068, device='cuda:0')
batch 57 loss: tensor(0.0103, device='cuda:0')
batch 58 loss: tensor(0.0077, device='cuda:0')
batch 59 loss: tensor(0.0121, device='cuda:0')
batch 60 loss: tensor(0.0109, device='cuda:0')
batch 61 loss: tensor(0.0126, device='cuda:0')
batch 62 loss: tensor(0.0053, device='cuda:0')
batch 63 loss: tensor(0.0103, device='cuda:0')
batch 64 loss: tensor(0.0132, device='cuda:0')
batch 65 loss: tensor(0.0083, device='cuda:0')
batch 66 loss: tensor(0.0140, device='cuda:0')
batch 67 loss: tensor(0.0079, device='cuda:0')
batch 68 loss: tensor(0.0084, device='cuda:0')
batch 69 loss: tensor(0.0074, device='cuda:0')
batch 70 loss: tensor(0.0090, device='cuda:0')
batch 71 loss: tensor(0.0096, device='cuda:0')
batch 72 loss: tensor(0.0080, device='cuda:0')
batch 73 loss: tensor(0.0074, device='cuda:0')
batch 74 loss: tensor(0.0070, device='cuda:0')
batch 75 loss: tensor(0.0074, device='cuda:0')
batch 76 loss: tensor(0.0070, device='cuda:0')
batch 77 loss: tensor(0.0066, device='cuda:0')
batch 78 loss: tensor(0.0066, device='cuda:0')
batch 79 loss: tensor(0.0087, device='cuda:0')
batch 80 loss: tensor(0.0075, device='cuda:0')
accuracy in val: 0.858
accuracy in test: 0.834
average epoch time: 0.00507182776927948
total time: 0.8114924430847168
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8342, device='cuda:0')
batch 2 loss: tensor(1.5841, device='cuda:0')
batch 3 loss: tensor(1.2862, device='cuda:0')
batch 4 loss: tensor(1.0399, device='cuda:0')
batch 5 loss: tensor(0.7980, device='cuda:0')
batch 6 loss: tensor(0.6630, device='cuda:0')
batch 7 loss: tensor(0.4945, device='cuda:0')
batch 8 loss: tensor(0.4001, device='cuda:0')
batch 9 loss: tensor(0.2992, device='cuda:0')
batch 10 loss: tensor(0.2560, device='cuda:0')
batch 11 loss: tensor(0.1846, device='cuda:0')
batch 12 loss: tensor(0.1876, device='cuda:0')
batch 13 loss: tensor(0.1566, device='cuda:0')
batch 14 loss: tensor(0.1277, device='cuda:0')
batch 15 loss: tensor(0.1066, device='cuda:0')
batch 16 loss: tensor(0.0705, device='cuda:0')
batch 17 loss: tensor(0.0924, device='cuda:0')
batch 18 loss: tensor(0.0755, device='cuda:0')
batch 19 loss: tensor(0.0702, device='cuda:0')
batch 20 loss: tensor(0.0517, device='cuda:0')
batch 21 loss: tensor(0.0448, device='cuda:0')
batch 22 loss: tensor(0.0386, device='cuda:0')
batch 23 loss: tensor(0.0325, device='cuda:0')
batch 24 loss: tensor(0.0362, device='cuda:0')
batch 25 loss: tensor(0.0320, device='cuda:0')
batch 26 loss: tensor(0.0269, device='cuda:0')
batch 27 loss: tensor(0.0326, device='cuda:0')
batch 28 loss: tensor(0.0241, device='cuda:0')
batch 29 loss: tensor(0.0196, device='cuda:0')
batch 30 loss: tensor(0.0219, device='cuda:0')
batch 31 loss: tensor(0.0155, device='cuda:0')
batch 32 loss: tensor(0.0182, device='cuda:0')
batch 33 loss: tensor(0.0162, device='cuda:0')
batch 34 loss: tensor(0.0189, device='cuda:0')
batch 35 loss: tensor(0.0135, device='cuda:0')
batch 36 loss: tensor(0.0139, device='cuda:0')
batch 37 loss: tensor(0.0177, device='cuda:0')
batch 38 loss: tensor(0.0136, device='cuda:0')
batch 39 loss: tensor(0.0131, device='cuda:0')
batch 40 loss: tensor(0.0113, device='cuda:0')
batch 41 loss: tensor(0.0101, device='cuda:0')
batch 42 loss: tensor(0.0116, device='cuda:0')
batch 43 loss: tensor(0.0109, device='cuda:0')
batch 44 loss: tensor(0.0101, device='cuda:0')
batch 45 loss: tensor(0.0083, device='cuda:0')
batch 46 loss: tensor(0.0086, device='cuda:0')
batch 47 loss: tensor(0.0116, device='cuda:0')
batch 48 loss: tensor(0.0083, device='cuda:0')
batch 49 loss: tensor(0.0098, device='cuda:0')
batch 50 loss: tensor(0.0104, device='cuda:0')
batch 51 loss: tensor(0.0072, device='cuda:0')
batch 52 loss: tensor(0.0058, device='cuda:0')
batch 53 loss: tensor(0.0063, device='cuda:0')
batch 54 loss: tensor(0.0097, device='cuda:0')
batch 55 loss: tensor(0.0057, device='cuda:0')
batch 56 loss: tensor(0.0064, device='cuda:0')
batch 57 loss: tensor(0.0058, device='cuda:0')
batch 58 loss: tensor(0.0071, device='cuda:0')
batch 59 loss: tensor(0.0049, device='cuda:0')
batch 60 loss: tensor(0.0069, device='cuda:0')
batch 61 loss: tensor(0.0041, device='cuda:0')
batch 62 loss: tensor(0.0054, device='cuda:0')
batch 63 loss: tensor(0.0046, device='cuda:0')
batch 64 loss: tensor(0.0042, device='cuda:0')
batch 65 loss: tensor(0.0041, device='cuda:0')
batch 66 loss: tensor(0.0042, device='cuda:0')
batch 67 loss: tensor(0.0038, device='cuda:0')
batch 68 loss: tensor(0.0041, device='cuda:0')
batch 69 loss: tensor(0.0034, device='cuda:0')
batch 70 loss: tensor(0.0037, device='cuda:0')
batch 71 loss: tensor(0.0047, device='cuda:0')
batch 72 loss: tensor(0.0041, device='cuda:0')
batch 73 loss: tensor(0.0039, device='cuda:0')
batch 74 loss: tensor(0.0033, device='cuda:0')
batch 75 loss: tensor(0.0045, device='cuda:0')
batch 76 loss: tensor(0.0043, device='cuda:0')
batch 77 loss: tensor(0.0026, device='cuda:0')
batch 78 loss: tensor(0.0035, device='cuda:0')
batch 79 loss: tensor(0.0042, device='cuda:0')
batch 80 loss: tensor(0.0030, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(2.0332, device='cuda:0')
batch 2 loss: tensor(1.1660, device='cuda:0')
batch 3 loss: tensor(0.8011, device='cuda:0')
batch 4 loss: tensor(0.5528, device='cuda:0')
batch 5 loss: tensor(0.4016, device='cuda:0')
batch 6 loss: tensor(0.2898, device='cuda:0')
batch 7 loss: tensor(0.2164, device='cuda:0')
batch 8 loss: tensor(0.1730, device='cuda:0')
batch 9 loss: tensor(0.1615, device='cuda:0')
batch 10 loss: tensor(0.1239, device='cuda:0')
batch 11 loss: tensor(0.1038, device='cuda:0')
batch 12 loss: tensor(0.0933, device='cuda:0')
batch 13 loss: tensor(0.0794, device='cuda:0')
batch 14 loss: tensor(0.0539, device='cuda:0')
batch 15 loss: tensor(0.0802, device='cuda:0')
batch 16 loss: tensor(0.0906, device='cuda:0')
batch 17 loss: tensor(0.0599, device='cuda:0')
batch 18 loss: tensor(0.0505, device='cuda:0')
batch 19 loss: tensor(0.0605, device='cuda:0')
batch 20 loss: tensor(0.0515, device='cuda:0')
batch 21 loss: tensor(0.0607, device='cuda:0')
batch 22 loss: tensor(0.0378, device='cuda:0')
batch 23 loss: tensor(0.0376, device='cuda:0')
batch 24 loss: tensor(0.0420, device='cuda:0')
batch 25 loss: tensor(0.0418, device='cuda:0')
batch 26 loss: tensor(0.0447, device='cuda:0')
batch 27 loss: tensor(0.0448, device='cuda:0')
batch 28 loss: tensor(0.0398, device='cuda:0')
batch 29 loss: tensor(0.0352, device='cuda:0')
batch 30 loss: tensor(0.0365, device='cuda:0')
batch 31 loss: tensor(0.0274, device='cuda:0')
batch 32 loss: tensor(0.0336, device='cuda:0')
batch 33 loss: tensor(0.0240, device='cuda:0')
batch 34 loss: tensor(0.0289, device='cuda:0')
batch 35 loss: tensor(0.0315, device='cuda:0')
batch 36 loss: tensor(0.0303, device='cuda:0')
batch 37 loss: tensor(0.0314, device='cuda:0')
batch 38 loss: tensor(0.0283, device='cuda:0')
batch 39 loss: tensor(0.0251, device='cuda:0')
batch 40 loss: tensor(0.0247, device='cuda:0')
batch 41 loss: tensor(0.0265, device='cuda:0')
batch 42 loss: tensor(0.0206, device='cuda:0')
batch 43 loss: tensor(0.0247, device='cuda:0')
batch 44 loss: tensor(0.0200, device='cuda:0')
batch 45 loss: tensor(0.0204, device='cuda:0')
batch 46 loss: tensor(0.0180, device='cuda:0')
batch 47 loss: tensor(0.0195, device='cuda:0')
batch 48 loss: tensor(0.0183, device='cuda:0')
batch 49 loss: tensor(0.0226, device='cuda:0')
batch 50 loss: tensor(0.0217, device='cuda:0')
batch 51 loss: tensor(0.0154, device='cuda:0')
batch 52 loss: tensor(0.0150, device='cuda:0')
batch 53 loss: tensor(0.0239, device='cuda:0')
batch 54 loss: tensor(0.0190, device='cuda:0')
batch 55 loss: tensor(0.0178, device='cuda:0')
batch 56 loss: tensor(0.0211, device='cuda:0')
batch 57 loss: tensor(0.0223, device='cuda:0')
batch 58 loss: tensor(0.0283, device='cuda:0')
batch 59 loss: tensor(0.0152, device='cuda:0')
batch 60 loss: tensor(0.0172, device='cuda:0')
batch 61 loss: tensor(0.0120, device='cuda:0')
batch 62 loss: tensor(0.0132, device='cuda:0')
batch 63 loss: tensor(0.0191, device='cuda:0')
batch 64 loss: tensor(0.0126, device='cuda:0')
batch 65 loss: tensor(0.0151, device='cuda:0')
batch 66 loss: tensor(0.0092, device='cuda:0')
batch 67 loss: tensor(0.0125, device='cuda:0')
batch 68 loss: tensor(0.0129, device='cuda:0')
batch 69 loss: tensor(0.0101, device='cuda:0')
batch 70 loss: tensor(0.0160, device='cuda:0')
batch 71 loss: tensor(0.0085, device='cuda:0')
batch 72 loss: tensor(0.0075, device='cuda:0')
batch 73 loss: tensor(0.0180, device='cuda:0')
batch 74 loss: tensor(0.0095, device='cuda:0')
batch 75 loss: tensor(0.0091, device='cuda:0')
batch 76 loss: tensor(0.0111, device='cuda:0')
batch 77 loss: tensor(0.0093, device='cuda:0')
batch 78 loss: tensor(0.0127, device='cuda:0')
batch 79 loss: tensor(0.0126, device='cuda:0')
batch 80 loss: tensor(0.0099, device='cuda:0')
accuracy in val: 0.85
accuracy in test: 0.841
average epoch time: 0.005566807091236114
total time: 0.8906891345977783
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8051, device='cuda:0')
batch 2 loss: tensor(1.5128, device='cuda:0')
batch 3 loss: tensor(1.2891, device='cuda:0')
batch 4 loss: tensor(1.0640, device='cuda:0')
batch 5 loss: tensor(0.8679, device='cuda:0')
batch 6 loss: tensor(0.6130, device='cuda:0')
batch 7 loss: tensor(0.4957, device='cuda:0')
batch 8 loss: tensor(0.4207, device='cuda:0')
batch 9 loss: tensor(0.3355, device='cuda:0')
batch 10 loss: tensor(0.3106, device='cuda:0')
batch 11 loss: tensor(0.2000, device='cuda:0')
batch 12 loss: tensor(0.1520, device='cuda:0')
batch 13 loss: tensor(0.1591, device='cuda:0')
batch 14 loss: tensor(0.1037, device='cuda:0')
batch 15 loss: tensor(0.1173, device='cuda:0')
batch 16 loss: tensor(0.0898, device='cuda:0')
batch 17 loss: tensor(0.0730, device='cuda:0')
batch 18 loss: tensor(0.0617, device='cuda:0')
batch 19 loss: tensor(0.0555, device='cuda:0')
batch 20 loss: tensor(0.0454, device='cuda:0')
batch 21 loss: tensor(0.0448, device='cuda:0')
batch 22 loss: tensor(0.0470, device='cuda:0')
batch 23 loss: tensor(0.0363, device='cuda:0')
batch 24 loss: tensor(0.0486, device='cuda:0')
batch 25 loss: tensor(0.0334, device='cuda:0')
batch 26 loss: tensor(0.0235, device='cuda:0')
batch 27 loss: tensor(0.0323, device='cuda:0')
batch 28 loss: tensor(0.0283, device='cuda:0')
batch 29 loss: tensor(0.0271, device='cuda:0')
batch 30 loss: tensor(0.0306, device='cuda:0')
batch 31 loss: tensor(0.0260, device='cuda:0')
batch 32 loss: tensor(0.0178, device='cuda:0')
batch 33 loss: tensor(0.0171, device='cuda:0')
batch 34 loss: tensor(0.0154, device='cuda:0')
batch 35 loss: tensor(0.0170, device='cuda:0')
batch 36 loss: tensor(0.0186, device='cuda:0')
batch 37 loss: tensor(0.0146, device='cuda:0')
batch 38 loss: tensor(0.0188, device='cuda:0')
batch 39 loss: tensor(0.0161, device='cuda:0')
batch 40 loss: tensor(0.0114, device='cuda:0')
batch 41 loss: tensor(0.0077, device='cuda:0')
batch 42 loss: tensor(0.0110, device='cuda:0')
batch 43 loss: tensor(0.0114, device='cuda:0')
batch 44 loss: tensor(0.0124, device='cuda:0')
batch 45 loss: tensor(0.0096, device='cuda:0')
batch 46 loss: tensor(0.0098, device='cuda:0')
batch 47 loss: tensor(0.0103, device='cuda:0')
batch 48 loss: tensor(0.0070, device='cuda:0')
batch 49 loss: tensor(0.0088, device='cuda:0')
batch 50 loss: tensor(0.0073, device='cuda:0')
batch 51 loss: tensor(0.0097, device='cuda:0')
batch 52 loss: tensor(0.0067, device='cuda:0')
batch 53 loss: tensor(0.0072, device='cuda:0')
batch 54 loss: tensor(0.0069, device='cuda:0')
batch 55 loss: tensor(0.0074, device='cuda:0')
batch 56 loss: tensor(0.0076, device='cuda:0')
batch 57 loss: tensor(0.0069, device='cuda:0')
batch 58 loss: tensor(0.0069, device='cuda:0')
batch 59 loss: tensor(0.0067, device='cuda:0')
batch 60 loss: tensor(0.0063, device='cuda:0')
batch 61 loss: tensor(0.0053, device='cuda:0')
batch 62 loss: tensor(0.0070, device='cuda:0')
batch 63 loss: tensor(0.0040, device='cuda:0')
batch 64 loss: tensor(0.0054, device='cuda:0')
batch 65 loss: tensor(0.0057, device='cuda:0')
batch 66 loss: tensor(0.0049, device='cuda:0')
batch 67 loss: tensor(0.0043, device='cuda:0')
batch 68 loss: tensor(0.0050, device='cuda:0')
batch 69 loss: tensor(0.0044, device='cuda:0')
batch 70 loss: tensor(0.0048, device='cuda:0')
batch 71 loss: tensor(0.0047, device='cuda:0')
batch 72 loss: tensor(0.0038, device='cuda:0')
batch 73 loss: tensor(0.0038, device='cuda:0')
batch 74 loss: tensor(0.0041, device='cuda:0')
batch 75 loss: tensor(0.0036, device='cuda:0')
batch 76 loss: tensor(0.0028, device='cuda:0')
batch 77 loss: tensor(0.0042, device='cuda:0')
batch 78 loss: tensor(0.0039, device='cuda:0')
batch 79 loss: tensor(0.0047, device='cuda:0')
batch 80 loss: tensor(0.0042, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(2.3264, device='cuda:0')
batch 2 loss: tensor(1.4464, device='cuda:0')
batch 3 loss: tensor(1.0020, device='cuda:0')
batch 4 loss: tensor(0.5915, device='cuda:0')
batch 5 loss: tensor(0.3743, device='cuda:0')
batch 6 loss: tensor(0.2264, device='cuda:0')
batch 7 loss: tensor(0.1575, device='cuda:0')
batch 8 loss: tensor(0.1123, device='cuda:0')
batch 9 loss: tensor(0.0863, device='cuda:0')
batch 10 loss: tensor(0.0574, device='cuda:0')
batch 11 loss: tensor(0.0533, device='cuda:0')
batch 12 loss: tensor(0.0508, device='cuda:0')
batch 13 loss: tensor(0.0303, device='cuda:0')
batch 14 loss: tensor(0.0364, device='cuda:0')
batch 15 loss: tensor(0.0178, device='cuda:0')
batch 16 loss: tensor(0.0156, device='cuda:0')
batch 17 loss: tensor(0.0348, device='cuda:0')
batch 18 loss: tensor(0.0232, device='cuda:0')
batch 19 loss: tensor(0.0259, device='cuda:0')
batch 20 loss: tensor(0.0244, device='cuda:0')
batch 21 loss: tensor(0.0159, device='cuda:0')
batch 22 loss: tensor(0.0177, device='cuda:0')
batch 23 loss: tensor(0.0256, device='cuda:0')
batch 24 loss: tensor(0.0136, device='cuda:0')
batch 25 loss: tensor(0.0161, device='cuda:0')
batch 26 loss: tensor(0.0154, device='cuda:0')
batch 27 loss: tensor(0.0142, device='cuda:0')
batch 28 loss: tensor(0.0151, device='cuda:0')
batch 29 loss: tensor(0.0222, device='cuda:0')
batch 30 loss: tensor(0.0126, device='cuda:0')
batch 31 loss: tensor(0.0119, device='cuda:0')
batch 32 loss: tensor(0.0148, device='cuda:0')
batch 33 loss: tensor(0.0197, device='cuda:0')
batch 34 loss: tensor(0.0096, device='cuda:0')
batch 35 loss: tensor(0.0109, device='cuda:0')
batch 36 loss: tensor(0.0104, device='cuda:0')
batch 37 loss: tensor(0.0088, device='cuda:0')
batch 38 loss: tensor(0.0160, device='cuda:0')
batch 39 loss: tensor(0.0122, device='cuda:0')
batch 40 loss: tensor(0.0149, device='cuda:0')
batch 41 loss: tensor(0.0132, device='cuda:0')
batch 42 loss: tensor(0.0120, device='cuda:0')
batch 43 loss: tensor(0.0098, device='cuda:0')
batch 44 loss: tensor(0.0094, device='cuda:0')
batch 45 loss: tensor(0.0106, device='cuda:0')
batch 46 loss: tensor(0.0116, device='cuda:0')
batch 47 loss: tensor(0.0079, device='cuda:0')
batch 48 loss: tensor(0.0115, device='cuda:0')
batch 49 loss: tensor(0.0060, device='cuda:0')
batch 50 loss: tensor(0.0062, device='cuda:0')
batch 51 loss: tensor(0.0098, device='cuda:0')
batch 52 loss: tensor(0.0085, device='cuda:0')
batch 53 loss: tensor(0.0114, device='cuda:0')
batch 54 loss: tensor(0.0068, device='cuda:0')
batch 55 loss: tensor(0.0068, device='cuda:0')
batch 56 loss: tensor(0.0074, device='cuda:0')
batch 57 loss: tensor(0.0119, device='cuda:0')
batch 58 loss: tensor(0.0076, device='cuda:0')
batch 59 loss: tensor(0.0047, device='cuda:0')
batch 60 loss: tensor(0.0074, device='cuda:0')
batch 61 loss: tensor(0.0055, device='cuda:0')
batch 62 loss: tensor(0.0051, device='cuda:0')
batch 63 loss: tensor(0.0051, device='cuda:0')
batch 64 loss: tensor(0.0037, device='cuda:0')
batch 65 loss: tensor(0.0103, device='cuda:0')
batch 66 loss: tensor(0.0081, device='cuda:0')
batch 67 loss: tensor(0.0047, device='cuda:0')
batch 68 loss: tensor(0.0045, device='cuda:0')
batch 69 loss: tensor(0.0099, device='cuda:0')
batch 70 loss: tensor(0.0099, device='cuda:0')
batch 71 loss: tensor(0.0078, device='cuda:0')
batch 72 loss: tensor(0.0110, device='cuda:0')
batch 73 loss: tensor(0.0070, device='cuda:0')
batch 74 loss: tensor(0.0053, device='cuda:0')
batch 75 loss: tensor(0.0051, device='cuda:0')
batch 76 loss: tensor(0.0058, device='cuda:0')
batch 77 loss: tensor(0.0070, device='cuda:0')
batch 78 loss: tensor(0.0076, device='cuda:0')
batch 79 loss: tensor(0.0064, device='cuda:0')
batch 80 loss: tensor(0.0053, device='cuda:0')
accuracy in val: 0.858
accuracy in test: 0.847
average epoch time: 0.00478607714176178
total time: 0.7657723426818848
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8124, device='cuda:0')
batch 2 loss: tensor(1.5204, device='cuda:0')
batch 3 loss: tensor(1.2735, device='cuda:0')
batch 4 loss: tensor(1.0545, device='cuda:0')
batch 5 loss: tensor(0.7584, device='cuda:0')
batch 6 loss: tensor(0.6084, device='cuda:0')
batch 7 loss: tensor(0.4534, device='cuda:0')
batch 8 loss: tensor(0.3980, device='cuda:0')
batch 9 loss: tensor(0.2736, device='cuda:0')
batch 10 loss: tensor(0.2475, device='cuda:0')
batch 11 loss: tensor(0.1958, device='cuda:0')
batch 12 loss: tensor(0.1411, device='cuda:0')
batch 13 loss: tensor(0.1310, device='cuda:0')
batch 14 loss: tensor(0.1106, device='cuda:0')
batch 15 loss: tensor(0.0680, device='cuda:0')
batch 16 loss: tensor(0.0880, device='cuda:0')
batch 17 loss: tensor(0.0652, device='cuda:0')
batch 18 loss: tensor(0.0795, device='cuda:0')
batch 19 loss: tensor(0.0562, device='cuda:0')
batch 20 loss: tensor(0.0492, device='cuda:0')
batch 21 loss: tensor(0.0411, device='cuda:0')
batch 22 loss: tensor(0.0432, device='cuda:0')
batch 23 loss: tensor(0.0385, device='cuda:0')
batch 24 loss: tensor(0.0299, device='cuda:0')
batch 25 loss: tensor(0.0293, device='cuda:0')
batch 26 loss: tensor(0.0281, device='cuda:0')
batch 27 loss: tensor(0.0278, device='cuda:0')
batch 28 loss: tensor(0.0275, device='cuda:0')
batch 29 loss: tensor(0.0272, device='cuda:0')
batch 30 loss: tensor(0.0208, device='cuda:0')
batch 31 loss: tensor(0.0201, device='cuda:0')
batch 32 loss: tensor(0.0199, device='cuda:0')
batch 33 loss: tensor(0.0243, device='cuda:0')
batch 34 loss: tensor(0.0201, device='cuda:0')
batch 35 loss: tensor(0.0184, device='cuda:0')
batch 36 loss: tensor(0.0113, device='cuda:0')
batch 37 loss: tensor(0.0172, device='cuda:0')
batch 38 loss: tensor(0.0134, device='cuda:0')
batch 39 loss: tensor(0.0141, device='cuda:0')
batch 40 loss: tensor(0.0120, device='cuda:0')
batch 41 loss: tensor(0.0130, device='cuda:0')
batch 42 loss: tensor(0.0128, device='cuda:0')
batch 43 loss: tensor(0.0099, device='cuda:0')
batch 44 loss: tensor(0.0070, device='cuda:0')
batch 45 loss: tensor(0.0112, device='cuda:0')
batch 46 loss: tensor(0.0098, device='cuda:0')
batch 47 loss: tensor(0.0084, device='cuda:0')
batch 48 loss: tensor(0.0108, device='cuda:0')
batch 49 loss: tensor(0.0084, device='cuda:0')
batch 50 loss: tensor(0.0119, device='cuda:0')
batch 51 loss: tensor(0.0069, device='cuda:0')
batch 52 loss: tensor(0.0093, device='cuda:0')
batch 53 loss: tensor(0.0081, device='cuda:0')
batch 54 loss: tensor(0.0059, device='cuda:0')
batch 55 loss: tensor(0.0061, device='cuda:0')
batch 56 loss: tensor(0.0060, device='cuda:0')
batch 57 loss: tensor(0.0073, device='cuda:0')
batch 58 loss: tensor(0.0059, device='cuda:0')
batch 59 loss: tensor(0.0060, device='cuda:0')
batch 60 loss: tensor(0.0079, device='cuda:0')
batch 61 loss: tensor(0.0059, device='cuda:0')
batch 62 loss: tensor(0.0051, device='cuda:0')
batch 63 loss: tensor(0.0045, device='cuda:0')
batch 64 loss: tensor(0.0056, device='cuda:0')
batch 65 loss: tensor(0.0068, device='cuda:0')
batch 66 loss: tensor(0.0045, device='cuda:0')
batch 67 loss: tensor(0.0046, device='cuda:0')
batch 68 loss: tensor(0.0057, device='cuda:0')
batch 69 loss: tensor(0.0046, device='cuda:0')
batch 70 loss: tensor(0.0050, device='cuda:0')
batch 71 loss: tensor(0.0048, device='cuda:0')
batch 72 loss: tensor(0.0041, device='cuda:0')
batch 73 loss: tensor(0.0044, device='cuda:0')
batch 74 loss: tensor(0.0033, device='cuda:0')
batch 75 loss: tensor(0.0044, device='cuda:0')
batch 76 loss: tensor(0.0028, device='cuda:0')
batch 77 loss: tensor(0.0035, device='cuda:0')
batch 78 loss: tensor(0.0032, device='cuda:0')
batch 79 loss: tensor(0.0025, device='cuda:0')
batch 80 loss: tensor(0.0034, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(1.8244, device='cuda:0')
batch 2 loss: tensor(0.9613, device='cuda:0')
batch 3 loss: tensor(0.4595, device='cuda:0')
batch 4 loss: tensor(0.2528, device='cuda:0')
batch 5 loss: tensor(0.1571, device='cuda:0')
batch 6 loss: tensor(0.0873, device='cuda:0')
batch 7 loss: tensor(0.0548, device='cuda:0')
batch 8 loss: tensor(0.0498, device='cuda:0')
batch 9 loss: tensor(0.0309, device='cuda:0')
batch 10 loss: tensor(0.0441, device='cuda:0')
batch 11 loss: tensor(0.0262, device='cuda:0')
batch 12 loss: tensor(0.0222, device='cuda:0')
batch 13 loss: tensor(0.0186, device='cuda:0')
batch 14 loss: tensor(0.0289, device='cuda:0')
batch 15 loss: tensor(0.0211, device='cuda:0')
batch 16 loss: tensor(0.0150, device='cuda:0')
batch 17 loss: tensor(0.0216, device='cuda:0')
batch 18 loss: tensor(0.0163, device='cuda:0')
batch 19 loss: tensor(0.0202, device='cuda:0')
batch 20 loss: tensor(0.0189, device='cuda:0')
batch 21 loss: tensor(0.0240, device='cuda:0')
batch 22 loss: tensor(0.0164, device='cuda:0')
batch 23 loss: tensor(0.0130, device='cuda:0')
batch 24 loss: tensor(0.0206, device='cuda:0')
batch 25 loss: tensor(0.0139, device='cuda:0')
batch 26 loss: tensor(0.0151, device='cuda:0')
batch 27 loss: tensor(0.0118, device='cuda:0')
batch 28 loss: tensor(0.0101, device='cuda:0')
batch 29 loss: tensor(0.0122, device='cuda:0')
batch 30 loss: tensor(0.0173, device='cuda:0')
batch 31 loss: tensor(0.0137, device='cuda:0')
batch 32 loss: tensor(0.0084, device='cuda:0')
batch 33 loss: tensor(0.0105, device='cuda:0')
batch 34 loss: tensor(0.0113, device='cuda:0')
batch 35 loss: tensor(0.0080, device='cuda:0')
batch 36 loss: tensor(0.0117, device='cuda:0')
batch 37 loss: tensor(0.0127, device='cuda:0')
batch 38 loss: tensor(0.0085, device='cuda:0')
batch 39 loss: tensor(0.0092, device='cuda:0')
batch 40 loss: tensor(0.0075, device='cuda:0')
batch 41 loss: tensor(0.0084, device='cuda:0')
batch 42 loss: tensor(0.0118, device='cuda:0')
batch 43 loss: tensor(0.0075, device='cuda:0')
batch 44 loss: tensor(0.0057, device='cuda:0')
batch 45 loss: tensor(0.0078, device='cuda:0')
batch 46 loss: tensor(0.0072, device='cuda:0')
batch 47 loss: tensor(0.0122, device='cuda:0')
batch 48 loss: tensor(0.0086, device='cuda:0')
batch 49 loss: tensor(0.0124, device='cuda:0')
batch 50 loss: tensor(0.0090, device='cuda:0')
batch 51 loss: tensor(0.0099, device='cuda:0')
batch 52 loss: tensor(0.0065, device='cuda:0')
batch 53 loss: tensor(0.0095, device='cuda:0')
batch 54 loss: tensor(0.0089, device='cuda:0')
batch 55 loss: tensor(0.0065, device='cuda:0')
batch 56 loss: tensor(0.0072, device='cuda:0')
batch 57 loss: tensor(0.0072, device='cuda:0')
batch 58 loss: tensor(0.0045, device='cuda:0')
batch 59 loss: tensor(0.0085, device='cuda:0')
batch 60 loss: tensor(0.0067, device='cuda:0')
batch 61 loss: tensor(0.0052, device='cuda:0')
batch 62 loss: tensor(0.0095, device='cuda:0')
batch 63 loss: tensor(0.0051, device='cuda:0')
batch 64 loss: tensor(0.0051, device='cuda:0')
batch 65 loss: tensor(0.0057, device='cuda:0')
batch 66 loss: tensor(0.0051, device='cuda:0')
batch 67 loss: tensor(0.0076, device='cuda:0')
batch 68 loss: tensor(0.0041, device='cuda:0')
batch 69 loss: tensor(0.0092, device='cuda:0')
batch 70 loss: tensor(0.0077, device='cuda:0')
batch 71 loss: tensor(0.0058, device='cuda:0')
batch 72 loss: tensor(0.0057, device='cuda:0')
batch 73 loss: tensor(0.0072, device='cuda:0')
batch 74 loss: tensor(0.0066, device='cuda:0')
batch 75 loss: tensor(0.0048, device='cuda:0')
batch 76 loss: tensor(0.0039, device='cuda:0')
batch 77 loss: tensor(0.0032, device='cuda:0')
batch 78 loss: tensor(0.0031, device='cuda:0')
batch 79 loss: tensor(0.0039, device='cuda:0')
batch 80 loss: tensor(0.0046, device='cuda:0')
accuracy in val: 0.8399999999999999
accuracy in test: 0.8399999999999999
average epoch time: 0.004786695539951325
total time: 0.7658712863922119
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8462, device='cuda:0')
batch 2 loss: tensor(1.6184, device='cuda:0')
batch 3 loss: tensor(1.3805, device='cuda:0')
batch 4 loss: tensor(1.0629, device='cuda:0')
batch 5 loss: tensor(0.8707, device='cuda:0')
batch 6 loss: tensor(0.6553, device='cuda:0')
batch 7 loss: tensor(0.4846, device='cuda:0')
batch 8 loss: tensor(0.3410, device='cuda:0')
batch 9 loss: tensor(0.2993, device='cuda:0')
batch 10 loss: tensor(0.2520, device='cuda:0')
batch 11 loss: tensor(0.1955, device='cuda:0')
batch 12 loss: tensor(0.1233, device='cuda:0')
batch 13 loss: tensor(0.1474, device='cuda:0')
batch 14 loss: tensor(0.1118, device='cuda:0')
batch 15 loss: tensor(0.1032, device='cuda:0')
batch 16 loss: tensor(0.0879, device='cuda:0')
batch 17 loss: tensor(0.0592, device='cuda:0')
batch 18 loss: tensor(0.0598, device='cuda:0')
batch 19 loss: tensor(0.0420, device='cuda:0')
batch 20 loss: tensor(0.0485, device='cuda:0')
batch 21 loss: tensor(0.0491, device='cuda:0')
batch 22 loss: tensor(0.0358, device='cuda:0')
batch 23 loss: tensor(0.0324, device='cuda:0')
batch 24 loss: tensor(0.0384, device='cuda:0')
batch 25 loss: tensor(0.0357, device='cuda:0')
batch 26 loss: tensor(0.0207, device='cuda:0')
batch 27 loss: tensor(0.0310, device='cuda:0')
batch 28 loss: tensor(0.0239, device='cuda:0')
batch 29 loss: tensor(0.0254, device='cuda:0')
batch 30 loss: tensor(0.0256, device='cuda:0')
batch 31 loss: tensor(0.0182, device='cuda:0')
batch 32 loss: tensor(0.0156, device='cuda:0')
batch 33 loss: tensor(0.0169, device='cuda:0')
batch 34 loss: tensor(0.0240, device='cuda:0')
batch 35 loss: tensor(0.0159, device='cuda:0')
batch 36 loss: tensor(0.0134, device='cuda:0')
batch 37 loss: tensor(0.0133, device='cuda:0')
batch 38 loss: tensor(0.0133, device='cuda:0')
batch 39 loss: tensor(0.0167, device='cuda:0')
batch 40 loss: tensor(0.0119, device='cuda:0')
batch 41 loss: tensor(0.0121, device='cuda:0')
batch 42 loss: tensor(0.0082, device='cuda:0')
batch 43 loss: tensor(0.0125, device='cuda:0')
batch 44 loss: tensor(0.0107, device='cuda:0')
batch 45 loss: tensor(0.0096, device='cuda:0')
batch 46 loss: tensor(0.0085, device='cuda:0')
batch 47 loss: tensor(0.0077, device='cuda:0')
batch 48 loss: tensor(0.0087, device='cuda:0')
batch 49 loss: tensor(0.0084, device='cuda:0')
batch 50 loss: tensor(0.0061, device='cuda:0')
batch 51 loss: tensor(0.0072, device='cuda:0')
batch 52 loss: tensor(0.0092, device='cuda:0')
batch 53 loss: tensor(0.0063, device='cuda:0')
batch 54 loss: tensor(0.0071, device='cuda:0')
batch 55 loss: tensor(0.0089, device='cuda:0')
batch 56 loss: tensor(0.0074, device='cuda:0')
batch 57 loss: tensor(0.0061, device='cuda:0')
batch 58 loss: tensor(0.0052, device='cuda:0')
batch 59 loss: tensor(0.0063, device='cuda:0')
batch 60 loss: tensor(0.0057, device='cuda:0')
batch 61 loss: tensor(0.0040, device='cuda:0')
batch 62 loss: tensor(0.0050, device='cuda:0')
batch 63 loss: tensor(0.0047, device='cuda:0')
batch 64 loss: tensor(0.0054, device='cuda:0')
batch 65 loss: tensor(0.0056, device='cuda:0')
batch 66 loss: tensor(0.0045, device='cuda:0')
batch 67 loss: tensor(0.0052, device='cuda:0')
batch 68 loss: tensor(0.0047, device='cuda:0')
batch 69 loss: tensor(0.0036, device='cuda:0')
batch 70 loss: tensor(0.0044, device='cuda:0')
batch 71 loss: tensor(0.0039, device='cuda:0')
batch 72 loss: tensor(0.0027, device='cuda:0')
batch 73 loss: tensor(0.0030, device='cuda:0')
batch 74 loss: tensor(0.0042, device='cuda:0')
batch 75 loss: tensor(0.0037, device='cuda:0')
batch 76 loss: tensor(0.0036, device='cuda:0')
batch 77 loss: tensor(0.0037, device='cuda:0')
batch 78 loss: tensor(0.0021, device='cuda:0')
batch 79 loss: tensor(0.0033, device='cuda:0')
batch 80 loss: tensor(0.0024, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(3.6239, device='cuda:0')
batch 2 loss: tensor(1.9871, device='cuda:0')
batch 3 loss: tensor(1.1676, device='cuda:0')
batch 4 loss: tensor(0.8640, device='cuda:0')
batch 5 loss: tensor(0.6549, device='cuda:0')
batch 6 loss: tensor(0.4626, device='cuda:0')
batch 7 loss: tensor(0.3909, device='cuda:0')
batch 8 loss: tensor(0.2461, device='cuda:0')
batch 9 loss: tensor(0.1743, device='cuda:0')
batch 10 loss: tensor(0.1657, device='cuda:0')
batch 11 loss: tensor(0.0877, device='cuda:0')
batch 12 loss: tensor(0.0859, device='cuda:0')
batch 13 loss: tensor(0.0766, device='cuda:0')
batch 14 loss: tensor(0.0606, device='cuda:0')
batch 15 loss: tensor(0.0405, device='cuda:0')
batch 16 loss: tensor(0.0549, device='cuda:0')
batch 17 loss: tensor(0.0492, device='cuda:0')
batch 18 loss: tensor(0.0459, device='cuda:0')
batch 19 loss: tensor(0.0471, device='cuda:0')
batch 20 loss: tensor(0.0503, device='cuda:0')
batch 21 loss: tensor(0.0486, device='cuda:0')
batch 22 loss: tensor(0.0422, device='cuda:0')
batch 23 loss: tensor(0.0264, device='cuda:0')
batch 24 loss: tensor(0.0309, device='cuda:0')
batch 25 loss: tensor(0.0278, device='cuda:0')
batch 26 loss: tensor(0.0243, device='cuda:0')
batch 27 loss: tensor(0.0294, device='cuda:0')
batch 28 loss: tensor(0.0208, device='cuda:0')
batch 29 loss: tensor(0.0232, device='cuda:0')
batch 30 loss: tensor(0.0408, device='cuda:0')
batch 31 loss: tensor(0.0263, device='cuda:0')
batch 32 loss: tensor(0.0235, device='cuda:0')
batch 33 loss: tensor(0.0167, device='cuda:0')
batch 34 loss: tensor(0.0212, device='cuda:0')
batch 35 loss: tensor(0.0285, device='cuda:0')
batch 36 loss: tensor(0.0247, device='cuda:0')
batch 37 loss: tensor(0.0150, device='cuda:0')
batch 38 loss: tensor(0.0249, device='cuda:0')
batch 39 loss: tensor(0.0147, device='cuda:0')
batch 40 loss: tensor(0.0294, device='cuda:0')
batch 41 loss: tensor(0.0137, device='cuda:0')
batch 42 loss: tensor(0.0192, device='cuda:0')
batch 43 loss: tensor(0.0144, device='cuda:0')
batch 44 loss: tensor(0.0128, device='cuda:0')
batch 45 loss: tensor(0.0281, device='cuda:0')
batch 46 loss: tensor(0.0140, device='cuda:0')
batch 47 loss: tensor(0.0231, device='cuda:0')
batch 48 loss: tensor(0.0130, device='cuda:0')
batch 49 loss: tensor(0.0260, device='cuda:0')
batch 50 loss: tensor(0.0173, device='cuda:0')
batch 51 loss: tensor(0.0185, device='cuda:0')
batch 52 loss: tensor(0.0165, device='cuda:0')
batch 53 loss: tensor(0.0076, device='cuda:0')
batch 54 loss: tensor(0.0210, device='cuda:0')
batch 55 loss: tensor(0.0147, device='cuda:0')
batch 56 loss: tensor(0.0138, device='cuda:0')
batch 57 loss: tensor(0.0080, device='cuda:0')
batch 58 loss: tensor(0.0143, device='cuda:0')
batch 59 loss: tensor(0.0116, device='cuda:0')
batch 60 loss: tensor(0.0117, device='cuda:0')
batch 61 loss: tensor(0.0215, device='cuda:0')
batch 62 loss: tensor(0.0124, device='cuda:0')
batch 63 loss: tensor(0.0075, device='cuda:0')
batch 64 loss: tensor(0.0132, device='cuda:0')
batch 65 loss: tensor(0.0081, device='cuda:0')
batch 66 loss: tensor(0.0130, device='cuda:0')
batch 67 loss: tensor(0.0075, device='cuda:0')
batch 68 loss: tensor(0.0104, device='cuda:0')
batch 69 loss: tensor(0.0144, device='cuda:0')
batch 70 loss: tensor(0.0077, device='cuda:0')
batch 71 loss: tensor(0.0098, device='cuda:0')
batch 72 loss: tensor(0.0082, device='cuda:0')
batch 73 loss: tensor(0.0057, device='cuda:0')
batch 74 loss: tensor(0.0104, device='cuda:0')
batch 75 loss: tensor(0.0062, device='cuda:0')
batch 76 loss: tensor(0.0054, device='cuda:0')
batch 77 loss: tensor(0.0111, device='cuda:0')
batch 78 loss: tensor(0.0083, device='cuda:0')
batch 79 loss: tensor(0.0068, device='cuda:0')
batch 80 loss: tensor(0.0059, device='cuda:0')
accuracy in val: 0.852
accuracy in test: 0.854
average epoch time: 0.005528676509857178
total time: 0.8845882415771484
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8684, device='cuda:0')
batch 2 loss: tensor(1.6099, device='cuda:0')
batch 3 loss: tensor(1.3308, device='cuda:0')
batch 4 loss: tensor(1.0432, device='cuda:0')
batch 5 loss: tensor(0.8433, device='cuda:0')
batch 6 loss: tensor(0.6604, device='cuda:0')
batch 7 loss: tensor(0.5529, device='cuda:0')
batch 8 loss: tensor(0.4351, device='cuda:0')
batch 9 loss: tensor(0.3120, device='cuda:0')
batch 10 loss: tensor(0.2502, device='cuda:0')
batch 11 loss: tensor(0.1851, device='cuda:0')
batch 12 loss: tensor(0.1556, device='cuda:0')
batch 13 loss: tensor(0.0945, device='cuda:0')
batch 14 loss: tensor(0.1108, device='cuda:0')
batch 15 loss: tensor(0.0814, device='cuda:0')
batch 16 loss: tensor(0.0706, device='cuda:0')
batch 17 loss: tensor(0.0765, device='cuda:0')
batch 18 loss: tensor(0.0614, device='cuda:0')
batch 19 loss: tensor(0.0526, device='cuda:0')
batch 20 loss: tensor(0.0398, device='cuda:0')
batch 21 loss: tensor(0.0409, device='cuda:0')
batch 22 loss: tensor(0.0448, device='cuda:0')
batch 23 loss: tensor(0.0317, device='cuda:0')
batch 24 loss: tensor(0.0270, device='cuda:0')
batch 25 loss: tensor(0.0346, device='cuda:0')
batch 26 loss: tensor(0.0277, device='cuda:0')
batch 27 loss: tensor(0.0319, device='cuda:0')
batch 28 loss: tensor(0.0265, device='cuda:0')
batch 29 loss: tensor(0.0214, device='cuda:0')
batch 30 loss: tensor(0.0205, device='cuda:0')
batch 31 loss: tensor(0.0193, device='cuda:0')
batch 32 loss: tensor(0.0170, device='cuda:0')
batch 33 loss: tensor(0.0150, device='cuda:0')
batch 34 loss: tensor(0.0164, device='cuda:0')
batch 35 loss: tensor(0.0201, device='cuda:0')
batch 36 loss: tensor(0.0167, device='cuda:0')
batch 37 loss: tensor(0.0123, device='cuda:0')
batch 38 loss: tensor(0.0135, device='cuda:0')
batch 39 loss: tensor(0.0107, device='cuda:0')
batch 40 loss: tensor(0.0152, device='cuda:0')
batch 41 loss: tensor(0.0096, device='cuda:0')
batch 42 loss: tensor(0.0126, device='cuda:0')
batch 43 loss: tensor(0.0120, device='cuda:0')
batch 44 loss: tensor(0.0101, device='cuda:0')
batch 45 loss: tensor(0.0097, device='cuda:0')
batch 46 loss: tensor(0.0089, device='cuda:0')
batch 47 loss: tensor(0.0101, device='cuda:0')
batch 48 loss: tensor(0.0077, device='cuda:0')
batch 49 loss: tensor(0.0061, device='cuda:0')
batch 50 loss: tensor(0.0077, device='cuda:0')
batch 51 loss: tensor(0.0067, device='cuda:0')
batch 52 loss: tensor(0.0070, device='cuda:0')
batch 53 loss: tensor(0.0061, device='cuda:0')
batch 54 loss: tensor(0.0059, device='cuda:0')
batch 55 loss: tensor(0.0080, device='cuda:0')
batch 56 loss: tensor(0.0068, device='cuda:0')
batch 57 loss: tensor(0.0046, device='cuda:0')
batch 58 loss: tensor(0.0053, device='cuda:0')
batch 59 loss: tensor(0.0058, device='cuda:0')
batch 60 loss: tensor(0.0055, device='cuda:0')
batch 61 loss: tensor(0.0047, device='cuda:0')
batch 62 loss: tensor(0.0059, device='cuda:0')
batch 63 loss: tensor(0.0058, device='cuda:0')
batch 64 loss: tensor(0.0044, device='cuda:0')
batch 65 loss: tensor(0.0051, device='cuda:0')
batch 66 loss: tensor(0.0057, device='cuda:0')
batch 67 loss: tensor(0.0065, device='cuda:0')
batch 68 loss: tensor(0.0045, device='cuda:0')
batch 69 loss: tensor(0.0042, device='cuda:0')
batch 70 loss: tensor(0.0039, device='cuda:0')
batch 71 loss: tensor(0.0058, device='cuda:0')
batch 72 loss: tensor(0.0049, device='cuda:0')
batch 73 loss: tensor(0.0034, device='cuda:0')
batch 74 loss: tensor(0.0046, device='cuda:0')
batch 75 loss: tensor(0.0052, device='cuda:0')
batch 76 loss: tensor(0.0028, device='cuda:0')
batch 77 loss: tensor(0.0033, device='cuda:0')
batch 78 loss: tensor(0.0034, device='cuda:0')
batch 79 loss: tensor(0.0036, device='cuda:0')
batch 80 loss: tensor(0.0027, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(1.7600, device='cuda:0')
batch 2 loss: tensor(0.8071, device='cuda:0')
batch 3 loss: tensor(0.6228, device='cuda:0')
batch 4 loss: tensor(0.3585, device='cuda:0')
batch 5 loss: tensor(0.2240, device='cuda:0')
batch 6 loss: tensor(0.1316, device='cuda:0')
batch 7 loss: tensor(0.0924, device='cuda:0')
batch 8 loss: tensor(0.0539, device='cuda:0')
batch 9 loss: tensor(0.0534, device='cuda:0')
batch 10 loss: tensor(0.0441, device='cuda:0')
batch 11 loss: tensor(0.0374, device='cuda:0')
batch 12 loss: tensor(0.0307, device='cuda:0')
batch 13 loss: tensor(0.0372, device='cuda:0')
batch 14 loss: tensor(0.0279, device='cuda:0')
batch 15 loss: tensor(0.0185, device='cuda:0')
batch 16 loss: tensor(0.0181, device='cuda:0')
batch 17 loss: tensor(0.0204, device='cuda:0')
batch 18 loss: tensor(0.0257, device='cuda:0')
batch 19 loss: tensor(0.0294, device='cuda:0')
batch 20 loss: tensor(0.0166, device='cuda:0')
batch 21 loss: tensor(0.0148, device='cuda:0')
batch 22 loss: tensor(0.0135, device='cuda:0')
batch 23 loss: tensor(0.0221, device='cuda:0')
batch 24 loss: tensor(0.0210, device='cuda:0')
batch 25 loss: tensor(0.0172, device='cuda:0')
batch 26 loss: tensor(0.0104, device='cuda:0')
batch 27 loss: tensor(0.0113, device='cuda:0')
batch 28 loss: tensor(0.0135, device='cuda:0')
batch 29 loss: tensor(0.0135, device='cuda:0')
batch 30 loss: tensor(0.0116, device='cuda:0')
batch 31 loss: tensor(0.0140, device='cuda:0')
batch 32 loss: tensor(0.0182, device='cuda:0')
batch 33 loss: tensor(0.0144, device='cuda:0')
batch 34 loss: tensor(0.0109, device='cuda:0')
batch 35 loss: tensor(0.0134, device='cuda:0')
batch 36 loss: tensor(0.0085, device='cuda:0')
batch 37 loss: tensor(0.0117, device='cuda:0')
batch 38 loss: tensor(0.0092, device='cuda:0')
batch 39 loss: tensor(0.0134, device='cuda:0')
batch 40 loss: tensor(0.0103, device='cuda:0')
batch 41 loss: tensor(0.0084, device='cuda:0')
batch 42 loss: tensor(0.0143, device='cuda:0')
batch 43 loss: tensor(0.0097, device='cuda:0')
batch 44 loss: tensor(0.0081, device='cuda:0')
batch 45 loss: tensor(0.0095, device='cuda:0')
batch 46 loss: tensor(0.0144, device='cuda:0')
batch 47 loss: tensor(0.0073, device='cuda:0')
batch 48 loss: tensor(0.0108, device='cuda:0')
batch 49 loss: tensor(0.0062, device='cuda:0')
batch 50 loss: tensor(0.0099, device='cuda:0')
batch 51 loss: tensor(0.0069, device='cuda:0')
batch 52 loss: tensor(0.0092, device='cuda:0')
batch 53 loss: tensor(0.0074, device='cuda:0')
batch 54 loss: tensor(0.0081, device='cuda:0')
batch 55 loss: tensor(0.0087, device='cuda:0')
batch 56 loss: tensor(0.0075, device='cuda:0')
batch 57 loss: tensor(0.0082, device='cuda:0')
batch 58 loss: tensor(0.0115, device='cuda:0')
batch 59 loss: tensor(0.0095, device='cuda:0')
batch 60 loss: tensor(0.0079, device='cuda:0')
batch 61 loss: tensor(0.0071, device='cuda:0')
batch 62 loss: tensor(0.0051, device='cuda:0')
batch 63 loss: tensor(0.0066, device='cuda:0')
batch 64 loss: tensor(0.0054, device='cuda:0')
batch 65 loss: tensor(0.0070, device='cuda:0')
batch 66 loss: tensor(0.0038, device='cuda:0')
batch 67 loss: tensor(0.0044, device='cuda:0')
batch 68 loss: tensor(0.0045, device='cuda:0')
batch 69 loss: tensor(0.0074, device='cuda:0')
batch 70 loss: tensor(0.0038, device='cuda:0')
batch 71 loss: tensor(0.0072, device='cuda:0')
batch 72 loss: tensor(0.0053, device='cuda:0')
batch 73 loss: tensor(0.0054, device='cuda:0')
batch 74 loss: tensor(0.0061, device='cuda:0')
batch 75 loss: tensor(0.0096, device='cuda:0')
batch 76 loss: tensor(0.0077, device='cuda:0')
batch 77 loss: tensor(0.0063, device='cuda:0')
batch 78 loss: tensor(0.0062, device='cuda:0')
batch 79 loss: tensor(0.0072, device='cuda:0')
batch 80 loss: tensor(0.0034, device='cuda:0')
accuracy in val: 0.854
accuracy in test: 0.83
average epoch time: 0.004789771139621734
total time: 0.7663633823394775
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8260, device='cuda:0')
batch 2 loss: tensor(1.5409, device='cuda:0')
batch 3 loss: tensor(1.2894, device='cuda:0')
batch 4 loss: tensor(1.0368, device='cuda:0')
batch 5 loss: tensor(0.8628, device='cuda:0')
batch 6 loss: tensor(0.6768, device='cuda:0')
batch 7 loss: tensor(0.5531, device='cuda:0')
batch 8 loss: tensor(0.4158, device='cuda:0')
batch 9 loss: tensor(0.3696, device='cuda:0')
batch 10 loss: tensor(0.2812, device='cuda:0')
batch 11 loss: tensor(0.2037, device='cuda:0')
batch 12 loss: tensor(0.1927, device='cuda:0')
batch 13 loss: tensor(0.1285, device='cuda:0')
batch 14 loss: tensor(0.1124, device='cuda:0')
batch 15 loss: tensor(0.1047, device='cuda:0')
batch 16 loss: tensor(0.0851, device='cuda:0')
batch 17 loss: tensor(0.0891, device='cuda:0')
batch 18 loss: tensor(0.0830, device='cuda:0')
batch 19 loss: tensor(0.0669, device='cuda:0')
batch 20 loss: tensor(0.0504, device='cuda:0')
batch 21 loss: tensor(0.0458, device='cuda:0')
batch 22 loss: tensor(0.0503, device='cuda:0')
batch 23 loss: tensor(0.0341, device='cuda:0')
batch 24 loss: tensor(0.0329, device='cuda:0')
batch 25 loss: tensor(0.0341, device='cuda:0')
batch 26 loss: tensor(0.0311, device='cuda:0')
batch 27 loss: tensor(0.0288, device='cuda:0')
batch 28 loss: tensor(0.0280, device='cuda:0')
batch 29 loss: tensor(0.0234, device='cuda:0')
batch 30 loss: tensor(0.0174, device='cuda:0')
batch 31 loss: tensor(0.0303, device='cuda:0')
batch 32 loss: tensor(0.0256, device='cuda:0')
batch 33 loss: tensor(0.0123, device='cuda:0')
batch 34 loss: tensor(0.0185, device='cuda:0')
batch 35 loss: tensor(0.0153, device='cuda:0')
batch 36 loss: tensor(0.0186, device='cuda:0')
batch 37 loss: tensor(0.0151, device='cuda:0')
batch 38 loss: tensor(0.0117, device='cuda:0')
batch 39 loss: tensor(0.0195, device='cuda:0')
batch 40 loss: tensor(0.0118, device='cuda:0')
batch 41 loss: tensor(0.0170, device='cuda:0')
batch 42 loss: tensor(0.0102, device='cuda:0')
batch 43 loss: tensor(0.0107, device='cuda:0')
batch 44 loss: tensor(0.0094, device='cuda:0')
batch 45 loss: tensor(0.0087, device='cuda:0')
batch 46 loss: tensor(0.0167, device='cuda:0')
batch 47 loss: tensor(0.0098, device='cuda:0')
batch 48 loss: tensor(0.0078, device='cuda:0')
batch 49 loss: tensor(0.0102, device='cuda:0')
batch 50 loss: tensor(0.0119, device='cuda:0')
batch 51 loss: tensor(0.0091, device='cuda:0')
batch 52 loss: tensor(0.0074, device='cuda:0')
batch 53 loss: tensor(0.0087, device='cuda:0')
batch 54 loss: tensor(0.0098, device='cuda:0')
batch 55 loss: tensor(0.0067, device='cuda:0')
batch 56 loss: tensor(0.0078, device='cuda:0')
batch 57 loss: tensor(0.0057, device='cuda:0')
batch 58 loss: tensor(0.0058, device='cuda:0')
batch 59 loss: tensor(0.0062, device='cuda:0')
batch 60 loss: tensor(0.0115, device='cuda:0')
batch 61 loss: tensor(0.0043, device='cuda:0')
batch 62 loss: tensor(0.0059, device='cuda:0')
batch 63 loss: tensor(0.0062, device='cuda:0')
batch 64 loss: tensor(0.0051, device='cuda:0')
batch 65 loss: tensor(0.0092, device='cuda:0')
batch 66 loss: tensor(0.0093, device='cuda:0')
batch 67 loss: tensor(0.0042, device='cuda:0')
batch 68 loss: tensor(0.0048, device='cuda:0')
batch 69 loss: tensor(0.0036, device='cuda:0')
batch 70 loss: tensor(0.0044, device='cuda:0')
batch 71 loss: tensor(0.0030, device='cuda:0')
batch 72 loss: tensor(0.0087, device='cuda:0')
batch 73 loss: tensor(0.0043, device='cuda:0')
batch 74 loss: tensor(0.0089, device='cuda:0')
batch 75 loss: tensor(0.0035, device='cuda:0')
batch 76 loss: tensor(0.0034, device='cuda:0')
batch 77 loss: tensor(0.0069, device='cuda:0')
batch 78 loss: tensor(0.0039, device='cuda:0')
batch 79 loss: tensor(0.0032, device='cuda:0')
batch 80 loss: tensor(0.0029, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(2.2984, device='cuda:0')
batch 2 loss: tensor(1.3040, device='cuda:0')
batch 3 loss: tensor(0.7630, device='cuda:0')
batch 4 loss: tensor(0.3737, device='cuda:0')
batch 5 loss: tensor(0.1773, device='cuda:0')
batch 6 loss: tensor(0.1256, device='cuda:0')
batch 7 loss: tensor(0.1298, device='cuda:0')
batch 8 loss: tensor(0.0788, device='cuda:0')
batch 9 loss: tensor(0.0648, device='cuda:0')
batch 10 loss: tensor(0.0517, device='cuda:0')
batch 11 loss: tensor(0.0366, device='cuda:0')
batch 12 loss: tensor(0.0361, device='cuda:0')
batch 13 loss: tensor(0.0297, device='cuda:0')
batch 14 loss: tensor(0.0423, device='cuda:0')
batch 15 loss: tensor(0.0374, device='cuda:0')
batch 16 loss: tensor(0.0292, device='cuda:0')
batch 17 loss: tensor(0.0251, device='cuda:0')
batch 18 loss: tensor(0.0311, device='cuda:0')
batch 19 loss: tensor(0.0303, device='cuda:0')
batch 20 loss: tensor(0.0226, device='cuda:0')
batch 21 loss: tensor(0.0212, device='cuda:0')
batch 22 loss: tensor(0.0222, device='cuda:0')
batch 23 loss: tensor(0.0280, device='cuda:0')
batch 24 loss: tensor(0.0191, device='cuda:0')
batch 25 loss: tensor(0.0263, device='cuda:0')
batch 26 loss: tensor(0.0245, device='cuda:0')
batch 27 loss: tensor(0.0237, device='cuda:0')
batch 28 loss: tensor(0.0164, device='cuda:0')
batch 29 loss: tensor(0.0206, device='cuda:0')
batch 30 loss: tensor(0.0243, device='cuda:0')
batch 31 loss: tensor(0.0216, device='cuda:0')
batch 32 loss: tensor(0.0143, device='cuda:0')
batch 33 loss: tensor(0.0236, device='cuda:0')
batch 34 loss: tensor(0.0149, device='cuda:0')
batch 35 loss: tensor(0.0144, device='cuda:0')
batch 36 loss: tensor(0.0202, device='cuda:0')
batch 37 loss: tensor(0.0149, device='cuda:0')
batch 38 loss: tensor(0.0152, device='cuda:0')
batch 39 loss: tensor(0.0128, device='cuda:0')
batch 40 loss: tensor(0.0164, device='cuda:0')
batch 41 loss: tensor(0.0110, device='cuda:0')
batch 42 loss: tensor(0.0171, device='cuda:0')
batch 43 loss: tensor(0.0143, device='cuda:0')
batch 44 loss: tensor(0.0114, device='cuda:0')
batch 45 loss: tensor(0.0138, device='cuda:0')
batch 46 loss: tensor(0.0174, device='cuda:0')
batch 47 loss: tensor(0.0162, device='cuda:0')
batch 48 loss: tensor(0.0111, device='cuda:0')
batch 49 loss: tensor(0.0147, device='cuda:0')
batch 50 loss: tensor(0.0150, device='cuda:0')
batch 51 loss: tensor(0.0108, device='cuda:0')
batch 52 loss: tensor(0.0093, device='cuda:0')
batch 53 loss: tensor(0.0115, device='cuda:0')
batch 54 loss: tensor(0.0162, device='cuda:0')
batch 55 loss: tensor(0.0106, device='cuda:0')
batch 56 loss: tensor(0.0067, device='cuda:0')
batch 57 loss: tensor(0.0168, device='cuda:0')
batch 58 loss: tensor(0.0053, device='cuda:0')
batch 59 loss: tensor(0.0074, device='cuda:0')
batch 60 loss: tensor(0.0091, device='cuda:0')
batch 61 loss: tensor(0.0137, device='cuda:0')
batch 62 loss: tensor(0.0044, device='cuda:0')
batch 63 loss: tensor(0.0138, device='cuda:0')
batch 64 loss: tensor(0.0082, device='cuda:0')
batch 65 loss: tensor(0.0072, device='cuda:0')
batch 66 loss: tensor(0.0076, device='cuda:0')
batch 67 loss: tensor(0.0067, device='cuda:0')
batch 68 loss: tensor(0.0110, device='cuda:0')
batch 69 loss: tensor(0.0126, device='cuda:0')
batch 70 loss: tensor(0.0084, device='cuda:0')
batch 71 loss: tensor(0.0089, device='cuda:0')
batch 72 loss: tensor(0.0084, device='cuda:0')
batch 73 loss: tensor(0.0063, device='cuda:0')
batch 74 loss: tensor(0.0126, device='cuda:0')
batch 75 loss: tensor(0.0122, device='cuda:0')
batch 76 loss: tensor(0.0107, device='cuda:0')
batch 77 loss: tensor(0.0054, device='cuda:0')
batch 78 loss: tensor(0.0077, device='cuda:0')
batch 79 loss: tensor(0.0072, device='cuda:0')
batch 80 loss: tensor(0.0080, device='cuda:0')
accuracy in val: 0.848
accuracy in test: 0.844
average epoch time: 0.005481977760791778
total time: 0.8771164417266846
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8013, device='cuda:0')
batch 2 loss: tensor(1.4991, device='cuda:0')
batch 3 loss: tensor(1.2744, device='cuda:0')
batch 4 loss: tensor(0.9857, device='cuda:0')
batch 5 loss: tensor(0.8096, device='cuda:0')
batch 6 loss: tensor(0.6690, device='cuda:0')
batch 7 loss: tensor(0.5171, device='cuda:0')
batch 8 loss: tensor(0.3152, device='cuda:0')
batch 9 loss: tensor(0.3181, device='cuda:0')
batch 10 loss: tensor(0.2433, device='cuda:0')
batch 11 loss: tensor(0.2038, device='cuda:0')
batch 12 loss: tensor(0.1605, device='cuda:0')
batch 13 loss: tensor(0.1553, device='cuda:0')
batch 14 loss: tensor(0.0955, device='cuda:0')
batch 15 loss: tensor(0.1066, device='cuda:0')
batch 16 loss: tensor(0.0791, device='cuda:0')
batch 17 loss: tensor(0.0576, device='cuda:0')
batch 18 loss: tensor(0.0667, device='cuda:0')
batch 19 loss: tensor(0.0546, device='cuda:0')
batch 20 loss: tensor(0.0553, device='cuda:0')
batch 21 loss: tensor(0.0450, device='cuda:0')
batch 22 loss: tensor(0.0495, device='cuda:0')
batch 23 loss: tensor(0.0365, device='cuda:0')
batch 24 loss: tensor(0.0289, device='cuda:0')
batch 25 loss: tensor(0.0331, device='cuda:0')
batch 26 loss: tensor(0.0303, device='cuda:0')
batch 27 loss: tensor(0.0235, device='cuda:0')
batch 28 loss: tensor(0.0309, device='cuda:0')
batch 29 loss: tensor(0.0191, device='cuda:0')
batch 30 loss: tensor(0.0227, device='cuda:0')
batch 31 loss: tensor(0.0196, device='cuda:0')
batch 32 loss: tensor(0.0165, device='cuda:0')
batch 33 loss: tensor(0.0166, device='cuda:0')
batch 34 loss: tensor(0.0151, device='cuda:0')
batch 35 loss: tensor(0.0135, device='cuda:0')
batch 36 loss: tensor(0.0146, device='cuda:0')
batch 37 loss: tensor(0.0134, device='cuda:0')
batch 38 loss: tensor(0.0155, device='cuda:0')
batch 39 loss: tensor(0.0082, device='cuda:0')
batch 40 loss: tensor(0.0116, device='cuda:0')
batch 41 loss: tensor(0.0111, device='cuda:0')
batch 42 loss: tensor(0.0092, device='cuda:0')
batch 43 loss: tensor(0.0108, device='cuda:0')
batch 44 loss: tensor(0.0088, device='cuda:0')
batch 45 loss: tensor(0.0103, device='cuda:0')
batch 46 loss: tensor(0.0094, device='cuda:0')
batch 47 loss: tensor(0.0081, device='cuda:0')
batch 48 loss: tensor(0.0093, device='cuda:0')
batch 49 loss: tensor(0.0112, device='cuda:0')
batch 50 loss: tensor(0.0132, device='cuda:0')
batch 51 loss: tensor(0.0112, device='cuda:0')
batch 52 loss: tensor(0.0082, device='cuda:0')
batch 53 loss: tensor(0.0070, device='cuda:0')
batch 54 loss: tensor(0.0073, device='cuda:0')
batch 55 loss: tensor(0.0067, device='cuda:0')
batch 56 loss: tensor(0.0100, device='cuda:0')
batch 57 loss: tensor(0.0045, device='cuda:0')
batch 58 loss: tensor(0.0083, device='cuda:0')
batch 59 loss: tensor(0.0040, device='cuda:0')
batch 60 loss: tensor(0.0056, device='cuda:0')
batch 61 loss: tensor(0.0077, device='cuda:0')
batch 62 loss: tensor(0.0042, device='cuda:0')
batch 63 loss: tensor(0.0063, device='cuda:0')
batch 64 loss: tensor(0.0051, device='cuda:0')
batch 65 loss: tensor(0.0060, device='cuda:0')
batch 66 loss: tensor(0.0054, device='cuda:0')
batch 67 loss: tensor(0.0041, device='cuda:0')
batch 68 loss: tensor(0.0056, device='cuda:0')
batch 69 loss: tensor(0.0051, device='cuda:0')
batch 70 loss: tensor(0.0040, device='cuda:0')
batch 71 loss: tensor(0.0034, device='cuda:0')
batch 72 loss: tensor(0.0030, device='cuda:0')
batch 73 loss: tensor(0.0045, device='cuda:0')
batch 74 loss: tensor(0.0041, device='cuda:0')
batch 75 loss: tensor(0.0031, device='cuda:0')
batch 76 loss: tensor(0.0036, device='cuda:0')
batch 77 loss: tensor(0.0035, device='cuda:0')
batch 78 loss: tensor(0.0035, device='cuda:0')
batch 79 loss: tensor(0.0033, device='cuda:0')
batch 80 loss: tensor(0.0029, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(1.5930, device='cuda:0')
batch 2 loss: tensor(0.7360, device='cuda:0')
batch 3 loss: tensor(0.4741, device='cuda:0')
batch 4 loss: tensor(0.2789, device='cuda:0')
batch 5 loss: tensor(0.1658, device='cuda:0')
batch 6 loss: tensor(0.0991, device='cuda:0')
batch 7 loss: tensor(0.0829, device='cuda:0')
batch 8 loss: tensor(0.0557, device='cuda:0')
batch 9 loss: tensor(0.0465, device='cuda:0')
batch 10 loss: tensor(0.0431, device='cuda:0')
batch 11 loss: tensor(0.0289, device='cuda:0')
batch 12 loss: tensor(0.0274, device='cuda:0')
batch 13 loss: tensor(0.0229, device='cuda:0')
batch 14 loss: tensor(0.0210, device='cuda:0')
batch 15 loss: tensor(0.0302, device='cuda:0')
batch 16 loss: tensor(0.0173, device='cuda:0')
batch 17 loss: tensor(0.0216, device='cuda:0')
batch 18 loss: tensor(0.0204, device='cuda:0')
batch 19 loss: tensor(0.0130, device='cuda:0')
batch 20 loss: tensor(0.0152, device='cuda:0')
batch 21 loss: tensor(0.0152, device='cuda:0')
batch 22 loss: tensor(0.0161, device='cuda:0')
batch 23 loss: tensor(0.0161, device='cuda:0')
batch 24 loss: tensor(0.0101, device='cuda:0')
batch 25 loss: tensor(0.0133, device='cuda:0')
batch 26 loss: tensor(0.0109, device='cuda:0')
batch 27 loss: tensor(0.0126, device='cuda:0')
batch 28 loss: tensor(0.0081, device='cuda:0')
batch 29 loss: tensor(0.0126, device='cuda:0')
batch 30 loss: tensor(0.0168, device='cuda:0')
batch 31 loss: tensor(0.0106, device='cuda:0')
batch 32 loss: tensor(0.0093, device='cuda:0')
batch 33 loss: tensor(0.0070, device='cuda:0')
batch 34 loss: tensor(0.0098, device='cuda:0')
batch 35 loss: tensor(0.0118, device='cuda:0')
batch 36 loss: tensor(0.0059, device='cuda:0')
batch 37 loss: tensor(0.0126, device='cuda:0')
batch 38 loss: tensor(0.0110, device='cuda:0')
batch 39 loss: tensor(0.0062, device='cuda:0')
batch 40 loss: tensor(0.0073, device='cuda:0')
batch 41 loss: tensor(0.0122, device='cuda:0')
batch 42 loss: tensor(0.0060, device='cuda:0')
batch 43 loss: tensor(0.0072, device='cuda:0')
batch 44 loss: tensor(0.0094, device='cuda:0')
batch 45 loss: tensor(0.0077, device='cuda:0')
batch 46 loss: tensor(0.0052, device='cuda:0')
batch 47 loss: tensor(0.0102, device='cuda:0')
batch 48 loss: tensor(0.0094, device='cuda:0')
batch 49 loss: tensor(0.0054, device='cuda:0')
batch 50 loss: tensor(0.0090, device='cuda:0')
batch 51 loss: tensor(0.0078, device='cuda:0')
batch 52 loss: tensor(0.0108, device='cuda:0')
batch 53 loss: tensor(0.0074, device='cuda:0')
batch 54 loss: tensor(0.0066, device='cuda:0')
batch 55 loss: tensor(0.0077, device='cuda:0')
batch 56 loss: tensor(0.0057, device='cuda:0')
batch 57 loss: tensor(0.0056, device='cuda:0')
batch 58 loss: tensor(0.0060, device='cuda:0')
batch 59 loss: tensor(0.0044, device='cuda:0')
batch 60 loss: tensor(0.0088, device='cuda:0')
batch 61 loss: tensor(0.0031, device='cuda:0')
batch 62 loss: tensor(0.0055, device='cuda:0')
batch 63 loss: tensor(0.0047, device='cuda:0')
batch 64 loss: tensor(0.0072, device='cuda:0')
batch 65 loss: tensor(0.0028, device='cuda:0')
batch 66 loss: tensor(0.0071, device='cuda:0')
batch 67 loss: tensor(0.0048, device='cuda:0')
batch 68 loss: tensor(0.0050, device='cuda:0')
batch 69 loss: tensor(0.0062, device='cuda:0')
batch 70 loss: tensor(0.0068, device='cuda:0')
batch 71 loss: tensor(0.0053, device='cuda:0')
batch 72 loss: tensor(0.0044, device='cuda:0')
batch 73 loss: tensor(0.0054, device='cuda:0')
batch 74 loss: tensor(0.0059, device='cuda:0')
batch 75 loss: tensor(0.0050, device='cuda:0')
batch 76 loss: tensor(0.0035, device='cuda:0')
batch 77 loss: tensor(0.0066, device='cuda:0')
batch 78 loss: tensor(0.0050, device='cuda:0')
batch 79 loss: tensor(0.0049, device='cuda:0')
batch 80 loss: tensor(0.0045, device='cuda:0')
accuracy in val: 0.8619999999999999
accuracy in test: 0.845
average epoch time: 0.004836906492710113
total time: 0.7739050388336182
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8230, device='cuda:0')
batch 2 loss: tensor(1.5156, device='cuda:0')
batch 3 loss: tensor(1.2471, device='cuda:0')
batch 4 loss: tensor(0.9959, device='cuda:0')
batch 5 loss: tensor(0.7977, device='cuda:0')
batch 6 loss: tensor(0.5878, device='cuda:0')
batch 7 loss: tensor(0.5079, device='cuda:0')
batch 8 loss: tensor(0.3763, device='cuda:0')
batch 9 loss: tensor(0.3065, device='cuda:0')
batch 10 loss: tensor(0.2303, device='cuda:0')
batch 11 loss: tensor(0.1763, device='cuda:0')
batch 12 loss: tensor(0.1733, device='cuda:0')
batch 13 loss: tensor(0.1132, device='cuda:0')
batch 14 loss: tensor(0.1107, device='cuda:0')
batch 15 loss: tensor(0.1011, device='cuda:0')
batch 16 loss: tensor(0.0821, device='cuda:0')
batch 17 loss: tensor(0.0677, device='cuda:0')
batch 18 loss: tensor(0.0706, device='cuda:0')
batch 19 loss: tensor(0.0530, device='cuda:0')
batch 20 loss: tensor(0.0407, device='cuda:0')
batch 21 loss: tensor(0.0464, device='cuda:0')
batch 22 loss: tensor(0.0426, device='cuda:0')
batch 23 loss: tensor(0.0460, device='cuda:0')
batch 24 loss: tensor(0.0304, device='cuda:0')
batch 25 loss: tensor(0.0328, device='cuda:0')
batch 26 loss: tensor(0.0290, device='cuda:0')
batch 27 loss: tensor(0.0268, device='cuda:0')
batch 28 loss: tensor(0.0349, device='cuda:0')
batch 29 loss: tensor(0.0220, device='cuda:0')
batch 30 loss: tensor(0.0187, device='cuda:0')
batch 31 loss: tensor(0.0160, device='cuda:0')
batch 32 loss: tensor(0.0191, device='cuda:0')
batch 33 loss: tensor(0.0166, device='cuda:0')
batch 34 loss: tensor(0.0175, device='cuda:0')
batch 35 loss: tensor(0.0192, device='cuda:0')
batch 36 loss: tensor(0.0199, device='cuda:0')
batch 37 loss: tensor(0.0148, device='cuda:0')
batch 38 loss: tensor(0.0099, device='cuda:0')
batch 39 loss: tensor(0.0130, device='cuda:0')
batch 40 loss: tensor(0.0149, device='cuda:0')
batch 41 loss: tensor(0.0121, device='cuda:0')
batch 42 loss: tensor(0.0113, device='cuda:0')
batch 43 loss: tensor(0.0104, device='cuda:0')
batch 44 loss: tensor(0.0123, device='cuda:0')
batch 45 loss: tensor(0.0115, device='cuda:0')
batch 46 loss: tensor(0.0096, device='cuda:0')
batch 47 loss: tensor(0.0076, device='cuda:0')
batch 48 loss: tensor(0.0109, device='cuda:0')
batch 49 loss: tensor(0.0069, device='cuda:0')
batch 50 loss: tensor(0.0095, device='cuda:0')
batch 51 loss: tensor(0.0062, device='cuda:0')
batch 52 loss: tensor(0.0094, device='cuda:0')
batch 53 loss: tensor(0.0076, device='cuda:0')
batch 54 loss: tensor(0.0068, device='cuda:0')
batch 55 loss: tensor(0.0066, device='cuda:0')
batch 56 loss: tensor(0.0073, device='cuda:0')
batch 57 loss: tensor(0.0055, device='cuda:0')
batch 58 loss: tensor(0.0073, device='cuda:0')
batch 59 loss: tensor(0.0050, device='cuda:0')
batch 60 loss: tensor(0.0060, device='cuda:0')
batch 61 loss: tensor(0.0058, device='cuda:0')
batch 62 loss: tensor(0.0065, device='cuda:0')
batch 63 loss: tensor(0.0043, device='cuda:0')
batch 64 loss: tensor(0.0038, device='cuda:0')
batch 65 loss: tensor(0.0060, device='cuda:0')
batch 66 loss: tensor(0.0054, device='cuda:0')
batch 67 loss: tensor(0.0048, device='cuda:0')
batch 68 loss: tensor(0.0045, device='cuda:0')
batch 69 loss: tensor(0.0043, device='cuda:0')
batch 70 loss: tensor(0.0028, device='cuda:0')
batch 71 loss: tensor(0.0046, device='cuda:0')
batch 72 loss: tensor(0.0047, device='cuda:0')
batch 73 loss: tensor(0.0040, device='cuda:0')
batch 74 loss: tensor(0.0040, device='cuda:0')
batch 75 loss: tensor(0.0035, device='cuda:0')
batch 76 loss: tensor(0.0035, device='cuda:0')
batch 77 loss: tensor(0.0047, device='cuda:0')
batch 78 loss: tensor(0.0033, device='cuda:0')
batch 79 loss: tensor(0.0033, device='cuda:0')
batch 80 loss: tensor(0.0027, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(3.7177, device='cuda:0')
batch 2 loss: tensor(1.7389, device='cuda:0')
batch 3 loss: tensor(0.7645, device='cuda:0')
batch 4 loss: tensor(0.2875, device='cuda:0')
batch 5 loss: tensor(0.1574, device='cuda:0')
batch 6 loss: tensor(0.1113, device='cuda:0')
batch 7 loss: tensor(0.0689, device='cuda:0')
batch 8 loss: tensor(0.0562, device='cuda:0')
batch 9 loss: tensor(0.0529, device='cuda:0')
batch 10 loss: tensor(0.0315, device='cuda:0')
batch 11 loss: tensor(0.0414, device='cuda:0')
batch 12 loss: tensor(0.0337, device='cuda:0')
batch 13 loss: tensor(0.0233, device='cuda:0')
batch 14 loss: tensor(0.0252, device='cuda:0')
batch 15 loss: tensor(0.0186, device='cuda:0')
batch 16 loss: tensor(0.0283, device='cuda:0')
batch 17 loss: tensor(0.0244, device='cuda:0')
batch 18 loss: tensor(0.0162, device='cuda:0')
batch 19 loss: tensor(0.0195, device='cuda:0')
batch 20 loss: tensor(0.0153, device='cuda:0')
batch 21 loss: tensor(0.0119, device='cuda:0')
batch 22 loss: tensor(0.0160, device='cuda:0')
batch 23 loss: tensor(0.0162, device='cuda:0')
batch 24 loss: tensor(0.0149, device='cuda:0')
batch 25 loss: tensor(0.0193, device='cuda:0')
batch 26 loss: tensor(0.0132, device='cuda:0')
batch 27 loss: tensor(0.0129, device='cuda:0')
batch 28 loss: tensor(0.0226, device='cuda:0')
batch 29 loss: tensor(0.0213, device='cuda:0')
batch 30 loss: tensor(0.0182, device='cuda:0')
batch 31 loss: tensor(0.0191, device='cuda:0')
batch 32 loss: tensor(0.0136, device='cuda:0')
batch 33 loss: tensor(0.0145, device='cuda:0')
batch 34 loss: tensor(0.0130, device='cuda:0')
batch 35 loss: tensor(0.0109, device='cuda:0')
batch 36 loss: tensor(0.0134, device='cuda:0')
batch 37 loss: tensor(0.0088, device='cuda:0')
batch 38 loss: tensor(0.0169, device='cuda:0')
batch 39 loss: tensor(0.0088, device='cuda:0')
batch 40 loss: tensor(0.0102, device='cuda:0')
batch 41 loss: tensor(0.0178, device='cuda:0')
batch 42 loss: tensor(0.0100, device='cuda:0')
batch 43 loss: tensor(0.0109, device='cuda:0')
batch 44 loss: tensor(0.0100, device='cuda:0')
batch 45 loss: tensor(0.0118, device='cuda:0')
batch 46 loss: tensor(0.0121, device='cuda:0')
batch 47 loss: tensor(0.0046, device='cuda:0')
batch 48 loss: tensor(0.0127, device='cuda:0')
batch 49 loss: tensor(0.0123, device='cuda:0')
batch 50 loss: tensor(0.0130, device='cuda:0')
batch 51 loss: tensor(0.0105, device='cuda:0')
batch 52 loss: tensor(0.0118, device='cuda:0')
batch 53 loss: tensor(0.0071, device='cuda:0')
batch 54 loss: tensor(0.0110, device='cuda:0')
batch 55 loss: tensor(0.0076, device='cuda:0')
batch 56 loss: tensor(0.0076, device='cuda:0')
batch 57 loss: tensor(0.0082, device='cuda:0')
batch 58 loss: tensor(0.0097, device='cuda:0')
batch 59 loss: tensor(0.0091, device='cuda:0')
batch 60 loss: tensor(0.0066, device='cuda:0')
batch 61 loss: tensor(0.0094, device='cuda:0')
batch 62 loss: tensor(0.0102, device='cuda:0')
batch 63 loss: tensor(0.0124, device='cuda:0')
batch 64 loss: tensor(0.0078, device='cuda:0')
batch 65 loss: tensor(0.0045, device='cuda:0')
batch 66 loss: tensor(0.0068, device='cuda:0')
batch 67 loss: tensor(0.0082, device='cuda:0')
batch 68 loss: tensor(0.0125, device='cuda:0')
batch 69 loss: tensor(0.0076, device='cuda:0')
batch 70 loss: tensor(0.0039, device='cuda:0')
batch 71 loss: tensor(0.0079, device='cuda:0')
batch 72 loss: tensor(0.0064, device='cuda:0')
batch 73 loss: tensor(0.0048, device='cuda:0')
batch 74 loss: tensor(0.0065, device='cuda:0')
batch 75 loss: tensor(0.0102, device='cuda:0')
batch 76 loss: tensor(0.0087, device='cuda:0')
batch 77 loss: tensor(0.0054, device='cuda:0')
batch 78 loss: tensor(0.0090, device='cuda:0')
batch 79 loss: tensor(0.0067, device='cuda:0')
batch 80 loss: tensor(0.0062, device='cuda:0')
accuracy in val: 0.85
accuracy in test: 0.839
average epoch time: 0.005421832203865051
total time: 0.8674931526184082
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8382, device='cuda:0')
batch 2 loss: tensor(1.5633, device='cuda:0')
batch 3 loss: tensor(1.3226, device='cuda:0')
batch 4 loss: tensor(1.0475, device='cuda:0')
batch 5 loss: tensor(0.8406, device='cuda:0')
batch 6 loss: tensor(0.6472, device='cuda:0')
batch 7 loss: tensor(0.4720, device='cuda:0')
batch 8 loss: tensor(0.4059, device='cuda:0')
batch 9 loss: tensor(0.3435, device='cuda:0')
batch 10 loss: tensor(0.2693, device='cuda:0')
batch 11 loss: tensor(0.2400, device='cuda:0')
batch 12 loss: tensor(0.1991, device='cuda:0')
batch 13 loss: tensor(0.1224, device='cuda:0')
batch 14 loss: tensor(0.1192, device='cuda:0')
batch 15 loss: tensor(0.0951, device='cuda:0')
batch 16 loss: tensor(0.1121, device='cuda:0')
batch 17 loss: tensor(0.0796, device='cuda:0')
batch 18 loss: tensor(0.0782, device='cuda:0')
batch 19 loss: tensor(0.0583, device='cuda:0')
batch 20 loss: tensor(0.0475, device='cuda:0')
batch 21 loss: tensor(0.0609, device='cuda:0')
batch 22 loss: tensor(0.0509, device='cuda:0')
batch 23 loss: tensor(0.0318, device='cuda:0')
batch 24 loss: tensor(0.0395, device='cuda:0')
batch 25 loss: tensor(0.0406, device='cuda:0')
batch 26 loss: tensor(0.0284, device='cuda:0')
batch 27 loss: tensor(0.0197, device='cuda:0')
batch 28 loss: tensor(0.0292, device='cuda:0')
batch 29 loss: tensor(0.0239, device='cuda:0')
batch 30 loss: tensor(0.0262, device='cuda:0')
batch 31 loss: tensor(0.0207, device='cuda:0')
batch 32 loss: tensor(0.0266, device='cuda:0')
batch 33 loss: tensor(0.0295, device='cuda:0')
batch 34 loss: tensor(0.0154, device='cuda:0')
batch 35 loss: tensor(0.0205, device='cuda:0')
batch 36 loss: tensor(0.0188, device='cuda:0')
batch 37 loss: tensor(0.0155, device='cuda:0')
batch 38 loss: tensor(0.0145, device='cuda:0')
batch 39 loss: tensor(0.0154, device='cuda:0')
batch 40 loss: tensor(0.0125, device='cuda:0')
batch 41 loss: tensor(0.0112, device='cuda:0')
batch 42 loss: tensor(0.0175, device='cuda:0')
batch 43 loss: tensor(0.0144, device='cuda:0')
batch 44 loss: tensor(0.0143, device='cuda:0')
batch 45 loss: tensor(0.0075, device='cuda:0')
batch 46 loss: tensor(0.0111, device='cuda:0')
batch 47 loss: tensor(0.0105, device='cuda:0')
batch 48 loss: tensor(0.0080, device='cuda:0')
batch 49 loss: tensor(0.0124, device='cuda:0')
batch 50 loss: tensor(0.0086, device='cuda:0')
batch 51 loss: tensor(0.0086, device='cuda:0')
batch 52 loss: tensor(0.0082, device='cuda:0')
batch 53 loss: tensor(0.0095, device='cuda:0')
batch 54 loss: tensor(0.0082, device='cuda:0')
batch 55 loss: tensor(0.0061, device='cuda:0')
batch 56 loss: tensor(0.0074, device='cuda:0')
batch 57 loss: tensor(0.0076, device='cuda:0')
batch 58 loss: tensor(0.0062, device='cuda:0')
batch 59 loss: tensor(0.0062, device='cuda:0')
batch 60 loss: tensor(0.0063, device='cuda:0')
batch 61 loss: tensor(0.0050, device='cuda:0')
batch 62 loss: tensor(0.0057, device='cuda:0')
batch 63 loss: tensor(0.0044, device='cuda:0')
batch 64 loss: tensor(0.0055, device='cuda:0')
batch 65 loss: tensor(0.0051, device='cuda:0')
batch 66 loss: tensor(0.0043, device='cuda:0')
batch 67 loss: tensor(0.0050, device='cuda:0')
batch 68 loss: tensor(0.0043, device='cuda:0')
batch 69 loss: tensor(0.0040, device='cuda:0')
batch 70 loss: tensor(0.0058, device='cuda:0')
batch 71 loss: tensor(0.0045, device='cuda:0')
batch 72 loss: tensor(0.0046, device='cuda:0')
batch 73 loss: tensor(0.0055, device='cuda:0')
batch 74 loss: tensor(0.0036, device='cuda:0')
batch 75 loss: tensor(0.0043, device='cuda:0')
batch 76 loss: tensor(0.0043, device='cuda:0')
batch 77 loss: tensor(0.0039, device='cuda:0')
batch 78 loss: tensor(0.0052, device='cuda:0')
batch 79 loss: tensor(0.0044, device='cuda:0')
batch 80 loss: tensor(0.0030, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(2.8397, device='cuda:0')
batch 2 loss: tensor(1.4572, device='cuda:0')
batch 3 loss: tensor(0.7838, device='cuda:0')
batch 4 loss: tensor(0.2439, device='cuda:0')
batch 5 loss: tensor(0.1948, device='cuda:0')
batch 6 loss: tensor(0.1377, device='cuda:0')
batch 7 loss: tensor(0.0904, device='cuda:0')
batch 8 loss: tensor(0.0648, device='cuda:0')
batch 9 loss: tensor(0.0462, device='cuda:0')
batch 10 loss: tensor(0.0456, device='cuda:0')
batch 11 loss: tensor(0.0448, device='cuda:0')
batch 12 loss: tensor(0.0320, device='cuda:0')
batch 13 loss: tensor(0.0329, device='cuda:0')
batch 14 loss: tensor(0.0336, device='cuda:0')
batch 15 loss: tensor(0.0288, device='cuda:0')
batch 16 loss: tensor(0.0297, device='cuda:0')
batch 17 loss: tensor(0.0271, device='cuda:0')
batch 18 loss: tensor(0.0238, device='cuda:0')
batch 19 loss: tensor(0.0266, device='cuda:0')
batch 20 loss: tensor(0.0249, device='cuda:0')
batch 21 loss: tensor(0.0141, device='cuda:0')
batch 22 loss: tensor(0.0223, device='cuda:0')
batch 23 loss: tensor(0.0229, device='cuda:0')
batch 24 loss: tensor(0.0209, device='cuda:0')
batch 25 loss: tensor(0.0270, device='cuda:0')
batch 26 loss: tensor(0.0192, device='cuda:0')
batch 27 loss: tensor(0.0186, device='cuda:0')
batch 28 loss: tensor(0.0195, device='cuda:0')
batch 29 loss: tensor(0.0124, device='cuda:0')
batch 30 loss: tensor(0.0189, device='cuda:0')
batch 31 loss: tensor(0.0241, device='cuda:0')
batch 32 loss: tensor(0.0196, device='cuda:0')
batch 33 loss: tensor(0.0211, device='cuda:0')
batch 34 loss: tensor(0.0194, device='cuda:0')
batch 35 loss: tensor(0.0215, device='cuda:0')
batch 36 loss: tensor(0.0124, device='cuda:0')
batch 37 loss: tensor(0.0195, device='cuda:0')
batch 38 loss: tensor(0.0183, device='cuda:0')
batch 39 loss: tensor(0.0192, device='cuda:0')
batch 40 loss: tensor(0.0134, device='cuda:0')
batch 41 loss: tensor(0.0155, device='cuda:0')
batch 42 loss: tensor(0.0160, device='cuda:0')
batch 43 loss: tensor(0.0183, device='cuda:0')
batch 44 loss: tensor(0.0137, device='cuda:0')
batch 45 loss: tensor(0.0093, device='cuda:0')
batch 46 loss: tensor(0.0114, device='cuda:0')
batch 47 loss: tensor(0.0101, device='cuda:0')
batch 48 loss: tensor(0.0115, device='cuda:0')
batch 49 loss: tensor(0.0092, device='cuda:0')
batch 50 loss: tensor(0.0159, device='cuda:0')
batch 51 loss: tensor(0.0097, device='cuda:0')
batch 52 loss: tensor(0.0107, device='cuda:0')
batch 53 loss: tensor(0.0154, device='cuda:0')
batch 54 loss: tensor(0.0146, device='cuda:0')
batch 55 loss: tensor(0.0136, device='cuda:0')
batch 56 loss: tensor(0.0095, device='cuda:0')
batch 57 loss: tensor(0.0122, device='cuda:0')
batch 58 loss: tensor(0.0060, device='cuda:0')
batch 59 loss: tensor(0.0114, device='cuda:0')
batch 60 loss: tensor(0.0098, device='cuda:0')
batch 61 loss: tensor(0.0124, device='cuda:0')
batch 62 loss: tensor(0.0134, device='cuda:0')
batch 63 loss: tensor(0.0114, device='cuda:0')
batch 64 loss: tensor(0.0111, device='cuda:0')
batch 65 loss: tensor(0.0121, device='cuda:0')
batch 66 loss: tensor(0.0096, device='cuda:0')
batch 67 loss: tensor(0.0078, device='cuda:0')
batch 68 loss: tensor(0.0138, device='cuda:0')
batch 69 loss: tensor(0.0114, device='cuda:0')
batch 70 loss: tensor(0.0097, device='cuda:0')
batch 71 loss: tensor(0.0123, device='cuda:0')
batch 72 loss: tensor(0.0075, device='cuda:0')
batch 73 loss: tensor(0.0088, device='cuda:0')
batch 74 loss: tensor(0.0084, device='cuda:0')
batch 75 loss: tensor(0.0129, device='cuda:0')
batch 76 loss: tensor(0.0075, device='cuda:0')
batch 77 loss: tensor(0.0093, device='cuda:0')
batch 78 loss: tensor(0.0087, device='cuda:0')
batch 79 loss: tensor(0.0088, device='cuda:0')
batch 80 loss: tensor(0.0047, device='cuda:0')
accuracy in val: 0.858
accuracy in test: 0.83
average epoch time: 0.004684002697467804
total time: 0.7494404315948486

0.8404 0.8152731895446778
0.007227724399837068 0.05512374684542303
Thu Nov 21 15:37:25 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   32C    P0    53W / 149W |    353MiB / 12206MiB |      8%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   33C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35184      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:28 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   32C    P0    53W / 149W |    353MiB / 12206MiB |      8%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   33C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35184      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:30 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   32C    P0    53W / 149W |    353MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   33C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35184      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:33 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   32C    P0    53W / 149W |    353MiB / 12206MiB |     12%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   33C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35184      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:36 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   33C    P0    53W / 149W |    353MiB / 12206MiB |     10%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   33C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35184      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:39 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   33C    P0    53W / 149W |    353MiB / 12206MiB |     12%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   33C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35184      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:42 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   33C    P0    53W / 149W |    353MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   34C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35184      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:45 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   33C    P0    54W / 149W |    353MiB / 12206MiB |     10%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   34C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35184      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:47 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   33C    P0    53W / 149W |    353MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   34C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35184      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:50 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   33C    P0    54W / 149W |    353MiB / 12206MiB |     12%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   34C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14690      G   /usr/bin/X                                    20MiB |
|    0     35184      C   python                                       321MiB |
|    1     14690      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
{'dataset': 'cora', 'config_file': 'cora.yaml', 'layer_num': 2, 'epoch_num': [100, 100]}
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8252, device='cuda:0')
batch 2 loss: tensor(1.5931, device='cuda:0')
batch 3 loss: tensor(1.3182, device='cuda:0')
batch 4 loss: tensor(1.0453, device='cuda:0')
batch 5 loss: tensor(0.8343, device='cuda:0')
batch 6 loss: tensor(0.6260, device='cuda:0')
batch 7 loss: tensor(0.5488, device='cuda:0')
batch 8 loss: tensor(0.3786, device='cuda:0')
batch 9 loss: tensor(0.3406, device='cuda:0')
batch 10 loss: tensor(0.2823, device='cuda:0')
batch 11 loss: tensor(0.2104, device='cuda:0')
batch 12 loss: tensor(0.1555, device='cuda:0')
batch 13 loss: tensor(0.1590, device='cuda:0')
batch 14 loss: tensor(0.1495, device='cuda:0')
batch 15 loss: tensor(0.1029, device='cuda:0')
batch 16 loss: tensor(0.0901, device='cuda:0')
batch 17 loss: tensor(0.0787, device='cuda:0')
batch 18 loss: tensor(0.0631, device='cuda:0')
batch 19 loss: tensor(0.0607, device='cuda:0')
batch 20 loss: tensor(0.0557, device='cuda:0')
batch 21 loss: tensor(0.0477, device='cuda:0')
batch 22 loss: tensor(0.0395, device='cuda:0')
batch 23 loss: tensor(0.0367, device='cuda:0')
batch 24 loss: tensor(0.0335, device='cuda:0')
batch 25 loss: tensor(0.0340, device='cuda:0')
batch 26 loss: tensor(0.0309, device='cuda:0')
batch 27 loss: tensor(0.0328, device='cuda:0')
batch 28 loss: tensor(0.0292, device='cuda:0')
batch 29 loss: tensor(0.0227, device='cuda:0')
batch 30 loss: tensor(0.0217, device='cuda:0')
batch 31 loss: tensor(0.0236, device='cuda:0')
batch 32 loss: tensor(0.0153, device='cuda:0')
batch 33 loss: tensor(0.0180, device='cuda:0')
batch 34 loss: tensor(0.0193, device='cuda:0')
batch 35 loss: tensor(0.0167, device='cuda:0')
batch 36 loss: tensor(0.0135, device='cuda:0')
batch 37 loss: tensor(0.0166, device='cuda:0')
batch 38 loss: tensor(0.0153, device='cuda:0')
batch 39 loss: tensor(0.0117, device='cuda:0')
batch 40 loss: tensor(0.0151, device='cuda:0')
batch 41 loss: tensor(0.0106, device='cuda:0')
batch 42 loss: tensor(0.0122, device='cuda:0')
batch 43 loss: tensor(0.0123, device='cuda:0')
batch 44 loss: tensor(0.0089, device='cuda:0')
batch 45 loss: tensor(0.0134, device='cuda:0')
batch 46 loss: tensor(0.0074, device='cuda:0')
batch 47 loss: tensor(0.0087, device='cuda:0')
batch 48 loss: tensor(0.0093, device='cuda:0')
batch 49 loss: tensor(0.0079, device='cuda:0')
batch 50 loss: tensor(0.0074, device='cuda:0')
batch 51 loss: tensor(0.0084, device='cuda:0')
batch 52 loss: tensor(0.0076, device='cuda:0')
batch 53 loss: tensor(0.0050, device='cuda:0')
batch 54 loss: tensor(0.0071, device='cuda:0')
batch 55 loss: tensor(0.0068, device='cuda:0')
batch 56 loss: tensor(0.0057, device='cuda:0')
batch 57 loss: tensor(0.0068, device='cuda:0')
batch 58 loss: tensor(0.0050, device='cuda:0')
batch 59 loss: tensor(0.0063, device='cuda:0')
batch 60 loss: tensor(0.0053, device='cuda:0')
batch 61 loss: tensor(0.0043, device='cuda:0')
batch 62 loss: tensor(0.0043, device='cuda:0')
batch 63 loss: tensor(0.0063, device='cuda:0')
batch 64 loss: tensor(0.0047, device='cuda:0')
batch 65 loss: tensor(0.0055, device='cuda:0')
batch 66 loss: tensor(0.0048, device='cuda:0')
batch 67 loss: tensor(0.0049, device='cuda:0')
batch 68 loss: tensor(0.0034, device='cuda:0')
batch 69 loss: tensor(0.0043, device='cuda:0')
batch 70 loss: tensor(0.0047, device='cuda:0')
batch 71 loss: tensor(0.0027, device='cuda:0')
batch 72 loss: tensor(0.0048, device='cuda:0')
batch 73 loss: tensor(0.0035, device='cuda:0')
batch 74 loss: tensor(0.0039, device='cuda:0')
batch 75 loss: tensor(0.0042, device='cuda:0')
batch 76 loss: tensor(0.0036, device='cuda:0')
batch 77 loss: tensor(0.0060, device='cuda:0')
batch 78 loss: tensor(0.0029, device='cuda:0')
batch 79 loss: tensor(0.0037, device='cuda:0')
batch 80 loss: tensor(0.0031, device='cuda:0')
batch 81 loss: tensor(0.0025, device='cuda:0')
batch 82 loss: tensor(0.0032, device='cuda:0')
batch 83 loss: tensor(0.0038, device='cuda:0')
batch 84 loss: tensor(0.0021, device='cuda:0')
batch 85 loss: tensor(0.0031, device='cuda:0')
batch 86 loss: tensor(0.0021, device='cuda:0')
batch 87 loss: tensor(0.0027, device='cuda:0')
batch 88 loss: tensor(0.0018, device='cuda:0')
batch 89 loss: tensor(0.0026, device='cuda:0')
batch 90 loss: tensor(0.0025, device='cuda:0')
batch 91 loss: tensor(0.0027, device='cuda:0')
batch 92 loss: tensor(0.0020, device='cuda:0')
batch 93 loss: tensor(0.0022, device='cuda:0')
batch 94 loss: tensor(0.0022, device='cuda:0')
batch 95 loss: tensor(0.0017, device='cuda:0')
batch 96 loss: tensor(0.0025, device='cuda:0')
batch 97 loss: tensor(0.0019, device='cuda:0')
batch 98 loss: tensor(0.0020, device='cuda:0')
batch 99 loss: tensor(0.0024, device='cuda:0')
batch 100 loss: tensor(0.0025, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(1.7718, device='cuda:0')
batch 2 loss: tensor(0.7344, device='cuda:0')
batch 3 loss: tensor(0.4057, device='cuda:0')
batch 4 loss: tensor(0.2609, device='cuda:0')
batch 5 loss: tensor(0.1532, device='cuda:0')
batch 6 loss: tensor(0.1129, device='cuda:0')
batch 7 loss: tensor(0.0861, device='cuda:0')
batch 8 loss: tensor(0.0661, device='cuda:0')
batch 9 loss: tensor(0.0545, device='cuda:0')
batch 10 loss: tensor(0.0683, device='cuda:0')
batch 11 loss: tensor(0.0410, device='cuda:0')
batch 12 loss: tensor(0.0380, device='cuda:0')
batch 13 loss: tensor(0.0344, device='cuda:0')
batch 14 loss: tensor(0.0346, device='cuda:0')
batch 15 loss: tensor(0.0284, device='cuda:0')
batch 16 loss: tensor(0.0179, device='cuda:0')
batch 17 loss: tensor(0.0327, device='cuda:0')
batch 18 loss: tensor(0.0272, device='cuda:0')
batch 19 loss: tensor(0.0282, device='cuda:0')
batch 20 loss: tensor(0.0186, device='cuda:0')
batch 21 loss: tensor(0.0141, device='cuda:0')
batch 22 loss: tensor(0.0234, device='cuda:0')
batch 23 loss: tensor(0.0231, device='cuda:0')
batch 24 loss: tensor(0.0166, device='cuda:0')
batch 25 loss: tensor(0.0263, device='cuda:0')
batch 26 loss: tensor(0.0195, device='cuda:0')
batch 27 loss: tensor(0.0173, device='cuda:0')
batch 28 loss: tensor(0.0167, device='cuda:0')
batch 29 loss: tensor(0.0161, device='cuda:0')
batch 30 loss: tensor(0.0136, device='cuda:0')
batch 31 loss: tensor(0.0217, device='cuda:0')
batch 32 loss: tensor(0.0147, device='cuda:0')
batch 33 loss: tensor(0.0127, device='cuda:0')
batch 34 loss: tensor(0.0133, device='cuda:0')
batch 35 loss: tensor(0.0143, device='cuda:0')
batch 36 loss: tensor(0.0099, device='cuda:0')
batch 37 loss: tensor(0.0134, device='cuda:0')
batch 38 loss: tensor(0.0110, device='cuda:0')
batch 39 loss: tensor(0.0144, device='cuda:0')
batch 40 loss: tensor(0.0149, device='cuda:0')
batch 41 loss: tensor(0.0133, device='cuda:0')
batch 42 loss: tensor(0.0071, device='cuda:0')
batch 43 loss: tensor(0.0121, device='cuda:0')
batch 44 loss: tensor(0.0129, device='cuda:0')
batch 45 loss: tensor(0.0093, device='cuda:0')
batch 46 loss: tensor(0.0136, device='cuda:0')
batch 47 loss: tensor(0.0102, device='cuda:0')
batch 48 loss: tensor(0.0093, device='cuda:0')
batch 49 loss: tensor(0.0086, device='cuda:0')
batch 50 loss: tensor(0.0093, device='cuda:0')
batch 51 loss: tensor(0.0105, device='cuda:0')
batch 52 loss: tensor(0.0072, device='cuda:0')
batch 53 loss: tensor(0.0074, device='cuda:0')
batch 54 loss: tensor(0.0070, device='cuda:0')
batch 55 loss: tensor(0.0079, device='cuda:0')
batch 56 loss: tensor(0.0075, device='cuda:0')
batch 57 loss: tensor(0.0068, device='cuda:0')
batch 58 loss: tensor(0.0055, device='cuda:0')
batch 59 loss: tensor(0.0102, device='cuda:0')
batch 60 loss: tensor(0.0074, device='cuda:0')
batch 61 loss: tensor(0.0067, device='cuda:0')
batch 62 loss: tensor(0.0102, device='cuda:0')
batch 63 loss: tensor(0.0086, device='cuda:0')
batch 64 loss: tensor(0.0093, device='cuda:0')
batch 65 loss: tensor(0.0093, device='cuda:0')
batch 66 loss: tensor(0.0044, device='cuda:0')
batch 67 loss: tensor(0.0073, device='cuda:0')
batch 68 loss: tensor(0.0041, device='cuda:0')
batch 69 loss: tensor(0.0076, device='cuda:0')
batch 70 loss: tensor(0.0056, device='cuda:0')
batch 71 loss: tensor(0.0057, device='cuda:0')
batch 72 loss: tensor(0.0068, device='cuda:0')
batch 73 loss: tensor(0.0055, device='cuda:0')
batch 74 loss: tensor(0.0069, device='cuda:0')
batch 75 loss: tensor(0.0041, device='cuda:0')
batch 76 loss: tensor(0.0059, device='cuda:0')
batch 77 loss: tensor(0.0068, device='cuda:0')
batch 78 loss: tensor(0.0056, device='cuda:0')
batch 79 loss: tensor(0.0052, device='cuda:0')
batch 80 loss: tensor(0.0056, device='cuda:0')
batch 81 loss: tensor(0.0090, device='cuda:0')
batch 82 loss: tensor(0.0032, device='cuda:0')
batch 83 loss: tensor(0.0037, device='cuda:0')
batch 84 loss: tensor(0.0026, device='cuda:0')
batch 85 loss: tensor(0.0047, device='cuda:0')
batch 86 loss: tensor(0.0057, device='cuda:0')
batch 87 loss: tensor(0.0073, device='cuda:0')
batch 88 loss: tensor(0.0048, device='cuda:0')
batch 89 loss: tensor(0.0052, device='cuda:0')
batch 90 loss: tensor(0.0048, device='cuda:0')
batch 91 loss: tensor(0.0050, device='cuda:0')
batch 92 loss: tensor(0.0070, device='cuda:0')
batch 93 loss: tensor(0.0053, device='cuda:0')
batch 94 loss: tensor(0.0037, device='cuda:0')
batch 95 loss: tensor(0.0040, device='cuda:0')
batch 96 loss: tensor(0.0045, device='cuda:0')
batch 97 loss: tensor(0.0031, device='cuda:0')
batch 98 loss: tensor(0.0045, device='cuda:0')
batch 99 loss: tensor(0.0034, device='cuda:0')
batch 100 loss: tensor(0.0036, device='cuda:0')
accuracy in val: 0.856
accuracy in test: 0.828
average epoch time: 0.004826174974441528
total time: 0.9652349948883057
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8342, device='cuda:0')
batch 2 loss: tensor(1.5841, device='cuda:0')
batch 3 loss: tensor(1.2862, device='cuda:0')
batch 4 loss: tensor(1.0399, device='cuda:0')
batch 5 loss: tensor(0.7980, device='cuda:0')
batch 6 loss: tensor(0.6630, device='cuda:0')
batch 7 loss: tensor(0.4945, device='cuda:0')
batch 8 loss: tensor(0.4001, device='cuda:0')
batch 9 loss: tensor(0.2992, device='cuda:0')
batch 10 loss: tensor(0.2560, device='cuda:0')
batch 11 loss: tensor(0.1846, device='cuda:0')
batch 12 loss: tensor(0.1876, device='cuda:0')
batch 13 loss: tensor(0.1566, device='cuda:0')
batch 14 loss: tensor(0.1277, device='cuda:0')
batch 15 loss: tensor(0.1066, device='cuda:0')
batch 16 loss: tensor(0.0705, device='cuda:0')
batch 17 loss: tensor(0.0924, device='cuda:0')
batch 18 loss: tensor(0.0755, device='cuda:0')
batch 19 loss: tensor(0.0702, device='cuda:0')
batch 20 loss: tensor(0.0517, device='cuda:0')
batch 21 loss: tensor(0.0448, device='cuda:0')
batch 22 loss: tensor(0.0386, device='cuda:0')
batch 23 loss: tensor(0.0325, device='cuda:0')
batch 24 loss: tensor(0.0362, device='cuda:0')
batch 25 loss: tensor(0.0320, device='cuda:0')
batch 26 loss: tensor(0.0269, device='cuda:0')
batch 27 loss: tensor(0.0326, device='cuda:0')
batch 28 loss: tensor(0.0241, device='cuda:0')
batch 29 loss: tensor(0.0196, device='cuda:0')
batch 30 loss: tensor(0.0219, device='cuda:0')
batch 31 loss: tensor(0.0155, device='cuda:0')
batch 32 loss: tensor(0.0182, device='cuda:0')
batch 33 loss: tensor(0.0162, device='cuda:0')
batch 34 loss: tensor(0.0189, device='cuda:0')
batch 35 loss: tensor(0.0135, device='cuda:0')
batch 36 loss: tensor(0.0139, device='cuda:0')
batch 37 loss: tensor(0.0177, device='cuda:0')
batch 38 loss: tensor(0.0136, device='cuda:0')
batch 39 loss: tensor(0.0131, device='cuda:0')
batch 40 loss: tensor(0.0113, device='cuda:0')
batch 41 loss: tensor(0.0101, device='cuda:0')
batch 42 loss: tensor(0.0116, device='cuda:0')
batch 43 loss: tensor(0.0109, device='cuda:0')
batch 44 loss: tensor(0.0101, device='cuda:0')
batch 45 loss: tensor(0.0083, device='cuda:0')
batch 46 loss: tensor(0.0086, device='cuda:0')
batch 47 loss: tensor(0.0116, device='cuda:0')
batch 48 loss: tensor(0.0083, device='cuda:0')
batch 49 loss: tensor(0.0098, device='cuda:0')
batch 50 loss: tensor(0.0104, device='cuda:0')
batch 51 loss: tensor(0.0072, device='cuda:0')
batch 52 loss: tensor(0.0058, device='cuda:0')
batch 53 loss: tensor(0.0063, device='cuda:0')
batch 54 loss: tensor(0.0097, device='cuda:0')
batch 55 loss: tensor(0.0057, device='cuda:0')
batch 56 loss: tensor(0.0064, device='cuda:0')
batch 57 loss: tensor(0.0058, device='cuda:0')
batch 58 loss: tensor(0.0071, device='cuda:0')
batch 59 loss: tensor(0.0049, device='cuda:0')
batch 60 loss: tensor(0.0069, device='cuda:0')
batch 61 loss: tensor(0.0041, device='cuda:0')
batch 62 loss: tensor(0.0054, device='cuda:0')
batch 63 loss: tensor(0.0046, device='cuda:0')
batch 64 loss: tensor(0.0042, device='cuda:0')
batch 65 loss: tensor(0.0041, device='cuda:0')
batch 66 loss: tensor(0.0042, device='cuda:0')
batch 67 loss: tensor(0.0038, device='cuda:0')
batch 68 loss: tensor(0.0041, device='cuda:0')
batch 69 loss: tensor(0.0034, device='cuda:0')
batch 70 loss: tensor(0.0037, device='cuda:0')
batch 71 loss: tensor(0.0047, device='cuda:0')
batch 72 loss: tensor(0.0041, device='cuda:0')
batch 73 loss: tensor(0.0039, device='cuda:0')
batch 74 loss: tensor(0.0033, device='cuda:0')
batch 75 loss: tensor(0.0045, device='cuda:0')
batch 76 loss: tensor(0.0043, device='cuda:0')
batch 77 loss: tensor(0.0026, device='cuda:0')
batch 78 loss: tensor(0.0035, device='cuda:0')
batch 79 loss: tensor(0.0042, device='cuda:0')
batch 80 loss: tensor(0.0030, device='cuda:0')
batch 81 loss: tensor(0.0031, device='cuda:0')
batch 82 loss: tensor(0.0027, device='cuda:0')
batch 83 loss: tensor(0.0028, device='cuda:0')
batch 84 loss: tensor(0.0037, device='cuda:0')
batch 85 loss: tensor(0.0025, device='cuda:0')
batch 86 loss: tensor(0.0021, device='cuda:0')
batch 87 loss: tensor(0.0031, device='cuda:0')
batch 88 loss: tensor(0.0023, device='cuda:0')
batch 89 loss: tensor(0.0024, device='cuda:0')
batch 90 loss: tensor(0.0032, device='cuda:0')
batch 91 loss: tensor(0.0026, device='cuda:0')
batch 92 loss: tensor(0.0025, device='cuda:0')
batch 93 loss: tensor(0.0025, device='cuda:0')
batch 94 loss: tensor(0.0019, device='cuda:0')
batch 95 loss: tensor(0.0026, device='cuda:0')
batch 96 loss: tensor(0.0023, device='cuda:0')
batch 97 loss: tensor(0.0026, device='cuda:0')
batch 98 loss: tensor(0.0018, device='cuda:0')
batch 99 loss: tensor(0.0017, device='cuda:0')
batch 100 loss: tensor(0.0018, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(2.3204, device='cuda:0')
batch 2 loss: tensor(1.2561, device='cuda:0')
batch 3 loss: tensor(0.8273, device='cuda:0')
batch 4 loss: tensor(0.5341, device='cuda:0')
batch 5 loss: tensor(0.3127, device='cuda:0')
batch 6 loss: tensor(0.2520, device='cuda:0')
batch 7 loss: tensor(0.2129, device='cuda:0')
batch 8 loss: tensor(0.1714, device='cuda:0')
batch 9 loss: tensor(0.1405, device='cuda:0')
batch 10 loss: tensor(0.1115, device='cuda:0')
batch 11 loss: tensor(0.0900, device='cuda:0')
batch 12 loss: tensor(0.0813, device='cuda:0')
batch 13 loss: tensor(0.0566, device='cuda:0')
batch 14 loss: tensor(0.0591, device='cuda:0')
batch 15 loss: tensor(0.0680, device='cuda:0')
batch 16 loss: tensor(0.0536, device='cuda:0')
batch 17 loss: tensor(0.0586, device='cuda:0')
batch 18 loss: tensor(0.0505, device='cuda:0')
batch 19 loss: tensor(0.0454, device='cuda:0')
batch 20 loss: tensor(0.0461, device='cuda:0')
batch 21 loss: tensor(0.0472, device='cuda:0')
batch 22 loss: tensor(0.0348, device='cuda:0')
batch 23 loss: tensor(0.0429, device='cuda:0')
batch 24 loss: tensor(0.0338, device='cuda:0')
batch 25 loss: tensor(0.0337, device='cuda:0')
batch 26 loss: tensor(0.0300, device='cuda:0')
batch 27 loss: tensor(0.0287, device='cuda:0')
batch 28 loss: tensor(0.0293, device='cuda:0')
batch 29 loss: tensor(0.0342, device='cuda:0')
batch 30 loss: tensor(0.0343, device='cuda:0')
batch 31 loss: tensor(0.0220, device='cuda:0')
batch 32 loss: tensor(0.0217, device='cuda:0')
batch 33 loss: tensor(0.0339, device='cuda:0')
batch 34 loss: tensor(0.0288, device='cuda:0')
batch 35 loss: tensor(0.0263, device='cuda:0')
batch 36 loss: tensor(0.0283, device='cuda:0')
batch 37 loss: tensor(0.0303, device='cuda:0')
batch 38 loss: tensor(0.0380, device='cuda:0')
batch 39 loss: tensor(0.0224, device='cuda:0')
batch 40 loss: tensor(0.0248, device='cuda:0')
batch 41 loss: tensor(0.0169, device='cuda:0')
batch 42 loss: tensor(0.0192, device='cuda:0')
batch 43 loss: tensor(0.0264, device='cuda:0')
batch 44 loss: tensor(0.0187, device='cuda:0')
batch 45 loss: tensor(0.0202, device='cuda:0')
batch 46 loss: tensor(0.0155, device='cuda:0')
batch 47 loss: tensor(0.0164, device='cuda:0')
batch 48 loss: tensor(0.0184, device='cuda:0')
batch 49 loss: tensor(0.0156, device='cuda:0')
batch 50 loss: tensor(0.0214, device='cuda:0')
batch 51 loss: tensor(0.0130, device='cuda:0')
batch 52 loss: tensor(0.0102, device='cuda:0')
batch 53 loss: tensor(0.0207, device='cuda:0')
batch 54 loss: tensor(0.0129, device='cuda:0')
batch 55 loss: tensor(0.0117, device='cuda:0')
batch 56 loss: tensor(0.0150, device='cuda:0')
batch 57 loss: tensor(0.0135, device='cuda:0')
batch 58 loss: tensor(0.0168, device='cuda:0')
batch 59 loss: tensor(0.0161, device='cuda:0')
batch 60 loss: tensor(0.0139, device='cuda:0')
batch 61 loss: tensor(0.0139, device='cuda:0')
batch 62 loss: tensor(0.0155, device='cuda:0')
batch 63 loss: tensor(0.0117, device='cuda:0')
batch 64 loss: tensor(0.0110, device='cuda:0')
batch 65 loss: tensor(0.0112, device='cuda:0')
batch 66 loss: tensor(0.0109, device='cuda:0')
batch 67 loss: tensor(0.0144, device='cuda:0')
batch 68 loss: tensor(0.0156, device='cuda:0')
batch 69 loss: tensor(0.0112, device='cuda:0')
batch 70 loss: tensor(0.0121, device='cuda:0')
batch 71 loss: tensor(0.0103, device='cuda:0')
batch 72 loss: tensor(0.0099, device='cuda:0')
batch 73 loss: tensor(0.0094, device='cuda:0')
batch 74 loss: tensor(0.0080, device='cuda:0')
batch 75 loss: tensor(0.0124, device='cuda:0')
batch 76 loss: tensor(0.0089, device='cuda:0')
batch 77 loss: tensor(0.0120, device='cuda:0')
batch 78 loss: tensor(0.0057, device='cuda:0')
batch 79 loss: tensor(0.0101, device='cuda:0')
batch 80 loss: tensor(0.0090, device='cuda:0')
batch 81 loss: tensor(0.0106, device='cuda:0')
batch 82 loss: tensor(0.0071, device='cuda:0')
batch 83 loss: tensor(0.0078, device='cuda:0')
batch 84 loss: tensor(0.0067, device='cuda:0')
batch 85 loss: tensor(0.0099, device='cuda:0')
batch 86 loss: tensor(0.0106, device='cuda:0')
batch 87 loss: tensor(0.0066, device='cuda:0')
batch 88 loss: tensor(0.0066, device='cuda:0')
batch 89 loss: tensor(0.0102, device='cuda:0')
batch 90 loss: tensor(0.0091, device='cuda:0')
batch 91 loss: tensor(0.0091, device='cuda:0')
batch 92 loss: tensor(0.0077, device='cuda:0')
batch 93 loss: tensor(0.0042, device='cuda:0')
batch 94 loss: tensor(0.0075, device='cuda:0')
batch 95 loss: tensor(0.0074, device='cuda:0')
batch 96 loss: tensor(0.0063, device='cuda:0')
batch 97 loss: tensor(0.0057, device='cuda:0')
batch 98 loss: tensor(0.0055, device='cuda:0')
batch 99 loss: tensor(0.0047, device='cuda:0')
batch 100 loss: tensor(0.0073, device='cuda:0')
accuracy in val: 0.848
accuracy in test: 0.836
average epoch time: 0.005658522844314575
total time: 1.131704568862915
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8051, device='cuda:0')
batch 2 loss: tensor(1.5128, device='cuda:0')
batch 3 loss: tensor(1.2891, device='cuda:0')
batch 4 loss: tensor(1.0640, device='cuda:0')
batch 5 loss: tensor(0.8679, device='cuda:0')
batch 6 loss: tensor(0.6130, device='cuda:0')
batch 7 loss: tensor(0.4957, device='cuda:0')
batch 8 loss: tensor(0.4207, device='cuda:0')
batch 9 loss: tensor(0.3355, device='cuda:0')
batch 10 loss: tensor(0.3106, device='cuda:0')
batch 11 loss: tensor(0.2000, device='cuda:0')
batch 12 loss: tensor(0.1520, device='cuda:0')
batch 13 loss: tensor(0.1591, device='cuda:0')
batch 14 loss: tensor(0.1037, device='cuda:0')
batch 15 loss: tensor(0.1173, device='cuda:0')
batch 16 loss: tensor(0.0898, device='cuda:0')
batch 17 loss: tensor(0.0730, device='cuda:0')
batch 18 loss: tensor(0.0617, device='cuda:0')
batch 19 loss: tensor(0.0555, device='cuda:0')
batch 20 loss: tensor(0.0454, device='cuda:0')
batch 21 loss: tensor(0.0448, device='cuda:0')
batch 22 loss: tensor(0.0470, device='cuda:0')
batch 23 loss: tensor(0.0363, device='cuda:0')
batch 24 loss: tensor(0.0486, device='cuda:0')
batch 25 loss: tensor(0.0334, device='cuda:0')
batch 26 loss: tensor(0.0235, device='cuda:0')
batch 27 loss: tensor(0.0323, device='cuda:0')
batch 28 loss: tensor(0.0283, device='cuda:0')
batch 29 loss: tensor(0.0271, device='cuda:0')
batch 30 loss: tensor(0.0306, device='cuda:0')
batch 31 loss: tensor(0.0260, device='cuda:0')
batch 32 loss: tensor(0.0178, device='cuda:0')
batch 33 loss: tensor(0.0171, device='cuda:0')
batch 34 loss: tensor(0.0154, device='cuda:0')
batch 35 loss: tensor(0.0170, device='cuda:0')
batch 36 loss: tensor(0.0186, device='cuda:0')
batch 37 loss: tensor(0.0146, device='cuda:0')
batch 38 loss: tensor(0.0188, device='cuda:0')
batch 39 loss: tensor(0.0161, device='cuda:0')
batch 40 loss: tensor(0.0114, device='cuda:0')
batch 41 loss: tensor(0.0077, device='cuda:0')
batch 42 loss: tensor(0.0110, device='cuda:0')
batch 43 loss: tensor(0.0114, device='cuda:0')
batch 44 loss: tensor(0.0124, device='cuda:0')
batch 45 loss: tensor(0.0096, device='cuda:0')
batch 46 loss: tensor(0.0098, device='cuda:0')
batch 47 loss: tensor(0.0103, device='cuda:0')
batch 48 loss: tensor(0.0070, device='cuda:0')
batch 49 loss: tensor(0.0088, device='cuda:0')
batch 50 loss: tensor(0.0073, device='cuda:0')
batch 51 loss: tensor(0.0097, device='cuda:0')
batch 52 loss: tensor(0.0067, device='cuda:0')
batch 53 loss: tensor(0.0072, device='cuda:0')
batch 54 loss: tensor(0.0069, device='cuda:0')
batch 55 loss: tensor(0.0074, device='cuda:0')
batch 56 loss: tensor(0.0076, device='cuda:0')
batch 57 loss: tensor(0.0069, device='cuda:0')
batch 58 loss: tensor(0.0069, device='cuda:0')
batch 59 loss: tensor(0.0067, device='cuda:0')
batch 60 loss: tensor(0.0063, device='cuda:0')
batch 61 loss: tensor(0.0053, device='cuda:0')
batch 62 loss: tensor(0.0070, device='cuda:0')
batch 63 loss: tensor(0.0040, device='cuda:0')
batch 64 loss: tensor(0.0054, device='cuda:0')
batch 65 loss: tensor(0.0057, device='cuda:0')
batch 66 loss: tensor(0.0049, device='cuda:0')
batch 67 loss: tensor(0.0043, device='cuda:0')
batch 68 loss: tensor(0.0050, device='cuda:0')
batch 69 loss: tensor(0.0044, device='cuda:0')
batch 70 loss: tensor(0.0048, device='cuda:0')
batch 71 loss: tensor(0.0047, device='cuda:0')
batch 72 loss: tensor(0.0038, device='cuda:0')
batch 73 loss: tensor(0.0038, device='cuda:0')
batch 74 loss: tensor(0.0041, device='cuda:0')
batch 75 loss: tensor(0.0036, device='cuda:0')
batch 76 loss: tensor(0.0028, device='cuda:0')
batch 77 loss: tensor(0.0042, device='cuda:0')
batch 78 loss: tensor(0.0039, device='cuda:0')
batch 79 loss: tensor(0.0047, device='cuda:0')
batch 80 loss: tensor(0.0042, device='cuda:0')
batch 81 loss: tensor(0.0025, device='cuda:0')
batch 82 loss: tensor(0.0030, device='cuda:0')
batch 83 loss: tensor(0.0033, device='cuda:0')
batch 84 loss: tensor(0.0026, device='cuda:0')
batch 85 loss: tensor(0.0028, device='cuda:0')
batch 86 loss: tensor(0.0030, device='cuda:0')
batch 87 loss: tensor(0.0020, device='cuda:0')
batch 88 loss: tensor(0.0025, device='cuda:0')
batch 89 loss: tensor(0.0029, device='cuda:0')
batch 90 loss: tensor(0.0024, device='cuda:0')
batch 91 loss: tensor(0.0026, device='cuda:0')
batch 92 loss: tensor(0.0029, device='cuda:0')
batch 93 loss: tensor(0.0029, device='cuda:0')
batch 94 loss: tensor(0.0021, device='cuda:0')
batch 95 loss: tensor(0.0021, device='cuda:0')
batch 96 loss: tensor(0.0020, device='cuda:0')
batch 97 loss: tensor(0.0024, device='cuda:0')
batch 98 loss: tensor(0.0024, device='cuda:0')
batch 99 loss: tensor(0.0021, device='cuda:0')
batch 100 loss: tensor(0.0028, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(2.3797, device='cuda:0')
batch 2 loss: tensor(1.4612, device='cuda:0')
batch 3 loss: tensor(0.8754, device='cuda:0')
batch 4 loss: tensor(0.5934, device='cuda:0')
batch 5 loss: tensor(0.3440, device='cuda:0')
batch 6 loss: tensor(0.2535, device='cuda:0')
batch 7 loss: tensor(0.1539, device='cuda:0')
batch 8 loss: tensor(0.1087, device='cuda:0')
batch 9 loss: tensor(0.0747, device='cuda:0')
batch 10 loss: tensor(0.0572, device='cuda:0')
batch 11 loss: tensor(0.0382, device='cuda:0')
batch 12 loss: tensor(0.0320, device='cuda:0')
batch 13 loss: tensor(0.0356, device='cuda:0')
batch 14 loss: tensor(0.0183, device='cuda:0')
batch 15 loss: tensor(0.0221, device='cuda:0')
batch 16 loss: tensor(0.0188, device='cuda:0')
batch 17 loss: tensor(0.0167, device='cuda:0')
batch 18 loss: tensor(0.0247, device='cuda:0')
batch 19 loss: tensor(0.0184, device='cuda:0')
batch 20 loss: tensor(0.0227, device='cuda:0')
batch 21 loss: tensor(0.0210, device='cuda:0')
batch 22 loss: tensor(0.0170, device='cuda:0')
batch 23 loss: tensor(0.0138, device='cuda:0')
batch 24 loss: tensor(0.0135, device='cuda:0')
batch 25 loss: tensor(0.0144, device='cuda:0')
batch 26 loss: tensor(0.0173, device='cuda:0')
batch 27 loss: tensor(0.0110, device='cuda:0')
batch 28 loss: tensor(0.0148, device='cuda:0')
batch 29 loss: tensor(0.0084, device='cuda:0')
batch 30 loss: tensor(0.0084, device='cuda:0')
batch 31 loss: tensor(0.0131, device='cuda:0')
batch 32 loss: tensor(0.0115, device='cuda:0')
batch 33 loss: tensor(0.0136, device='cuda:0')
batch 34 loss: tensor(0.0094, device='cuda:0')
batch 35 loss: tensor(0.0075, device='cuda:0')
batch 36 loss: tensor(0.0089, device='cuda:0')
batch 37 loss: tensor(0.0147, device='cuda:0')
batch 38 loss: tensor(0.0097, device='cuda:0')
batch 39 loss: tensor(0.0057, device='cuda:0')
batch 40 loss: tensor(0.0072, device='cuda:0')
batch 41 loss: tensor(0.0060, device='cuda:0')
batch 42 loss: tensor(0.0068, device='cuda:0')
batch 43 loss: tensor(0.0069, device='cuda:0')
batch 44 loss: tensor(0.0048, device='cuda:0')
batch 45 loss: tensor(0.0109, device='cuda:0')
batch 46 loss: tensor(0.0106, device='cuda:0')
batch 47 loss: tensor(0.0055, device='cuda:0')
batch 48 loss: tensor(0.0057, device='cuda:0')
batch 49 loss: tensor(0.0092, device='cuda:0')
batch 50 loss: tensor(0.0098, device='cuda:0')
batch 51 loss: tensor(0.0096, device='cuda:0')
batch 52 loss: tensor(0.0128, device='cuda:0')
batch 53 loss: tensor(0.0077, device='cuda:0')
batch 54 loss: tensor(0.0066, device='cuda:0')
batch 55 loss: tensor(0.0058, device='cuda:0')
batch 56 loss: tensor(0.0063, device='cuda:0')
batch 57 loss: tensor(0.0076, device='cuda:0')
batch 58 loss: tensor(0.0083, device='cuda:0')
batch 59 loss: tensor(0.0070, device='cuda:0')
batch 60 loss: tensor(0.0060, device='cuda:0')
batch 61 loss: tensor(0.0081, device='cuda:0')
batch 62 loss: tensor(0.0062, device='cuda:0')
batch 63 loss: tensor(0.0060, device='cuda:0')
batch 64 loss: tensor(0.0040, device='cuda:0')
batch 65 loss: tensor(0.0037, device='cuda:0')
batch 66 loss: tensor(0.0084, device='cuda:0')
batch 67 loss: tensor(0.0060, device='cuda:0')
batch 68 loss: tensor(0.0028, device='cuda:0')
batch 69 loss: tensor(0.0084, device='cuda:0')
batch 70 loss: tensor(0.0087, device='cuda:0')
batch 71 loss: tensor(0.0070, device='cuda:0')
batch 72 loss: tensor(0.0069, device='cuda:0')
batch 73 loss: tensor(0.0035, device='cuda:0')
batch 74 loss: tensor(0.0031, device='cuda:0')
batch 75 loss: tensor(0.0054, device='cuda:0')
batch 76 loss: tensor(0.0059, device='cuda:0')
batch 77 loss: tensor(0.0050, device='cuda:0')
batch 78 loss: tensor(0.0043, device='cuda:0')
batch 79 loss: tensor(0.0045, device='cuda:0')
batch 80 loss: tensor(0.0070, device='cuda:0')
batch 81 loss: tensor(0.0021, device='cuda:0')
batch 82 loss: tensor(0.0069, device='cuda:0')
batch 83 loss: tensor(0.0029, device='cuda:0')
batch 84 loss: tensor(0.0048, device='cuda:0')
batch 85 loss: tensor(0.0055, device='cuda:0')
batch 86 loss: tensor(0.0037, device='cuda:0')
batch 87 loss: tensor(0.0049, device='cuda:0')
batch 88 loss: tensor(0.0037, device='cuda:0')
batch 89 loss: tensor(0.0020, device='cuda:0')
batch 90 loss: tensor(0.0029, device='cuda:0')
batch 91 loss: tensor(0.0057, device='cuda:0')
batch 92 loss: tensor(0.0039, device='cuda:0')
batch 93 loss: tensor(0.0037, device='cuda:0')
batch 94 loss: tensor(0.0074, device='cuda:0')
batch 95 loss: tensor(0.0042, device='cuda:0')
batch 96 loss: tensor(0.0030, device='cuda:0')
batch 97 loss: tensor(0.0036, device='cuda:0')
batch 98 loss: tensor(0.0033, device='cuda:0')
batch 99 loss: tensor(0.0040, device='cuda:0')
batch 100 loss: tensor(0.0018, device='cuda:0')
accuracy in val: 0.8599999999999999
accuracy in test: 0.847
average epoch time: 0.004758189916610717
total time: 0.9516379833221436
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8124, device='cuda:0')
batch 2 loss: tensor(1.5204, device='cuda:0')
batch 3 loss: tensor(1.2735, device='cuda:0')
batch 4 loss: tensor(1.0545, device='cuda:0')
batch 5 loss: tensor(0.7584, device='cuda:0')
batch 6 loss: tensor(0.6084, device='cuda:0')
batch 7 loss: tensor(0.4534, device='cuda:0')
batch 8 loss: tensor(0.3980, device='cuda:0')
batch 9 loss: tensor(0.2736, device='cuda:0')
batch 10 loss: tensor(0.2475, device='cuda:0')
batch 11 loss: tensor(0.1958, device='cuda:0')
batch 12 loss: tensor(0.1411, device='cuda:0')
batch 13 loss: tensor(0.1310, device='cuda:0')
batch 14 loss: tensor(0.1106, device='cuda:0')
batch 15 loss: tensor(0.0680, device='cuda:0')
batch 16 loss: tensor(0.0880, device='cuda:0')
batch 17 loss: tensor(0.0652, device='cuda:0')
batch 18 loss: tensor(0.0795, device='cuda:0')
batch 19 loss: tensor(0.0562, device='cuda:0')
batch 20 loss: tensor(0.0492, device='cuda:0')
batch 21 loss: tensor(0.0411, device='cuda:0')
batch 22 loss: tensor(0.0432, device='cuda:0')
batch 23 loss: tensor(0.0385, device='cuda:0')
batch 24 loss: tensor(0.0299, device='cuda:0')
batch 25 loss: tensor(0.0293, device='cuda:0')
batch 26 loss: tensor(0.0281, device='cuda:0')
batch 27 loss: tensor(0.0278, device='cuda:0')
batch 28 loss: tensor(0.0275, device='cuda:0')
batch 29 loss: tensor(0.0272, device='cuda:0')
batch 30 loss: tensor(0.0208, device='cuda:0')
batch 31 loss: tensor(0.0201, device='cuda:0')
batch 32 loss: tensor(0.0199, device='cuda:0')
batch 33 loss: tensor(0.0243, device='cuda:0')
batch 34 loss: tensor(0.0201, device='cuda:0')
batch 35 loss: tensor(0.0184, device='cuda:0')
batch 36 loss: tensor(0.0113, device='cuda:0')
batch 37 loss: tensor(0.0172, device='cuda:0')
batch 38 loss: tensor(0.0134, device='cuda:0')
batch 39 loss: tensor(0.0141, device='cuda:0')
batch 40 loss: tensor(0.0120, device='cuda:0')
batch 41 loss: tensor(0.0130, device='cuda:0')
batch 42 loss: tensor(0.0128, device='cuda:0')
batch 43 loss: tensor(0.0099, device='cuda:0')
batch 44 loss: tensor(0.0070, device='cuda:0')
batch 45 loss: tensor(0.0112, device='cuda:0')
batch 46 loss: tensor(0.0098, device='cuda:0')
batch 47 loss: tensor(0.0084, device='cuda:0')
batch 48 loss: tensor(0.0108, device='cuda:0')
batch 49 loss: tensor(0.0084, device='cuda:0')
batch 50 loss: tensor(0.0119, device='cuda:0')
batch 51 loss: tensor(0.0069, device='cuda:0')
batch 52 loss: tensor(0.0093, device='cuda:0')
batch 53 loss: tensor(0.0081, device='cuda:0')
batch 54 loss: tensor(0.0059, device='cuda:0')
batch 55 loss: tensor(0.0061, device='cuda:0')
batch 56 loss: tensor(0.0060, device='cuda:0')
batch 57 loss: tensor(0.0073, device='cuda:0')
batch 58 loss: tensor(0.0059, device='cuda:0')
batch 59 loss: tensor(0.0060, device='cuda:0')
batch 60 loss: tensor(0.0079, device='cuda:0')
batch 61 loss: tensor(0.0059, device='cuda:0')
batch 62 loss: tensor(0.0051, device='cuda:0')
batch 63 loss: tensor(0.0045, device='cuda:0')
batch 64 loss: tensor(0.0056, device='cuda:0')
batch 65 loss: tensor(0.0068, device='cuda:0')
batch 66 loss: tensor(0.0045, device='cuda:0')
batch 67 loss: tensor(0.0046, device='cuda:0')
batch 68 loss: tensor(0.0057, device='cuda:0')
batch 69 loss: tensor(0.0046, device='cuda:0')
batch 70 loss: tensor(0.0050, device='cuda:0')
batch 71 loss: tensor(0.0048, device='cuda:0')
batch 72 loss: tensor(0.0041, device='cuda:0')
batch 73 loss: tensor(0.0044, device='cuda:0')
batch 74 loss: tensor(0.0033, device='cuda:0')
batch 75 loss: tensor(0.0044, device='cuda:0')
batch 76 loss: tensor(0.0028, device='cuda:0')
batch 77 loss: tensor(0.0035, device='cuda:0')
batch 78 loss: tensor(0.0032, device='cuda:0')
batch 79 loss: tensor(0.0025, device='cuda:0')
batch 80 loss: tensor(0.0034, device='cuda:0')
batch 81 loss: tensor(0.0040, device='cuda:0')
batch 82 loss: tensor(0.0040, device='cuda:0')
batch 83 loss: tensor(0.0024, device='cuda:0')
batch 84 loss: tensor(0.0026, device='cuda:0')
batch 85 loss: tensor(0.0036, device='cuda:0')
batch 86 loss: tensor(0.0025, device='cuda:0')
batch 87 loss: tensor(0.0036, device='cuda:0')
batch 88 loss: tensor(0.0029, device='cuda:0')
batch 89 loss: tensor(0.0020, device='cuda:0')
batch 90 loss: tensor(0.0030, device='cuda:0')
batch 91 loss: tensor(0.0027, device='cuda:0')
batch 92 loss: tensor(0.0016, device='cuda:0')
batch 93 loss: tensor(0.0024, device='cuda:0')
batch 94 loss: tensor(0.0028, device='cuda:0')
batch 95 loss: tensor(0.0025, device='cuda:0')
batch 96 loss: tensor(0.0025, device='cuda:0')
batch 97 loss: tensor(0.0027, device='cuda:0')
batch 98 loss: tensor(0.0016, device='cuda:0')
batch 99 loss: tensor(0.0025, device='cuda:0')
batch 100 loss: tensor(0.0023, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(2.0591, device='cuda:0')
batch 2 loss: tensor(0.8343, device='cuda:0')
batch 3 loss: tensor(0.3889, device='cuda:0')
batch 4 loss: tensor(0.2553, device='cuda:0')
batch 5 loss: tensor(0.1264, device='cuda:0')
batch 6 loss: tensor(0.0942, device='cuda:0')
batch 7 loss: tensor(0.0568, device='cuda:0')
batch 8 loss: tensor(0.0389, device='cuda:0')
batch 9 loss: tensor(0.0320, device='cuda:0')
batch 10 loss: tensor(0.0423, device='cuda:0')
batch 11 loss: tensor(0.0326, device='cuda:0')
batch 12 loss: tensor(0.0168, device='cuda:0')
batch 13 loss: tensor(0.0215, device='cuda:0')
batch 14 loss: tensor(0.0164, device='cuda:0')
batch 15 loss: tensor(0.0150, device='cuda:0')
batch 16 loss: tensor(0.0207, device='cuda:0')
batch 17 loss: tensor(0.0206, device='cuda:0')
batch 18 loss: tensor(0.0140, device='cuda:0')
batch 19 loss: tensor(0.0151, device='cuda:0')
batch 20 loss: tensor(0.0129, device='cuda:0')
batch 21 loss: tensor(0.0124, device='cuda:0')
batch 22 loss: tensor(0.0173, device='cuda:0')
batch 23 loss: tensor(0.0114, device='cuda:0')
batch 24 loss: tensor(0.0081, device='cuda:0')
batch 25 loss: tensor(0.0102, device='cuda:0')
batch 26 loss: tensor(0.0097, device='cuda:0')
batch 27 loss: tensor(0.0160, device='cuda:0')
batch 28 loss: tensor(0.0113, device='cuda:0')
batch 29 loss: tensor(0.0159, device='cuda:0')
batch 30 loss: tensor(0.0116, device='cuda:0')
batch 31 loss: tensor(0.0133, device='cuda:0')
batch 32 loss: tensor(0.0097, device='cuda:0')
batch 33 loss: tensor(0.0116, device='cuda:0')
batch 34 loss: tensor(0.0110, device='cuda:0')
batch 35 loss: tensor(0.0091, device='cuda:0')
batch 36 loss: tensor(0.0094, device='cuda:0')
batch 37 loss: tensor(0.0097, device='cuda:0')
batch 38 loss: tensor(0.0060, device='cuda:0')
batch 39 loss: tensor(0.0101, device='cuda:0')
batch 40 loss: tensor(0.0085, device='cuda:0')
batch 41 loss: tensor(0.0078, device='cuda:0')
batch 42 loss: tensor(0.0113, device='cuda:0')
batch 43 loss: tensor(0.0062, device='cuda:0')
batch 44 loss: tensor(0.0068, device='cuda:0')
batch 45 loss: tensor(0.0072, device='cuda:0')
batch 46 loss: tensor(0.0069, device='cuda:0')
batch 47 loss: tensor(0.0096, device='cuda:0')
batch 48 loss: tensor(0.0054, device='cuda:0')
batch 49 loss: tensor(0.0109, device='cuda:0')
batch 50 loss: tensor(0.0094, device='cuda:0')
batch 51 loss: tensor(0.0072, device='cuda:0')
batch 52 loss: tensor(0.0066, device='cuda:0')
batch 53 loss: tensor(0.0087, device='cuda:0')
batch 54 loss: tensor(0.0080, device='cuda:0')
batch 55 loss: tensor(0.0062, device='cuda:0')
batch 56 loss: tensor(0.0050, device='cuda:0')
batch 57 loss: tensor(0.0037, device='cuda:0')
batch 58 loss: tensor(0.0037, device='cuda:0')
batch 59 loss: tensor(0.0055, device='cuda:0')
batch 60 loss: tensor(0.0056, device='cuda:0')
batch 61 loss: tensor(0.0054, device='cuda:0')
batch 62 loss: tensor(0.0071, device='cuda:0')
batch 63 loss: tensor(0.0046, device='cuda:0')
batch 64 loss: tensor(0.0057, device='cuda:0')
batch 65 loss: tensor(0.0065, device='cuda:0')
batch 66 loss: tensor(0.0060, device='cuda:0')
batch 67 loss: tensor(0.0038, device='cuda:0')
batch 68 loss: tensor(0.0069, device='cuda:0')
batch 69 loss: tensor(0.0073, device='cuda:0')
batch 70 loss: tensor(0.0069, device='cuda:0')
batch 71 loss: tensor(0.0048, device='cuda:0')
batch 72 loss: tensor(0.0075, device='cuda:0')
batch 73 loss: tensor(0.0057, device='cuda:0')
batch 74 loss: tensor(0.0047, device='cuda:0')
batch 75 loss: tensor(0.0048, device='cuda:0')
batch 76 loss: tensor(0.0035, device='cuda:0')
batch 77 loss: tensor(0.0075, device='cuda:0')
batch 78 loss: tensor(0.0062, device='cuda:0')
batch 79 loss: tensor(0.0041, device='cuda:0')
batch 80 loss: tensor(0.0031, device='cuda:0')
batch 81 loss: tensor(0.0039, device='cuda:0')
batch 82 loss: tensor(0.0056, device='cuda:0')
batch 83 loss: tensor(0.0034, device='cuda:0')
batch 84 loss: tensor(0.0037, device='cuda:0')
batch 85 loss: tensor(0.0062, device='cuda:0')
batch 86 loss: tensor(0.0046, device='cuda:0')
batch 87 loss: tensor(0.0045, device='cuda:0')
batch 88 loss: tensor(0.0031, device='cuda:0')
batch 89 loss: tensor(0.0035, device='cuda:0')
batch 90 loss: tensor(0.0052, device='cuda:0')
batch 91 loss: tensor(0.0027, device='cuda:0')
batch 92 loss: tensor(0.0045, device='cuda:0')
batch 93 loss: tensor(0.0021, device='cuda:0')
batch 94 loss: tensor(0.0024, device='cuda:0')
batch 95 loss: tensor(0.0033, device='cuda:0')
batch 96 loss: tensor(0.0027, device='cuda:0')
batch 97 loss: tensor(0.0057, device='cuda:0')
batch 98 loss: tensor(0.0041, device='cuda:0')
batch 99 loss: tensor(0.0043, device='cuda:0')
batch 100 loss: tensor(0.0054, device='cuda:0')
accuracy in val: 0.8399999999999999
accuracy in test: 0.839
average epoch time: 0.006009718179702759
total time: 1.2019436359405518
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8462, device='cuda:0')
batch 2 loss: tensor(1.6184, device='cuda:0')
batch 3 loss: tensor(1.3805, device='cuda:0')
batch 4 loss: tensor(1.0629, device='cuda:0')
batch 5 loss: tensor(0.8707, device='cuda:0')
batch 6 loss: tensor(0.6553, device='cuda:0')
batch 7 loss: tensor(0.4846, device='cuda:0')
batch 8 loss: tensor(0.3410, device='cuda:0')
batch 9 loss: tensor(0.2993, device='cuda:0')
batch 10 loss: tensor(0.2520, device='cuda:0')
batch 11 loss: tensor(0.1955, device='cuda:0')
batch 12 loss: tensor(0.1233, device='cuda:0')
batch 13 loss: tensor(0.1474, device='cuda:0')
batch 14 loss: tensor(0.1118, device='cuda:0')
batch 15 loss: tensor(0.1032, device='cuda:0')
batch 16 loss: tensor(0.0879, device='cuda:0')
batch 17 loss: tensor(0.0592, device='cuda:0')
batch 18 loss: tensor(0.0598, device='cuda:0')
batch 19 loss: tensor(0.0420, device='cuda:0')
batch 20 loss: tensor(0.0485, device='cuda:0')
batch 21 loss: tensor(0.0491, device='cuda:0')
batch 22 loss: tensor(0.0358, device='cuda:0')
batch 23 loss: tensor(0.0324, device='cuda:0')
batch 24 loss: tensor(0.0384, device='cuda:0')
batch 25 loss: tensor(0.0357, device='cuda:0')
batch 26 loss: tensor(0.0207, device='cuda:0')
batch 27 loss: tensor(0.0310, device='cuda:0')
batch 28 loss: tensor(0.0239, device='cuda:0')
batch 29 loss: tensor(0.0254, device='cuda:0')
batch 30 loss: tensor(0.0256, device='cuda:0')
batch 31 loss: tensor(0.0182, device='cuda:0')
batch 32 loss: tensor(0.0156, device='cuda:0')
batch 33 loss: tensor(0.0169, device='cuda:0')
batch 34 loss: tensor(0.0240, device='cuda:0')
batch 35 loss: tensor(0.0159, device='cuda:0')
batch 36 loss: tensor(0.0134, device='cuda:0')
batch 37 loss: tensor(0.0133, device='cuda:0')
batch 38 loss: tensor(0.0133, device='cuda:0')
batch 39 loss: tensor(0.0167, device='cuda:0')
batch 40 loss: tensor(0.0119, device='cuda:0')
batch 41 loss: tensor(0.0121, device='cuda:0')
batch 42 loss: tensor(0.0082, device='cuda:0')
batch 43 loss: tensor(0.0125, device='cuda:0')
batch 44 loss: tensor(0.0107, device='cuda:0')
batch 45 loss: tensor(0.0096, device='cuda:0')
batch 46 loss: tensor(0.0085, device='cuda:0')
batch 47 loss: tensor(0.0077, device='cuda:0')
batch 48 loss: tensor(0.0087, device='cuda:0')
batch 49 loss: tensor(0.0084, device='cuda:0')
batch 50 loss: tensor(0.0061, device='cuda:0')
batch 51 loss: tensor(0.0072, device='cuda:0')
batch 52 loss: tensor(0.0092, device='cuda:0')
batch 53 loss: tensor(0.0063, device='cuda:0')
batch 54 loss: tensor(0.0071, device='cuda:0')
batch 55 loss: tensor(0.0089, device='cuda:0')
batch 56 loss: tensor(0.0074, device='cuda:0')
batch 57 loss: tensor(0.0061, device='cuda:0')
batch 58 loss: tensor(0.0052, device='cuda:0')
batch 59 loss: tensor(0.0063, device='cuda:0')
batch 60 loss: tensor(0.0057, device='cuda:0')
batch 61 loss: tensor(0.0040, device='cuda:0')
batch 62 loss: tensor(0.0050, device='cuda:0')
batch 63 loss: tensor(0.0047, device='cuda:0')
batch 64 loss: tensor(0.0054, device='cuda:0')
batch 65 loss: tensor(0.0056, device='cuda:0')
batch 66 loss: tensor(0.0045, device='cuda:0')
batch 67 loss: tensor(0.0052, device='cuda:0')
batch 68 loss: tensor(0.0047, device='cuda:0')
batch 69 loss: tensor(0.0036, device='cuda:0')
batch 70 loss: tensor(0.0044, device='cuda:0')
batch 71 loss: tensor(0.0039, device='cuda:0')
batch 72 loss: tensor(0.0027, device='cuda:0')
batch 73 loss: tensor(0.0030, device='cuda:0')
batch 74 loss: tensor(0.0042, device='cuda:0')
batch 75 loss: tensor(0.0037, device='cuda:0')
batch 76 loss: tensor(0.0036, device='cuda:0')
batch 77 loss: tensor(0.0037, device='cuda:0')
batch 78 loss: tensor(0.0021, device='cuda:0')
batch 79 loss: tensor(0.0033, device='cuda:0')
batch 80 loss: tensor(0.0024, device='cuda:0')
batch 81 loss: tensor(0.0027, device='cuda:0')
batch 82 loss: tensor(0.0030, device='cuda:0')
batch 83 loss: tensor(0.0039, device='cuda:0')
batch 84 loss: tensor(0.0029, device='cuda:0')
batch 85 loss: tensor(0.0031, device='cuda:0')
batch 86 loss: tensor(0.0020, device='cuda:0')
batch 87 loss: tensor(0.0038, device='cuda:0')
batch 88 loss: tensor(0.0026, device='cuda:0')
batch 89 loss: tensor(0.0024, device='cuda:0')
batch 90 loss: tensor(0.0034, device='cuda:0')
batch 91 loss: tensor(0.0027, device='cuda:0')
batch 92 loss: tensor(0.0022, device='cuda:0')
batch 93 loss: tensor(0.0026, device='cuda:0')
batch 94 loss: tensor(0.0017, device='cuda:0')
batch 95 loss: tensor(0.0022, device='cuda:0')
batch 96 loss: tensor(0.0018, device='cuda:0')
batch 97 loss: tensor(0.0020, device='cuda:0')
batch 98 loss: tensor(0.0019, device='cuda:0')
batch 99 loss: tensor(0.0023, device='cuda:0')
batch 100 loss: tensor(0.0025, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(3.7284, device='cuda:0')
batch 2 loss: tensor(2.2395, device='cuda:0')
batch 3 loss: tensor(1.2830, device='cuda:0')
batch 4 loss: tensor(0.9739, device='cuda:0')
batch 5 loss: tensor(0.5737, device='cuda:0')
batch 6 loss: tensor(0.4246, device='cuda:0')
batch 7 loss: tensor(0.3191, device='cuda:0')
batch 8 loss: tensor(0.2458, device='cuda:0')
batch 9 loss: tensor(0.1924, device='cuda:0')
batch 10 loss: tensor(0.1861, device='cuda:0')
batch 11 loss: tensor(0.1114, device='cuda:0')
batch 12 loss: tensor(0.0913, device='cuda:0')
batch 13 loss: tensor(0.0788, device='cuda:0')
batch 14 loss: tensor(0.0563, device='cuda:0')
batch 15 loss: tensor(0.0614, device='cuda:0')
batch 16 loss: tensor(0.0691, device='cuda:0')
batch 17 loss: tensor(0.0310, device='cuda:0')
batch 18 loss: tensor(0.0525, device='cuda:0')
batch 19 loss: tensor(0.0336, device='cuda:0')
batch 20 loss: tensor(0.0444, device='cuda:0')
batch 21 loss: tensor(0.0302, device='cuda:0')
batch 22 loss: tensor(0.0394, device='cuda:0')
batch 23 loss: tensor(0.0261, device='cuda:0')
batch 24 loss: tensor(0.0238, device='cuda:0')
batch 25 loss: tensor(0.0431, device='cuda:0')
batch 26 loss: tensor(0.0230, device='cuda:0')
batch 27 loss: tensor(0.0345, device='cuda:0')
batch 28 loss: tensor(0.0224, device='cuda:0')
batch 29 loss: tensor(0.0382, device='cuda:0')
batch 30 loss: tensor(0.0280, device='cuda:0')
batch 31 loss: tensor(0.0277, device='cuda:0')
batch 32 loss: tensor(0.0265, device='cuda:0')
batch 33 loss: tensor(0.0130, device='cuda:0')
batch 34 loss: tensor(0.0325, device='cuda:0')
batch 35 loss: tensor(0.0213, device='cuda:0')
batch 36 loss: tensor(0.0209, device='cuda:0')
batch 37 loss: tensor(0.0142, device='cuda:0')
batch 38 loss: tensor(0.0209, device='cuda:0')
batch 39 loss: tensor(0.0167, device='cuda:0')
batch 40 loss: tensor(0.0191, device='cuda:0')
batch 41 loss: tensor(0.0286, device='cuda:0')
batch 42 loss: tensor(0.0176, device='cuda:0')
batch 43 loss: tensor(0.0107, device='cuda:0')
batch 44 loss: tensor(0.0197, device='cuda:0')
batch 45 loss: tensor(0.0116, device='cuda:0')
batch 46 loss: tensor(0.0186, device='cuda:0')
batch 47 loss: tensor(0.0109, device='cuda:0')
batch 48 loss: tensor(0.0159, device='cuda:0')
batch 49 loss: tensor(0.0212, device='cuda:0')
batch 50 loss: tensor(0.0111, device='cuda:0')
batch 51 loss: tensor(0.0132, device='cuda:0')
batch 52 loss: tensor(0.0131, device='cuda:0')
batch 53 loss: tensor(0.0082, device='cuda:0')
batch 54 loss: tensor(0.0134, device='cuda:0')
batch 55 loss: tensor(0.0091, device='cuda:0')
batch 56 loss: tensor(0.0083, device='cuda:0')
batch 57 loss: tensor(0.0142, device='cuda:0')
batch 58 loss: tensor(0.0114, device='cuda:0')
batch 59 loss: tensor(0.0091, device='cuda:0')
batch 60 loss: tensor(0.0072, device='cuda:0')
batch 61 loss: tensor(0.0080, device='cuda:0')
batch 62 loss: tensor(0.0155, device='cuda:0')
batch 63 loss: tensor(0.0060, device='cuda:0')
batch 64 loss: tensor(0.0062, device='cuda:0')
batch 65 loss: tensor(0.0124, device='cuda:0')
batch 66 loss: tensor(0.0067, device='cuda:0')
batch 67 loss: tensor(0.0063, device='cuda:0')
batch 68 loss: tensor(0.0060, device='cuda:0')
batch 69 loss: tensor(0.0159, device='cuda:0')
batch 70 loss: tensor(0.0125, device='cuda:0')
batch 71 loss: tensor(0.0071, device='cuda:0')
batch 72 loss: tensor(0.0115, device='cuda:0')
batch 73 loss: tensor(0.0094, device='cuda:0')
batch 74 loss: tensor(0.0060, device='cuda:0')
batch 75 loss: tensor(0.0089, device='cuda:0')
batch 76 loss: tensor(0.0071, device='cuda:0')
batch 77 loss: tensor(0.0163, device='cuda:0')
batch 78 loss: tensor(0.0119, device='cuda:0')
batch 79 loss: tensor(0.0082, device='cuda:0')
batch 80 loss: tensor(0.0129, device='cuda:0')
batch 81 loss: tensor(0.0063, device='cuda:0')
batch 82 loss: tensor(0.0042, device='cuda:0')
batch 83 loss: tensor(0.0091, device='cuda:0')
batch 84 loss: tensor(0.0053, device='cuda:0')
batch 85 loss: tensor(0.0056, device='cuda:0')
batch 86 loss: tensor(0.0124, device='cuda:0')
batch 87 loss: tensor(0.0079, device='cuda:0')
batch 88 loss: tensor(0.0108, device='cuda:0')
batch 89 loss: tensor(0.0055, device='cuda:0')
batch 90 loss: tensor(0.0066, device='cuda:0')
batch 91 loss: tensor(0.0038, device='cuda:0')
batch 92 loss: tensor(0.0049, device='cuda:0')
batch 93 loss: tensor(0.0095, device='cuda:0')
batch 94 loss: tensor(0.0119, device='cuda:0')
batch 95 loss: tensor(0.0138, device='cuda:0')
batch 96 loss: tensor(0.0062, device='cuda:0')
batch 97 loss: tensor(0.0053, device='cuda:0')
batch 98 loss: tensor(0.0078, device='cuda:0')
batch 99 loss: tensor(0.0028, device='cuda:0')
batch 100 loss: tensor(0.0058, device='cuda:0')
accuracy in val: 0.852
accuracy in test: 0.853
average epoch time: 0.004787839651107788
total time: 0.9575679302215576
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8684, device='cuda:0')
batch 2 loss: tensor(1.6099, device='cuda:0')
batch 3 loss: tensor(1.3308, device='cuda:0')
batch 4 loss: tensor(1.0432, device='cuda:0')
batch 5 loss: tensor(0.8433, device='cuda:0')
batch 6 loss: tensor(0.6604, device='cuda:0')
batch 7 loss: tensor(0.5529, device='cuda:0')
batch 8 loss: tensor(0.4351, device='cuda:0')
batch 9 loss: tensor(0.3120, device='cuda:0')
batch 10 loss: tensor(0.2502, device='cuda:0')
batch 11 loss: tensor(0.1851, device='cuda:0')
batch 12 loss: tensor(0.1556, device='cuda:0')
batch 13 loss: tensor(0.0945, device='cuda:0')
batch 14 loss: tensor(0.1108, device='cuda:0')
batch 15 loss: tensor(0.0814, device='cuda:0')
batch 16 loss: tensor(0.0706, device='cuda:0')
batch 17 loss: tensor(0.0765, device='cuda:0')
batch 18 loss: tensor(0.0614, device='cuda:0')
batch 19 loss: tensor(0.0526, device='cuda:0')
batch 20 loss: tensor(0.0398, device='cuda:0')
batch 21 loss: tensor(0.0409, device='cuda:0')
batch 22 loss: tensor(0.0448, device='cuda:0')
batch 23 loss: tensor(0.0317, device='cuda:0')
batch 24 loss: tensor(0.0270, device='cuda:0')
batch 25 loss: tensor(0.0346, device='cuda:0')
batch 26 loss: tensor(0.0277, device='cuda:0')
batch 27 loss: tensor(0.0319, device='cuda:0')
batch 28 loss: tensor(0.0265, device='cuda:0')
batch 29 loss: tensor(0.0214, device='cuda:0')
batch 30 loss: tensor(0.0205, device='cuda:0')
batch 31 loss: tensor(0.0193, device='cuda:0')
batch 32 loss: tensor(0.0170, device='cuda:0')
batch 33 loss: tensor(0.0150, device='cuda:0')
batch 34 loss: tensor(0.0164, device='cuda:0')
batch 35 loss: tensor(0.0201, device='cuda:0')
batch 36 loss: tensor(0.0167, device='cuda:0')
batch 37 loss: tensor(0.0123, device='cuda:0')
batch 38 loss: tensor(0.0135, device='cuda:0')
batch 39 loss: tensor(0.0107, device='cuda:0')
batch 40 loss: tensor(0.0152, device='cuda:0')
batch 41 loss: tensor(0.0096, device='cuda:0')
batch 42 loss: tensor(0.0126, device='cuda:0')
batch 43 loss: tensor(0.0120, device='cuda:0')
batch 44 loss: tensor(0.0101, device='cuda:0')
batch 45 loss: tensor(0.0097, device='cuda:0')
batch 46 loss: tensor(0.0089, device='cuda:0')
batch 47 loss: tensor(0.0101, device='cuda:0')
batch 48 loss: tensor(0.0077, device='cuda:0')
batch 49 loss: tensor(0.0061, device='cuda:0')
batch 50 loss: tensor(0.0077, device='cuda:0')
batch 51 loss: tensor(0.0067, device='cuda:0')
batch 52 loss: tensor(0.0070, device='cuda:0')
batch 53 loss: tensor(0.0061, device='cuda:0')
batch 54 loss: tensor(0.0059, device='cuda:0')
batch 55 loss: tensor(0.0080, device='cuda:0')
batch 56 loss: tensor(0.0068, device='cuda:0')
batch 57 loss: tensor(0.0046, device='cuda:0')
batch 58 loss: tensor(0.0053, device='cuda:0')
batch 59 loss: tensor(0.0058, device='cuda:0')
batch 60 loss: tensor(0.0055, device='cuda:0')
batch 61 loss: tensor(0.0047, device='cuda:0')
batch 62 loss: tensor(0.0059, device='cuda:0')
batch 63 loss: tensor(0.0058, device='cuda:0')
batch 64 loss: tensor(0.0044, device='cuda:0')
batch 65 loss: tensor(0.0051, device='cuda:0')
batch 66 loss: tensor(0.0057, device='cuda:0')
batch 67 loss: tensor(0.0065, device='cuda:0')
batch 68 loss: tensor(0.0045, device='cuda:0')
batch 69 loss: tensor(0.0042, device='cuda:0')
batch 70 loss: tensor(0.0039, device='cuda:0')
batch 71 loss: tensor(0.0058, device='cuda:0')
batch 72 loss: tensor(0.0049, device='cuda:0')
batch 73 loss: tensor(0.0034, device='cuda:0')
batch 74 loss: tensor(0.0046, device='cuda:0')
batch 75 loss: tensor(0.0052, device='cuda:0')
batch 76 loss: tensor(0.0028, device='cuda:0')
batch 77 loss: tensor(0.0033, device='cuda:0')
batch 78 loss: tensor(0.0034, device='cuda:0')
batch 79 loss: tensor(0.0036, device='cuda:0')
batch 80 loss: tensor(0.0027, device='cuda:0')
batch 81 loss: tensor(0.0024, device='cuda:0')
batch 82 loss: tensor(0.0025, device='cuda:0')
batch 83 loss: tensor(0.0029, device='cuda:0')
batch 84 loss: tensor(0.0030, device='cuda:0')
batch 85 loss: tensor(0.0033, device='cuda:0')
batch 86 loss: tensor(0.0028, device='cuda:0')
batch 87 loss: tensor(0.0030, device='cuda:0')
batch 88 loss: tensor(0.0023, device='cuda:0')
batch 89 loss: tensor(0.0031, device='cuda:0')
batch 90 loss: tensor(0.0025, device='cuda:0')
batch 91 loss: tensor(0.0020, device='cuda:0')
batch 92 loss: tensor(0.0026, device='cuda:0')
batch 93 loss: tensor(0.0022, device='cuda:0')
batch 94 loss: tensor(0.0031, device='cuda:0')
batch 95 loss: tensor(0.0019, device='cuda:0')
batch 96 loss: tensor(0.0016, device='cuda:0')
batch 97 loss: tensor(0.0019, device='cuda:0')
batch 98 loss: tensor(0.0025, device='cuda:0')
batch 99 loss: tensor(0.0022, device='cuda:0')
batch 100 loss: tensor(0.0018, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(1.7053, device='cuda:0')
batch 2 loss: tensor(0.7730, device='cuda:0')
batch 3 loss: tensor(0.4412, device='cuda:0')
batch 4 loss: tensor(0.3402, device='cuda:0')
batch 5 loss: tensor(0.1705, device='cuda:0')
batch 6 loss: tensor(0.1108, device='cuda:0')
batch 7 loss: tensor(0.0634, device='cuda:0')
batch 8 loss: tensor(0.0572, device='cuda:0')
batch 9 loss: tensor(0.0430, device='cuda:0')
batch 10 loss: tensor(0.0343, device='cuda:0')
batch 11 loss: tensor(0.0398, device='cuda:0')
batch 12 loss: tensor(0.0323, device='cuda:0')
batch 13 loss: tensor(0.0286, device='cuda:0')
batch 14 loss: tensor(0.0209, device='cuda:0')
batch 15 loss: tensor(0.0256, device='cuda:0')
batch 16 loss: tensor(0.0146, device='cuda:0')
batch 17 loss: tensor(0.0179, device='cuda:0')
batch 18 loss: tensor(0.0162, device='cuda:0')
batch 19 loss: tensor(0.0203, device='cuda:0')
batch 20 loss: tensor(0.0150, device='cuda:0')
batch 21 loss: tensor(0.0137, device='cuda:0')
batch 22 loss: tensor(0.0201, device='cuda:0')
batch 23 loss: tensor(0.0132, device='cuda:0')
batch 24 loss: tensor(0.0121, device='cuda:0')
batch 25 loss: tensor(0.0131, device='cuda:0')
batch 26 loss: tensor(0.0194, device='cuda:0')
batch 27 loss: tensor(0.0104, device='cuda:0')
batch 28 loss: tensor(0.0144, device='cuda:0')
batch 29 loss: tensor(0.0093, device='cuda:0')
batch 30 loss: tensor(0.0131, device='cuda:0')
batch 31 loss: tensor(0.0101, device='cuda:0')
batch 32 loss: tensor(0.0109, device='cuda:0')
batch 33 loss: tensor(0.0102, device='cuda:0')
batch 34 loss: tensor(0.0110, device='cuda:0')
batch 35 loss: tensor(0.0110, device='cuda:0')
batch 36 loss: tensor(0.0098, device='cuda:0')
batch 37 loss: tensor(0.0097, device='cuda:0')
batch 38 loss: tensor(0.0138, device='cuda:0')
batch 39 loss: tensor(0.0113, device='cuda:0')
batch 40 loss: tensor(0.0105, device='cuda:0')
batch 41 loss: tensor(0.0101, device='cuda:0')
batch 42 loss: tensor(0.0067, device='cuda:0')
batch 43 loss: tensor(0.0094, device='cuda:0')
batch 44 loss: tensor(0.0065, device='cuda:0')
batch 45 loss: tensor(0.0082, device='cuda:0')
batch 46 loss: tensor(0.0052, device='cuda:0')
batch 47 loss: tensor(0.0056, device='cuda:0')
batch 48 loss: tensor(0.0052, device='cuda:0')
batch 49 loss: tensor(0.0094, device='cuda:0')
batch 50 loss: tensor(0.0045, device='cuda:0')
batch 51 loss: tensor(0.0083, device='cuda:0')
batch 52 loss: tensor(0.0062, device='cuda:0')
batch 53 loss: tensor(0.0066, device='cuda:0')
batch 54 loss: tensor(0.0079, device='cuda:0')
batch 55 loss: tensor(0.0103, device='cuda:0')
batch 56 loss: tensor(0.0085, device='cuda:0')
batch 57 loss: tensor(0.0073, device='cuda:0')
batch 58 loss: tensor(0.0070, device='cuda:0')
batch 59 loss: tensor(0.0075, device='cuda:0')
batch 60 loss: tensor(0.0041, device='cuda:0')
batch 61 loss: tensor(0.0056, device='cuda:0')
batch 62 loss: tensor(0.0047, device='cuda:0')
batch 63 loss: tensor(0.0092, device='cuda:0')
batch 64 loss: tensor(0.0026, device='cuda:0')
batch 65 loss: tensor(0.0056, device='cuda:0')
batch 66 loss: tensor(0.0067, device='cuda:0')
batch 67 loss: tensor(0.0075, device='cuda:0')
batch 68 loss: tensor(0.0062, device='cuda:0')
batch 69 loss: tensor(0.0080, device='cuda:0')
batch 70 loss: tensor(0.0078, device='cuda:0')
batch 71 loss: tensor(0.0035, device='cuda:0')
batch 72 loss: tensor(0.0076, device='cuda:0')
batch 73 loss: tensor(0.0036, device='cuda:0')
batch 74 loss: tensor(0.0027, device='cuda:0')
batch 75 loss: tensor(0.0067, device='cuda:0')
batch 76 loss: tensor(0.0056, device='cuda:0')
batch 77 loss: tensor(0.0038, device='cuda:0')
batch 78 loss: tensor(0.0050, device='cuda:0')
batch 79 loss: tensor(0.0044, device='cuda:0')
batch 80 loss: tensor(0.0041, device='cuda:0')
batch 81 loss: tensor(0.0054, device='cuda:0')
batch 82 loss: tensor(0.0061, device='cuda:0')
batch 83 loss: tensor(0.0047, device='cuda:0')
batch 84 loss: tensor(0.0045, device='cuda:0')
batch 85 loss: tensor(0.0034, device='cuda:0')
batch 86 loss: tensor(0.0029, device='cuda:0')
batch 87 loss: tensor(0.0034, device='cuda:0')
batch 88 loss: tensor(0.0033, device='cuda:0')
batch 89 loss: tensor(0.0042, device='cuda:0')
batch 90 loss: tensor(0.0068, device='cuda:0')
batch 91 loss: tensor(0.0053, device='cuda:0')
batch 92 loss: tensor(0.0069, device='cuda:0')
batch 93 loss: tensor(0.0047, device='cuda:0')
batch 94 loss: tensor(0.0043, device='cuda:0')
batch 95 loss: tensor(0.0027, device='cuda:0')
batch 96 loss: tensor(0.0037, device='cuda:0')
batch 97 loss: tensor(0.0031, device='cuda:0')
batch 98 loss: tensor(0.0038, device='cuda:0')
batch 99 loss: tensor(0.0043, device='cuda:0')
batch 100 loss: tensor(0.0039, device='cuda:0')
accuracy in val: 0.8599999999999999
accuracy in test: 0.835
average epoch time: 0.0069877696037292485
total time: 1.3975539207458496
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8260, device='cuda:0')
batch 2 loss: tensor(1.5409, device='cuda:0')
batch 3 loss: tensor(1.2894, device='cuda:0')
batch 4 loss: tensor(1.0368, device='cuda:0')
batch 5 loss: tensor(0.8628, device='cuda:0')
batch 6 loss: tensor(0.6768, device='cuda:0')
batch 7 loss: tensor(0.5531, device='cuda:0')
batch 8 loss: tensor(0.4158, device='cuda:0')
batch 9 loss: tensor(0.3696, device='cuda:0')
batch 10 loss: tensor(0.2812, device='cuda:0')
batch 11 loss: tensor(0.2037, device='cuda:0')
batch 12 loss: tensor(0.1927, device='cuda:0')
batch 13 loss: tensor(0.1285, device='cuda:0')
batch 14 loss: tensor(0.1124, device='cuda:0')
batch 15 loss: tensor(0.1047, device='cuda:0')
batch 16 loss: tensor(0.0851, device='cuda:0')
batch 17 loss: tensor(0.0891, device='cuda:0')
batch 18 loss: tensor(0.0830, device='cuda:0')
batch 19 loss: tensor(0.0669, device='cuda:0')
batch 20 loss: tensor(0.0504, device='cuda:0')
batch 21 loss: tensor(0.0458, device='cuda:0')
batch 22 loss: tensor(0.0503, device='cuda:0')
batch 23 loss: tensor(0.0341, device='cuda:0')
batch 24 loss: tensor(0.0329, device='cuda:0')
batch 25 loss: tensor(0.0341, device='cuda:0')
batch 26 loss: tensor(0.0311, device='cuda:0')
batch 27 loss: tensor(0.0288, device='cuda:0')
batch 28 loss: tensor(0.0280, device='cuda:0')
batch 29 loss: tensor(0.0234, device='cuda:0')
batch 30 loss: tensor(0.0174, device='cuda:0')
batch 31 loss: tensor(0.0303, device='cuda:0')
batch 32 loss: tensor(0.0256, device='cuda:0')
batch 33 loss: tensor(0.0123, device='cuda:0')
batch 34 loss: tensor(0.0185, device='cuda:0')
batch 35 loss: tensor(0.0153, device='cuda:0')
batch 36 loss: tensor(0.0186, device='cuda:0')
batch 37 loss: tensor(0.0151, device='cuda:0')
batch 38 loss: tensor(0.0117, device='cuda:0')
batch 39 loss: tensor(0.0195, device='cuda:0')
batch 40 loss: tensor(0.0118, device='cuda:0')
batch 41 loss: tensor(0.0170, device='cuda:0')
batch 42 loss: tensor(0.0102, device='cuda:0')
batch 43 loss: tensor(0.0107, device='cuda:0')
batch 44 loss: tensor(0.0094, device='cuda:0')
batch 45 loss: tensor(0.0087, device='cuda:0')
batch 46 loss: tensor(0.0167, device='cuda:0')
batch 47 loss: tensor(0.0098, device='cuda:0')
batch 48 loss: tensor(0.0078, device='cuda:0')
batch 49 loss: tensor(0.0102, device='cuda:0')
batch 50 loss: tensor(0.0119, device='cuda:0')
batch 51 loss: tensor(0.0091, device='cuda:0')
batch 52 loss: tensor(0.0074, device='cuda:0')
batch 53 loss: tensor(0.0087, device='cuda:0')
batch 54 loss: tensor(0.0098, device='cuda:0')
batch 55 loss: tensor(0.0067, device='cuda:0')
batch 56 loss: tensor(0.0078, device='cuda:0')
batch 57 loss: tensor(0.0057, device='cuda:0')
batch 58 loss: tensor(0.0058, device='cuda:0')
batch 59 loss: tensor(0.0062, device='cuda:0')
batch 60 loss: tensor(0.0115, device='cuda:0')
batch 61 loss: tensor(0.0043, device='cuda:0')
batch 62 loss: tensor(0.0059, device='cuda:0')
batch 63 loss: tensor(0.0062, device='cuda:0')
batch 64 loss: tensor(0.0051, device='cuda:0')
batch 65 loss: tensor(0.0092, device='cuda:0')
batch 66 loss: tensor(0.0093, device='cuda:0')
batch 67 loss: tensor(0.0042, device='cuda:0')
batch 68 loss: tensor(0.0048, device='cuda:0')
batch 69 loss: tensor(0.0036, device='cuda:0')
batch 70 loss: tensor(0.0044, device='cuda:0')
batch 71 loss: tensor(0.0030, device='cuda:0')
batch 72 loss: tensor(0.0087, device='cuda:0')
batch 73 loss: tensor(0.0043, device='cuda:0')
batch 74 loss: tensor(0.0089, device='cuda:0')
batch 75 loss: tensor(0.0035, device='cuda:0')
batch 76 loss: tensor(0.0034, device='cuda:0')
batch 77 loss: tensor(0.0069, device='cuda:0')
batch 78 loss: tensor(0.0039, device='cuda:0')
batch 79 loss: tensor(0.0032, device='cuda:0')
batch 80 loss: tensor(0.0029, device='cuda:0')
batch 81 loss: tensor(0.0080, device='cuda:0')
batch 82 loss: tensor(0.0032, device='cuda:0')
batch 83 loss: tensor(0.0029, device='cuda:0')
batch 84 loss: tensor(0.0039, device='cuda:0')
batch 85 loss: tensor(0.0027, device='cuda:0')
batch 86 loss: tensor(0.0024, device='cuda:0')
batch 87 loss: tensor(0.0039, device='cuda:0')
batch 88 loss: tensor(0.0059, device='cuda:0')
batch 89 loss: tensor(0.0027, device='cuda:0')
batch 90 loss: tensor(0.0062, device='cuda:0')
batch 91 loss: tensor(0.0028, device='cuda:0')
batch 92 loss: tensor(0.0029, device='cuda:0')
batch 93 loss: tensor(0.0025, device='cuda:0')
batch 94 loss: tensor(0.0033, device='cuda:0')
batch 95 loss: tensor(0.0025, device='cuda:0')
batch 96 loss: tensor(0.0027, device='cuda:0')
batch 97 loss: tensor(0.0020, device='cuda:0')
batch 98 loss: tensor(0.0052, device='cuda:0')
batch 99 loss: tensor(0.0029, device='cuda:0')
batch 100 loss: tensor(0.0024, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(2.1901, device='cuda:0')
batch 2 loss: tensor(1.4745, device='cuda:0')
batch 3 loss: tensor(0.8460, device='cuda:0')
batch 4 loss: tensor(0.3533, device='cuda:0')
batch 5 loss: tensor(0.1882, device='cuda:0')
batch 6 loss: tensor(0.1177, device='cuda:0')
batch 7 loss: tensor(0.0747, device='cuda:0')
batch 8 loss: tensor(0.0616, device='cuda:0')
batch 9 loss: tensor(0.0569, device='cuda:0')
batch 10 loss: tensor(0.0715, device='cuda:0')
batch 11 loss: tensor(0.0505, device='cuda:0')
batch 12 loss: tensor(0.0322, device='cuda:0')
batch 13 loss: tensor(0.0387, device='cuda:0')
batch 14 loss: tensor(0.0262, device='cuda:0')
batch 15 loss: tensor(0.0220, device='cuda:0')
batch 16 loss: tensor(0.0325, device='cuda:0')
batch 17 loss: tensor(0.0259, device='cuda:0')
batch 18 loss: tensor(0.0230, device='cuda:0')
batch 19 loss: tensor(0.0223, device='cuda:0')
batch 20 loss: tensor(0.0233, device='cuda:0')
batch 21 loss: tensor(0.0193, device='cuda:0')
batch 22 loss: tensor(0.0265, device='cuda:0')
batch 23 loss: tensor(0.0205, device='cuda:0')
batch 24 loss: tensor(0.0163, device='cuda:0')
batch 25 loss: tensor(0.0182, device='cuda:0')
batch 26 loss: tensor(0.0249, device='cuda:0')
batch 27 loss: tensor(0.0227, device='cuda:0')
batch 28 loss: tensor(0.0167, device='cuda:0')
batch 29 loss: tensor(0.0198, device='cuda:0')
batch 30 loss: tensor(0.0204, device='cuda:0')
batch 31 loss: tensor(0.0154, device='cuda:0')
batch 32 loss: tensor(0.0129, device='cuda:0')
batch 33 loss: tensor(0.0155, device='cuda:0')
batch 34 loss: tensor(0.0197, device='cuda:0')
batch 35 loss: tensor(0.0127, device='cuda:0')
batch 36 loss: tensor(0.0098, device='cuda:0')
batch 37 loss: tensor(0.0207, device='cuda:0')
batch 38 loss: tensor(0.0078, device='cuda:0')
batch 39 loss: tensor(0.0091, device='cuda:0')
batch 40 loss: tensor(0.0129, device='cuda:0')
batch 41 loss: tensor(0.0170, device='cuda:0')
batch 42 loss: tensor(0.0064, device='cuda:0')
batch 43 loss: tensor(0.0171, device='cuda:0')
batch 44 loss: tensor(0.0100, device='cuda:0')
batch 45 loss: tensor(0.0088, device='cuda:0')
batch 46 loss: tensor(0.0093, device='cuda:0')
batch 47 loss: tensor(0.0086, device='cuda:0')
batch 48 loss: tensor(0.0128, device='cuda:0')
batch 49 loss: tensor(0.0157, device='cuda:0')
batch 50 loss: tensor(0.0111, device='cuda:0')
batch 51 loss: tensor(0.0107, device='cuda:0')
batch 52 loss: tensor(0.0102, device='cuda:0')
batch 53 loss: tensor(0.0085, device='cuda:0')
batch 54 loss: tensor(0.0142, device='cuda:0')
batch 55 loss: tensor(0.0144, device='cuda:0')
batch 56 loss: tensor(0.0122, device='cuda:0')
batch 57 loss: tensor(0.0070, device='cuda:0')
batch 58 loss: tensor(0.0095, device='cuda:0')
batch 59 loss: tensor(0.0089, device='cuda:0')
batch 60 loss: tensor(0.0094, device='cuda:0')
batch 61 loss: tensor(0.0125, device='cuda:0')
batch 62 loss: tensor(0.0140, device='cuda:0')
batch 63 loss: tensor(0.0078, device='cuda:0')
batch 64 loss: tensor(0.0098, device='cuda:0')
batch 65 loss: tensor(0.0081, device='cuda:0')
batch 66 loss: tensor(0.0076, device='cuda:0')
batch 67 loss: tensor(0.0053, device='cuda:0')
batch 68 loss: tensor(0.0118, device='cuda:0')
batch 69 loss: tensor(0.0096, device='cuda:0')
batch 70 loss: tensor(0.0061, device='cuda:0')
batch 71 loss: tensor(0.0074, device='cuda:0')
batch 72 loss: tensor(0.0100, device='cuda:0')
batch 73 loss: tensor(0.0091, device='cuda:0')
batch 74 loss: tensor(0.0122, device='cuda:0')
batch 75 loss: tensor(0.0092, device='cuda:0')
batch 76 loss: tensor(0.0107, device='cuda:0')
batch 77 loss: tensor(0.0114, device='cuda:0')
batch 78 loss: tensor(0.0075, device='cuda:0')
batch 79 loss: tensor(0.0074, device='cuda:0')
batch 80 loss: tensor(0.0082, device='cuda:0')
batch 81 loss: tensor(0.0075, device='cuda:0')
batch 82 loss: tensor(0.0105, device='cuda:0')
batch 83 loss: tensor(0.0056, device='cuda:0')
batch 84 loss: tensor(0.0029, device='cuda:0')
batch 85 loss: tensor(0.0082, device='cuda:0')
batch 86 loss: tensor(0.0044, device='cuda:0')
batch 87 loss: tensor(0.0089, device='cuda:0')
batch 88 loss: tensor(0.0082, device='cuda:0')
batch 89 loss: tensor(0.0063, device='cuda:0')
batch 90 loss: tensor(0.0050, device='cuda:0')
batch 91 loss: tensor(0.0090, device='cuda:0')
batch 92 loss: tensor(0.0048, device='cuda:0')
batch 93 loss: tensor(0.0070, device='cuda:0')
batch 94 loss: tensor(0.0057, device='cuda:0')
batch 95 loss: tensor(0.0073, device='cuda:0')
batch 96 loss: tensor(0.0061, device='cuda:0')
batch 97 loss: tensor(0.0073, device='cuda:0')
batch 98 loss: tensor(0.0036, device='cuda:0')
batch 99 loss: tensor(0.0059, device='cuda:0')
batch 100 loss: tensor(0.0047, device='cuda:0')
accuracy in val: 0.848
accuracy in test: 0.845
average epoch time: 0.004825748205184936
total time: 0.9651496410369873
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8013, device='cuda:0')
batch 2 loss: tensor(1.4991, device='cuda:0')
batch 3 loss: tensor(1.2744, device='cuda:0')
batch 4 loss: tensor(0.9857, device='cuda:0')
batch 5 loss: tensor(0.8096, device='cuda:0')
batch 6 loss: tensor(0.6690, device='cuda:0')
batch 7 loss: tensor(0.5171, device='cuda:0')
batch 8 loss: tensor(0.3152, device='cuda:0')
batch 9 loss: tensor(0.3181, device='cuda:0')
batch 10 loss: tensor(0.2433, device='cuda:0')
batch 11 loss: tensor(0.2038, device='cuda:0')
batch 12 loss: tensor(0.1605, device='cuda:0')
batch 13 loss: tensor(0.1553, device='cuda:0')
batch 14 loss: tensor(0.0955, device='cuda:0')
batch 15 loss: tensor(0.1066, device='cuda:0')
batch 16 loss: tensor(0.0791, device='cuda:0')
batch 17 loss: tensor(0.0576, device='cuda:0')
batch 18 loss: tensor(0.0667, device='cuda:0')
batch 19 loss: tensor(0.0546, device='cuda:0')
batch 20 loss: tensor(0.0553, device='cuda:0')
batch 21 loss: tensor(0.0450, device='cuda:0')
batch 22 loss: tensor(0.0495, device='cuda:0')
batch 23 loss: tensor(0.0365, device='cuda:0')
batch 24 loss: tensor(0.0289, device='cuda:0')
batch 25 loss: tensor(0.0331, device='cuda:0')
batch 26 loss: tensor(0.0303, device='cuda:0')
batch 27 loss: tensor(0.0235, device='cuda:0')
batch 28 loss: tensor(0.0309, device='cuda:0')
batch 29 loss: tensor(0.0191, device='cuda:0')
batch 30 loss: tensor(0.0227, device='cuda:0')
batch 31 loss: tensor(0.0196, device='cuda:0')
batch 32 loss: tensor(0.0165, device='cuda:0')
batch 33 loss: tensor(0.0166, device='cuda:0')
batch 34 loss: tensor(0.0151, device='cuda:0')
batch 35 loss: tensor(0.0135, device='cuda:0')
batch 36 loss: tensor(0.0146, device='cuda:0')
batch 37 loss: tensor(0.0134, device='cuda:0')
batch 38 loss: tensor(0.0155, device='cuda:0')
batch 39 loss: tensor(0.0082, device='cuda:0')
batch 40 loss: tensor(0.0116, device='cuda:0')
batch 41 loss: tensor(0.0111, device='cuda:0')
batch 42 loss: tensor(0.0092, device='cuda:0')
batch 43 loss: tensor(0.0108, device='cuda:0')
batch 44 loss: tensor(0.0088, device='cuda:0')
batch 45 loss: tensor(0.0103, device='cuda:0')
batch 46 loss: tensor(0.0094, device='cuda:0')
batch 47 loss: tensor(0.0081, device='cuda:0')
batch 48 loss: tensor(0.0093, device='cuda:0')
batch 49 loss: tensor(0.0112, device='cuda:0')
batch 50 loss: tensor(0.0132, device='cuda:0')
batch 51 loss: tensor(0.0112, device='cuda:0')
batch 52 loss: tensor(0.0082, device='cuda:0')
batch 53 loss: tensor(0.0070, device='cuda:0')
batch 54 loss: tensor(0.0073, device='cuda:0')
batch 55 loss: tensor(0.0067, device='cuda:0')
batch 56 loss: tensor(0.0100, device='cuda:0')
batch 57 loss: tensor(0.0045, device='cuda:0')
batch 58 loss: tensor(0.0083, device='cuda:0')
batch 59 loss: tensor(0.0040, device='cuda:0')
batch 60 loss: tensor(0.0056, device='cuda:0')
batch 61 loss: tensor(0.0077, device='cuda:0')
batch 62 loss: tensor(0.0042, device='cuda:0')
batch 63 loss: tensor(0.0063, device='cuda:0')
batch 64 loss: tensor(0.0051, device='cuda:0')
batch 65 loss: tensor(0.0060, device='cuda:0')
batch 66 loss: tensor(0.0054, device='cuda:0')
batch 67 loss: tensor(0.0041, device='cuda:0')
batch 68 loss: tensor(0.0056, device='cuda:0')
batch 69 loss: tensor(0.0051, device='cuda:0')
batch 70 loss: tensor(0.0040, device='cuda:0')
batch 71 loss: tensor(0.0034, device='cuda:0')
batch 72 loss: tensor(0.0030, device='cuda:0')
batch 73 loss: tensor(0.0045, device='cuda:0')
batch 74 loss: tensor(0.0041, device='cuda:0')
batch 75 loss: tensor(0.0031, device='cuda:0')
batch 76 loss: tensor(0.0036, device='cuda:0')
batch 77 loss: tensor(0.0035, device='cuda:0')
batch 78 loss: tensor(0.0035, device='cuda:0')
batch 79 loss: tensor(0.0033, device='cuda:0')
batch 80 loss: tensor(0.0029, device='cuda:0')
batch 81 loss: tensor(0.0037, device='cuda:0')
batch 82 loss: tensor(0.0030, device='cuda:0')
batch 83 loss: tensor(0.0035, device='cuda:0')
batch 84 loss: tensor(0.0036, device='cuda:0')
batch 85 loss: tensor(0.0024, device='cuda:0')
batch 86 loss: tensor(0.0038, device='cuda:0')
batch 87 loss: tensor(0.0028, device='cuda:0')
batch 88 loss: tensor(0.0028, device='cuda:0')
batch 89 loss: tensor(0.0026, device='cuda:0')
batch 90 loss: tensor(0.0022, device='cuda:0')
batch 91 loss: tensor(0.0022, device='cuda:0')
batch 92 loss: tensor(0.0023, device='cuda:0')
batch 93 loss: tensor(0.0024, device='cuda:0')
batch 94 loss: tensor(0.0020, device='cuda:0')
batch 95 loss: tensor(0.0025, device='cuda:0')
batch 96 loss: tensor(0.0021, device='cuda:0')
batch 97 loss: tensor(0.0022, device='cuda:0')
batch 98 loss: tensor(0.0032, device='cuda:0')
batch 99 loss: tensor(0.0017, device='cuda:0')
batch 100 loss: tensor(0.0021, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(1.6402, device='cuda:0')
batch 2 loss: tensor(0.8790, device='cuda:0')
batch 3 loss: tensor(0.4825, device='cuda:0')
batch 4 loss: tensor(0.1913, device='cuda:0')
batch 5 loss: tensor(0.1346, device='cuda:0')
batch 6 loss: tensor(0.0805, device='cuda:0')
batch 7 loss: tensor(0.0549, device='cuda:0')
batch 8 loss: tensor(0.0320, device='cuda:0')
batch 9 loss: tensor(0.0370, device='cuda:0')
batch 10 loss: tensor(0.0395, device='cuda:0')
batch 11 loss: tensor(0.0230, device='cuda:0')
batch 12 loss: tensor(0.0248, device='cuda:0')
batch 13 loss: tensor(0.0173, device='cuda:0')
batch 14 loss: tensor(0.0190, device='cuda:0')
batch 15 loss: tensor(0.0217, device='cuda:0')
batch 16 loss: tensor(0.0112, device='cuda:0')
batch 17 loss: tensor(0.0231, device='cuda:0')
batch 18 loss: tensor(0.0182, device='cuda:0')
batch 19 loss: tensor(0.0120, device='cuda:0')
batch 20 loss: tensor(0.0128, device='cuda:0')
batch 21 loss: tensor(0.0198, device='cuda:0')
batch 22 loss: tensor(0.0102, device='cuda:0')
batch 23 loss: tensor(0.0117, device='cuda:0')
batch 24 loss: tensor(0.0159, device='cuda:0')
batch 25 loss: tensor(0.0128, device='cuda:0')
batch 26 loss: tensor(0.0095, device='cuda:0')
batch 27 loss: tensor(0.0176, device='cuda:0')
batch 28 loss: tensor(0.0138, device='cuda:0')
batch 29 loss: tensor(0.0087, device='cuda:0')
batch 30 loss: tensor(0.0129, device='cuda:0')
batch 31 loss: tensor(0.0129, device='cuda:0')
batch 32 loss: tensor(0.0145, device='cuda:0')
batch 33 loss: tensor(0.0112, device='cuda:0')
batch 34 loss: tensor(0.0096, device='cuda:0')
batch 35 loss: tensor(0.0120, device='cuda:0')
batch 36 loss: tensor(0.0090, device='cuda:0')
batch 37 loss: tensor(0.0092, device='cuda:0')
batch 38 loss: tensor(0.0083, device='cuda:0')
batch 39 loss: tensor(0.0068, device='cuda:0')
batch 40 loss: tensor(0.0118, device='cuda:0')
batch 41 loss: tensor(0.0049, device='cuda:0')
batch 42 loss: tensor(0.0077, device='cuda:0')
batch 43 loss: tensor(0.0076, device='cuda:0')
batch 44 loss: tensor(0.0097, device='cuda:0')
batch 45 loss: tensor(0.0045, device='cuda:0')
batch 46 loss: tensor(0.0093, device='cuda:0')
batch 47 loss: tensor(0.0067, device='cuda:0')
batch 48 loss: tensor(0.0070, device='cuda:0')
batch 49 loss: tensor(0.0082, device='cuda:0')
batch 50 loss: tensor(0.0080, device='cuda:0')
batch 51 loss: tensor(0.0072, device='cuda:0')
batch 52 loss: tensor(0.0060, device='cuda:0')
batch 53 loss: tensor(0.0071, device='cuda:0')
batch 54 loss: tensor(0.0085, device='cuda:0')
batch 55 loss: tensor(0.0058, device='cuda:0')
batch 56 loss: tensor(0.0039, device='cuda:0')
batch 57 loss: tensor(0.0087, device='cuda:0')
batch 58 loss: tensor(0.0065, device='cuda:0')
batch 59 loss: tensor(0.0062, device='cuda:0')
batch 60 loss: tensor(0.0052, device='cuda:0')
batch 61 loss: tensor(0.0085, device='cuda:0')
batch 62 loss: tensor(0.0053, device='cuda:0')
batch 63 loss: tensor(0.0057, device='cuda:0')
batch 64 loss: tensor(0.0084, device='cuda:0')
batch 65 loss: tensor(0.0060, device='cuda:0')
batch 66 loss: tensor(0.0045, device='cuda:0')
batch 67 loss: tensor(0.0043, device='cuda:0')
batch 68 loss: tensor(0.0038, device='cuda:0')
batch 69 loss: tensor(0.0041, device='cuda:0')
batch 70 loss: tensor(0.0050, device='cuda:0')
batch 71 loss: tensor(0.0053, device='cuda:0')
batch 72 loss: tensor(0.0053, device='cuda:0')
batch 73 loss: tensor(0.0046, device='cuda:0')
batch 74 loss: tensor(0.0051, device='cuda:0')
batch 75 loss: tensor(0.0037, device='cuda:0')
batch 76 loss: tensor(0.0076, device='cuda:0')
batch 77 loss: tensor(0.0048, device='cuda:0')
batch 78 loss: tensor(0.0048, device='cuda:0')
batch 79 loss: tensor(0.0052, device='cuda:0')
batch 80 loss: tensor(0.0032, device='cuda:0')
batch 81 loss: tensor(0.0056, device='cuda:0')
batch 82 loss: tensor(0.0066, device='cuda:0')
batch 83 loss: tensor(0.0020, device='cuda:0')
batch 84 loss: tensor(0.0031, device='cuda:0')
batch 85 loss: tensor(0.0066, device='cuda:0')
batch 86 loss: tensor(0.0050, device='cuda:0')
batch 87 loss: tensor(0.0047, device='cuda:0')
batch 88 loss: tensor(0.0041, device='cuda:0')
batch 89 loss: tensor(0.0017, device='cuda:0')
batch 90 loss: tensor(0.0034, device='cuda:0')
batch 91 loss: tensor(0.0053, device='cuda:0')
batch 92 loss: tensor(0.0033, device='cuda:0')
batch 93 loss: tensor(0.0056, device='cuda:0')
batch 94 loss: tensor(0.0043, device='cuda:0')
batch 95 loss: tensor(0.0024, device='cuda:0')
batch 96 loss: tensor(0.0078, device='cuda:0')
batch 97 loss: tensor(0.0031, device='cuda:0')
batch 98 loss: tensor(0.0022, device='cuda:0')
batch 99 loss: tensor(0.0028, device='cuda:0')
batch 100 loss: tensor(0.0049, device='cuda:0')
accuracy in val: 0.864
accuracy in test: 0.852
average epoch time: 0.005618101358413697
total time: 1.1236202716827393
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8230, device='cuda:0')
batch 2 loss: tensor(1.5156, device='cuda:0')
batch 3 loss: tensor(1.2471, device='cuda:0')
batch 4 loss: tensor(0.9959, device='cuda:0')
batch 5 loss: tensor(0.7977, device='cuda:0')
batch 6 loss: tensor(0.5878, device='cuda:0')
batch 7 loss: tensor(0.5079, device='cuda:0')
batch 8 loss: tensor(0.3763, device='cuda:0')
batch 9 loss: tensor(0.3065, device='cuda:0')
batch 10 loss: tensor(0.2303, device='cuda:0')
batch 11 loss: tensor(0.1763, device='cuda:0')
batch 12 loss: tensor(0.1733, device='cuda:0')
batch 13 loss: tensor(0.1132, device='cuda:0')
batch 14 loss: tensor(0.1107, device='cuda:0')
batch 15 loss: tensor(0.1011, device='cuda:0')
batch 16 loss: tensor(0.0821, device='cuda:0')
batch 17 loss: tensor(0.0677, device='cuda:0')
batch 18 loss: tensor(0.0706, device='cuda:0')
batch 19 loss: tensor(0.0530, device='cuda:0')
batch 20 loss: tensor(0.0407, device='cuda:0')
batch 21 loss: tensor(0.0464, device='cuda:0')
batch 22 loss: tensor(0.0426, device='cuda:0')
batch 23 loss: tensor(0.0460, device='cuda:0')
batch 24 loss: tensor(0.0304, device='cuda:0')
batch 25 loss: tensor(0.0328, device='cuda:0')
batch 26 loss: tensor(0.0290, device='cuda:0')
batch 27 loss: tensor(0.0268, device='cuda:0')
batch 28 loss: tensor(0.0349, device='cuda:0')
batch 29 loss: tensor(0.0220, device='cuda:0')
batch 30 loss: tensor(0.0187, device='cuda:0')
batch 31 loss: tensor(0.0160, device='cuda:0')
batch 32 loss: tensor(0.0191, device='cuda:0')
batch 33 loss: tensor(0.0166, device='cuda:0')
batch 34 loss: tensor(0.0175, device='cuda:0')
batch 35 loss: tensor(0.0192, device='cuda:0')
batch 36 loss: tensor(0.0199, device='cuda:0')
batch 37 loss: tensor(0.0148, device='cuda:0')
batch 38 loss: tensor(0.0099, device='cuda:0')
batch 39 loss: tensor(0.0130, device='cuda:0')
batch 40 loss: tensor(0.0149, device='cuda:0')
batch 41 loss: tensor(0.0121, device='cuda:0')
batch 42 loss: tensor(0.0113, device='cuda:0')
batch 43 loss: tensor(0.0104, device='cuda:0')
batch 44 loss: tensor(0.0123, device='cuda:0')
batch 45 loss: tensor(0.0115, device='cuda:0')
batch 46 loss: tensor(0.0096, device='cuda:0')
batch 47 loss: tensor(0.0076, device='cuda:0')
batch 48 loss: tensor(0.0109, device='cuda:0')
batch 49 loss: tensor(0.0069, device='cuda:0')
batch 50 loss: tensor(0.0095, device='cuda:0')
batch 51 loss: tensor(0.0062, device='cuda:0')
batch 52 loss: tensor(0.0094, device='cuda:0')
batch 53 loss: tensor(0.0076, device='cuda:0')
batch 54 loss: tensor(0.0068, device='cuda:0')
batch 55 loss: tensor(0.0066, device='cuda:0')
batch 56 loss: tensor(0.0073, device='cuda:0')
batch 57 loss: tensor(0.0055, device='cuda:0')
batch 58 loss: tensor(0.0073, device='cuda:0')
batch 59 loss: tensor(0.0050, device='cuda:0')
batch 60 loss: tensor(0.0060, device='cuda:0')
batch 61 loss: tensor(0.0058, device='cuda:0')
batch 62 loss: tensor(0.0065, device='cuda:0')
batch 63 loss: tensor(0.0043, device='cuda:0')
batch 64 loss: tensor(0.0038, device='cuda:0')
batch 65 loss: tensor(0.0060, device='cuda:0')
batch 66 loss: tensor(0.0054, device='cuda:0')
batch 67 loss: tensor(0.0048, device='cuda:0')
batch 68 loss: tensor(0.0045, device='cuda:0')
batch 69 loss: tensor(0.0043, device='cuda:0')
batch 70 loss: tensor(0.0028, device='cuda:0')
batch 71 loss: tensor(0.0046, device='cuda:0')
batch 72 loss: tensor(0.0047, device='cuda:0')
batch 73 loss: tensor(0.0040, device='cuda:0')
batch 74 loss: tensor(0.0040, device='cuda:0')
batch 75 loss: tensor(0.0035, device='cuda:0')
batch 76 loss: tensor(0.0035, device='cuda:0')
batch 77 loss: tensor(0.0047, device='cuda:0')
batch 78 loss: tensor(0.0033, device='cuda:0')
batch 79 loss: tensor(0.0033, device='cuda:0')
batch 80 loss: tensor(0.0027, device='cuda:0')
batch 81 loss: tensor(0.0029, device='cuda:0')
batch 82 loss: tensor(0.0030, device='cuda:0')
batch 83 loss: tensor(0.0029, device='cuda:0')
batch 84 loss: tensor(0.0033, device='cuda:0')
batch 85 loss: tensor(0.0041, device='cuda:0')
batch 86 loss: tensor(0.0028, device='cuda:0')
batch 87 loss: tensor(0.0019, device='cuda:0')
batch 88 loss: tensor(0.0021, device='cuda:0')
batch 89 loss: tensor(0.0029, device='cuda:0')
batch 90 loss: tensor(0.0026, device='cuda:0')
batch 91 loss: tensor(0.0026, device='cuda:0')
batch 92 loss: tensor(0.0022, device='cuda:0')
batch 93 loss: tensor(0.0018, device='cuda:0')
batch 94 loss: tensor(0.0021, device='cuda:0')
batch 95 loss: tensor(0.0023, device='cuda:0')
batch 96 loss: tensor(0.0028, device='cuda:0')
batch 97 loss: tensor(0.0022, device='cuda:0')
batch 98 loss: tensor(0.0024, device='cuda:0')
batch 99 loss: tensor(0.0028, device='cuda:0')
batch 100 loss: tensor(0.0023, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(3.7806, device='cuda:0')
batch 2 loss: tensor(1.5841, device='cuda:0')
batch 3 loss: tensor(0.6579, device='cuda:0')
batch 4 loss: tensor(0.2723, device='cuda:0')
batch 5 loss: tensor(0.1510, device='cuda:0')
batch 6 loss: tensor(0.0891, device='cuda:0')
batch 7 loss: tensor(0.0569, device='cuda:0')
batch 8 loss: tensor(0.0691, device='cuda:0')
batch 9 loss: tensor(0.0484, device='cuda:0')
batch 10 loss: tensor(0.0413, device='cuda:0')
batch 11 loss: tensor(0.0368, device='cuda:0')
batch 12 loss: tensor(0.0328, device='cuda:0')
batch 13 loss: tensor(0.0235, device='cuda:0')
batch 14 loss: tensor(0.0250, device='cuda:0')
batch 15 loss: tensor(0.0194, device='cuda:0')
batch 16 loss: tensor(0.0207, device='cuda:0')
batch 17 loss: tensor(0.0133, device='cuda:0')
batch 18 loss: tensor(0.0254, device='cuda:0')
batch 19 loss: tensor(0.0145, device='cuda:0')
batch 20 loss: tensor(0.0136, device='cuda:0')
batch 21 loss: tensor(0.0229, device='cuda:0')
batch 22 loss: tensor(0.0140, device='cuda:0')
batch 23 loss: tensor(0.0152, device='cuda:0')
batch 24 loss: tensor(0.0125, device='cuda:0')
batch 25 loss: tensor(0.0158, device='cuda:0')
batch 26 loss: tensor(0.0151, device='cuda:0')
batch 27 loss: tensor(0.0067, device='cuda:0')
batch 28 loss: tensor(0.0165, device='cuda:0')
batch 29 loss: tensor(0.0148, device='cuda:0')
batch 30 loss: tensor(0.0165, device='cuda:0')
batch 31 loss: tensor(0.0128, device='cuda:0')
batch 32 loss: tensor(0.0147, device='cuda:0')
batch 33 loss: tensor(0.0084, device='cuda:0')
batch 34 loss: tensor(0.0129, device='cuda:0')
batch 35 loss: tensor(0.0088, device='cuda:0')
batch 36 loss: tensor(0.0095, device='cuda:0')
batch 37 loss: tensor(0.0107, device='cuda:0')
batch 38 loss: tensor(0.0109, device='cuda:0')
batch 39 loss: tensor(0.0101, device='cuda:0')
batch 40 loss: tensor(0.0077, device='cuda:0')
batch 41 loss: tensor(0.0107, device='cuda:0')
batch 42 loss: tensor(0.0120, device='cuda:0')
batch 43 loss: tensor(0.0144, device='cuda:0')
batch 44 loss: tensor(0.0085, device='cuda:0')
batch 45 loss: tensor(0.0056, device='cuda:0')
batch 46 loss: tensor(0.0074, device='cuda:0')
batch 47 loss: tensor(0.0099, device='cuda:0')
batch 48 loss: tensor(0.0137, device='cuda:0')
batch 49 loss: tensor(0.0087, device='cuda:0')
batch 50 loss: tensor(0.0044, device='cuda:0')
batch 51 loss: tensor(0.0091, device='cuda:0')
batch 52 loss: tensor(0.0069, device='cuda:0')
batch 53 loss: tensor(0.0050, device='cuda:0')
batch 54 loss: tensor(0.0070, device='cuda:0')
batch 55 loss: tensor(0.0107, device='cuda:0')
batch 56 loss: tensor(0.0101, device='cuda:0')
batch 57 loss: tensor(0.0064, device='cuda:0')
batch 58 loss: tensor(0.0102, device='cuda:0')
batch 59 loss: tensor(0.0075, device='cuda:0')
batch 60 loss: tensor(0.0072, device='cuda:0')
batch 61 loss: tensor(0.0085, device='cuda:0')
batch 62 loss: tensor(0.0088, device='cuda:0')
batch 63 loss: tensor(0.0028, device='cuda:0')
batch 64 loss: tensor(0.0052, device='cuda:0')
batch 65 loss: tensor(0.0087, device='cuda:0')
batch 66 loss: tensor(0.0089, device='cuda:0')
batch 67 loss: tensor(0.0056, device='cuda:0')
batch 68 loss: tensor(0.0068, device='cuda:0')
batch 69 loss: tensor(0.0104, device='cuda:0')
batch 70 loss: tensor(0.0046, device='cuda:0')
batch 71 loss: tensor(0.0052, device='cuda:0')
batch 72 loss: tensor(0.0087, device='cuda:0')
batch 73 loss: tensor(0.0085, device='cuda:0')
batch 74 loss: tensor(0.0049, device='cuda:0')
batch 75 loss: tensor(0.0035, device='cuda:0')
batch 76 loss: tensor(0.0065, device='cuda:0')
batch 77 loss: tensor(0.0047, device='cuda:0')
batch 78 loss: tensor(0.0046, device='cuda:0')
batch 79 loss: tensor(0.0064, device='cuda:0')
batch 80 loss: tensor(0.0059, device='cuda:0')
batch 81 loss: tensor(0.0059, device='cuda:0')
batch 82 loss: tensor(0.0058, device='cuda:0')
batch 83 loss: tensor(0.0043, device='cuda:0')
batch 84 loss: tensor(0.0087, device='cuda:0')
batch 85 loss: tensor(0.0046, device='cuda:0')
batch 86 loss: tensor(0.0033, device='cuda:0')
batch 87 loss: tensor(0.0040, device='cuda:0')
batch 88 loss: tensor(0.0044, device='cuda:0')
batch 89 loss: tensor(0.0054, device='cuda:0')
batch 90 loss: tensor(0.0070, device='cuda:0')
batch 91 loss: tensor(0.0065, device='cuda:0')
batch 92 loss: tensor(0.0063, device='cuda:0')
batch 93 loss: tensor(0.0052, device='cuda:0')
batch 94 loss: tensor(0.0043, device='cuda:0')
batch 95 loss: tensor(0.0060, device='cuda:0')
batch 96 loss: tensor(0.0052, device='cuda:0')
batch 97 loss: tensor(0.0052, device='cuda:0')
batch 98 loss: tensor(0.0038, device='cuda:0')
batch 99 loss: tensor(0.0057, device='cuda:0')
batch 100 loss: tensor(0.0054, device='cuda:0')
accuracy in val: 0.8459999999999999
accuracy in test: 0.838
average epoch time: 0.004803764820098877
total time: 0.9607529640197754
Finished loading dataset.
{'node_num': 2708, 'feat_dim': 1433, 'class_num': 7, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.005, 'batch_size': 256, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.8382, device='cuda:0')
batch 2 loss: tensor(1.5633, device='cuda:0')
batch 3 loss: tensor(1.3226, device='cuda:0')
batch 4 loss: tensor(1.0475, device='cuda:0')
batch 5 loss: tensor(0.8406, device='cuda:0')
batch 6 loss: tensor(0.6472, device='cuda:0')
batch 7 loss: tensor(0.4720, device='cuda:0')
batch 8 loss: tensor(0.4059, device='cuda:0')
batch 9 loss: tensor(0.3435, device='cuda:0')
batch 10 loss: tensor(0.2693, device='cuda:0')
batch 11 loss: tensor(0.2400, device='cuda:0')
batch 12 loss: tensor(0.1991, device='cuda:0')
batch 13 loss: tensor(0.1224, device='cuda:0')
batch 14 loss: tensor(0.1192, device='cuda:0')
batch 15 loss: tensor(0.0951, device='cuda:0')
batch 16 loss: tensor(0.1121, device='cuda:0')
batch 17 loss: tensor(0.0796, device='cuda:0')
batch 18 loss: tensor(0.0782, device='cuda:0')
batch 19 loss: tensor(0.0583, device='cuda:0')
batch 20 loss: tensor(0.0475, device='cuda:0')
batch 21 loss: tensor(0.0609, device='cuda:0')
batch 22 loss: tensor(0.0509, device='cuda:0')
batch 23 loss: tensor(0.0318, device='cuda:0')
batch 24 loss: tensor(0.0395, device='cuda:0')
batch 25 loss: tensor(0.0406, device='cuda:0')
batch 26 loss: tensor(0.0284, device='cuda:0')
batch 27 loss: tensor(0.0197, device='cuda:0')
batch 28 loss: tensor(0.0292, device='cuda:0')
batch 29 loss: tensor(0.0239, device='cuda:0')
batch 30 loss: tensor(0.0262, device='cuda:0')
batch 31 loss: tensor(0.0207, device='cuda:0')
batch 32 loss: tensor(0.0266, device='cuda:0')
batch 33 loss: tensor(0.0295, device='cuda:0')
batch 34 loss: tensor(0.0154, device='cuda:0')
batch 35 loss: tensor(0.0205, device='cuda:0')
batch 36 loss: tensor(0.0188, device='cuda:0')
batch 37 loss: tensor(0.0155, device='cuda:0')
batch 38 loss: tensor(0.0145, device='cuda:0')
batch 39 loss: tensor(0.0154, device='cuda:0')
batch 40 loss: tensor(0.0125, device='cuda:0')
batch 41 loss: tensor(0.0112, device='cuda:0')
batch 42 loss: tensor(0.0175, device='cuda:0')
batch 43 loss: tensor(0.0144, device='cuda:0')
batch 44 loss: tensor(0.0143, device='cuda:0')
batch 45 loss: tensor(0.0075, device='cuda:0')
batch 46 loss: tensor(0.0111, device='cuda:0')
batch 47 loss: tensor(0.0105, device='cuda:0')
batch 48 loss: tensor(0.0080, device='cuda:0')
batch 49 loss: tensor(0.0124, device='cuda:0')
batch 50 loss: tensor(0.0086, device='cuda:0')
batch 51 loss: tensor(0.0086, device='cuda:0')
batch 52 loss: tensor(0.0082, device='cuda:0')
batch 53 loss: tensor(0.0095, device='cuda:0')
batch 54 loss: tensor(0.0082, device='cuda:0')
batch 55 loss: tensor(0.0061, device='cuda:0')
batch 56 loss: tensor(0.0074, device='cuda:0')
batch 57 loss: tensor(0.0076, device='cuda:0')
batch 58 loss: tensor(0.0062, device='cuda:0')
batch 59 loss: tensor(0.0062, device='cuda:0')
batch 60 loss: tensor(0.0063, device='cuda:0')
batch 61 loss: tensor(0.0050, device='cuda:0')
batch 62 loss: tensor(0.0057, device='cuda:0')
batch 63 loss: tensor(0.0044, device='cuda:0')
batch 64 loss: tensor(0.0055, device='cuda:0')
batch 65 loss: tensor(0.0051, device='cuda:0')
batch 66 loss: tensor(0.0043, device='cuda:0')
batch 67 loss: tensor(0.0050, device='cuda:0')
batch 68 loss: tensor(0.0043, device='cuda:0')
batch 69 loss: tensor(0.0040, device='cuda:0')
batch 70 loss: tensor(0.0058, device='cuda:0')
batch 71 loss: tensor(0.0045, device='cuda:0')
batch 72 loss: tensor(0.0046, device='cuda:0')
batch 73 loss: tensor(0.0055, device='cuda:0')
batch 74 loss: tensor(0.0036, device='cuda:0')
batch 75 loss: tensor(0.0043, device='cuda:0')
batch 76 loss: tensor(0.0043, device='cuda:0')
batch 77 loss: tensor(0.0039, device='cuda:0')
batch 78 loss: tensor(0.0052, device='cuda:0')
batch 79 loss: tensor(0.0044, device='cuda:0')
batch 80 loss: tensor(0.0030, device='cuda:0')
batch 81 loss: tensor(0.0046, device='cuda:0')
batch 82 loss: tensor(0.0035, device='cuda:0')
batch 83 loss: tensor(0.0030, device='cuda:0')
batch 84 loss: tensor(0.0023, device='cuda:0')
batch 85 loss: tensor(0.0034, device='cuda:0')
batch 86 loss: tensor(0.0027, device='cuda:0')
batch 87 loss: tensor(0.0029, device='cuda:0')
batch 88 loss: tensor(0.0032, device='cuda:0')
batch 89 loss: tensor(0.0027, device='cuda:0')
batch 90 loss: tensor(0.0029, device='cuda:0')
batch 91 loss: tensor(0.0033, device='cuda:0')
batch 92 loss: tensor(0.0025, device='cuda:0')
batch 93 loss: tensor(0.0028, device='cuda:0')
batch 94 loss: tensor(0.0029, device='cuda:0')
batch 95 loss: tensor(0.0022, device='cuda:0')
batch 96 loss: tensor(0.0025, device='cuda:0')
batch 97 loss: tensor(0.0027, device='cuda:0')
batch 98 loss: tensor(0.0020, device='cuda:0')
batch 99 loss: tensor(0.0023, device='cuda:0')
batch 100 loss: tensor(0.0024, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(2.5394, device='cuda:0')
batch 2 loss: tensor(1.4406, device='cuda:0')
batch 3 loss: tensor(0.6167, device='cuda:0')
batch 4 loss: tensor(0.2194, device='cuda:0')
batch 5 loss: tensor(0.1885, device='cuda:0')
batch 6 loss: tensor(0.0884, device='cuda:0')
batch 7 loss: tensor(0.0622, device='cuda:0')
batch 8 loss: tensor(0.0507, device='cuda:0')
batch 9 loss: tensor(0.0375, device='cuda:0')
batch 10 loss: tensor(0.0369, device='cuda:0')
batch 11 loss: tensor(0.0450, device='cuda:0')
batch 12 loss: tensor(0.0311, device='cuda:0')
batch 13 loss: tensor(0.0361, device='cuda:0')
batch 14 loss: tensor(0.0306, device='cuda:0')
batch 15 loss: tensor(0.0354, device='cuda:0')
batch 16 loss: tensor(0.0217, device='cuda:0')
batch 17 loss: tensor(0.0263, device='cuda:0')
batch 18 loss: tensor(0.0242, device='cuda:0')
batch 19 loss: tensor(0.0225, device='cuda:0')
batch 20 loss: tensor(0.0186, device='cuda:0')
batch 21 loss: tensor(0.0209, device='cuda:0')
batch 22 loss: tensor(0.0201, device='cuda:0')
batch 23 loss: tensor(0.0226, device='cuda:0')
batch 24 loss: tensor(0.0203, device='cuda:0')
batch 25 loss: tensor(0.0139, device='cuda:0')
batch 26 loss: tensor(0.0153, device='cuda:0')
batch 27 loss: tensor(0.0133, device='cuda:0')
batch 28 loss: tensor(0.0153, device='cuda:0')
batch 29 loss: tensor(0.0119, device='cuda:0')
batch 30 loss: tensor(0.0209, device='cuda:0')
batch 31 loss: tensor(0.0131, device='cuda:0')
batch 32 loss: tensor(0.0135, device='cuda:0')
batch 33 loss: tensor(0.0193, device='cuda:0')
batch 34 loss: tensor(0.0197, device='cuda:0')
batch 35 loss: tensor(0.0170, device='cuda:0')
batch 36 loss: tensor(0.0115, device='cuda:0')
batch 37 loss: tensor(0.0148, device='cuda:0')
batch 38 loss: tensor(0.0074, device='cuda:0')
batch 39 loss: tensor(0.0144, device='cuda:0')
batch 40 loss: tensor(0.0113, device='cuda:0')
batch 41 loss: tensor(0.0151, device='cuda:0')
batch 42 loss: tensor(0.0159, device='cuda:0')
batch 43 loss: tensor(0.0135, device='cuda:0')
batch 44 loss: tensor(0.0127, device='cuda:0')
batch 45 loss: tensor(0.0140, device='cuda:0')
batch 46 loss: tensor(0.0118, device='cuda:0')
batch 47 loss: tensor(0.0089, device='cuda:0')
batch 48 loss: tensor(0.0166, device='cuda:0')
batch 49 loss: tensor(0.0138, device='cuda:0')
batch 50 loss: tensor(0.0114, device='cuda:0')
batch 51 loss: tensor(0.0147, device='cuda:0')
batch 52 loss: tensor(0.0088, device='cuda:0')
batch 53 loss: tensor(0.0098, device='cuda:0')
batch 54 loss: tensor(0.0105, device='cuda:0')
batch 55 loss: tensor(0.0148, device='cuda:0')
batch 56 loss: tensor(0.0082, device='cuda:0')
batch 57 loss: tensor(0.0099, device='cuda:0')
batch 58 loss: tensor(0.0096, device='cuda:0')
batch 59 loss: tensor(0.0097, device='cuda:0')
batch 60 loss: tensor(0.0053, device='cuda:0')
batch 61 loss: tensor(0.0092, device='cuda:0')
batch 62 loss: tensor(0.0079, device='cuda:0')
batch 63 loss: tensor(0.0075, device='cuda:0')
batch 64 loss: tensor(0.0073, device='cuda:0')
batch 65 loss: tensor(0.0077, device='cuda:0')
batch 66 loss: tensor(0.0064, device='cuda:0')
batch 67 loss: tensor(0.0093, device='cuda:0')
batch 68 loss: tensor(0.0084, device='cuda:0')
batch 69 loss: tensor(0.0107, device='cuda:0')
batch 70 loss: tensor(0.0053, device='cuda:0')
batch 71 loss: tensor(0.0097, device='cuda:0')
batch 72 loss: tensor(0.0103, device='cuda:0')
batch 73 loss: tensor(0.0061, device='cuda:0')
batch 74 loss: tensor(0.0096, device='cuda:0')
batch 75 loss: tensor(0.0095, device='cuda:0')
batch 76 loss: tensor(0.0088, device='cuda:0')
batch 77 loss: tensor(0.0108, device='cuda:0')
batch 78 loss: tensor(0.0040, device='cuda:0')
batch 79 loss: tensor(0.0102, device='cuda:0')
batch 80 loss: tensor(0.0100, device='cuda:0')
batch 81 loss: tensor(0.0075, device='cuda:0')
batch 82 loss: tensor(0.0039, device='cuda:0')
batch 83 loss: tensor(0.0068, device='cuda:0')
batch 84 loss: tensor(0.0080, device='cuda:0')
batch 85 loss: tensor(0.0037, device='cuda:0')
batch 86 loss: tensor(0.0103, device='cuda:0')
batch 87 loss: tensor(0.0064, device='cuda:0')
batch 88 loss: tensor(0.0084, device='cuda:0')
batch 89 loss: tensor(0.0041, device='cuda:0')
batch 90 loss: tensor(0.0078, device='cuda:0')
batch 91 loss: tensor(0.0044, device='cuda:0')
batch 92 loss: tensor(0.0058, device='cuda:0')
batch 93 loss: tensor(0.0078, device='cuda:0')
batch 94 loss: tensor(0.0050, device='cuda:0')
batch 95 loss: tensor(0.0056, device='cuda:0')
batch 96 loss: tensor(0.0050, device='cuda:0')
batch 97 loss: tensor(0.0059, device='cuda:0')
batch 98 loss: tensor(0.0058, device='cuda:0')
batch 99 loss: tensor(0.0048, device='cuda:0')
batch 100 loss: tensor(0.0061, device='cuda:0')
accuracy in val: 0.858
accuracy in test: 0.831
average epoch time: 0.005673364400863647
total time: 1.1346728801727295

0.8404 1.0789838790893556
0.008101851640211644 0.13975461289628296
