Thu Nov 21 15:36:46 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   27C    P0    57W / 149W |    352MiB / 12206MiB |      8%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   27C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     27670      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:00 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   29C    P0    57W / 149W |    352MiB / 12206MiB |      9%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   27C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     27670      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:15 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   30C    P0    57W / 149W |    352MiB / 12206MiB |      7%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   27C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     27670      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:32 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   31C    P0    57W / 149W |    352MiB / 12206MiB |      5%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   28C    P8    29W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     27670      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:37:48 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   32C    P0    57W / 149W |    352MiB / 12206MiB |      9%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   29C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     27670      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:38:02 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   33C    P0    57W / 149W |    352MiB / 12206MiB |      7%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   29C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     27670      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:38:17 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   33C    P0    57W / 149W |    352MiB / 12206MiB |      9%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   30C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     27670      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:38:31 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    57W / 149W |    352MiB / 12206MiB |      8%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   30C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     27670      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:38:45 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    57W / 149W |    352MiB / 12206MiB |      9%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   31C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     27670      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:39:00 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    57W / 149W |    352MiB / 12206MiB |      5%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     27670      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
{'dataset': 'pubmed', 'config_file': 'pubmed.yaml', 'layer_num': 2, 'epoch_num': [60, 60]}
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0819, device='cuda:0')
batch 2 loss: tensor(1.0495, device='cuda:0')
batch 3 loss: tensor(1.0075, device='cuda:0')
batch 4 loss: tensor(0.9583, device='cuda:0')
batch 5 loss: tensor(0.9035, device='cuda:0')
batch 6 loss: tensor(0.8533, device='cuda:0')
batch 7 loss: tensor(0.7852, device='cuda:0')
batch 8 loss: tensor(0.7272, device='cuda:0')
batch 9 loss: tensor(0.6973, device='cuda:0')
batch 10 loss: tensor(0.6456, device='cuda:0')
batch 11 loss: tensor(0.6003, device='cuda:0')
batch 12 loss: tensor(0.5566, device='cuda:0')
batch 13 loss: tensor(0.5320, device='cuda:0')
batch 14 loss: tensor(0.5082, device='cuda:0')
batch 15 loss: tensor(0.5077, device='cuda:0')
batch 16 loss: tensor(0.4558, device='cuda:0')
batch 17 loss: tensor(0.4631, device='cuda:0')
batch 18 loss: tensor(0.4231, device='cuda:0')
batch 19 loss: tensor(0.3982, device='cuda:0')
batch 20 loss: tensor(0.4348, device='cuda:0')
batch 21 loss: tensor(0.4045, device='cuda:0')
batch 22 loss: tensor(0.3774, device='cuda:0')
batch 23 loss: tensor(0.3858, device='cuda:0')
batch 24 loss: tensor(0.3815, device='cuda:0')
batch 25 loss: tensor(0.3728, device='cuda:0')
batch 26 loss: tensor(0.3707, device='cuda:0')
batch 27 loss: tensor(0.3606, device='cuda:0')
batch 28 loss: tensor(0.3543, device='cuda:0')
batch 29 loss: tensor(0.3678, device='cuda:0')
batch 30 loss: tensor(0.3329, device='cuda:0')
batch 31 loss: tensor(0.3442, device='cuda:0')
batch 32 loss: tensor(0.3410, device='cuda:0')
batch 33 loss: tensor(0.3305, device='cuda:0')
batch 34 loss: tensor(0.3535, device='cuda:0')
batch 35 loss: tensor(0.3174, device='cuda:0')
batch 36 loss: tensor(0.3667, device='cuda:0')
batch 37 loss: tensor(0.3211, device='cuda:0')
batch 38 loss: tensor(0.3675, device='cuda:0')
batch 39 loss: tensor(0.3121, device='cuda:0')
batch 40 loss: tensor(0.3082, device='cuda:0')
batch 41 loss: tensor(0.3242, device='cuda:0')
batch 42 loss: tensor(0.3486, device='cuda:0')
batch 43 loss: tensor(0.2983, device='cuda:0')
batch 44 loss: tensor(0.3212, device='cuda:0')
batch 45 loss: tensor(0.3106, device='cuda:0')
batch 46 loss: tensor(0.3138, device='cuda:0')
batch 47 loss: tensor(0.2989, device='cuda:0')
batch 48 loss: tensor(0.3183, device='cuda:0')
batch 49 loss: tensor(0.2990, device='cuda:0')
batch 50 loss: tensor(0.3131, device='cuda:0')
batch 51 loss: tensor(0.3097, device='cuda:0')
batch 52 loss: tensor(0.2740, device='cuda:0')
batch 53 loss: tensor(0.2548, device='cuda:0')
batch 54 loss: tensor(0.2820, device='cuda:0')
batch 55 loss: tensor(0.2906, device='cuda:0')
batch 56 loss: tensor(0.2960, device='cuda:0')
batch 57 loss: tensor(0.2701, device='cuda:0')
batch 58 loss: tensor(0.2915, device='cuda:0')
batch 59 loss: tensor(0.2895, device='cuda:0')
batch 60 loss: tensor(0.3126, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.8883, device='cuda:0')
batch 2 loss: tensor(0.6157, device='cuda:0')
batch 3 loss: tensor(0.4561, device='cuda:0')
batch 4 loss: tensor(0.3727, device='cuda:0')
batch 5 loss: tensor(0.3401, device='cuda:0')
batch 6 loss: tensor(0.3256, device='cuda:0')
batch 7 loss: tensor(0.3267, device='cuda:0')
batch 8 loss: tensor(0.2905, device='cuda:0')
batch 9 loss: tensor(0.3099, device='cuda:0')
batch 10 loss: tensor(0.3120, device='cuda:0')
batch 11 loss: tensor(0.3131, device='cuda:0')
batch 12 loss: tensor(0.2814, device='cuda:0')
batch 13 loss: tensor(0.2984, device='cuda:0')
batch 14 loss: tensor(0.3093, device='cuda:0')
batch 15 loss: tensor(0.2507, device='cuda:0')
batch 16 loss: tensor(0.2931, device='cuda:0')
batch 17 loss: tensor(0.2931, device='cuda:0')
batch 18 loss: tensor(0.2620, device='cuda:0')
batch 19 loss: tensor(0.2758, device='cuda:0')
batch 20 loss: tensor(0.2711, device='cuda:0')
batch 21 loss: tensor(0.3173, device='cuda:0')
batch 22 loss: tensor(0.2764, device='cuda:0')
batch 23 loss: tensor(0.2664, device='cuda:0')
batch 24 loss: tensor(0.3188, device='cuda:0')
batch 25 loss: tensor(0.2796, device='cuda:0')
batch 26 loss: tensor(0.2913, device='cuda:0')
batch 27 loss: tensor(0.2953, device='cuda:0')
batch 28 loss: tensor(0.2433, device='cuda:0')
batch 29 loss: tensor(0.2905, device='cuda:0')
batch 30 loss: tensor(0.3095, device='cuda:0')
batch 31 loss: tensor(0.3173, device='cuda:0')
batch 32 loss: tensor(0.3278, device='cuda:0')
batch 33 loss: tensor(0.2759, device='cuda:0')
batch 34 loss: tensor(0.2686, device='cuda:0')
batch 35 loss: tensor(0.2825, device='cuda:0')
batch 36 loss: tensor(0.3041, device='cuda:0')
batch 37 loss: tensor(0.3178, device='cuda:0')
batch 38 loss: tensor(0.3159, device='cuda:0')
batch 39 loss: tensor(0.2773, device='cuda:0')
batch 40 loss: tensor(0.2870, device='cuda:0')
batch 41 loss: tensor(0.3023, device='cuda:0')
batch 42 loss: tensor(0.3007, device='cuda:0')
batch 43 loss: tensor(0.2658, device='cuda:0')
batch 44 loss: tensor(0.2619, device='cuda:0')
batch 45 loss: tensor(0.2796, device='cuda:0')
batch 46 loss: tensor(0.3126, device='cuda:0')
batch 47 loss: tensor(0.3054, device='cuda:0')
batch 48 loss: tensor(0.2576, device='cuda:0')
batch 49 loss: tensor(0.3079, device='cuda:0')
batch 50 loss: tensor(0.2971, device='cuda:0')
batch 51 loss: tensor(0.2986, device='cuda:0')
batch 52 loss: tensor(0.2928, device='cuda:0')
batch 53 loss: tensor(0.3020, device='cuda:0')
batch 54 loss: tensor(0.2730, device='cuda:0')
batch 55 loss: tensor(0.3233, device='cuda:0')
batch 56 loss: tensor(0.2754, device='cuda:0')
batch 57 loss: tensor(0.2976, device='cuda:0')
batch 58 loss: tensor(0.2628, device='cuda:0')
batch 59 loss: tensor(0.2707, device='cuda:0')
batch 60 loss: tensor(0.2734, device='cuda:0')
accuracy in val: 0.886
accuracy in test: 0.885
average epoch time: 0.02310228943824768
total time: 2.7722747325897217
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0793, device='cuda:0')
batch 2 loss: tensor(1.0438, device='cuda:0')
batch 3 loss: tensor(1.0018, device='cuda:0')
batch 4 loss: tensor(0.9453, device='cuda:0')
batch 5 loss: tensor(0.8920, device='cuda:0')
batch 6 loss: tensor(0.8421, device='cuda:0')
batch 7 loss: tensor(0.7834, device='cuda:0')
batch 8 loss: tensor(0.7257, device='cuda:0')
batch 9 loss: tensor(0.6848, device='cuda:0')
batch 10 loss: tensor(0.6363, device='cuda:0')
batch 11 loss: tensor(0.5750, device='cuda:0')
batch 12 loss: tensor(0.5883, device='cuda:0')
batch 13 loss: tensor(0.5523, device='cuda:0')
batch 14 loss: tensor(0.4898, device='cuda:0')
batch 15 loss: tensor(0.4902, device='cuda:0')
batch 16 loss: tensor(0.4877, device='cuda:0')
batch 17 loss: tensor(0.4564, device='cuda:0')
batch 18 loss: tensor(0.4447, device='cuda:0')
batch 19 loss: tensor(0.3997, device='cuda:0')
batch 20 loss: tensor(0.4137, device='cuda:0')
batch 21 loss: tensor(0.3915, device='cuda:0')
batch 22 loss: tensor(0.3952, device='cuda:0')
batch 23 loss: tensor(0.3929, device='cuda:0')
batch 24 loss: tensor(0.3739, device='cuda:0')
batch 25 loss: tensor(0.3588, device='cuda:0')
batch 26 loss: tensor(0.3567, device='cuda:0')
batch 27 loss: tensor(0.3709, device='cuda:0')
batch 28 loss: tensor(0.3533, device='cuda:0')
batch 29 loss: tensor(0.3232, device='cuda:0')
batch 30 loss: tensor(0.3610, device='cuda:0')
batch 31 loss: tensor(0.3416, device='cuda:0')
batch 32 loss: tensor(0.3199, device='cuda:0')
batch 33 loss: tensor(0.3400, device='cuda:0')
batch 34 loss: tensor(0.3521, device='cuda:0')
batch 35 loss: tensor(0.3303, device='cuda:0')
batch 36 loss: tensor(0.3128, device='cuda:0')
batch 37 loss: tensor(0.3230, device='cuda:0')
batch 38 loss: tensor(0.3325, device='cuda:0')
batch 39 loss: tensor(0.3378, device='cuda:0')
batch 40 loss: tensor(0.3081, device='cuda:0')
batch 41 loss: tensor(0.3223, device='cuda:0')
batch 42 loss: tensor(0.3304, device='cuda:0')
batch 43 loss: tensor(0.3091, device='cuda:0')
batch 44 loss: tensor(0.2929, device='cuda:0')
batch 45 loss: tensor(0.3139, device='cuda:0')
batch 46 loss: tensor(0.3182, device='cuda:0')
batch 47 loss: tensor(0.3037, device='cuda:0')
batch 48 loss: tensor(0.3228, device='cuda:0')
batch 49 loss: tensor(0.2954, device='cuda:0')
batch 50 loss: tensor(0.2862, device='cuda:0')
batch 51 loss: tensor(0.3008, device='cuda:0')
batch 52 loss: tensor(0.2894, device='cuda:0')
batch 53 loss: tensor(0.2922, device='cuda:0')
batch 54 loss: tensor(0.3107, device='cuda:0')
batch 55 loss: tensor(0.2864, device='cuda:0')
batch 56 loss: tensor(0.3280, device='cuda:0')
batch 57 loss: tensor(0.2826, device='cuda:0')
batch 58 loss: tensor(0.3051, device='cuda:0')
batch 59 loss: tensor(0.2590, device='cuda:0')
batch 60 loss: tensor(0.2969, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.8548, device='cuda:0')
batch 2 loss: tensor(0.6231, device='cuda:0')
batch 3 loss: tensor(0.4808, device='cuda:0')
batch 4 loss: tensor(0.3776, device='cuda:0')
batch 5 loss: tensor(0.3578, device='cuda:0')
batch 6 loss: tensor(0.3313, device='cuda:0')
batch 7 loss: tensor(0.3076, device='cuda:0')
batch 8 loss: tensor(0.3009, device='cuda:0')
batch 9 loss: tensor(0.3489, device='cuda:0')
batch 10 loss: tensor(0.3678, device='cuda:0')
batch 11 loss: tensor(0.3044, device='cuda:0')
batch 12 loss: tensor(0.3223, device='cuda:0')
batch 13 loss: tensor(0.2664, device='cuda:0')
batch 14 loss: tensor(0.3598, device='cuda:0')
batch 15 loss: tensor(0.3214, device='cuda:0')
batch 16 loss: tensor(0.2850, device='cuda:0')
batch 17 loss: tensor(0.3011, device='cuda:0')
batch 18 loss: tensor(0.3080, device='cuda:0')
batch 19 loss: tensor(0.2863, device='cuda:0')
batch 20 loss: tensor(0.2560, device='cuda:0')
batch 21 loss: tensor(0.2967, device='cuda:0')
batch 22 loss: tensor(0.2932, device='cuda:0')
batch 23 loss: tensor(0.3486, device='cuda:0')
batch 24 loss: tensor(0.2829, device='cuda:0')
batch 25 loss: tensor(0.2905, device='cuda:0')
batch 26 loss: tensor(0.3244, device='cuda:0')
batch 27 loss: tensor(0.2778, device='cuda:0')
batch 28 loss: tensor(0.2901, device='cuda:0')
batch 29 loss: tensor(0.2900, device='cuda:0')
batch 30 loss: tensor(0.3032, device='cuda:0')
batch 31 loss: tensor(0.2722, device='cuda:0')
batch 32 loss: tensor(0.2800, device='cuda:0')
batch 33 loss: tensor(0.3109, device='cuda:0')
batch 34 loss: tensor(0.2784, device='cuda:0')
batch 35 loss: tensor(0.3101, device='cuda:0')
batch 36 loss: tensor(0.2676, device='cuda:0')
batch 37 loss: tensor(0.2771, device='cuda:0')
batch 38 loss: tensor(0.2913, device='cuda:0')
batch 39 loss: tensor(0.3232, device='cuda:0')
batch 40 loss: tensor(0.2947, device='cuda:0')
batch 41 loss: tensor(0.3225, device='cuda:0')
batch 42 loss: tensor(0.3035, device='cuda:0')
batch 43 loss: tensor(0.2998, device='cuda:0')
batch 44 loss: tensor(0.3093, device='cuda:0')
batch 45 loss: tensor(0.2716, device='cuda:0')
batch 46 loss: tensor(0.2710, device='cuda:0')
batch 47 loss: tensor(0.2797, device='cuda:0')
batch 48 loss: tensor(0.3287, device='cuda:0')
batch 49 loss: tensor(0.3057, device='cuda:0')
batch 50 loss: tensor(0.2967, device='cuda:0')
batch 51 loss: tensor(0.2695, device='cuda:0')
batch 52 loss: tensor(0.2778, device='cuda:0')
batch 53 loss: tensor(0.2888, device='cuda:0')
batch 54 loss: tensor(0.2906, device='cuda:0')
batch 55 loss: tensor(0.2928, device='cuda:0')
batch 56 loss: tensor(0.2478, device='cuda:0')
batch 57 loss: tensor(0.2763, device='cuda:0')
batch 58 loss: tensor(0.3024, device='cuda:0')
batch 59 loss: tensor(0.2861, device='cuda:0')
batch 60 loss: tensor(0.3290, device='cuda:0')
accuracy in val: 0.888
accuracy in test: 0.888
average epoch time: 0.02560932238896688
total time: 3.0731186866760254
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0746, device='cuda:0')
batch 2 loss: tensor(1.0377, device='cuda:0')
batch 3 loss: tensor(0.9947, device='cuda:0')
batch 4 loss: tensor(0.9535, device='cuda:0')
batch 5 loss: tensor(0.8987, device='cuda:0')
batch 6 loss: tensor(0.8621, device='cuda:0')
batch 7 loss: tensor(0.8099, device='cuda:0')
batch 8 loss: tensor(0.7575, device='cuda:0')
batch 9 loss: tensor(0.7018, device='cuda:0')
batch 10 loss: tensor(0.6684, device='cuda:0')
batch 11 loss: tensor(0.5964, device='cuda:0')
batch 12 loss: tensor(0.6061, device='cuda:0')
batch 13 loss: tensor(0.5547, device='cuda:0')
batch 14 loss: tensor(0.5240, device='cuda:0')
batch 15 loss: tensor(0.4726, device='cuda:0')
batch 16 loss: tensor(0.4670, device='cuda:0')
batch 17 loss: tensor(0.4485, device='cuda:0')
batch 18 loss: tensor(0.4465, device='cuda:0')
batch 19 loss: tensor(0.4318, device='cuda:0')
batch 20 loss: tensor(0.4077, device='cuda:0')
batch 21 loss: tensor(0.4380, device='cuda:0')
batch 22 loss: tensor(0.3869, device='cuda:0')
batch 23 loss: tensor(0.3799, device='cuda:0')
batch 24 loss: tensor(0.3804, device='cuda:0')
batch 25 loss: tensor(0.3621, device='cuda:0')
batch 26 loss: tensor(0.3932, device='cuda:0')
batch 27 loss: tensor(0.3747, device='cuda:0')
batch 28 loss: tensor(0.3498, device='cuda:0')
batch 29 loss: tensor(0.3560, device='cuda:0')
batch 30 loss: tensor(0.3577, device='cuda:0')
batch 31 loss: tensor(0.3315, device='cuda:0')
batch 32 loss: tensor(0.3313, device='cuda:0')
batch 33 loss: tensor(0.3572, device='cuda:0')
batch 34 loss: tensor(0.3453, device='cuda:0')
batch 35 loss: tensor(0.3202, device='cuda:0')
batch 36 loss: tensor(0.3303, device='cuda:0')
batch 37 loss: tensor(0.3093, device='cuda:0')
batch 38 loss: tensor(0.3400, device='cuda:0')
batch 39 loss: tensor(0.3288, device='cuda:0')
batch 40 loss: tensor(0.3318, device='cuda:0')
batch 41 loss: tensor(0.3165, device='cuda:0')
batch 42 loss: tensor(0.2983, device='cuda:0')
batch 43 loss: tensor(0.3390, device='cuda:0')
batch 44 loss: tensor(0.3257, device='cuda:0')
batch 45 loss: tensor(0.3112, device='cuda:0')
batch 46 loss: tensor(0.2977, device='cuda:0')
batch 47 loss: tensor(0.3281, device='cuda:0')
batch 48 loss: tensor(0.3046, device='cuda:0')
batch 49 loss: tensor(0.2984, device='cuda:0')
batch 50 loss: tensor(0.2982, device='cuda:0')
batch 51 loss: tensor(0.3145, device='cuda:0')
batch 52 loss: tensor(0.2790, device='cuda:0')
batch 53 loss: tensor(0.3035, device='cuda:0')
batch 54 loss: tensor(0.2816, device='cuda:0')
batch 55 loss: tensor(0.3027, device='cuda:0')
batch 56 loss: tensor(0.2781, device='cuda:0')
batch 57 loss: tensor(0.2861, device='cuda:0')
batch 58 loss: tensor(0.3055, device='cuda:0')
batch 59 loss: tensor(0.3218, device='cuda:0')
batch 60 loss: tensor(0.2970, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.9640, device='cuda:0')
batch 2 loss: tensor(0.5465, device='cuda:0')
batch 3 loss: tensor(0.4327, device='cuda:0')
batch 4 loss: tensor(0.3526, device='cuda:0')
batch 5 loss: tensor(0.3214, device='cuda:0')
batch 6 loss: tensor(0.3554, device='cuda:0')
batch 7 loss: tensor(0.2987, device='cuda:0')
batch 8 loss: tensor(0.3378, device='cuda:0')
batch 9 loss: tensor(0.3068, device='cuda:0')
batch 10 loss: tensor(0.2956, device='cuda:0')
batch 11 loss: tensor(0.2930, device='cuda:0')
batch 12 loss: tensor(0.3083, device='cuda:0')
batch 13 loss: tensor(0.2737, device='cuda:0')
batch 14 loss: tensor(0.2998, device='cuda:0')
batch 15 loss: tensor(0.2914, device='cuda:0')
batch 16 loss: tensor(0.2449, device='cuda:0')
batch 17 loss: tensor(0.2831, device='cuda:0')
batch 18 loss: tensor(0.3012, device='cuda:0')
batch 19 loss: tensor(0.2780, device='cuda:0')
batch 20 loss: tensor(0.2666, device='cuda:0')
batch 21 loss: tensor(0.2733, device='cuda:0')
batch 22 loss: tensor(0.2986, device='cuda:0')
batch 23 loss: tensor(0.2707, device='cuda:0')
batch 24 loss: tensor(0.2707, device='cuda:0')
batch 25 loss: tensor(0.2919, device='cuda:0')
batch 26 loss: tensor(0.3360, device='cuda:0')
batch 27 loss: tensor(0.2895, device='cuda:0')
batch 28 loss: tensor(0.2775, device='cuda:0')
batch 29 loss: tensor(0.2968, device='cuda:0')
batch 30 loss: tensor(0.2697, device='cuda:0')
batch 31 loss: tensor(0.3107, device='cuda:0')
batch 32 loss: tensor(0.2722, device='cuda:0')
batch 33 loss: tensor(0.3039, device='cuda:0')
batch 34 loss: tensor(0.3077, device='cuda:0')
batch 35 loss: tensor(0.2876, device='cuda:0')
batch 36 loss: tensor(0.3010, device='cuda:0')
batch 37 loss: tensor(0.2672, device='cuda:0')
batch 38 loss: tensor(0.2857, device='cuda:0')
batch 39 loss: tensor(0.2787, device='cuda:0')
batch 40 loss: tensor(0.2934, device='cuda:0')
batch 41 loss: tensor(0.2972, device='cuda:0')
batch 42 loss: tensor(0.2791, device='cuda:0')
batch 43 loss: tensor(0.3062, device='cuda:0')
batch 44 loss: tensor(0.2962, device='cuda:0')
batch 45 loss: tensor(0.3051, device='cuda:0')
batch 46 loss: tensor(0.3150, device='cuda:0')
batch 47 loss: tensor(0.3066, device='cuda:0')
batch 48 loss: tensor(0.2823, device='cuda:0')
batch 49 loss: tensor(0.2685, device='cuda:0')
batch 50 loss: tensor(0.2983, device='cuda:0')
batch 51 loss: tensor(0.2772, device='cuda:0')
batch 52 loss: tensor(0.2911, device='cuda:0')
batch 53 loss: tensor(0.2818, device='cuda:0')
batch 54 loss: tensor(0.3096, device='cuda:0')
batch 55 loss: tensor(0.2435, device='cuda:0')
batch 56 loss: tensor(0.2735, device='cuda:0')
batch 57 loss: tensor(0.2688, device='cuda:0')
batch 58 loss: tensor(0.2901, device='cuda:0')
batch 59 loss: tensor(0.2828, device='cuda:0')
batch 60 loss: tensor(0.3144, device='cuda:0')
accuracy in val: 0.894
accuracy in test: 0.893
average epoch time: 0.022668466965357462
total time: 2.7202160358428955
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0788, device='cuda:0')
batch 2 loss: tensor(1.0474, device='cuda:0')
batch 3 loss: tensor(1.0030, device='cuda:0')
batch 4 loss: tensor(0.9523, device='cuda:0')
batch 5 loss: tensor(0.8963, device='cuda:0')
batch 6 loss: tensor(0.8390, device='cuda:0')
batch 7 loss: tensor(0.7707, device='cuda:0')
batch 8 loss: tensor(0.7337, device='cuda:0')
batch 9 loss: tensor(0.6692, device='cuda:0')
batch 10 loss: tensor(0.6256, device='cuda:0')
batch 11 loss: tensor(0.5596, device='cuda:0')
batch 12 loss: tensor(0.5397, device='cuda:0')
batch 13 loss: tensor(0.5222, device='cuda:0')
batch 14 loss: tensor(0.4837, device='cuda:0')
batch 15 loss: tensor(0.4871, device='cuda:0')
batch 16 loss: tensor(0.4662, device='cuda:0')
batch 17 loss: tensor(0.4061, device='cuda:0')
batch 18 loss: tensor(0.4180, device='cuda:0')
batch 19 loss: tensor(0.4090, device='cuda:0')
batch 20 loss: tensor(0.3853, device='cuda:0')
batch 21 loss: tensor(0.3907, device='cuda:0')
batch 22 loss: tensor(0.3824, device='cuda:0')
batch 23 loss: tensor(0.3808, device='cuda:0')
batch 24 loss: tensor(0.3833, device='cuda:0')
batch 25 loss: tensor(0.3480, device='cuda:0')
batch 26 loss: tensor(0.3643, device='cuda:0')
batch 27 loss: tensor(0.3326, device='cuda:0')
batch 28 loss: tensor(0.3360, device='cuda:0')
batch 29 loss: tensor(0.3412, device='cuda:0')
batch 30 loss: tensor(0.3571, device='cuda:0')
batch 31 loss: tensor(0.3601, device='cuda:0')
batch 32 loss: tensor(0.3671, device='cuda:0')
batch 33 loss: tensor(0.3207, device='cuda:0')
batch 34 loss: tensor(0.3296, device='cuda:0')
batch 35 loss: tensor(0.3093, device='cuda:0')
batch 36 loss: tensor(0.3146, device='cuda:0')
batch 37 loss: tensor(0.3555, device='cuda:0')
batch 38 loss: tensor(0.3230, device='cuda:0')
batch 39 loss: tensor(0.2998, device='cuda:0')
batch 40 loss: tensor(0.3165, device='cuda:0')
batch 41 loss: tensor(0.3288, device='cuda:0')
batch 42 loss: tensor(0.3042, device='cuda:0')
batch 43 loss: tensor(0.3615, device='cuda:0')
batch 44 loss: tensor(0.3169, device='cuda:0')
batch 45 loss: tensor(0.2965, device='cuda:0')
batch 46 loss: tensor(0.3031, device='cuda:0')
batch 47 loss: tensor(0.2977, device='cuda:0')
batch 48 loss: tensor(0.3325, device='cuda:0')
batch 49 loss: tensor(0.3089, device='cuda:0')
batch 50 loss: tensor(0.2933, device='cuda:0')
batch 51 loss: tensor(0.3074, device='cuda:0')
batch 52 loss: tensor(0.2690, device='cuda:0')
batch 53 loss: tensor(0.2661, device='cuda:0')
batch 54 loss: tensor(0.2909, device='cuda:0')
batch 55 loss: tensor(0.2859, device='cuda:0')
batch 56 loss: tensor(0.2826, device='cuda:0')
batch 57 loss: tensor(0.2880, device='cuda:0')
batch 58 loss: tensor(0.2665, device='cuda:0')
batch 59 loss: tensor(0.2715, device='cuda:0')
batch 60 loss: tensor(0.2703, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.8993, device='cuda:0')
batch 2 loss: tensor(0.5301, device='cuda:0')
batch 3 loss: tensor(0.3885, device='cuda:0')
batch 4 loss: tensor(0.3525, device='cuda:0')
batch 5 loss: tensor(0.3236, device='cuda:0')
batch 6 loss: tensor(0.3013, device='cuda:0')
batch 7 loss: tensor(0.2939, device='cuda:0')
batch 8 loss: tensor(0.2962, device='cuda:0')
batch 9 loss: tensor(0.2832, device='cuda:0')
batch 10 loss: tensor(0.2686, device='cuda:0')
batch 11 loss: tensor(0.2733, device='cuda:0')
batch 12 loss: tensor(0.2817, device='cuda:0')
batch 13 loss: tensor(0.2844, device='cuda:0')
batch 14 loss: tensor(0.2919, device='cuda:0')
batch 15 loss: tensor(0.3127, device='cuda:0')
batch 16 loss: tensor(0.2962, device='cuda:0')
batch 17 loss: tensor(0.2885, device='cuda:0')
batch 18 loss: tensor(0.2990, device='cuda:0')
batch 19 loss: tensor(0.2957, device='cuda:0')
batch 20 loss: tensor(0.2988, device='cuda:0')
batch 21 loss: tensor(0.3022, device='cuda:0')
batch 22 loss: tensor(0.2731, device='cuda:0')
batch 23 loss: tensor(0.2981, device='cuda:0')
batch 24 loss: tensor(0.2705, device='cuda:0')
batch 25 loss: tensor(0.3062, device='cuda:0')
batch 26 loss: tensor(0.3424, device='cuda:0')
batch 27 loss: tensor(0.2686, device='cuda:0')
batch 28 loss: tensor(0.2858, device='cuda:0')
batch 29 loss: tensor(0.2944, device='cuda:0')
batch 30 loss: tensor(0.2528, device='cuda:0')
batch 31 loss: tensor(0.2692, device='cuda:0')
batch 32 loss: tensor(0.2844, device='cuda:0')
batch 33 loss: tensor(0.3199, device='cuda:0')
batch 34 loss: tensor(0.2852, device='cuda:0')
batch 35 loss: tensor(0.2722, device='cuda:0')
batch 36 loss: tensor(0.2999, device='cuda:0')
batch 37 loss: tensor(0.2860, device='cuda:0')
batch 38 loss: tensor(0.2704, device='cuda:0')
batch 39 loss: tensor(0.2965, device='cuda:0')
batch 40 loss: tensor(0.2893, device='cuda:0')
batch 41 loss: tensor(0.3187, device='cuda:0')
batch 42 loss: tensor(0.2729, device='cuda:0')
batch 43 loss: tensor(0.2777, device='cuda:0')
batch 44 loss: tensor(0.2736, device='cuda:0')
batch 45 loss: tensor(0.2665, device='cuda:0')
batch 46 loss: tensor(0.3040, device='cuda:0')
batch 47 loss: tensor(0.2811, device='cuda:0')
batch 48 loss: tensor(0.2790, device='cuda:0')
batch 49 loss: tensor(0.3069, device='cuda:0')
batch 50 loss: tensor(0.2922, device='cuda:0')
batch 51 loss: tensor(0.2915, device='cuda:0')
batch 52 loss: tensor(0.2877, device='cuda:0')
batch 53 loss: tensor(0.3092, device='cuda:0')
batch 54 loss: tensor(0.3062, device='cuda:0')
batch 55 loss: tensor(0.3013, device='cuda:0')
batch 56 loss: tensor(0.2895, device='cuda:0')
batch 57 loss: tensor(0.2799, device='cuda:0')
batch 58 loss: tensor(0.2961, device='cuda:0')
batch 59 loss: tensor(0.2928, device='cuda:0')
batch 60 loss: tensor(0.2457, device='cuda:0')
accuracy in val: 0.8960000000000001
accuracy in test: 0.894
average epoch time: 0.026261929670969644
total time: 3.1514315605163574
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0714, device='cuda:0')
batch 2 loss: tensor(1.0325, device='cuda:0')
batch 3 loss: tensor(0.9811, device='cuda:0')
batch 4 loss: tensor(0.9333, device='cuda:0')
batch 5 loss: tensor(0.8741, device='cuda:0')
batch 6 loss: tensor(0.8170, device='cuda:0')
batch 7 loss: tensor(0.7578, device='cuda:0')
batch 8 loss: tensor(0.6885, device='cuda:0')
batch 9 loss: tensor(0.6554, device='cuda:0')
batch 10 loss: tensor(0.6177, device='cuda:0')
batch 11 loss: tensor(0.5605, device='cuda:0')
batch 12 loss: tensor(0.5399, device='cuda:0')
batch 13 loss: tensor(0.5024, device='cuda:0')
batch 14 loss: tensor(0.4780, device='cuda:0')
batch 15 loss: tensor(0.4694, device='cuda:0')
batch 16 loss: tensor(0.4525, device='cuda:0')
batch 17 loss: tensor(0.4270, device='cuda:0')
batch 18 loss: tensor(0.4089, device='cuda:0')
batch 19 loss: tensor(0.4023, device='cuda:0')
batch 20 loss: tensor(0.4091, device='cuda:0')
batch 21 loss: tensor(0.3910, device='cuda:0')
batch 22 loss: tensor(0.3838, device='cuda:0')
batch 23 loss: tensor(0.3706, device='cuda:0')
batch 24 loss: tensor(0.3708, device='cuda:0')
batch 25 loss: tensor(0.3418, device='cuda:0')
batch 26 loss: tensor(0.3764, device='cuda:0')
batch 27 loss: tensor(0.3719, device='cuda:0')
batch 28 loss: tensor(0.3243, device='cuda:0')
batch 29 loss: tensor(0.3651, device='cuda:0')
batch 30 loss: tensor(0.3721, device='cuda:0')
batch 31 loss: tensor(0.3450, device='cuda:0')
batch 32 loss: tensor(0.3153, device='cuda:0')
batch 33 loss: tensor(0.3091, device='cuda:0')
batch 34 loss: tensor(0.3305, device='cuda:0')
batch 35 loss: tensor(0.3512, device='cuda:0')
batch 36 loss: tensor(0.3123, device='cuda:0')
batch 37 loss: tensor(0.3361, device='cuda:0')
batch 38 loss: tensor(0.3171, device='cuda:0')
batch 39 loss: tensor(0.3127, device='cuda:0')
batch 40 loss: tensor(0.3123, device='cuda:0')
batch 41 loss: tensor(0.3283, device='cuda:0')
batch 42 loss: tensor(0.2965, device='cuda:0')
batch 43 loss: tensor(0.2901, device='cuda:0')
batch 44 loss: tensor(0.3342, device='cuda:0')
batch 45 loss: tensor(0.3215, device='cuda:0')
batch 46 loss: tensor(0.3073, device='cuda:0')
batch 47 loss: tensor(0.3087, device='cuda:0')
batch 48 loss: tensor(0.3288, device='cuda:0')
batch 49 loss: tensor(0.2959, device='cuda:0')
batch 50 loss: tensor(0.3019, device='cuda:0')
batch 51 loss: tensor(0.2873, device='cuda:0')
batch 52 loss: tensor(0.2977, device='cuda:0')
batch 53 loss: tensor(0.2987, device='cuda:0')
batch 54 loss: tensor(0.2538, device='cuda:0')
batch 55 loss: tensor(0.3012, device='cuda:0')
batch 56 loss: tensor(0.3034, device='cuda:0')
batch 57 loss: tensor(0.2491, device='cuda:0')
batch 58 loss: tensor(0.2691, device='cuda:0')
batch 59 loss: tensor(0.3240, device='cuda:0')
batch 60 loss: tensor(0.3040, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(1.2430, device='cuda:0')
batch 2 loss: tensor(0.8445, device='cuda:0')
batch 3 loss: tensor(0.6980, device='cuda:0')
batch 4 loss: tensor(0.6092, device='cuda:0')
batch 5 loss: tensor(0.5331, device='cuda:0')
batch 6 loss: tensor(0.5071, device='cuda:0')
batch 7 loss: tensor(0.4515, device='cuda:0')
batch 8 loss: tensor(0.4236, device='cuda:0')
batch 9 loss: tensor(0.3969, device='cuda:0')
batch 10 loss: tensor(0.3867, device='cuda:0')
batch 11 loss: tensor(0.3593, device='cuda:0')
batch 12 loss: tensor(0.3225, device='cuda:0')
batch 13 loss: tensor(0.2975, device='cuda:0')
batch 14 loss: tensor(0.3470, device='cuda:0')
batch 15 loss: tensor(0.3191, device='cuda:0')
batch 16 loss: tensor(0.3198, device='cuda:0')
batch 17 loss: tensor(0.2877, device='cuda:0')
batch 18 loss: tensor(0.2767, device='cuda:0')
batch 19 loss: tensor(0.3001, device='cuda:0')
batch 20 loss: tensor(0.2899, device='cuda:0')
batch 21 loss: tensor(0.3168, device='cuda:0')
batch 22 loss: tensor(0.2848, device='cuda:0')
batch 23 loss: tensor(0.2761, device='cuda:0')
batch 24 loss: tensor(0.3235, device='cuda:0')
batch 25 loss: tensor(0.2954, device='cuda:0')
batch 26 loss: tensor(0.3110, device='cuda:0')
batch 27 loss: tensor(0.2884, device='cuda:0')
batch 28 loss: tensor(0.2915, device='cuda:0')
batch 29 loss: tensor(0.2821, device='cuda:0')
batch 30 loss: tensor(0.2799, device='cuda:0')
batch 31 loss: tensor(0.2792, device='cuda:0')
batch 32 loss: tensor(0.2794, device='cuda:0')
batch 33 loss: tensor(0.3024, device='cuda:0')
batch 34 loss: tensor(0.3119, device='cuda:0')
batch 35 loss: tensor(0.2635, device='cuda:0')
batch 36 loss: tensor(0.2981, device='cuda:0')
batch 37 loss: tensor(0.2622, device='cuda:0')
batch 38 loss: tensor(0.3114, device='cuda:0')
batch 39 loss: tensor(0.2776, device='cuda:0')
batch 40 loss: tensor(0.2794, device='cuda:0')
batch 41 loss: tensor(0.2864, device='cuda:0')
batch 42 loss: tensor(0.2674, device='cuda:0')
batch 43 loss: tensor(0.2843, device='cuda:0')
batch 44 loss: tensor(0.3031, device='cuda:0')
batch 45 loss: tensor(0.3237, device='cuda:0')
batch 46 loss: tensor(0.2700, device='cuda:0')
batch 47 loss: tensor(0.2963, device='cuda:0')
batch 48 loss: tensor(0.2630, device='cuda:0')
batch 49 loss: tensor(0.2901, device='cuda:0')
batch 50 loss: tensor(0.3043, device='cuda:0')
batch 51 loss: tensor(0.2555, device='cuda:0')
batch 52 loss: tensor(0.3039, device='cuda:0')
batch 53 loss: tensor(0.3075, device='cuda:0')
batch 54 loss: tensor(0.2770, device='cuda:0')
batch 55 loss: tensor(0.2667, device='cuda:0')
batch 56 loss: tensor(0.2546, device='cuda:0')
batch 57 loss: tensor(0.2627, device='cuda:0')
batch 58 loss: tensor(0.2799, device='cuda:0')
batch 59 loss: tensor(0.2878, device='cuda:0')
batch 60 loss: tensor(0.2822, device='cuda:0')
accuracy in val: 0.8960000000000001
accuracy in test: 0.889
average epoch time: 0.026061238845189412
total time: 3.1273486614227295
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0782, device='cuda:0')
batch 2 loss: tensor(1.0407, device='cuda:0')
batch 3 loss: tensor(0.9976, device='cuda:0')
batch 4 loss: tensor(0.9513, device='cuda:0')
batch 5 loss: tensor(0.8920, device='cuda:0')
batch 6 loss: tensor(0.8354, device='cuda:0')
batch 7 loss: tensor(0.7750, device='cuda:0')
batch 8 loss: tensor(0.7215, device='cuda:0')
batch 9 loss: tensor(0.6656, device='cuda:0')
batch 10 loss: tensor(0.6228, device='cuda:0')
batch 11 loss: tensor(0.5685, device='cuda:0')
batch 12 loss: tensor(0.5683, device='cuda:0')
batch 13 loss: tensor(0.5080, device='cuda:0')
batch 14 loss: tensor(0.4697, device='cuda:0')
batch 15 loss: tensor(0.4766, device='cuda:0')
batch 16 loss: tensor(0.4773, device='cuda:0')
batch 17 loss: tensor(0.4317, device='cuda:0')
batch 18 loss: tensor(0.4138, device='cuda:0')
batch 19 loss: tensor(0.4294, device='cuda:0')
batch 20 loss: tensor(0.4102, device='cuda:0')
batch 21 loss: tensor(0.4015, device='cuda:0')
batch 22 loss: tensor(0.4196, device='cuda:0')
batch 23 loss: tensor(0.3776, device='cuda:0')
batch 24 loss: tensor(0.3625, device='cuda:0')
batch 25 loss: tensor(0.4069, device='cuda:0')
batch 26 loss: tensor(0.3721, device='cuda:0')
batch 27 loss: tensor(0.3774, device='cuda:0')
batch 28 loss: tensor(0.3680, device='cuda:0')
batch 29 loss: tensor(0.3621, device='cuda:0')
batch 30 loss: tensor(0.3639, device='cuda:0')
batch 31 loss: tensor(0.3538, device='cuda:0')
batch 32 loss: tensor(0.3565, device='cuda:0')
batch 33 loss: tensor(0.3289, device='cuda:0')
batch 34 loss: tensor(0.2857, device='cuda:0')
batch 35 loss: tensor(0.3209, device='cuda:0')
batch 36 loss: tensor(0.3141, device='cuda:0')
batch 37 loss: tensor(0.3320, device='cuda:0')
batch 38 loss: tensor(0.3207, device='cuda:0')
batch 39 loss: tensor(0.3242, device='cuda:0')
batch 40 loss: tensor(0.3153, device='cuda:0')
batch 41 loss: tensor(0.2857, device='cuda:0')
batch 42 loss: tensor(0.3222, device='cuda:0')
batch 43 loss: tensor(0.3182, device='cuda:0')
batch 44 loss: tensor(0.3214, device='cuda:0')
batch 45 loss: tensor(0.2955, device='cuda:0')
batch 46 loss: tensor(0.3299, device='cuda:0')
batch 47 loss: tensor(0.3661, device='cuda:0')
batch 48 loss: tensor(0.2982, device='cuda:0')
batch 49 loss: tensor(0.3316, device='cuda:0')
batch 50 loss: tensor(0.2925, device='cuda:0')
batch 51 loss: tensor(0.3215, device='cuda:0')
batch 52 loss: tensor(0.3097, device='cuda:0')
batch 53 loss: tensor(0.3205, device='cuda:0')
batch 54 loss: tensor(0.3035, device='cuda:0')
batch 55 loss: tensor(0.3043, device='cuda:0')
batch 56 loss: tensor(0.3046, device='cuda:0')
batch 57 loss: tensor(0.2841, device='cuda:0')
batch 58 loss: tensor(0.2944, device='cuda:0')
batch 59 loss: tensor(0.3213, device='cuda:0')
batch 60 loss: tensor(0.3115, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.7640, device='cuda:0')
batch 2 loss: tensor(0.5412, device='cuda:0')
batch 3 loss: tensor(0.4079, device='cuda:0')
batch 4 loss: tensor(0.3795, device='cuda:0')
batch 5 loss: tensor(0.3102, device='cuda:0')
batch 6 loss: tensor(0.3014, device='cuda:0')
batch 7 loss: tensor(0.3064, device='cuda:0')
batch 8 loss: tensor(0.3152, device='cuda:0')
batch 9 loss: tensor(0.2956, device='cuda:0')
batch 10 loss: tensor(0.2948, device='cuda:0')
batch 11 loss: tensor(0.2761, device='cuda:0')
batch 12 loss: tensor(0.3075, device='cuda:0')
batch 13 loss: tensor(0.3228, device='cuda:0')
batch 14 loss: tensor(0.2900, device='cuda:0')
batch 15 loss: tensor(0.2823, device='cuda:0')
batch 16 loss: tensor(0.2852, device='cuda:0')
batch 17 loss: tensor(0.2827, device='cuda:0')
batch 18 loss: tensor(0.3231, device='cuda:0')
batch 19 loss: tensor(0.2662, device='cuda:0')
batch 20 loss: tensor(0.3121, device='cuda:0')
batch 21 loss: tensor(0.2725, device='cuda:0')
batch 22 loss: tensor(0.3056, device='cuda:0')
batch 23 loss: tensor(0.2852, device='cuda:0')
batch 24 loss: tensor(0.2781, device='cuda:0')
batch 25 loss: tensor(0.2921, device='cuda:0')
batch 26 loss: tensor(0.3128, device='cuda:0')
batch 27 loss: tensor(0.3085, device='cuda:0')
batch 28 loss: tensor(0.2899, device='cuda:0')
batch 29 loss: tensor(0.2777, device='cuda:0')
batch 30 loss: tensor(0.3015, device='cuda:0')
batch 31 loss: tensor(0.2985, device='cuda:0')
batch 32 loss: tensor(0.2800, device='cuda:0')
batch 33 loss: tensor(0.2753, device='cuda:0')
batch 34 loss: tensor(0.2956, device='cuda:0')
batch 35 loss: tensor(0.2794, device='cuda:0')
batch 36 loss: tensor(0.2926, device='cuda:0')
batch 37 loss: tensor(0.2875, device='cuda:0')
batch 38 loss: tensor(0.2948, device='cuda:0')
batch 39 loss: tensor(0.2682, device='cuda:0')
batch 40 loss: tensor(0.2808, device='cuda:0')
batch 41 loss: tensor(0.2710, device='cuda:0')
batch 42 loss: tensor(0.2813, device='cuda:0')
batch 43 loss: tensor(0.2856, device='cuda:0')
batch 44 loss: tensor(0.2761, device='cuda:0')
batch 45 loss: tensor(0.3067, device='cuda:0')
batch 46 loss: tensor(0.2947, device='cuda:0')
batch 47 loss: tensor(0.2829, device='cuda:0')
batch 48 loss: tensor(0.2908, device='cuda:0')
batch 49 loss: tensor(0.2711, device='cuda:0')
batch 50 loss: tensor(0.2707, device='cuda:0')
batch 51 loss: tensor(0.2579, device='cuda:0')
batch 52 loss: tensor(0.2539, device='cuda:0')
batch 53 loss: tensor(0.2995, device='cuda:0')
batch 54 loss: tensor(0.2740, device='cuda:0')
batch 55 loss: tensor(0.3030, device='cuda:0')
batch 56 loss: tensor(0.3002, device='cuda:0')
batch 57 loss: tensor(0.2902, device='cuda:0')
batch 58 loss: tensor(0.2865, device='cuda:0')
batch 59 loss: tensor(0.2990, device='cuda:0')
batch 60 loss: tensor(0.2978, device='cuda:0')
accuracy in val: 0.898
accuracy in test: 0.887
average epoch time: 0.02270140250523885
total time: 2.724168300628662
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0790, device='cuda:0')
batch 2 loss: tensor(1.0458, device='cuda:0')
batch 3 loss: tensor(0.9986, device='cuda:0')
batch 4 loss: tensor(0.9484, device='cuda:0')
batch 5 loss: tensor(0.8942, device='cuda:0')
batch 6 loss: tensor(0.8320, device='cuda:0')
batch 7 loss: tensor(0.7768, device='cuda:0')
batch 8 loss: tensor(0.7118, device='cuda:0')
batch 9 loss: tensor(0.6775, device='cuda:0')
batch 10 loss: tensor(0.6277, device='cuda:0')
batch 11 loss: tensor(0.5673, device='cuda:0')
batch 12 loss: tensor(0.5598, device='cuda:0')
batch 13 loss: tensor(0.5211, device='cuda:0')
batch 14 loss: tensor(0.4964, device='cuda:0')
batch 15 loss: tensor(0.4727, device='cuda:0')
batch 16 loss: tensor(0.4348, device='cuda:0')
batch 17 loss: tensor(0.4676, device='cuda:0')
batch 18 loss: tensor(0.4368, device='cuda:0')
batch 19 loss: tensor(0.4362, device='cuda:0')
batch 20 loss: tensor(0.4097, device='cuda:0')
batch 21 loss: tensor(0.3939, device='cuda:0')
batch 22 loss: tensor(0.3848, device='cuda:0')
batch 23 loss: tensor(0.4007, device='cuda:0')
batch 24 loss: tensor(0.3818, device='cuda:0')
batch 25 loss: tensor(0.3778, device='cuda:0')
batch 26 loss: tensor(0.3748, device='cuda:0')
batch 27 loss: tensor(0.3796, device='cuda:0')
batch 28 loss: tensor(0.3279, device='cuda:0')
batch 29 loss: tensor(0.3316, device='cuda:0')
batch 30 loss: tensor(0.3623, device='cuda:0')
batch 31 loss: tensor(0.3684, device='cuda:0')
batch 32 loss: tensor(0.3291, device='cuda:0')
batch 33 loss: tensor(0.3521, device='cuda:0')
batch 34 loss: tensor(0.3142, device='cuda:0')
batch 35 loss: tensor(0.3328, device='cuda:0')
batch 36 loss: tensor(0.3662, device='cuda:0')
batch 37 loss: tensor(0.3362, device='cuda:0')
batch 38 loss: tensor(0.3064, device='cuda:0')
batch 39 loss: tensor(0.2840, device='cuda:0')
batch 40 loss: tensor(0.3443, device='cuda:0')
batch 41 loss: tensor(0.3193, device='cuda:0')
batch 42 loss: tensor(0.3156, device='cuda:0')
batch 43 loss: tensor(0.3074, device='cuda:0')
batch 44 loss: tensor(0.3130, device='cuda:0')
batch 45 loss: tensor(0.3171, device='cuda:0')
batch 46 loss: tensor(0.2978, device='cuda:0')
batch 47 loss: tensor(0.3181, device='cuda:0')
batch 48 loss: tensor(0.2788, device='cuda:0')
batch 49 loss: tensor(0.3435, device='cuda:0')
batch 50 loss: tensor(0.2739, device='cuda:0')
batch 51 loss: tensor(0.2996, device='cuda:0')
batch 52 loss: tensor(0.2664, device='cuda:0')
batch 53 loss: tensor(0.2961, device='cuda:0')
batch 54 loss: tensor(0.2709, device='cuda:0')
batch 55 loss: tensor(0.2803, device='cuda:0')
batch 56 loss: tensor(0.3046, device='cuda:0')
batch 57 loss: tensor(0.2821, device='cuda:0')
batch 58 loss: tensor(0.3059, device='cuda:0')
batch 59 loss: tensor(0.2952, device='cuda:0')
batch 60 loss: tensor(0.2721, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.9234, device='cuda:0')
batch 2 loss: tensor(0.5662, device='cuda:0')
batch 3 loss: tensor(0.4062, device='cuda:0')
batch 4 loss: tensor(0.3611, device='cuda:0')
batch 5 loss: tensor(0.3397, device='cuda:0')
batch 6 loss: tensor(0.3210, device='cuda:0')
batch 7 loss: tensor(0.3160, device='cuda:0')
batch 8 loss: tensor(0.3095, device='cuda:0')
batch 9 loss: tensor(0.2912, device='cuda:0')
batch 10 loss: tensor(0.3021, device='cuda:0')
batch 11 loss: tensor(0.3065, device='cuda:0')
batch 12 loss: tensor(0.2702, device='cuda:0')
batch 13 loss: tensor(0.2740, device='cuda:0')
batch 14 loss: tensor(0.2595, device='cuda:0')
batch 15 loss: tensor(0.2789, device='cuda:0')
batch 16 loss: tensor(0.3048, device='cuda:0')
batch 17 loss: tensor(0.3028, device='cuda:0')
batch 18 loss: tensor(0.2888, device='cuda:0')
batch 19 loss: tensor(0.3116, device='cuda:0')
batch 20 loss: tensor(0.2859, device='cuda:0')
batch 21 loss: tensor(0.2755, device='cuda:0')
batch 22 loss: tensor(0.3016, device='cuda:0')
batch 23 loss: tensor(0.2733, device='cuda:0')
batch 24 loss: tensor(0.2645, device='cuda:0')
batch 25 loss: tensor(0.2985, device='cuda:0')
batch 26 loss: tensor(0.2610, device='cuda:0')
batch 27 loss: tensor(0.2780, device='cuda:0')
batch 28 loss: tensor(0.2765, device='cuda:0')
batch 29 loss: tensor(0.2849, device='cuda:0')
batch 30 loss: tensor(0.2659, device='cuda:0')
batch 31 loss: tensor(0.3139, device='cuda:0')
batch 32 loss: tensor(0.2832, device='cuda:0')
batch 33 loss: tensor(0.3133, device='cuda:0')
batch 34 loss: tensor(0.2739, device='cuda:0')
batch 35 loss: tensor(0.2845, device='cuda:0')
batch 36 loss: tensor(0.3114, device='cuda:0')
batch 37 loss: tensor(0.2967, device='cuda:0')
batch 38 loss: tensor(0.2610, device='cuda:0')
batch 39 loss: tensor(0.2954, device='cuda:0')
batch 40 loss: tensor(0.2872, device='cuda:0')
batch 41 loss: tensor(0.2659, device='cuda:0')
batch 42 loss: tensor(0.2940, device='cuda:0')
batch 43 loss: tensor(0.2930, device='cuda:0')
batch 44 loss: tensor(0.3164, device='cuda:0')
batch 45 loss: tensor(0.2765, device='cuda:0')
batch 46 loss: tensor(0.2938, device='cuda:0')
batch 47 loss: tensor(0.2630, device='cuda:0')
batch 48 loss: tensor(0.3055, device='cuda:0')
batch 49 loss: tensor(0.2706, device='cuda:0')
batch 50 loss: tensor(0.3083, device='cuda:0')
batch 51 loss: tensor(0.2768, device='cuda:0')
batch 52 loss: tensor(0.2680, device='cuda:0')
batch 53 loss: tensor(0.3094, device='cuda:0')
batch 54 loss: tensor(0.2709, device='cuda:0')
batch 55 loss: tensor(0.2682, device='cuda:0')
batch 56 loss: tensor(0.3156, device='cuda:0')
batch 57 loss: tensor(0.2622, device='cuda:0')
batch 58 loss: tensor(0.2941, device='cuda:0')
batch 59 loss: tensor(0.2418, device='cuda:0')
batch 60 loss: tensor(0.2802, device='cuda:0')
accuracy in val: 0.892
accuracy in test: 0.888
average epoch time: 0.02532339294751485
total time: 3.0388071537017822
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0752, device='cuda:0')
batch 2 loss: tensor(1.0336, device='cuda:0')
batch 3 loss: tensor(0.9892, device='cuda:0')
batch 4 loss: tensor(0.9349, device='cuda:0')
batch 5 loss: tensor(0.8802, device='cuda:0')
batch 6 loss: tensor(0.8179, device='cuda:0')
batch 7 loss: tensor(0.7636, device='cuda:0')
batch 8 loss: tensor(0.7133, device='cuda:0')
batch 9 loss: tensor(0.6568, device='cuda:0')
batch 10 loss: tensor(0.6285, device='cuda:0')
batch 11 loss: tensor(0.5763, device='cuda:0')
batch 12 loss: tensor(0.5483, device='cuda:0')
batch 13 loss: tensor(0.5382, device='cuda:0')
batch 14 loss: tensor(0.4907, device='cuda:0')
batch 15 loss: tensor(0.4710, device='cuda:0')
batch 16 loss: tensor(0.4642, device='cuda:0')
batch 17 loss: tensor(0.4253, device='cuda:0')
batch 18 loss: tensor(0.4426, device='cuda:0')
batch 19 loss: tensor(0.3969, device='cuda:0')
batch 20 loss: tensor(0.3897, device='cuda:0')
batch 21 loss: tensor(0.3799, device='cuda:0')
batch 22 loss: tensor(0.4328, device='cuda:0')
batch 23 loss: tensor(0.3966, device='cuda:0')
batch 24 loss: tensor(0.3846, device='cuda:0')
batch 25 loss: tensor(0.3593, device='cuda:0')
batch 26 loss: tensor(0.3820, device='cuda:0')
batch 27 loss: tensor(0.3836, device='cuda:0')
batch 28 loss: tensor(0.3497, device='cuda:0')
batch 29 loss: tensor(0.3558, device='cuda:0')
batch 30 loss: tensor(0.3492, device='cuda:0')
batch 31 loss: tensor(0.3612, device='cuda:0')
batch 32 loss: tensor(0.3571, device='cuda:0')
batch 33 loss: tensor(0.3380, device='cuda:0')
batch 34 loss: tensor(0.3389, device='cuda:0')
batch 35 loss: tensor(0.3287, device='cuda:0')
batch 36 loss: tensor(0.3317, device='cuda:0')
batch 37 loss: tensor(0.3274, device='cuda:0')
batch 38 loss: tensor(0.3002, device='cuda:0')
batch 39 loss: tensor(0.3442, device='cuda:0')
batch 40 loss: tensor(0.3065, device='cuda:0')
batch 41 loss: tensor(0.3231, device='cuda:0')
batch 42 loss: tensor(0.3359, device='cuda:0')
batch 43 loss: tensor(0.3021, device='cuda:0')
batch 44 loss: tensor(0.2929, device='cuda:0')
batch 45 loss: tensor(0.3117, device='cuda:0')
batch 46 loss: tensor(0.2788, device='cuda:0')
batch 47 loss: tensor(0.3046, device='cuda:0')
batch 48 loss: tensor(0.3087, device='cuda:0')
batch 49 loss: tensor(0.3685, device='cuda:0')
batch 50 loss: tensor(0.3132, device='cuda:0')
batch 51 loss: tensor(0.3390, device='cuda:0')
batch 52 loss: tensor(0.2818, device='cuda:0')
batch 53 loss: tensor(0.3030, device='cuda:0')
batch 54 loss: tensor(0.2892, device='cuda:0')
batch 55 loss: tensor(0.3315, device='cuda:0')
batch 56 loss: tensor(0.2633, device='cuda:0')
batch 57 loss: tensor(0.3197, device='cuda:0')
batch 58 loss: tensor(0.2708, device='cuda:0')
batch 59 loss: tensor(0.2672, device='cuda:0')
batch 60 loss: tensor(0.3001, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.6769, device='cuda:0')
batch 2 loss: tensor(0.4640, device='cuda:0')
batch 3 loss: tensor(0.3691, device='cuda:0')
batch 4 loss: tensor(0.3307, device='cuda:0')
batch 5 loss: tensor(0.3312, device='cuda:0')
batch 6 loss: tensor(0.2872, device='cuda:0')
batch 7 loss: tensor(0.3076, device='cuda:0')
batch 8 loss: tensor(0.2609, device='cuda:0')
batch 9 loss: tensor(0.3061, device='cuda:0')
batch 10 loss: tensor(0.2765, device='cuda:0')
batch 11 loss: tensor(0.2918, device='cuda:0')
batch 12 loss: tensor(0.2496, device='cuda:0')
batch 13 loss: tensor(0.2959, device='cuda:0')
batch 14 loss: tensor(0.2684, device='cuda:0')
batch 15 loss: tensor(0.2606, device='cuda:0')
batch 16 loss: tensor(0.2780, device='cuda:0')
batch 17 loss: tensor(0.3296, device='cuda:0')
batch 18 loss: tensor(0.2753, device='cuda:0')
batch 19 loss: tensor(0.2954, device='cuda:0')
batch 20 loss: tensor(0.2932, device='cuda:0')
batch 21 loss: tensor(0.2872, device='cuda:0')
batch 22 loss: tensor(0.2842, device='cuda:0')
batch 23 loss: tensor(0.3040, device='cuda:0')
batch 24 loss: tensor(0.2584, device='cuda:0')
batch 25 loss: tensor(0.3269, device='cuda:0')
batch 26 loss: tensor(0.2714, device='cuda:0')
batch 27 loss: tensor(0.2979, device='cuda:0')
batch 28 loss: tensor(0.2550, device='cuda:0')
batch 29 loss: tensor(0.2929, device='cuda:0')
batch 30 loss: tensor(0.3179, device='cuda:0')
batch 31 loss: tensor(0.2751, device='cuda:0')
batch 32 loss: tensor(0.2961, device='cuda:0')
batch 33 loss: tensor(0.2683, device='cuda:0')
batch 34 loss: tensor(0.3080, device='cuda:0')
batch 35 loss: tensor(0.2804, device='cuda:0')
batch 36 loss: tensor(0.2855, device='cuda:0')
batch 37 loss: tensor(0.2799, device='cuda:0')
batch 38 loss: tensor(0.2571, device='cuda:0')
batch 39 loss: tensor(0.2811, device='cuda:0')
batch 40 loss: tensor(0.3220, device='cuda:0')
batch 41 loss: tensor(0.2819, device='cuda:0')
batch 42 loss: tensor(0.2859, device='cuda:0')
batch 43 loss: tensor(0.2772, device='cuda:0')
batch 44 loss: tensor(0.2409, device='cuda:0')
batch 45 loss: tensor(0.3055, device='cuda:0')
batch 46 loss: tensor(0.2835, device='cuda:0')
batch 47 loss: tensor(0.2877, device='cuda:0')
batch 48 loss: tensor(0.3062, device='cuda:0')
batch 49 loss: tensor(0.2826, device='cuda:0')
batch 50 loss: tensor(0.2678, device='cuda:0')
batch 51 loss: tensor(0.2838, device='cuda:0')
batch 52 loss: tensor(0.2720, device='cuda:0')
batch 53 loss: tensor(0.2686, device='cuda:0')
batch 54 loss: tensor(0.3145, device='cuda:0')
batch 55 loss: tensor(0.2529, device='cuda:0')
batch 56 loss: tensor(0.3130, device='cuda:0')
batch 57 loss: tensor(0.2723, device='cuda:0')
batch 58 loss: tensor(0.2512, device='cuda:0')
batch 59 loss: tensor(0.2790, device='cuda:0')
batch 60 loss: tensor(0.3102, device='cuda:0')
accuracy in val: 0.8960000000000001
accuracy in test: 0.89
average epoch time: 0.022567824522654215
total time: 2.708138942718506
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0795, device='cuda:0')
batch 2 loss: tensor(1.0459, device='cuda:0')
batch 3 loss: tensor(1.0025, device='cuda:0')
batch 4 loss: tensor(0.9475, device='cuda:0')
batch 5 loss: tensor(0.9039, device='cuda:0')
batch 6 loss: tensor(0.8318, device='cuda:0')
batch 7 loss: tensor(0.7907, device='cuda:0')
batch 8 loss: tensor(0.7169, device='cuda:0')
batch 9 loss: tensor(0.6821, device='cuda:0')
batch 10 loss: tensor(0.6261, device='cuda:0')
batch 11 loss: tensor(0.5692, device='cuda:0')
batch 12 loss: tensor(0.5695, device='cuda:0')
batch 13 loss: tensor(0.5217, device='cuda:0')
batch 14 loss: tensor(0.5151, device='cuda:0')
batch 15 loss: tensor(0.4745, device='cuda:0')
batch 16 loss: tensor(0.4769, device='cuda:0')
batch 17 loss: tensor(0.4456, device='cuda:0')
batch 18 loss: tensor(0.4438, device='cuda:0')
batch 19 loss: tensor(0.4220, device='cuda:0')
batch 20 loss: tensor(0.4125, device='cuda:0')
batch 21 loss: tensor(0.3922, device='cuda:0')
batch 22 loss: tensor(0.4101, device='cuda:0')
batch 23 loss: tensor(0.3929, device='cuda:0')
batch 24 loss: tensor(0.3544, device='cuda:0')
batch 25 loss: tensor(0.3752, device='cuda:0')
batch 26 loss: tensor(0.3873, device='cuda:0')
batch 27 loss: tensor(0.3722, device='cuda:0')
batch 28 loss: tensor(0.3495, device='cuda:0')
batch 29 loss: tensor(0.3631, device='cuda:0')
batch 30 loss: tensor(0.3383, device='cuda:0')
batch 31 loss: tensor(0.3180, device='cuda:0')
batch 32 loss: tensor(0.3446, device='cuda:0')
batch 33 loss: tensor(0.3628, device='cuda:0')
batch 34 loss: tensor(0.3440, device='cuda:0')
batch 35 loss: tensor(0.3392, device='cuda:0')
batch 36 loss: tensor(0.3298, device='cuda:0')
batch 37 loss: tensor(0.3209, device='cuda:0')
batch 38 loss: tensor(0.3462, device='cuda:0')
batch 39 loss: tensor(0.3174, device='cuda:0')
batch 40 loss: tensor(0.3199, device='cuda:0')
batch 41 loss: tensor(0.3114, device='cuda:0')
batch 42 loss: tensor(0.3087, device='cuda:0')
batch 43 loss: tensor(0.3079, device='cuda:0')
batch 44 loss: tensor(0.3105, device='cuda:0')
batch 45 loss: tensor(0.2886, device='cuda:0')
batch 46 loss: tensor(0.3273, device='cuda:0')
batch 47 loss: tensor(0.3192, device='cuda:0')
batch 48 loss: tensor(0.3315, device='cuda:0')
batch 49 loss: tensor(0.3224, device='cuda:0')
batch 50 loss: tensor(0.3038, device='cuda:0')
batch 51 loss: tensor(0.3148, device='cuda:0')
batch 52 loss: tensor(0.2718, device='cuda:0')
batch 53 loss: tensor(0.2943, device='cuda:0')
batch 54 loss: tensor(0.2869, device='cuda:0')
batch 55 loss: tensor(0.3199, device='cuda:0')
batch 56 loss: tensor(0.3093, device='cuda:0')
batch 57 loss: tensor(0.3150, device='cuda:0')
batch 58 loss: tensor(0.2993, device='cuda:0')
batch 59 loss: tensor(0.2986, device='cuda:0')
batch 60 loss: tensor(0.2808, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5696, device='cuda:0')
batch 2 loss: tensor(0.3766, device='cuda:0')
batch 3 loss: tensor(0.3442, device='cuda:0')
batch 4 loss: tensor(0.3147, device='cuda:0')
batch 5 loss: tensor(0.3110, device='cuda:0')
batch 6 loss: tensor(0.3021, device='cuda:0')
batch 7 loss: tensor(0.2760, device='cuda:0')
batch 8 loss: tensor(0.3344, device='cuda:0')
batch 9 loss: tensor(0.3047, device='cuda:0')
batch 10 loss: tensor(0.2773, device='cuda:0')
batch 11 loss: tensor(0.2799, device='cuda:0')
batch 12 loss: tensor(0.2656, device='cuda:0')
batch 13 loss: tensor(0.2870, device='cuda:0')
batch 14 loss: tensor(0.3143, device='cuda:0')
batch 15 loss: tensor(0.3135, device='cuda:0')
batch 16 loss: tensor(0.3214, device='cuda:0')
batch 17 loss: tensor(0.2776, device='cuda:0')
batch 18 loss: tensor(0.2718, device='cuda:0')
batch 19 loss: tensor(0.3093, device='cuda:0')
batch 20 loss: tensor(0.3110, device='cuda:0')
batch 21 loss: tensor(0.3204, device='cuda:0')
batch 22 loss: tensor(0.2694, device='cuda:0')
batch 23 loss: tensor(0.2837, device='cuda:0')
batch 24 loss: tensor(0.2577, device='cuda:0')
batch 25 loss: tensor(0.2719, device='cuda:0')
batch 26 loss: tensor(0.3320, device='cuda:0')
batch 27 loss: tensor(0.3137, device='cuda:0')
batch 28 loss: tensor(0.2861, device='cuda:0')
batch 29 loss: tensor(0.2950, device='cuda:0')
batch 30 loss: tensor(0.2753, device='cuda:0')
batch 31 loss: tensor(0.3318, device='cuda:0')
batch 32 loss: tensor(0.2845, device='cuda:0')
batch 33 loss: tensor(0.3177, device='cuda:0')
batch 34 loss: tensor(0.2703, device='cuda:0')
batch 35 loss: tensor(0.2955, device='cuda:0')
batch 36 loss: tensor(0.3076, device='cuda:0')
batch 37 loss: tensor(0.2586, device='cuda:0')
batch 38 loss: tensor(0.3093, device='cuda:0')
batch 39 loss: tensor(0.3010, device='cuda:0')
batch 40 loss: tensor(0.2918, device='cuda:0')
batch 41 loss: tensor(0.2777, device='cuda:0')
batch 42 loss: tensor(0.2735, device='cuda:0')
batch 43 loss: tensor(0.2246, device='cuda:0')
batch 44 loss: tensor(0.2851, device='cuda:0')
batch 45 loss: tensor(0.2736, device='cuda:0')
batch 46 loss: tensor(0.2892, device='cuda:0')
batch 47 loss: tensor(0.3060, device='cuda:0')
batch 48 loss: tensor(0.2741, device='cuda:0')
batch 49 loss: tensor(0.2919, device='cuda:0')
batch 50 loss: tensor(0.2810, device='cuda:0')
batch 51 loss: tensor(0.3004, device='cuda:0')
batch 52 loss: tensor(0.2850, device='cuda:0')
batch 53 loss: tensor(0.2661, device='cuda:0')
batch 54 loss: tensor(0.3070, device='cuda:0')
batch 55 loss: tensor(0.2757, device='cuda:0')
batch 56 loss: tensor(0.2739, device='cuda:0')
batch 57 loss: tensor(0.2650, device='cuda:0')
batch 58 loss: tensor(0.2954, device='cuda:0')
batch 59 loss: tensor(0.2874, device='cuda:0')
batch 60 loss: tensor(0.2996, device='cuda:0')
accuracy in val: 0.892
accuracy in test: 0.888
average epoch time: 0.022520548105239867
total time: 2.702465772628784
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0786, device='cuda:0')
batch 2 loss: tensor(1.0480, device='cuda:0')
batch 3 loss: tensor(1.0103, device='cuda:0')
batch 4 loss: tensor(0.9629, device='cuda:0')
batch 5 loss: tensor(0.9078, device='cuda:0')
batch 6 loss: tensor(0.8490, device='cuda:0')
batch 7 loss: tensor(0.7963, device='cuda:0')
batch 8 loss: tensor(0.7269, device='cuda:0')
batch 9 loss: tensor(0.6816, device='cuda:0')
batch 10 loss: tensor(0.6157, device='cuda:0')
batch 11 loss: tensor(0.5954, device='cuda:0')
batch 12 loss: tensor(0.5663, device='cuda:0')
batch 13 loss: tensor(0.5420, device='cuda:0')
batch 14 loss: tensor(0.4997, device='cuda:0')
batch 15 loss: tensor(0.4672, device='cuda:0')
batch 16 loss: tensor(0.4371, device='cuda:0')
batch 17 loss: tensor(0.4353, device='cuda:0')
batch 18 loss: tensor(0.4285, device='cuda:0')
batch 19 loss: tensor(0.4350, device='cuda:0')
batch 20 loss: tensor(0.3983, device='cuda:0')
batch 21 loss: tensor(0.3814, device='cuda:0')
batch 22 loss: tensor(0.3990, device='cuda:0')
batch 23 loss: tensor(0.3893, device='cuda:0')
batch 24 loss: tensor(0.3522, device='cuda:0')
batch 25 loss: tensor(0.3974, device='cuda:0')
batch 26 loss: tensor(0.3823, device='cuda:0')
batch 27 loss: tensor(0.3595, device='cuda:0')
batch 28 loss: tensor(0.3631, device='cuda:0')
batch 29 loss: tensor(0.3424, device='cuda:0')
batch 30 loss: tensor(0.3940, device='cuda:0')
batch 31 loss: tensor(0.3072, device='cuda:0')
batch 32 loss: tensor(0.3268, device='cuda:0')
batch 33 loss: tensor(0.3101, device='cuda:0')
batch 34 loss: tensor(0.3231, device='cuda:0')
batch 35 loss: tensor(0.3362, device='cuda:0')
batch 36 loss: tensor(0.3193, device='cuda:0')
batch 37 loss: tensor(0.3179, device='cuda:0')
batch 38 loss: tensor(0.3104, device='cuda:0')
batch 39 loss: tensor(0.3383, device='cuda:0')
batch 40 loss: tensor(0.3137, device='cuda:0')
batch 41 loss: tensor(0.3089, device='cuda:0')
batch 42 loss: tensor(0.3198, device='cuda:0')
batch 43 loss: tensor(0.3323, device='cuda:0')
batch 44 loss: tensor(0.3274, device='cuda:0')
batch 45 loss: tensor(0.3251, device='cuda:0')
batch 46 loss: tensor(0.3217, device='cuda:0')
batch 47 loss: tensor(0.2762, device='cuda:0')
batch 48 loss: tensor(0.2937, device='cuda:0')
batch 49 loss: tensor(0.2992, device='cuda:0')
batch 50 loss: tensor(0.3038, device='cuda:0')
batch 51 loss: tensor(0.2720, device='cuda:0')
batch 52 loss: tensor(0.2775, device='cuda:0')
batch 53 loss: tensor(0.2758, device='cuda:0')
batch 54 loss: tensor(0.2934, device='cuda:0')
batch 55 loss: tensor(0.3251, device='cuda:0')
batch 56 loss: tensor(0.3027, device='cuda:0')
batch 57 loss: tensor(0.2960, device='cuda:0')
batch 58 loss: tensor(0.2817, device='cuda:0')
batch 59 loss: tensor(0.2919, device='cuda:0')
batch 60 loss: tensor(0.3021, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5624, device='cuda:0')
batch 2 loss: tensor(0.4197, device='cuda:0')
batch 3 loss: tensor(0.3455, device='cuda:0')
batch 4 loss: tensor(0.3274, device='cuda:0')
batch 5 loss: tensor(0.3171, device='cuda:0')
batch 6 loss: tensor(0.3202, device='cuda:0')
batch 7 loss: tensor(0.3137, device='cuda:0')
batch 8 loss: tensor(0.3190, device='cuda:0')
batch 9 loss: tensor(0.2940, device='cuda:0')
batch 10 loss: tensor(0.2705, device='cuda:0')
batch 11 loss: tensor(0.2780, device='cuda:0')
batch 12 loss: tensor(0.2527, device='cuda:0')
batch 13 loss: tensor(0.2462, device='cuda:0')
batch 14 loss: tensor(0.2809, device='cuda:0')
batch 15 loss: tensor(0.3048, device='cuda:0')
batch 16 loss: tensor(0.3059, device='cuda:0')
batch 17 loss: tensor(0.2516, device='cuda:0')
batch 18 loss: tensor(0.2744, device='cuda:0')
batch 19 loss: tensor(0.2764, device='cuda:0')
batch 20 loss: tensor(0.2674, device='cuda:0')
batch 21 loss: tensor(0.3057, device='cuda:0')
batch 22 loss: tensor(0.2625, device='cuda:0')
batch 23 loss: tensor(0.2665, device='cuda:0')
batch 24 loss: tensor(0.2722, device='cuda:0')
batch 25 loss: tensor(0.2720, device='cuda:0')
batch 26 loss: tensor(0.2921, device='cuda:0')
batch 27 loss: tensor(0.3112, device='cuda:0')
batch 28 loss: tensor(0.2899, device='cuda:0')
batch 29 loss: tensor(0.2737, device='cuda:0')
batch 30 loss: tensor(0.2842, device='cuda:0')
batch 31 loss: tensor(0.2985, device='cuda:0')
batch 32 loss: tensor(0.2758, device='cuda:0')
batch 33 loss: tensor(0.2612, device='cuda:0')
batch 34 loss: tensor(0.3075, device='cuda:0')
batch 35 loss: tensor(0.3218, device='cuda:0')
batch 36 loss: tensor(0.2921, device='cuda:0')
batch 37 loss: tensor(0.2603, device='cuda:0')
batch 38 loss: tensor(0.2688, device='cuda:0')
batch 39 loss: tensor(0.2749, device='cuda:0')
batch 40 loss: tensor(0.2578, device='cuda:0')
batch 41 loss: tensor(0.2695, device='cuda:0')
batch 42 loss: tensor(0.3248, device='cuda:0')
batch 43 loss: tensor(0.2733, device='cuda:0')
batch 44 loss: tensor(0.2753, device='cuda:0')
batch 45 loss: tensor(0.2784, device='cuda:0')
batch 46 loss: tensor(0.3236, device='cuda:0')
batch 47 loss: tensor(0.2943, device='cuda:0')
batch 48 loss: tensor(0.3325, device='cuda:0')
batch 49 loss: tensor(0.3454, device='cuda:0')
batch 50 loss: tensor(0.2629, device='cuda:0')
batch 51 loss: tensor(0.2737, device='cuda:0')
batch 52 loss: tensor(0.3425, device='cuda:0')
batch 53 loss: tensor(0.2929, device='cuda:0')
batch 54 loss: tensor(0.3082, device='cuda:0')
batch 55 loss: tensor(0.3062, device='cuda:0')
batch 56 loss: tensor(0.2858, device='cuda:0')
batch 57 loss: tensor(0.2599, device='cuda:0')
batch 58 loss: tensor(0.2797, device='cuda:0')
batch 59 loss: tensor(0.2831, device='cuda:0')
batch 60 loss: tensor(0.2795, device='cuda:0')
accuracy in val: 0.888
accuracy in test: 0.887
average epoch time: 0.02517649531364441
total time: 3.021179437637329

0.8889000000000001 2.9039149284362793
0.00262488094968134 0.18277231163945643
Thu Nov 21 15:39:36 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    57W / 149W |    352MiB / 12206MiB |      2%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   32C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28039      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:39:57 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    57W / 149W |    352MiB / 12206MiB |      8%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   33C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28039      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:40:15 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    58W / 149W |    352MiB / 12206MiB |      9%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   33C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28039      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:40:33 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    58W / 149W |    352MiB / 12206MiB |      9%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   33C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28039      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:40:52 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    57W / 149W |    352MiB / 12206MiB |      9%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   34C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28039      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:41:10 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    58W / 149W |    352MiB / 12206MiB |     10%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   34C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28039      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:41:28 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    58W / 149W |    352MiB / 12206MiB |      7%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   34C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28039      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:41:46 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   36C    P0    58W / 149W |    352MiB / 12206MiB |      9%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   34C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28039      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:42:05 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    57W / 149W |    352MiB / 12206MiB |      9%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   35C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28039      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:42:23 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    58W / 149W |    352MiB / 12206MiB |      3%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   35C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28039      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
{'dataset': 'pubmed', 'config_file': 'pubmed.yaml', 'layer_num': 2, 'epoch_num': [80, 80]}
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0819, device='cuda:0')
batch 2 loss: tensor(1.0495, device='cuda:0')
batch 3 loss: tensor(1.0075, device='cuda:0')
batch 4 loss: tensor(0.9583, device='cuda:0')
batch 5 loss: tensor(0.9035, device='cuda:0')
batch 6 loss: tensor(0.8533, device='cuda:0')
batch 7 loss: tensor(0.7852, device='cuda:0')
batch 8 loss: tensor(0.7272, device='cuda:0')
batch 9 loss: tensor(0.6973, device='cuda:0')
batch 10 loss: tensor(0.6456, device='cuda:0')
batch 11 loss: tensor(0.6003, device='cuda:0')
batch 12 loss: tensor(0.5566, device='cuda:0')
batch 13 loss: tensor(0.5320, device='cuda:0')
batch 14 loss: tensor(0.5082, device='cuda:0')
batch 15 loss: tensor(0.5077, device='cuda:0')
batch 16 loss: tensor(0.4558, device='cuda:0')
batch 17 loss: tensor(0.4631, device='cuda:0')
batch 18 loss: tensor(0.4231, device='cuda:0')
batch 19 loss: tensor(0.3982, device='cuda:0')
batch 20 loss: tensor(0.4348, device='cuda:0')
batch 21 loss: tensor(0.4045, device='cuda:0')
batch 22 loss: tensor(0.3774, device='cuda:0')
batch 23 loss: tensor(0.3858, device='cuda:0')
batch 24 loss: tensor(0.3815, device='cuda:0')
batch 25 loss: tensor(0.3728, device='cuda:0')
batch 26 loss: tensor(0.3707, device='cuda:0')
batch 27 loss: tensor(0.3606, device='cuda:0')
batch 28 loss: tensor(0.3543, device='cuda:0')
batch 29 loss: tensor(0.3678, device='cuda:0')
batch 30 loss: tensor(0.3329, device='cuda:0')
batch 31 loss: tensor(0.3442, device='cuda:0')
batch 32 loss: tensor(0.3410, device='cuda:0')
batch 33 loss: tensor(0.3305, device='cuda:0')
batch 34 loss: tensor(0.3535, device='cuda:0')
batch 35 loss: tensor(0.3174, device='cuda:0')
batch 36 loss: tensor(0.3667, device='cuda:0')
batch 37 loss: tensor(0.3211, device='cuda:0')
batch 38 loss: tensor(0.3675, device='cuda:0')
batch 39 loss: tensor(0.3121, device='cuda:0')
batch 40 loss: tensor(0.3082, device='cuda:0')
batch 41 loss: tensor(0.3242, device='cuda:0')
batch 42 loss: tensor(0.3486, device='cuda:0')
batch 43 loss: tensor(0.2983, device='cuda:0')
batch 44 loss: tensor(0.3212, device='cuda:0')
batch 45 loss: tensor(0.3106, device='cuda:0')
batch 46 loss: tensor(0.3138, device='cuda:0')
batch 47 loss: tensor(0.2989, device='cuda:0')
batch 48 loss: tensor(0.3183, device='cuda:0')
batch 49 loss: tensor(0.2990, device='cuda:0')
batch 50 loss: tensor(0.3131, device='cuda:0')
batch 51 loss: tensor(0.3097, device='cuda:0')
batch 52 loss: tensor(0.2740, device='cuda:0')
batch 53 loss: tensor(0.2548, device='cuda:0')
batch 54 loss: tensor(0.2820, device='cuda:0')
batch 55 loss: tensor(0.2906, device='cuda:0')
batch 56 loss: tensor(0.2960, device='cuda:0')
batch 57 loss: tensor(0.2701, device='cuda:0')
batch 58 loss: tensor(0.2915, device='cuda:0')
batch 59 loss: tensor(0.2895, device='cuda:0')
batch 60 loss: tensor(0.3126, device='cuda:0')
batch 61 loss: tensor(0.2912, device='cuda:0')
batch 62 loss: tensor(0.3002, device='cuda:0')
batch 63 loss: tensor(0.2529, device='cuda:0')
batch 64 loss: tensor(0.2528, device='cuda:0')
batch 65 loss: tensor(0.2758, device='cuda:0')
batch 66 loss: tensor(0.2792, device='cuda:0')
batch 67 loss: tensor(0.3021, device='cuda:0')
batch 68 loss: tensor(0.2637, device='cuda:0')
batch 69 loss: tensor(0.2985, device='cuda:0')
batch 70 loss: tensor(0.2959, device='cuda:0')
batch 71 loss: tensor(0.2908, device='cuda:0')
batch 72 loss: tensor(0.2628, device='cuda:0')
batch 73 loss: tensor(0.2844, device='cuda:0')
batch 74 loss: tensor(0.2850, device='cuda:0')
batch 75 loss: tensor(0.2397, device='cuda:0')
batch 76 loss: tensor(0.2688, device='cuda:0')
batch 77 loss: tensor(0.2719, device='cuda:0')
batch 78 loss: tensor(0.2569, device='cuda:0')
batch 79 loss: tensor(0.2583, device='cuda:0')
batch 80 loss: tensor(0.2486, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.8597, device='cuda:0')
batch 2 loss: tensor(0.5908, device='cuda:0')
batch 3 loss: tensor(0.4366, device='cuda:0')
batch 4 loss: tensor(0.3886, device='cuda:0')
batch 5 loss: tensor(0.3170, device='cuda:0')
batch 6 loss: tensor(0.3056, device='cuda:0')
batch 7 loss: tensor(0.2958, device='cuda:0')
batch 8 loss: tensor(0.2444, device='cuda:0')
batch 9 loss: tensor(0.2820, device='cuda:0')
batch 10 loss: tensor(0.3003, device='cuda:0')
batch 11 loss: tensor(0.3062, device='cuda:0')
batch 12 loss: tensor(0.3158, device='cuda:0')
batch 13 loss: tensor(0.2664, device='cuda:0')
batch 14 loss: tensor(0.2588, device='cuda:0')
batch 15 loss: tensor(0.2735, device='cuda:0')
batch 16 loss: tensor(0.2936, device='cuda:0')
batch 17 loss: tensor(0.3080, device='cuda:0')
batch 18 loss: tensor(0.2965, device='cuda:0')
batch 19 loss: tensor(0.2681, device='cuda:0')
batch 20 loss: tensor(0.2775, device='cuda:0')
batch 21 loss: tensor(0.2886, device='cuda:0')
batch 22 loss: tensor(0.2849, device='cuda:0')
batch 23 loss: tensor(0.2527, device='cuda:0')
batch 24 loss: tensor(0.2526, device='cuda:0')
batch 25 loss: tensor(0.2651, device='cuda:0')
batch 26 loss: tensor(0.2982, device='cuda:0')
batch 27 loss: tensor(0.2925, device='cuda:0')
batch 28 loss: tensor(0.2451, device='cuda:0')
batch 29 loss: tensor(0.2916, device='cuda:0')
batch 30 loss: tensor(0.2831, device='cuda:0')
batch 31 loss: tensor(0.2863, device='cuda:0')
batch 32 loss: tensor(0.2779, device='cuda:0')
batch 33 loss: tensor(0.2866, device='cuda:0')
batch 34 loss: tensor(0.2615, device='cuda:0')
batch 35 loss: tensor(0.3083, device='cuda:0')
batch 36 loss: tensor(0.2583, device='cuda:0')
batch 37 loss: tensor(0.2848, device='cuda:0')
batch 38 loss: tensor(0.2504, device='cuda:0')
batch 39 loss: tensor(0.2559, device='cuda:0')
batch 40 loss: tensor(0.2605, device='cuda:0')
batch 41 loss: tensor(0.2811, device='cuda:0')
batch 42 loss: tensor(0.2767, device='cuda:0')
batch 43 loss: tensor(0.2745, device='cuda:0')
batch 44 loss: tensor(0.2288, device='cuda:0')
batch 45 loss: tensor(0.2690, device='cuda:0')
batch 46 loss: tensor(0.2798, device='cuda:0')
batch 47 loss: tensor(0.2578, device='cuda:0')
batch 48 loss: tensor(0.2828, device='cuda:0')
batch 49 loss: tensor(0.2872, device='cuda:0')
batch 50 loss: tensor(0.2740, device='cuda:0')
batch 51 loss: tensor(0.2934, device='cuda:0')
batch 52 loss: tensor(0.2584, device='cuda:0')
batch 53 loss: tensor(0.2712, device='cuda:0')
batch 54 loss: tensor(0.2811, device='cuda:0')
batch 55 loss: tensor(0.2782, device='cuda:0')
batch 56 loss: tensor(0.2669, device='cuda:0')
batch 57 loss: tensor(0.2558, device='cuda:0')
batch 58 loss: tensor(0.2641, device='cuda:0')
batch 59 loss: tensor(0.2412, device='cuda:0')
batch 60 loss: tensor(0.2760, device='cuda:0')
batch 61 loss: tensor(0.2700, device='cuda:0')
batch 62 loss: tensor(0.2670, device='cuda:0')
batch 63 loss: tensor(0.2524, device='cuda:0')
batch 64 loss: tensor(0.2837, device='cuda:0')
batch 65 loss: tensor(0.2648, device='cuda:0')
batch 66 loss: tensor(0.2550, device='cuda:0')
batch 67 loss: tensor(0.2708, device='cuda:0')
batch 68 loss: tensor(0.2741, device='cuda:0')
batch 69 loss: tensor(0.2723, device='cuda:0')
batch 70 loss: tensor(0.2627, device='cuda:0')
batch 71 loss: tensor(0.3107, device='cuda:0')
batch 72 loss: tensor(0.2860, device='cuda:0')
batch 73 loss: tensor(0.2961, device='cuda:0')
batch 74 loss: tensor(0.2951, device='cuda:0')
batch 75 loss: tensor(0.2656, device='cuda:0')
batch 76 loss: tensor(0.2491, device='cuda:0')
batch 77 loss: tensor(0.2463, device='cuda:0')
batch 78 loss: tensor(0.2634, device='cuda:0')
batch 79 loss: tensor(0.2905, device='cuda:0')
batch 80 loss: tensor(0.2761, device='cuda:0')
accuracy in val: 0.894
accuracy in test: 0.89
average epoch time: 0.026177166402339934
total time: 4.18834662437439
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0793, device='cuda:0')
batch 2 loss: tensor(1.0438, device='cuda:0')
batch 3 loss: tensor(1.0018, device='cuda:0')
batch 4 loss: tensor(0.9453, device='cuda:0')
batch 5 loss: tensor(0.8920, device='cuda:0')
batch 6 loss: tensor(0.8421, device='cuda:0')
batch 7 loss: tensor(0.7834, device='cuda:0')
batch 8 loss: tensor(0.7257, device='cuda:0')
batch 9 loss: tensor(0.6848, device='cuda:0')
batch 10 loss: tensor(0.6363, device='cuda:0')
batch 11 loss: tensor(0.5750, device='cuda:0')
batch 12 loss: tensor(0.5883, device='cuda:0')
batch 13 loss: tensor(0.5523, device='cuda:0')
batch 14 loss: tensor(0.4898, device='cuda:0')
batch 15 loss: tensor(0.4902, device='cuda:0')
batch 16 loss: tensor(0.4877, device='cuda:0')
batch 17 loss: tensor(0.4564, device='cuda:0')
batch 18 loss: tensor(0.4447, device='cuda:0')
batch 19 loss: tensor(0.3997, device='cuda:0')
batch 20 loss: tensor(0.4137, device='cuda:0')
batch 21 loss: tensor(0.3915, device='cuda:0')
batch 22 loss: tensor(0.3952, device='cuda:0')
batch 23 loss: tensor(0.3929, device='cuda:0')
batch 24 loss: tensor(0.3739, device='cuda:0')
batch 25 loss: tensor(0.3588, device='cuda:0')
batch 26 loss: tensor(0.3567, device='cuda:0')
batch 27 loss: tensor(0.3709, device='cuda:0')
batch 28 loss: tensor(0.3533, device='cuda:0')
batch 29 loss: tensor(0.3232, device='cuda:0')
batch 30 loss: tensor(0.3610, device='cuda:0')
batch 31 loss: tensor(0.3416, device='cuda:0')
batch 32 loss: tensor(0.3199, device='cuda:0')
batch 33 loss: tensor(0.3400, device='cuda:0')
batch 34 loss: tensor(0.3521, device='cuda:0')
batch 35 loss: tensor(0.3303, device='cuda:0')
batch 36 loss: tensor(0.3128, device='cuda:0')
batch 37 loss: tensor(0.3230, device='cuda:0')
batch 38 loss: tensor(0.3325, device='cuda:0')
batch 39 loss: tensor(0.3378, device='cuda:0')
batch 40 loss: tensor(0.3081, device='cuda:0')
batch 41 loss: tensor(0.3223, device='cuda:0')
batch 42 loss: tensor(0.3304, device='cuda:0')
batch 43 loss: tensor(0.3091, device='cuda:0')
batch 44 loss: tensor(0.2929, device='cuda:0')
batch 45 loss: tensor(0.3139, device='cuda:0')
batch 46 loss: tensor(0.3182, device='cuda:0')
batch 47 loss: tensor(0.3037, device='cuda:0')
batch 48 loss: tensor(0.3228, device='cuda:0')
batch 49 loss: tensor(0.2954, device='cuda:0')
batch 50 loss: tensor(0.2862, device='cuda:0')
batch 51 loss: tensor(0.3008, device='cuda:0')
batch 52 loss: tensor(0.2894, device='cuda:0')
batch 53 loss: tensor(0.2922, device='cuda:0')
batch 54 loss: tensor(0.3107, device='cuda:0')
batch 55 loss: tensor(0.2864, device='cuda:0')
batch 56 loss: tensor(0.3280, device='cuda:0')
batch 57 loss: tensor(0.2826, device='cuda:0')
batch 58 loss: tensor(0.3051, device='cuda:0')
batch 59 loss: tensor(0.2590, device='cuda:0')
batch 60 loss: tensor(0.2969, device='cuda:0')
batch 61 loss: tensor(0.2732, device='cuda:0')
batch 62 loss: tensor(0.3036, device='cuda:0')
batch 63 loss: tensor(0.2842, device='cuda:0')
batch 64 loss: tensor(0.2493, device='cuda:0')
batch 65 loss: tensor(0.2882, device='cuda:0')
batch 66 loss: tensor(0.2777, device='cuda:0')
batch 67 loss: tensor(0.2628, device='cuda:0')
batch 68 loss: tensor(0.2618, device='cuda:0')
batch 69 loss: tensor(0.3169, device='cuda:0')
batch 70 loss: tensor(0.3332, device='cuda:0')
batch 71 loss: tensor(0.2812, device='cuda:0')
batch 72 loss: tensor(0.2921, device='cuda:0')
batch 73 loss: tensor(0.2379, device='cuda:0')
batch 74 loss: tensor(0.3394, device='cuda:0')
batch 75 loss: tensor(0.2897, device='cuda:0')
batch 76 loss: tensor(0.2664, device='cuda:0')
batch 77 loss: tensor(0.2841, device='cuda:0')
batch 78 loss: tensor(0.2780, device='cuda:0')
batch 79 loss: tensor(0.2704, device='cuda:0')
batch 80 loss: tensor(0.2433, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.8387, device='cuda:0')
batch 2 loss: tensor(0.6001, device='cuda:0')
batch 3 loss: tensor(0.4754, device='cuda:0')
batch 4 loss: tensor(0.3658, device='cuda:0')
batch 5 loss: tensor(0.3362, device='cuda:0')
batch 6 loss: tensor(0.3363, device='cuda:0')
batch 7 loss: tensor(0.2842, device='cuda:0')
batch 8 loss: tensor(0.2905, device='cuda:0')
batch 9 loss: tensor(0.2866, device='cuda:0')
batch 10 loss: tensor(0.2958, device='cuda:0')
batch 11 loss: tensor(0.2674, device='cuda:0')
batch 12 loss: tensor(0.2721, device='cuda:0')
batch 13 loss: tensor(0.3034, device='cuda:0')
batch 14 loss: tensor(0.2692, device='cuda:0')
batch 15 loss: tensor(0.2989, device='cuda:0')
batch 16 loss: tensor(0.2595, device='cuda:0')
batch 17 loss: tensor(0.2675, device='cuda:0')
batch 18 loss: tensor(0.2774, device='cuda:0')
batch 19 loss: tensor(0.3057, device='cuda:0')
batch 20 loss: tensor(0.2830, device='cuda:0')
batch 21 loss: tensor(0.3074, device='cuda:0')
batch 22 loss: tensor(0.2919, device='cuda:0')
batch 23 loss: tensor(0.2890, device='cuda:0')
batch 24 loss: tensor(0.2981, device='cuda:0')
batch 25 loss: tensor(0.2646, device='cuda:0')
batch 26 loss: tensor(0.2569, device='cuda:0')
batch 27 loss: tensor(0.2681, device='cuda:0')
batch 28 loss: tensor(0.3166, device='cuda:0')
batch 29 loss: tensor(0.2952, device='cuda:0')
batch 30 loss: tensor(0.2809, device='cuda:0')
batch 31 loss: tensor(0.2575, device='cuda:0')
batch 32 loss: tensor(0.2654, device='cuda:0')
batch 33 loss: tensor(0.2754, device='cuda:0')
batch 34 loss: tensor(0.2787, device='cuda:0')
batch 35 loss: tensor(0.2756, device='cuda:0')
batch 36 loss: tensor(0.2363, device='cuda:0')
batch 37 loss: tensor(0.2621, device='cuda:0')
batch 38 loss: tensor(0.2895, device='cuda:0')
batch 39 loss: tensor(0.2747, device='cuda:0')
batch 40 loss: tensor(0.3140, device='cuda:0')
batch 41 loss: tensor(0.2575, device='cuda:0')
batch 42 loss: tensor(0.2914, device='cuda:0')
batch 43 loss: tensor(0.2919, device='cuda:0')
batch 44 loss: tensor(0.2893, device='cuda:0')
batch 45 loss: tensor(0.3078, device='cuda:0')
batch 46 loss: tensor(0.2693, device='cuda:0')
batch 47 loss: tensor(0.2941, device='cuda:0')
batch 48 loss: tensor(0.2646, device='cuda:0')
batch 49 loss: tensor(0.2822, device='cuda:0')
batch 50 loss: tensor(0.2649, device='cuda:0')
batch 51 loss: tensor(0.2896, device='cuda:0')
batch 52 loss: tensor(0.2395, device='cuda:0')
batch 53 loss: tensor(0.2964, device='cuda:0')
batch 54 loss: tensor(0.2399, device='cuda:0')
batch 55 loss: tensor(0.2795, device='cuda:0')
batch 56 loss: tensor(0.2298, device='cuda:0')
batch 57 loss: tensor(0.2707, device='cuda:0')
batch 58 loss: tensor(0.2851, device='cuda:0')
batch 59 loss: tensor(0.2692, device='cuda:0')
batch 60 loss: tensor(0.2993, device='cuda:0')
batch 61 loss: tensor(0.2829, device='cuda:0')
batch 62 loss: tensor(0.2604, device='cuda:0')
batch 63 loss: tensor(0.2606, device='cuda:0')
batch 64 loss: tensor(0.2476, device='cuda:0')
batch 65 loss: tensor(0.2870, device='cuda:0')
batch 66 loss: tensor(0.2635, device='cuda:0')
batch 67 loss: tensor(0.2694, device='cuda:0')
batch 68 loss: tensor(0.2792, device='cuda:0')
batch 69 loss: tensor(0.2415, device='cuda:0')
batch 70 loss: tensor(0.3069, device='cuda:0')
batch 71 loss: tensor(0.2999, device='cuda:0')
batch 72 loss: tensor(0.2826, device='cuda:0')
batch 73 loss: tensor(0.2530, device='cuda:0')
batch 74 loss: tensor(0.2798, device='cuda:0')
batch 75 loss: tensor(0.2712, device='cuda:0')
batch 76 loss: tensor(0.2932, device='cuda:0')
batch 77 loss: tensor(0.2688, device='cuda:0')
batch 78 loss: tensor(0.2430, device='cuda:0')
batch 79 loss: tensor(0.2781, device='cuda:0')
batch 80 loss: tensor(0.2956, device='cuda:0')
accuracy in val: 0.892
accuracy in test: 0.889
average epoch time: 0.026767507195472717
total time: 4.282801151275635
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0746, device='cuda:0')
batch 2 loss: tensor(1.0377, device='cuda:0')
batch 3 loss: tensor(0.9947, device='cuda:0')
batch 4 loss: tensor(0.9535, device='cuda:0')
batch 5 loss: tensor(0.8987, device='cuda:0')
batch 6 loss: tensor(0.8621, device='cuda:0')
batch 7 loss: tensor(0.8099, device='cuda:0')
batch 8 loss: tensor(0.7575, device='cuda:0')
batch 9 loss: tensor(0.7018, device='cuda:0')
batch 10 loss: tensor(0.6684, device='cuda:0')
batch 11 loss: tensor(0.5964, device='cuda:0')
batch 12 loss: tensor(0.6061, device='cuda:0')
batch 13 loss: tensor(0.5547, device='cuda:0')
batch 14 loss: tensor(0.5240, device='cuda:0')
batch 15 loss: tensor(0.4726, device='cuda:0')
batch 16 loss: tensor(0.4670, device='cuda:0')
batch 17 loss: tensor(0.4485, device='cuda:0')
batch 18 loss: tensor(0.4465, device='cuda:0')
batch 19 loss: tensor(0.4318, device='cuda:0')
batch 20 loss: tensor(0.4077, device='cuda:0')
batch 21 loss: tensor(0.4380, device='cuda:0')
batch 22 loss: tensor(0.3869, device='cuda:0')
batch 23 loss: tensor(0.3799, device='cuda:0')
batch 24 loss: tensor(0.3804, device='cuda:0')
batch 25 loss: tensor(0.3621, device='cuda:0')
batch 26 loss: tensor(0.3932, device='cuda:0')
batch 27 loss: tensor(0.3747, device='cuda:0')
batch 28 loss: tensor(0.3498, device='cuda:0')
batch 29 loss: tensor(0.3560, device='cuda:0')
batch 30 loss: tensor(0.3577, device='cuda:0')
batch 31 loss: tensor(0.3315, device='cuda:0')
batch 32 loss: tensor(0.3313, device='cuda:0')
batch 33 loss: tensor(0.3572, device='cuda:0')
batch 34 loss: tensor(0.3453, device='cuda:0')
batch 35 loss: tensor(0.3202, device='cuda:0')
batch 36 loss: tensor(0.3303, device='cuda:0')
batch 37 loss: tensor(0.3093, device='cuda:0')
batch 38 loss: tensor(0.3400, device='cuda:0')
batch 39 loss: tensor(0.3288, device='cuda:0')
batch 40 loss: tensor(0.3318, device='cuda:0')
batch 41 loss: tensor(0.3165, device='cuda:0')
batch 42 loss: tensor(0.2983, device='cuda:0')
batch 43 loss: tensor(0.3390, device='cuda:0')
batch 44 loss: tensor(0.3257, device='cuda:0')
batch 45 loss: tensor(0.3112, device='cuda:0')
batch 46 loss: tensor(0.2977, device='cuda:0')
batch 47 loss: tensor(0.3281, device='cuda:0')
batch 48 loss: tensor(0.3046, device='cuda:0')
batch 49 loss: tensor(0.2984, device='cuda:0')
batch 50 loss: tensor(0.2982, device='cuda:0')
batch 51 loss: tensor(0.3145, device='cuda:0')
batch 52 loss: tensor(0.2790, device='cuda:0')
batch 53 loss: tensor(0.3035, device='cuda:0')
batch 54 loss: tensor(0.2816, device='cuda:0')
batch 55 loss: tensor(0.3027, device='cuda:0')
batch 56 loss: tensor(0.2781, device='cuda:0')
batch 57 loss: tensor(0.2861, device='cuda:0')
batch 58 loss: tensor(0.3055, device='cuda:0')
batch 59 loss: tensor(0.3218, device='cuda:0')
batch 60 loss: tensor(0.2970, device='cuda:0')
batch 61 loss: tensor(0.3023, device='cuda:0')
batch 62 loss: tensor(0.2863, device='cuda:0')
batch 63 loss: tensor(0.3000, device='cuda:0')
batch 64 loss: tensor(0.2828, device='cuda:0')
batch 65 loss: tensor(0.2728, device='cuda:0')
batch 66 loss: tensor(0.3042, device='cuda:0')
batch 67 loss: tensor(0.2659, device='cuda:0')
batch 68 loss: tensor(0.3032, device='cuda:0')
batch 69 loss: tensor(0.2799, device='cuda:0')
batch 70 loss: tensor(0.2823, device='cuda:0')
batch 71 loss: tensor(0.2770, device='cuda:0')
batch 72 loss: tensor(0.2863, device='cuda:0')
batch 73 loss: tensor(0.2515, device='cuda:0')
batch 74 loss: tensor(0.2746, device='cuda:0')
batch 75 loss: tensor(0.2743, device='cuda:0')
batch 76 loss: tensor(0.2332, device='cuda:0')
batch 77 loss: tensor(0.2670, device='cuda:0')
batch 78 loss: tensor(0.2828, device='cuda:0')
batch 79 loss: tensor(0.2579, device='cuda:0')
batch 80 loss: tensor(0.2444, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.9960, device='cuda:0')
batch 2 loss: tensor(0.5218, device='cuda:0')
batch 3 loss: tensor(0.3801, device='cuda:0')
batch 4 loss: tensor(0.3224, device='cuda:0')
batch 5 loss: tensor(0.3209, device='cuda:0')
batch 6 loss: tensor(0.3288, device='cuda:0')
batch 7 loss: tensor(0.2859, device='cuda:0')
batch 8 loss: tensor(0.2735, device='cuda:0')
batch 9 loss: tensor(0.2899, device='cuda:0')
batch 10 loss: tensor(0.2672, device='cuda:0')
batch 11 loss: tensor(0.2973, device='cuda:0')
batch 12 loss: tensor(0.2625, device='cuda:0')
batch 13 loss: tensor(0.2917, device='cuda:0')
batch 14 loss: tensor(0.2925, device='cuda:0')
batch 15 loss: tensor(0.2759, device='cuda:0')
batch 16 loss: tensor(0.2851, device='cuda:0')
batch 17 loss: tensor(0.2569, device='cuda:0')
batch 18 loss: tensor(0.2724, device='cuda:0')
batch 19 loss: tensor(0.2626, device='cuda:0')
batch 20 loss: tensor(0.2807, device='cuda:0')
batch 21 loss: tensor(0.2802, device='cuda:0')
batch 22 loss: tensor(0.2661, device='cuda:0')
batch 23 loss: tensor(0.2880, device='cuda:0')
batch 24 loss: tensor(0.2850, device='cuda:0')
batch 25 loss: tensor(0.2917, device='cuda:0')
batch 26 loss: tensor(0.2978, device='cuda:0')
batch 27 loss: tensor(0.2901, device='cuda:0')
batch 28 loss: tensor(0.2688, device='cuda:0')
batch 29 loss: tensor(0.2556, device='cuda:0')
batch 30 loss: tensor(0.2827, device='cuda:0')
batch 31 loss: tensor(0.2607, device='cuda:0')
batch 32 loss: tensor(0.2745, device='cuda:0')
batch 33 loss: tensor(0.2682, device='cuda:0')
batch 34 loss: tensor(0.2983, device='cuda:0')
batch 35 loss: tensor(0.2308, device='cuda:0')
batch 36 loss: tensor(0.2583, device='cuda:0')
batch 37 loss: tensor(0.2536, device='cuda:0')
batch 38 loss: tensor(0.2733, device='cuda:0')
batch 39 loss: tensor(0.2627, device='cuda:0')
batch 40 loss: tensor(0.2954, device='cuda:0')
batch 41 loss: tensor(0.2818, device='cuda:0')
batch 42 loss: tensor(0.3020, device='cuda:0')
batch 43 loss: tensor(0.2550, device='cuda:0')
batch 44 loss: tensor(0.2861, device='cuda:0')
batch 45 loss: tensor(0.2920, device='cuda:0')
batch 46 loss: tensor(0.2515, device='cuda:0')
batch 47 loss: tensor(0.2849, device='cuda:0')
batch 48 loss: tensor(0.2285, device='cuda:0')
batch 49 loss: tensor(0.3003, device='cuda:0')
batch 50 loss: tensor(0.2836, device='cuda:0')
batch 51 loss: tensor(0.2376, device='cuda:0')
batch 52 loss: tensor(0.2373, device='cuda:0')
batch 53 loss: tensor(0.2325, device='cuda:0')
batch 54 loss: tensor(0.2849, device='cuda:0')
batch 55 loss: tensor(0.2667, device='cuda:0')
batch 56 loss: tensor(0.3102, device='cuda:0')
batch 57 loss: tensor(0.2388, device='cuda:0')
batch 58 loss: tensor(0.2918, device='cuda:0')
batch 59 loss: tensor(0.2839, device='cuda:0')
batch 60 loss: tensor(0.2663, device='cuda:0')
batch 61 loss: tensor(0.2858, device='cuda:0')
batch 62 loss: tensor(0.2557, device='cuda:0')
batch 63 loss: tensor(0.2834, device='cuda:0')
batch 64 loss: tensor(0.2569, device='cuda:0')
batch 65 loss: tensor(0.2756, device='cuda:0')
batch 66 loss: tensor(0.2679, device='cuda:0')
batch 67 loss: tensor(0.2579, device='cuda:0')
batch 68 loss: tensor(0.2846, device='cuda:0')
batch 69 loss: tensor(0.2679, device='cuda:0')
batch 70 loss: tensor(0.2613, device='cuda:0')
batch 71 loss: tensor(0.3000, device='cuda:0')
batch 72 loss: tensor(0.2649, device='cuda:0')
batch 73 loss: tensor(0.2901, device='cuda:0')
batch 74 loss: tensor(0.3136, device='cuda:0')
batch 75 loss: tensor(0.2752, device='cuda:0')
batch 76 loss: tensor(0.2568, device='cuda:0')
batch 77 loss: tensor(0.2762, device='cuda:0')
batch 78 loss: tensor(0.2630, device='cuda:0')
batch 79 loss: tensor(0.2608, device='cuda:0')
batch 80 loss: tensor(0.3260, device='cuda:0')
accuracy in val: 0.898
accuracy in test: 0.888
average epoch time: 0.022773230075836183
total time: 3.643716812133789
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0788, device='cuda:0')
batch 2 loss: tensor(1.0474, device='cuda:0')
batch 3 loss: tensor(1.0030, device='cuda:0')
batch 4 loss: tensor(0.9523, device='cuda:0')
batch 5 loss: tensor(0.8963, device='cuda:0')
batch 6 loss: tensor(0.8390, device='cuda:0')
batch 7 loss: tensor(0.7707, device='cuda:0')
batch 8 loss: tensor(0.7337, device='cuda:0')
batch 9 loss: tensor(0.6692, device='cuda:0')
batch 10 loss: tensor(0.6256, device='cuda:0')
batch 11 loss: tensor(0.5596, device='cuda:0')
batch 12 loss: tensor(0.5397, device='cuda:0')
batch 13 loss: tensor(0.5222, device='cuda:0')
batch 14 loss: tensor(0.4837, device='cuda:0')
batch 15 loss: tensor(0.4871, device='cuda:0')
batch 16 loss: tensor(0.4662, device='cuda:0')
batch 17 loss: tensor(0.4061, device='cuda:0')
batch 18 loss: tensor(0.4180, device='cuda:0')
batch 19 loss: tensor(0.4090, device='cuda:0')
batch 20 loss: tensor(0.3853, device='cuda:0')
batch 21 loss: tensor(0.3907, device='cuda:0')
batch 22 loss: tensor(0.3824, device='cuda:0')
batch 23 loss: tensor(0.3808, device='cuda:0')
batch 24 loss: tensor(0.3833, device='cuda:0')
batch 25 loss: tensor(0.3480, device='cuda:0')
batch 26 loss: tensor(0.3643, device='cuda:0')
batch 27 loss: tensor(0.3326, device='cuda:0')
batch 28 loss: tensor(0.3360, device='cuda:0')
batch 29 loss: tensor(0.3412, device='cuda:0')
batch 30 loss: tensor(0.3571, device='cuda:0')
batch 31 loss: tensor(0.3601, device='cuda:0')
batch 32 loss: tensor(0.3671, device='cuda:0')
batch 33 loss: tensor(0.3207, device='cuda:0')
batch 34 loss: tensor(0.3296, device='cuda:0')
batch 35 loss: tensor(0.3093, device='cuda:0')
batch 36 loss: tensor(0.3146, device='cuda:0')
batch 37 loss: tensor(0.3555, device='cuda:0')
batch 38 loss: tensor(0.3230, device='cuda:0')
batch 39 loss: tensor(0.2998, device='cuda:0')
batch 40 loss: tensor(0.3165, device='cuda:0')
batch 41 loss: tensor(0.3288, device='cuda:0')
batch 42 loss: tensor(0.3042, device='cuda:0')
batch 43 loss: tensor(0.3615, device='cuda:0')
batch 44 loss: tensor(0.3169, device='cuda:0')
batch 45 loss: tensor(0.2965, device='cuda:0')
batch 46 loss: tensor(0.3031, device='cuda:0')
batch 47 loss: tensor(0.2977, device='cuda:0')
batch 48 loss: tensor(0.3325, device='cuda:0')
batch 49 loss: tensor(0.3089, device='cuda:0')
batch 50 loss: tensor(0.2933, device='cuda:0')
batch 51 loss: tensor(0.3074, device='cuda:0')
batch 52 loss: tensor(0.2690, device='cuda:0')
batch 53 loss: tensor(0.2661, device='cuda:0')
batch 54 loss: tensor(0.2909, device='cuda:0')
batch 55 loss: tensor(0.2859, device='cuda:0')
batch 56 loss: tensor(0.2826, device='cuda:0')
batch 57 loss: tensor(0.2880, device='cuda:0')
batch 58 loss: tensor(0.2665, device='cuda:0')
batch 59 loss: tensor(0.2715, device='cuda:0')
batch 60 loss: tensor(0.2703, device='cuda:0')
batch 61 loss: tensor(0.2797, device='cuda:0')
batch 62 loss: tensor(0.2699, device='cuda:0')
batch 63 loss: tensor(0.2739, device='cuda:0')
batch 64 loss: tensor(0.2959, device='cuda:0')
batch 65 loss: tensor(0.2838, device='cuda:0')
batch 66 loss: tensor(0.2764, device='cuda:0')
batch 67 loss: tensor(0.2686, device='cuda:0')
batch 68 loss: tensor(0.2772, device='cuda:0')
batch 69 loss: tensor(0.2647, device='cuda:0')
batch 70 loss: tensor(0.2479, device='cuda:0')
batch 71 loss: tensor(0.2495, device='cuda:0')
batch 72 loss: tensor(0.2687, device='cuda:0')
batch 73 loss: tensor(0.2787, device='cuda:0')
batch 74 loss: tensor(0.2844, device='cuda:0')
batch 75 loss: tensor(0.2996, device='cuda:0')
batch 76 loss: tensor(0.2735, device='cuda:0')
batch 77 loss: tensor(0.2677, device='cuda:0')
batch 78 loss: tensor(0.2883, device='cuda:0')
batch 79 loss: tensor(0.2705, device='cuda:0')
batch 80 loss: tensor(0.2822, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.8752, device='cuda:0')
batch 2 loss: tensor(0.4926, device='cuda:0')
batch 3 loss: tensor(0.3734, device='cuda:0')
batch 4 loss: tensor(0.3203, device='cuda:0')
batch 5 loss: tensor(0.3184, device='cuda:0')
batch 6 loss: tensor(0.3406, device='cuda:0')
batch 7 loss: tensor(0.2755, device='cuda:0')
batch 8 loss: tensor(0.2832, device='cuda:0')
batch 9 loss: tensor(0.2892, device='cuda:0')
batch 10 loss: tensor(0.2496, device='cuda:0')
batch 11 loss: tensor(0.2603, device='cuda:0')
batch 12 loss: tensor(0.2795, device='cuda:0')
batch 13 loss: tensor(0.3056, device='cuda:0')
batch 14 loss: tensor(0.2768, device='cuda:0')
batch 15 loss: tensor(0.2638, device='cuda:0')
batch 16 loss: tensor(0.2859, device='cuda:0')
batch 17 loss: tensor(0.2751, device='cuda:0')
batch 18 loss: tensor(0.2597, device='cuda:0')
batch 19 loss: tensor(0.2839, device='cuda:0')
batch 20 loss: tensor(0.2785, device='cuda:0')
batch 21 loss: tensor(0.3088, device='cuda:0')
batch 22 loss: tensor(0.2641, device='cuda:0')
batch 23 loss: tensor(0.2645, device='cuda:0')
batch 24 loss: tensor(0.2621, device='cuda:0')
batch 25 loss: tensor(0.2539, device='cuda:0')
batch 26 loss: tensor(0.2938, device='cuda:0')
batch 27 loss: tensor(0.2694, device='cuda:0')
batch 28 loss: tensor(0.2666, device='cuda:0')
batch 29 loss: tensor(0.2980, device='cuda:0')
batch 30 loss: tensor(0.2802, device='cuda:0')
batch 31 loss: tensor(0.2800, device='cuda:0')
batch 32 loss: tensor(0.2775, device='cuda:0')
batch 33 loss: tensor(0.2941, device='cuda:0')
batch 34 loss: tensor(0.2950, device='cuda:0')
batch 35 loss: tensor(0.2880, device='cuda:0')
batch 36 loss: tensor(0.2784, device='cuda:0')
batch 37 loss: tensor(0.2652, device='cuda:0')
batch 38 loss: tensor(0.2845, device='cuda:0')
batch 39 loss: tensor(0.2804, device='cuda:0')
batch 40 loss: tensor(0.2330, device='cuda:0')
batch 41 loss: tensor(0.2661, device='cuda:0')
batch 42 loss: tensor(0.2851, device='cuda:0')
batch 43 loss: tensor(0.2681, device='cuda:0')
batch 44 loss: tensor(0.2680, device='cuda:0')
batch 45 loss: tensor(0.2704, device='cuda:0')
batch 46 loss: tensor(0.2626, device='cuda:0')
batch 47 loss: tensor(0.2365, device='cuda:0')
batch 48 loss: tensor(0.2634, device='cuda:0')
batch 49 loss: tensor(0.2540, device='cuda:0')
batch 50 loss: tensor(0.2488, device='cuda:0')
batch 51 loss: tensor(0.2666, device='cuda:0')
batch 52 loss: tensor(0.2749, device='cuda:0')
batch 53 loss: tensor(0.2755, device='cuda:0')
batch 54 loss: tensor(0.2644, device='cuda:0')
batch 55 loss: tensor(0.2899, device='cuda:0')
batch 56 loss: tensor(0.2892, device='cuda:0')
batch 57 loss: tensor(0.2729, device='cuda:0')
batch 58 loss: tensor(0.3022, device='cuda:0')
batch 59 loss: tensor(0.3007, device='cuda:0')
batch 60 loss: tensor(0.3193, device='cuda:0')
batch 61 loss: tensor(0.2993, device='cuda:0')
batch 62 loss: tensor(0.2537, device='cuda:0')
batch 63 loss: tensor(0.2586, device='cuda:0')
batch 64 loss: tensor(0.2779, device='cuda:0')
batch 65 loss: tensor(0.2640, device='cuda:0')
batch 66 loss: tensor(0.2818, device='cuda:0')
batch 67 loss: tensor(0.2478, device='cuda:0')
batch 68 loss: tensor(0.2614, device='cuda:0')
batch 69 loss: tensor(0.2373, device='cuda:0')
batch 70 loss: tensor(0.2887, device='cuda:0')
batch 71 loss: tensor(0.2581, device='cuda:0')
batch 72 loss: tensor(0.2662, device='cuda:0')
batch 73 loss: tensor(0.2419, device='cuda:0')
batch 74 loss: tensor(0.2785, device='cuda:0')
batch 75 loss: tensor(0.2703, device='cuda:0')
batch 76 loss: tensor(0.2843, device='cuda:0')
batch 77 loss: tensor(0.2715, device='cuda:0')
batch 78 loss: tensor(0.2669, device='cuda:0')
batch 79 loss: tensor(0.2771, device='cuda:0')
batch 80 loss: tensor(0.2430, device='cuda:0')
accuracy in val: 0.902
accuracy in test: 0.895
average epoch time: 0.02189193218946457
total time: 3.502709150314331
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0714, device='cuda:0')
batch 2 loss: tensor(1.0325, device='cuda:0')
batch 3 loss: tensor(0.9811, device='cuda:0')
batch 4 loss: tensor(0.9333, device='cuda:0')
batch 5 loss: tensor(0.8741, device='cuda:0')
batch 6 loss: tensor(0.8170, device='cuda:0')
batch 7 loss: tensor(0.7578, device='cuda:0')
batch 8 loss: tensor(0.6885, device='cuda:0')
batch 9 loss: tensor(0.6554, device='cuda:0')
batch 10 loss: tensor(0.6177, device='cuda:0')
batch 11 loss: tensor(0.5605, device='cuda:0')
batch 12 loss: tensor(0.5399, device='cuda:0')
batch 13 loss: tensor(0.5024, device='cuda:0')
batch 14 loss: tensor(0.4780, device='cuda:0')
batch 15 loss: tensor(0.4694, device='cuda:0')
batch 16 loss: tensor(0.4525, device='cuda:0')
batch 17 loss: tensor(0.4270, device='cuda:0')
batch 18 loss: tensor(0.4089, device='cuda:0')
batch 19 loss: tensor(0.4023, device='cuda:0')
batch 20 loss: tensor(0.4091, device='cuda:0')
batch 21 loss: tensor(0.3910, device='cuda:0')
batch 22 loss: tensor(0.3838, device='cuda:0')
batch 23 loss: tensor(0.3706, device='cuda:0')
batch 24 loss: tensor(0.3708, device='cuda:0')
batch 25 loss: tensor(0.3418, device='cuda:0')
batch 26 loss: tensor(0.3764, device='cuda:0')
batch 27 loss: tensor(0.3719, device='cuda:0')
batch 28 loss: tensor(0.3243, device='cuda:0')
batch 29 loss: tensor(0.3651, device='cuda:0')
batch 30 loss: tensor(0.3721, device='cuda:0')
batch 31 loss: tensor(0.3450, device='cuda:0')
batch 32 loss: tensor(0.3153, device='cuda:0')
batch 33 loss: tensor(0.3091, device='cuda:0')
batch 34 loss: tensor(0.3305, device='cuda:0')
batch 35 loss: tensor(0.3512, device='cuda:0')
batch 36 loss: tensor(0.3123, device='cuda:0')
batch 37 loss: tensor(0.3361, device='cuda:0')
batch 38 loss: tensor(0.3171, device='cuda:0')
batch 39 loss: tensor(0.3127, device='cuda:0')
batch 40 loss: tensor(0.3123, device='cuda:0')
batch 41 loss: tensor(0.3283, device='cuda:0')
batch 42 loss: tensor(0.2965, device='cuda:0')
batch 43 loss: tensor(0.2901, device='cuda:0')
batch 44 loss: tensor(0.3342, device='cuda:0')
batch 45 loss: tensor(0.3215, device='cuda:0')
batch 46 loss: tensor(0.3073, device='cuda:0')
batch 47 loss: tensor(0.3087, device='cuda:0')
batch 48 loss: tensor(0.3288, device='cuda:0')
batch 49 loss: tensor(0.2959, device='cuda:0')
batch 50 loss: tensor(0.3019, device='cuda:0')
batch 51 loss: tensor(0.2873, device='cuda:0')
batch 52 loss: tensor(0.2977, device='cuda:0')
batch 53 loss: tensor(0.2987, device='cuda:0')
batch 54 loss: tensor(0.2538, device='cuda:0')
batch 55 loss: tensor(0.3012, device='cuda:0')
batch 56 loss: tensor(0.3034, device='cuda:0')
batch 57 loss: tensor(0.2491, device='cuda:0')
batch 58 loss: tensor(0.2691, device='cuda:0')
batch 59 loss: tensor(0.3240, device='cuda:0')
batch 60 loss: tensor(0.3040, device='cuda:0')
batch 61 loss: tensor(0.2858, device='cuda:0')
batch 62 loss: tensor(0.2548, device='cuda:0')
batch 63 loss: tensor(0.2878, device='cuda:0')
batch 64 loss: tensor(0.2919, device='cuda:0')
batch 65 loss: tensor(0.2787, device='cuda:0')
batch 66 loss: tensor(0.2958, device='cuda:0')
batch 67 loss: tensor(0.2623, device='cuda:0')
batch 68 loss: tensor(0.2703, device='cuda:0')
batch 69 loss: tensor(0.2742, device='cuda:0')
batch 70 loss: tensor(0.2864, device='cuda:0')
batch 71 loss: tensor(0.2684, device='cuda:0')
batch 72 loss: tensor(0.2612, device='cuda:0')
batch 73 loss: tensor(0.2319, device='cuda:0')
batch 74 loss: tensor(0.3013, device='cuda:0')
batch 75 loss: tensor(0.2664, device='cuda:0')
batch 76 loss: tensor(0.2765, device='cuda:0')
batch 77 loss: tensor(0.2563, device='cuda:0')
batch 78 loss: tensor(0.2437, device='cuda:0')
batch 79 loss: tensor(0.2707, device='cuda:0')
batch 80 loss: tensor(0.2641, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(1.3017, device='cuda:0')
batch 2 loss: tensor(0.8672, device='cuda:0')
batch 3 loss: tensor(0.6922, device='cuda:0')
batch 4 loss: tensor(0.6151, device='cuda:0')
batch 5 loss: tensor(0.5207, device='cuda:0')
batch 6 loss: tensor(0.4958, device='cuda:0')
batch 7 loss: tensor(0.4217, device='cuda:0')
batch 8 loss: tensor(0.4033, device='cuda:0')
batch 9 loss: tensor(0.3767, device='cuda:0')
batch 10 loss: tensor(0.3676, device='cuda:0')
batch 11 loss: tensor(0.3381, device='cuda:0')
batch 12 loss: tensor(0.3239, device='cuda:0')
batch 13 loss: tensor(0.3248, device='cuda:0')
batch 14 loss: tensor(0.3280, device='cuda:0')
batch 15 loss: tensor(0.2788, device='cuda:0')
batch 16 loss: tensor(0.3073, device='cuda:0')
batch 17 loss: tensor(0.2684, device='cuda:0')
batch 18 loss: tensor(0.3116, device='cuda:0')
batch 19 loss: tensor(0.2804, device='cuda:0')
batch 20 loss: tensor(0.2770, device='cuda:0')
batch 21 loss: tensor(0.2807, device='cuda:0')
batch 22 loss: tensor(0.2606, device='cuda:0')
batch 23 loss: tensor(0.2745, device='cuda:0')
batch 24 loss: tensor(0.2932, device='cuda:0')
batch 25 loss: tensor(0.3108, device='cuda:0')
batch 26 loss: tensor(0.2565, device='cuda:0')
batch 27 loss: tensor(0.2790, device='cuda:0')
batch 28 loss: tensor(0.2532, device='cuda:0')
batch 29 loss: tensor(0.2773, device='cuda:0')
batch 30 loss: tensor(0.2909, device='cuda:0')
batch 31 loss: tensor(0.2391, device='cuda:0')
batch 32 loss: tensor(0.2886, device='cuda:0')
batch 33 loss: tensor(0.2928, device='cuda:0')
batch 34 loss: tensor(0.2625, device='cuda:0')
batch 35 loss: tensor(0.2492, device='cuda:0')
batch 36 loss: tensor(0.2395, device='cuda:0')
batch 37 loss: tensor(0.2493, device='cuda:0')
batch 38 loss: tensor(0.2610, device='cuda:0')
batch 39 loss: tensor(0.2732, device='cuda:0')
batch 40 loss: tensor(0.2685, device='cuda:0')
batch 41 loss: tensor(0.2562, device='cuda:0')
batch 42 loss: tensor(0.2786, device='cuda:0')
batch 43 loss: tensor(0.2598, device='cuda:0')
batch 44 loss: tensor(0.2590, device='cuda:0')
batch 45 loss: tensor(0.2479, device='cuda:0')
batch 46 loss: tensor(0.2803, device='cuda:0')
batch 47 loss: tensor(0.2746, device='cuda:0')
batch 48 loss: tensor(0.2969, device='cuda:0')
batch 49 loss: tensor(0.2824, device='cuda:0')
batch 50 loss: tensor(0.2711, device='cuda:0')
batch 51 loss: tensor(0.2963, device='cuda:0')
batch 52 loss: tensor(0.2609, device='cuda:0')
batch 53 loss: tensor(0.2699, device='cuda:0')
batch 54 loss: tensor(0.2650, device='cuda:0')
batch 55 loss: tensor(0.3239, device='cuda:0')
batch 56 loss: tensor(0.2715, device='cuda:0')
batch 57 loss: tensor(0.2919, device='cuda:0')
batch 58 loss: tensor(0.2695, device='cuda:0')
batch 59 loss: tensor(0.2527, device='cuda:0')
batch 60 loss: tensor(0.2526, device='cuda:0')
batch 61 loss: tensor(0.2608, device='cuda:0')
batch 62 loss: tensor(0.2488, device='cuda:0')
batch 63 loss: tensor(0.2503, device='cuda:0')
batch 64 loss: tensor(0.2486, device='cuda:0')
batch 65 loss: tensor(0.2665, device='cuda:0')
batch 66 loss: tensor(0.2685, device='cuda:0')
batch 67 loss: tensor(0.2655, device='cuda:0')
batch 68 loss: tensor(0.2942, device='cuda:0')
batch 69 loss: tensor(0.2740, device='cuda:0')
batch 70 loss: tensor(0.2737, device='cuda:0')
batch 71 loss: tensor(0.2834, device='cuda:0')
batch 72 loss: tensor(0.2822, device='cuda:0')
batch 73 loss: tensor(0.2886, device='cuda:0')
batch 74 loss: tensor(0.2882, device='cuda:0')
batch 75 loss: tensor(0.2846, device='cuda:0')
batch 76 loss: tensor(0.2634, device='cuda:0')
batch 77 loss: tensor(0.2696, device='cuda:0')
batch 78 loss: tensor(0.2796, device='cuda:0')
batch 79 loss: tensor(0.2785, device='cuda:0')
batch 80 loss: tensor(0.2803, device='cuda:0')
accuracy in val: 0.892
accuracy in test: 0.887
average epoch time: 0.02301429510116577
total time: 3.6822872161865234
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0782, device='cuda:0')
batch 2 loss: tensor(1.0407, device='cuda:0')
batch 3 loss: tensor(0.9976, device='cuda:0')
batch 4 loss: tensor(0.9513, device='cuda:0')
batch 5 loss: tensor(0.8920, device='cuda:0')
batch 6 loss: tensor(0.8354, device='cuda:0')
batch 7 loss: tensor(0.7750, device='cuda:0')
batch 8 loss: tensor(0.7215, device='cuda:0')
batch 9 loss: tensor(0.6656, device='cuda:0')
batch 10 loss: tensor(0.6228, device='cuda:0')
batch 11 loss: tensor(0.5685, device='cuda:0')
batch 12 loss: tensor(0.5683, device='cuda:0')
batch 13 loss: tensor(0.5080, device='cuda:0')
batch 14 loss: tensor(0.4697, device='cuda:0')
batch 15 loss: tensor(0.4766, device='cuda:0')
batch 16 loss: tensor(0.4773, device='cuda:0')
batch 17 loss: tensor(0.4317, device='cuda:0')
batch 18 loss: tensor(0.4138, device='cuda:0')
batch 19 loss: tensor(0.4294, device='cuda:0')
batch 20 loss: tensor(0.4102, device='cuda:0')
batch 21 loss: tensor(0.4015, device='cuda:0')
batch 22 loss: tensor(0.4196, device='cuda:0')
batch 23 loss: tensor(0.3776, device='cuda:0')
batch 24 loss: tensor(0.3625, device='cuda:0')
batch 25 loss: tensor(0.4069, device='cuda:0')
batch 26 loss: tensor(0.3721, device='cuda:0')
batch 27 loss: tensor(0.3774, device='cuda:0')
batch 28 loss: tensor(0.3680, device='cuda:0')
batch 29 loss: tensor(0.3621, device='cuda:0')
batch 30 loss: tensor(0.3639, device='cuda:0')
batch 31 loss: tensor(0.3538, device='cuda:0')
batch 32 loss: tensor(0.3565, device='cuda:0')
batch 33 loss: tensor(0.3289, device='cuda:0')
batch 34 loss: tensor(0.2857, device='cuda:0')
batch 35 loss: tensor(0.3209, device='cuda:0')
batch 36 loss: tensor(0.3141, device='cuda:0')
batch 37 loss: tensor(0.3320, device='cuda:0')
batch 38 loss: tensor(0.3207, device='cuda:0')
batch 39 loss: tensor(0.3242, device='cuda:0')
batch 40 loss: tensor(0.3153, device='cuda:0')
batch 41 loss: tensor(0.2857, device='cuda:0')
batch 42 loss: tensor(0.3222, device='cuda:0')
batch 43 loss: tensor(0.3182, device='cuda:0')
batch 44 loss: tensor(0.3214, device='cuda:0')
batch 45 loss: tensor(0.2955, device='cuda:0')
batch 46 loss: tensor(0.3299, device='cuda:0')
batch 47 loss: tensor(0.3661, device='cuda:0')
batch 48 loss: tensor(0.2982, device='cuda:0')
batch 49 loss: tensor(0.3316, device='cuda:0')
batch 50 loss: tensor(0.2925, device='cuda:0')
batch 51 loss: tensor(0.3215, device='cuda:0')
batch 52 loss: tensor(0.3097, device='cuda:0')
batch 53 loss: tensor(0.3205, device='cuda:0')
batch 54 loss: tensor(0.3035, device='cuda:0')
batch 55 loss: tensor(0.3043, device='cuda:0')
batch 56 loss: tensor(0.3046, device='cuda:0')
batch 57 loss: tensor(0.2841, device='cuda:0')
batch 58 loss: tensor(0.2944, device='cuda:0')
batch 59 loss: tensor(0.3213, device='cuda:0')
batch 60 loss: tensor(0.3115, device='cuda:0')
batch 61 loss: tensor(0.3069, device='cuda:0')
batch 62 loss: tensor(0.3012, device='cuda:0')
batch 63 loss: tensor(0.3113, device='cuda:0')
batch 64 loss: tensor(0.3055, device='cuda:0')
batch 65 loss: tensor(0.2637, device='cuda:0')
batch 66 loss: tensor(0.2781, device='cuda:0')
batch 67 loss: tensor(0.2820, device='cuda:0')
batch 68 loss: tensor(0.2893, device='cuda:0')
batch 69 loss: tensor(0.2756, device='cuda:0')
batch 70 loss: tensor(0.2720, device='cuda:0')
batch 71 loss: tensor(0.2562, device='cuda:0')
batch 72 loss: tensor(0.2807, device='cuda:0')
batch 73 loss: tensor(0.3019, device='cuda:0')
batch 74 loss: tensor(0.2680, device='cuda:0')
batch 75 loss: tensor(0.2572, device='cuda:0')
batch 76 loss: tensor(0.2583, device='cuda:0')
batch 77 loss: tensor(0.2628, device='cuda:0')
batch 78 loss: tensor(0.2858, device='cuda:0')
batch 79 loss: tensor(0.2353, device='cuda:0')
batch 80 loss: tensor(0.2909, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.7293, device='cuda:0')
batch 2 loss: tensor(0.5230, device='cuda:0')
batch 3 loss: tensor(0.3844, device='cuda:0')
batch 4 loss: tensor(0.3316, device='cuda:0')
batch 5 loss: tensor(0.3172, device='cuda:0')
batch 6 loss: tensor(0.3215, device='cuda:0')
batch 7 loss: tensor(0.3049, device='cuda:0')
batch 8 loss: tensor(0.2807, device='cuda:0')
batch 9 loss: tensor(0.2701, device='cuda:0')
batch 10 loss: tensor(0.2958, device='cuda:0')
batch 11 loss: tensor(0.2905, device='cuda:0')
batch 12 loss: tensor(0.2701, device='cuda:0')
batch 13 loss: tensor(0.2639, device='cuda:0')
batch 14 loss: tensor(0.2814, device='cuda:0')
batch 15 loss: tensor(0.2707, device='cuda:0')
batch 16 loss: tensor(0.2823, device='cuda:0')
batch 17 loss: tensor(0.2773, device='cuda:0')
batch 18 loss: tensor(0.2840, device='cuda:0')
batch 19 loss: tensor(0.2591, device='cuda:0')
batch 20 loss: tensor(0.2687, device='cuda:0')
batch 21 loss: tensor(0.2601, device='cuda:0')
batch 22 loss: tensor(0.2682, device='cuda:0')
batch 23 loss: tensor(0.2694, device='cuda:0')
batch 24 loss: tensor(0.2601, device='cuda:0')
batch 25 loss: tensor(0.2940, device='cuda:0')
batch 26 loss: tensor(0.2810, device='cuda:0')
batch 27 loss: tensor(0.2744, device='cuda:0')
batch 28 loss: tensor(0.2776, device='cuda:0')
batch 29 loss: tensor(0.2596, device='cuda:0')
batch 30 loss: tensor(0.2568, device='cuda:0')
batch 31 loss: tensor(0.2431, device='cuda:0')
batch 32 loss: tensor(0.2391, device='cuda:0')
batch 33 loss: tensor(0.2839, device='cuda:0')
batch 34 loss: tensor(0.2592, device='cuda:0')
batch 35 loss: tensor(0.2878, device='cuda:0')
batch 36 loss: tensor(0.2855, device='cuda:0')
batch 37 loss: tensor(0.2794, device='cuda:0')
batch 38 loss: tensor(0.2686, device='cuda:0')
batch 39 loss: tensor(0.2807, device='cuda:0')
batch 40 loss: tensor(0.2822, device='cuda:0')
batch 41 loss: tensor(0.2411, device='cuda:0')
batch 42 loss: tensor(0.2603, device='cuda:0')
batch 43 loss: tensor(0.2874, device='cuda:0')
batch 44 loss: tensor(0.2774, device='cuda:0')
batch 45 loss: tensor(0.2455, device='cuda:0')
batch 46 loss: tensor(0.2741, device='cuda:0')
batch 47 loss: tensor(0.3031, device='cuda:0')
batch 48 loss: tensor(0.2693, device='cuda:0')
batch 49 loss: tensor(0.2787, device='cuda:0')
batch 50 loss: tensor(0.2719, device='cuda:0')
batch 51 loss: tensor(0.2429, device='cuda:0')
batch 52 loss: tensor(0.2988, device='cuda:0')
batch 53 loss: tensor(0.3003, device='cuda:0')
batch 54 loss: tensor(0.2612, device='cuda:0')
batch 55 loss: tensor(0.2579, device='cuda:0')
batch 56 loss: tensor(0.2661, device='cuda:0')
batch 57 loss: tensor(0.2904, device='cuda:0')
batch 58 loss: tensor(0.2848, device='cuda:0')
batch 59 loss: tensor(0.2564, device='cuda:0')
batch 60 loss: tensor(0.2781, device='cuda:0')
batch 61 loss: tensor(0.2926, device='cuda:0')
batch 62 loss: tensor(0.2599, device='cuda:0')
batch 63 loss: tensor(0.2752, device='cuda:0')
batch 64 loss: tensor(0.2776, device='cuda:0')
batch 65 loss: tensor(0.2968, device='cuda:0')
batch 66 loss: tensor(0.2522, device='cuda:0')
batch 67 loss: tensor(0.2699, device='cuda:0')
batch 68 loss: tensor(0.2623, device='cuda:0')
batch 69 loss: tensor(0.2690, device='cuda:0')
batch 70 loss: tensor(0.2748, device='cuda:0')
batch 71 loss: tensor(0.2829, device='cuda:0')
batch 72 loss: tensor(0.3029, device='cuda:0')
batch 73 loss: tensor(0.2842, device='cuda:0')
batch 74 loss: tensor(0.2423, device='cuda:0')
batch 75 loss: tensor(0.2690, device='cuda:0')
batch 76 loss: tensor(0.2636, device='cuda:0')
batch 77 loss: tensor(0.2675, device='cuda:0')
batch 78 loss: tensor(0.2558, device='cuda:0')
batch 79 loss: tensor(0.2777, device='cuda:0')
batch 80 loss: tensor(0.2699, device='cuda:0')
accuracy in val: 0.898
accuracy in test: 0.888
average epoch time: 0.02181224673986435
total time: 3.489959478378296
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0790, device='cuda:0')
batch 2 loss: tensor(1.0458, device='cuda:0')
batch 3 loss: tensor(0.9986, device='cuda:0')
batch 4 loss: tensor(0.9484, device='cuda:0')
batch 5 loss: tensor(0.8942, device='cuda:0')
batch 6 loss: tensor(0.8320, device='cuda:0')
batch 7 loss: tensor(0.7768, device='cuda:0')
batch 8 loss: tensor(0.7118, device='cuda:0')
batch 9 loss: tensor(0.6775, device='cuda:0')
batch 10 loss: tensor(0.6277, device='cuda:0')
batch 11 loss: tensor(0.5673, device='cuda:0')
batch 12 loss: tensor(0.5598, device='cuda:0')
batch 13 loss: tensor(0.5211, device='cuda:0')
batch 14 loss: tensor(0.4964, device='cuda:0')
batch 15 loss: tensor(0.4727, device='cuda:0')
batch 16 loss: tensor(0.4348, device='cuda:0')
batch 17 loss: tensor(0.4676, device='cuda:0')
batch 18 loss: tensor(0.4368, device='cuda:0')
batch 19 loss: tensor(0.4362, device='cuda:0')
batch 20 loss: tensor(0.4097, device='cuda:0')
batch 21 loss: tensor(0.3939, device='cuda:0')
batch 22 loss: tensor(0.3848, device='cuda:0')
batch 23 loss: tensor(0.4007, device='cuda:0')
batch 24 loss: tensor(0.3818, device='cuda:0')
batch 25 loss: tensor(0.3778, device='cuda:0')
batch 26 loss: tensor(0.3748, device='cuda:0')
batch 27 loss: tensor(0.3796, device='cuda:0')
batch 28 loss: tensor(0.3279, device='cuda:0')
batch 29 loss: tensor(0.3316, device='cuda:0')
batch 30 loss: tensor(0.3623, device='cuda:0')
batch 31 loss: tensor(0.3684, device='cuda:0')
batch 32 loss: tensor(0.3291, device='cuda:0')
batch 33 loss: tensor(0.3521, device='cuda:0')
batch 34 loss: tensor(0.3142, device='cuda:0')
batch 35 loss: tensor(0.3328, device='cuda:0')
batch 36 loss: tensor(0.3662, device='cuda:0')
batch 37 loss: tensor(0.3362, device='cuda:0')
batch 38 loss: tensor(0.3064, device='cuda:0')
batch 39 loss: tensor(0.2840, device='cuda:0')
batch 40 loss: tensor(0.3443, device='cuda:0')
batch 41 loss: tensor(0.3193, device='cuda:0')
batch 42 loss: tensor(0.3156, device='cuda:0')
batch 43 loss: tensor(0.3074, device='cuda:0')
batch 44 loss: tensor(0.3130, device='cuda:0')
batch 45 loss: tensor(0.3171, device='cuda:0')
batch 46 loss: tensor(0.2978, device='cuda:0')
batch 47 loss: tensor(0.3181, device='cuda:0')
batch 48 loss: tensor(0.2788, device='cuda:0')
batch 49 loss: tensor(0.3435, device='cuda:0')
batch 50 loss: tensor(0.2739, device='cuda:0')
batch 51 loss: tensor(0.2996, device='cuda:0')
batch 52 loss: tensor(0.2664, device='cuda:0')
batch 53 loss: tensor(0.2961, device='cuda:0')
batch 54 loss: tensor(0.2709, device='cuda:0')
batch 55 loss: tensor(0.2803, device='cuda:0')
batch 56 loss: tensor(0.3046, device='cuda:0')
batch 57 loss: tensor(0.2821, device='cuda:0')
batch 58 loss: tensor(0.3059, device='cuda:0')
batch 59 loss: tensor(0.2952, device='cuda:0')
batch 60 loss: tensor(0.2721, device='cuda:0')
batch 61 loss: tensor(0.2786, device='cuda:0')
batch 62 loss: tensor(0.3090, device='cuda:0')
batch 63 loss: tensor(0.2629, device='cuda:0')
batch 64 loss: tensor(0.2966, device='cuda:0')
batch 65 loss: tensor(0.2851, device='cuda:0')
batch 66 loss: tensor(0.2945, device='cuda:0')
batch 67 loss: tensor(0.2863, device='cuda:0')
batch 68 loss: tensor(0.2962, device='cuda:0')
batch 69 loss: tensor(0.2669, device='cuda:0')
batch 70 loss: tensor(0.2792, device='cuda:0')
batch 71 loss: tensor(0.2942, device='cuda:0')
batch 72 loss: tensor(0.2536, device='cuda:0')
batch 73 loss: tensor(0.2548, device='cuda:0')
batch 74 loss: tensor(0.2494, device='cuda:0')
batch 75 loss: tensor(0.2623, device='cuda:0')
batch 76 loss: tensor(0.2941, device='cuda:0')
batch 77 loss: tensor(0.2726, device='cuda:0')
batch 78 loss: tensor(0.2593, device='cuda:0')
batch 79 loss: tensor(0.2921, device='cuda:0')
batch 80 loss: tensor(0.2717, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.9468, device='cuda:0')
batch 2 loss: tensor(0.5327, device='cuda:0')
batch 3 loss: tensor(0.3961, device='cuda:0')
batch 4 loss: tensor(0.3159, device='cuda:0')
batch 5 loss: tensor(0.3246, device='cuda:0')
batch 6 loss: tensor(0.2745, device='cuda:0')
batch 7 loss: tensor(0.2747, device='cuda:0')
batch 8 loss: tensor(0.2760, device='cuda:0')
batch 9 loss: tensor(0.2790, device='cuda:0')
batch 10 loss: tensor(0.2585, device='cuda:0')
batch 11 loss: tensor(0.3025, device='cuda:0')
batch 12 loss: tensor(0.2722, device='cuda:0')
batch 13 loss: tensor(0.3017, device='cuda:0')
batch 14 loss: tensor(0.2632, device='cuda:0')
batch 15 loss: tensor(0.2696, device='cuda:0')
batch 16 loss: tensor(0.2926, device='cuda:0')
batch 17 loss: tensor(0.2839, device='cuda:0')
batch 18 loss: tensor(0.2470, device='cuda:0')
batch 19 loss: tensor(0.2804, device='cuda:0')
batch 20 loss: tensor(0.2735, device='cuda:0')
batch 21 loss: tensor(0.2510, device='cuda:0')
batch 22 loss: tensor(0.2792, device='cuda:0')
batch 23 loss: tensor(0.2805, device='cuda:0')
batch 24 loss: tensor(0.3041, device='cuda:0')
batch 25 loss: tensor(0.2642, device='cuda:0')
batch 26 loss: tensor(0.2813, device='cuda:0')
batch 27 loss: tensor(0.2473, device='cuda:0')
batch 28 loss: tensor(0.2863, device='cuda:0')
batch 29 loss: tensor(0.2558, device='cuda:0')
batch 30 loss: tensor(0.2944, device='cuda:0')
batch 31 loss: tensor(0.2610, device='cuda:0')
batch 32 loss: tensor(0.2548, device='cuda:0')
batch 33 loss: tensor(0.2915, device='cuda:0')
batch 34 loss: tensor(0.2556, device='cuda:0')
batch 35 loss: tensor(0.2550, device='cuda:0')
batch 36 loss: tensor(0.3068, device='cuda:0')
batch 37 loss: tensor(0.2467, device='cuda:0')
batch 38 loss: tensor(0.2823, device='cuda:0')
batch 39 loss: tensor(0.2280, device='cuda:0')
batch 40 loss: tensor(0.2658, device='cuda:0')
batch 41 loss: tensor(0.2762, device='cuda:0')
batch 42 loss: tensor(0.2850, device='cuda:0')
batch 43 loss: tensor(0.2582, device='cuda:0')
batch 44 loss: tensor(0.2795, device='cuda:0')
batch 45 loss: tensor(0.2864, device='cuda:0')
batch 46 loss: tensor(0.2595, device='cuda:0')
batch 47 loss: tensor(0.2456, device='cuda:0')
batch 48 loss: tensor(0.2704, device='cuda:0')
batch 49 loss: tensor(0.2600, device='cuda:0')
batch 50 loss: tensor(0.2746, device='cuda:0')
batch 51 loss: tensor(0.2692, device='cuda:0')
batch 52 loss: tensor(0.2706, device='cuda:0')
batch 53 loss: tensor(0.2875, device='cuda:0')
batch 54 loss: tensor(0.3121, device='cuda:0')
batch 55 loss: tensor(0.2636, device='cuda:0')
batch 56 loss: tensor(0.2547, device='cuda:0')
batch 57 loss: tensor(0.2843, device='cuda:0')
batch 58 loss: tensor(0.2669, device='cuda:0')
batch 59 loss: tensor(0.2637, device='cuda:0')
batch 60 loss: tensor(0.2782, device='cuda:0')
batch 61 loss: tensor(0.2286, device='cuda:0')
batch 62 loss: tensor(0.3001, device='cuda:0')
batch 63 loss: tensor(0.2647, device='cuda:0')
batch 64 loss: tensor(0.2912, device='cuda:0')
batch 65 loss: tensor(0.2639, device='cuda:0')
batch 66 loss: tensor(0.2376, device='cuda:0')
batch 67 loss: tensor(0.2825, device='cuda:0')
batch 68 loss: tensor(0.2657, device='cuda:0')
batch 69 loss: tensor(0.2689, device='cuda:0')
batch 70 loss: tensor(0.2645, device='cuda:0')
batch 71 loss: tensor(0.2506, device='cuda:0')
batch 72 loss: tensor(0.2657, device='cuda:0')
batch 73 loss: tensor(0.3007, device='cuda:0')
batch 74 loss: tensor(0.2738, device='cuda:0')
batch 75 loss: tensor(0.2723, device='cuda:0')
batch 76 loss: tensor(0.2891, device='cuda:0')
batch 77 loss: tensor(0.2684, device='cuda:0')
batch 78 loss: tensor(0.3054, device='cuda:0')
batch 79 loss: tensor(0.2977, device='cuda:0')
batch 80 loss: tensor(0.2582, device='cuda:0')
accuracy in val: 0.894
accuracy in test: 0.888
average epoch time: 0.02450011819601059
total time: 3.9200189113616943
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0752, device='cuda:0')
batch 2 loss: tensor(1.0336, device='cuda:0')
batch 3 loss: tensor(0.9892, device='cuda:0')
batch 4 loss: tensor(0.9349, device='cuda:0')
batch 5 loss: tensor(0.8802, device='cuda:0')
batch 6 loss: tensor(0.8179, device='cuda:0')
batch 7 loss: tensor(0.7636, device='cuda:0')
batch 8 loss: tensor(0.7133, device='cuda:0')
batch 9 loss: tensor(0.6568, device='cuda:0')
batch 10 loss: tensor(0.6285, device='cuda:0')
batch 11 loss: tensor(0.5763, device='cuda:0')
batch 12 loss: tensor(0.5483, device='cuda:0')
batch 13 loss: tensor(0.5382, device='cuda:0')
batch 14 loss: tensor(0.4907, device='cuda:0')
batch 15 loss: tensor(0.4710, device='cuda:0')
batch 16 loss: tensor(0.4642, device='cuda:0')
batch 17 loss: tensor(0.4253, device='cuda:0')
batch 18 loss: tensor(0.4426, device='cuda:0')
batch 19 loss: tensor(0.3969, device='cuda:0')
batch 20 loss: tensor(0.3897, device='cuda:0')
batch 21 loss: tensor(0.3799, device='cuda:0')
batch 22 loss: tensor(0.4328, device='cuda:0')
batch 23 loss: tensor(0.3966, device='cuda:0')
batch 24 loss: tensor(0.3846, device='cuda:0')
batch 25 loss: tensor(0.3593, device='cuda:0')
batch 26 loss: tensor(0.3820, device='cuda:0')
batch 27 loss: tensor(0.3836, device='cuda:0')
batch 28 loss: tensor(0.3497, device='cuda:0')
batch 29 loss: tensor(0.3558, device='cuda:0')
batch 30 loss: tensor(0.3492, device='cuda:0')
batch 31 loss: tensor(0.3612, device='cuda:0')
batch 32 loss: tensor(0.3571, device='cuda:0')
batch 33 loss: tensor(0.3380, device='cuda:0')
batch 34 loss: tensor(0.3389, device='cuda:0')
batch 35 loss: tensor(0.3287, device='cuda:0')
batch 36 loss: tensor(0.3317, device='cuda:0')
batch 37 loss: tensor(0.3274, device='cuda:0')
batch 38 loss: tensor(0.3002, device='cuda:0')
batch 39 loss: tensor(0.3442, device='cuda:0')
batch 40 loss: tensor(0.3065, device='cuda:0')
batch 41 loss: tensor(0.3231, device='cuda:0')
batch 42 loss: tensor(0.3359, device='cuda:0')
batch 43 loss: tensor(0.3021, device='cuda:0')
batch 44 loss: tensor(0.2929, device='cuda:0')
batch 45 loss: tensor(0.3117, device='cuda:0')
batch 46 loss: tensor(0.2788, device='cuda:0')
batch 47 loss: tensor(0.3046, device='cuda:0')
batch 48 loss: tensor(0.3087, device='cuda:0')
batch 49 loss: tensor(0.3685, device='cuda:0')
batch 50 loss: tensor(0.3132, device='cuda:0')
batch 51 loss: tensor(0.3390, device='cuda:0')
batch 52 loss: tensor(0.2818, device='cuda:0')
batch 53 loss: tensor(0.3030, device='cuda:0')
batch 54 loss: tensor(0.2892, device='cuda:0')
batch 55 loss: tensor(0.3315, device='cuda:0')
batch 56 loss: tensor(0.2633, device='cuda:0')
batch 57 loss: tensor(0.3197, device='cuda:0')
batch 58 loss: tensor(0.2708, device='cuda:0')
batch 59 loss: tensor(0.2672, device='cuda:0')
batch 60 loss: tensor(0.3001, device='cuda:0')
batch 61 loss: tensor(0.2642, device='cuda:0')
batch 62 loss: tensor(0.3072, device='cuda:0')
batch 63 loss: tensor(0.3022, device='cuda:0')
batch 64 loss: tensor(0.2859, device='cuda:0')
batch 65 loss: tensor(0.3170, device='cuda:0')
batch 66 loss: tensor(0.2703, device='cuda:0')
batch 67 loss: tensor(0.2828, device='cuda:0')
batch 68 loss: tensor(0.2408, device='cuda:0')
batch 69 loss: tensor(0.2920, device='cuda:0')
batch 70 loss: tensor(0.2642, device='cuda:0')
batch 71 loss: tensor(0.2656, device='cuda:0')
batch 72 loss: tensor(0.2371, device='cuda:0')
batch 73 loss: tensor(0.2779, device='cuda:0')
batch 74 loss: tensor(0.2574, device='cuda:0')
batch 75 loss: tensor(0.2488, device='cuda:0')
batch 76 loss: tensor(0.2589, device='cuda:0')
batch 77 loss: tensor(0.2940, device='cuda:0')
batch 78 loss: tensor(0.2608, device='cuda:0')
batch 79 loss: tensor(0.2730, device='cuda:0')
batch 80 loss: tensor(0.2740, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.6610, device='cuda:0')
batch 2 loss: tensor(0.4337, device='cuda:0')
batch 3 loss: tensor(0.3599, device='cuda:0')
batch 4 loss: tensor(0.2884, device='cuda:0')
batch 5 loss: tensor(0.3236, device='cuda:0')
batch 6 loss: tensor(0.2741, device='cuda:0')
batch 7 loss: tensor(0.2889, device='cuda:0')
batch 8 loss: tensor(0.2494, device='cuda:0')
batch 9 loss: tensor(0.2855, device='cuda:0')
batch 10 loss: tensor(0.3069, device='cuda:0')
batch 11 loss: tensor(0.2674, device='cuda:0')
batch 12 loss: tensor(0.2877, device='cuda:0')
batch 13 loss: tensor(0.2617, device='cuda:0')
batch 14 loss: tensor(0.3007, device='cuda:0')
batch 15 loss: tensor(0.2645, device='cuda:0')
batch 16 loss: tensor(0.2712, device='cuda:0')
batch 17 loss: tensor(0.2717, device='cuda:0')
batch 18 loss: tensor(0.2468, device='cuda:0')
batch 19 loss: tensor(0.2686, device='cuda:0')
batch 20 loss: tensor(0.3113, device='cuda:0')
batch 21 loss: tensor(0.2712, device='cuda:0')
batch 22 loss: tensor(0.2765, device='cuda:0')
batch 23 loss: tensor(0.2656, device='cuda:0')
batch 24 loss: tensor(0.2279, device='cuda:0')
batch 25 loss: tensor(0.2922, device='cuda:0')
batch 26 loss: tensor(0.2696, device='cuda:0')
batch 27 loss: tensor(0.2728, device='cuda:0')
batch 28 loss: tensor(0.2925, device='cuda:0')
batch 29 loss: tensor(0.2673, device='cuda:0')
batch 30 loss: tensor(0.2508, device='cuda:0')
batch 31 loss: tensor(0.2724, device='cuda:0')
batch 32 loss: tensor(0.2592, device='cuda:0')
batch 33 loss: tensor(0.2574, device='cuda:0')
batch 34 loss: tensor(0.3008, device='cuda:0')
batch 35 loss: tensor(0.2430, device='cuda:0')
batch 36 loss: tensor(0.2981, device='cuda:0')
batch 37 loss: tensor(0.2626, device='cuda:0')
batch 38 loss: tensor(0.2382, device='cuda:0')
batch 39 loss: tensor(0.2616, device='cuda:0')
batch 40 loss: tensor(0.3017, device='cuda:0')
batch 41 loss: tensor(0.2659, device='cuda:0')
batch 42 loss: tensor(0.2557, device='cuda:0')
batch 43 loss: tensor(0.2556, device='cuda:0')
batch 44 loss: tensor(0.2958, device='cuda:0')
batch 45 loss: tensor(0.2808, device='cuda:0')
batch 46 loss: tensor(0.2870, device='cuda:0')
batch 47 loss: tensor(0.2761, device='cuda:0')
batch 48 loss: tensor(0.2476, device='cuda:0')
batch 49 loss: tensor(0.3000, device='cuda:0')
batch 50 loss: tensor(0.2739, device='cuda:0')
batch 51 loss: tensor(0.2567, device='cuda:0')
batch 52 loss: tensor(0.2464, device='cuda:0')
batch 53 loss: tensor(0.2785, device='cuda:0')
batch 54 loss: tensor(0.2897, device='cuda:0')
batch 55 loss: tensor(0.2619, device='cuda:0')
batch 56 loss: tensor(0.2573, device='cuda:0')
batch 57 loss: tensor(0.2485, device='cuda:0')
batch 58 loss: tensor(0.2568, device='cuda:0')
batch 59 loss: tensor(0.2763, device='cuda:0')
batch 60 loss: tensor(0.3018, device='cuda:0')
batch 61 loss: tensor(0.2727, device='cuda:0')
batch 62 loss: tensor(0.2644, device='cuda:0')
batch 63 loss: tensor(0.2640, device='cuda:0')
batch 64 loss: tensor(0.2972, device='cuda:0')
batch 65 loss: tensor(0.2617, device='cuda:0')
batch 66 loss: tensor(0.2968, device='cuda:0')
batch 67 loss: tensor(0.2531, device='cuda:0')
batch 68 loss: tensor(0.2595, device='cuda:0')
batch 69 loss: tensor(0.2399, device='cuda:0')
batch 70 loss: tensor(0.2542, device='cuda:0')
batch 71 loss: tensor(0.2707, device='cuda:0')
batch 72 loss: tensor(0.2631, device='cuda:0')
batch 73 loss: tensor(0.2668, device='cuda:0')
batch 74 loss: tensor(0.2490, device='cuda:0')
batch 75 loss: tensor(0.2638, device='cuda:0')
batch 76 loss: tensor(0.2531, device='cuda:0')
batch 77 loss: tensor(0.2337, device='cuda:0')
batch 78 loss: tensor(0.2744, device='cuda:0')
batch 79 loss: tensor(0.2897, device='cuda:0')
batch 80 loss: tensor(0.2852, device='cuda:0')
accuracy in val: 0.894
accuracy in test: 0.889
average epoch time: 0.021869409084320068
total time: 3.499105453491211
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0795, device='cuda:0')
batch 2 loss: tensor(1.0459, device='cuda:0')
batch 3 loss: tensor(1.0025, device='cuda:0')
batch 4 loss: tensor(0.9475, device='cuda:0')
batch 5 loss: tensor(0.9039, device='cuda:0')
batch 6 loss: tensor(0.8318, device='cuda:0')
batch 7 loss: tensor(0.7907, device='cuda:0')
batch 8 loss: tensor(0.7169, device='cuda:0')
batch 9 loss: tensor(0.6821, device='cuda:0')
batch 10 loss: tensor(0.6261, device='cuda:0')
batch 11 loss: tensor(0.5692, device='cuda:0')
batch 12 loss: tensor(0.5695, device='cuda:0')
batch 13 loss: tensor(0.5217, device='cuda:0')
batch 14 loss: tensor(0.5151, device='cuda:0')
batch 15 loss: tensor(0.4745, device='cuda:0')
batch 16 loss: tensor(0.4769, device='cuda:0')
batch 17 loss: tensor(0.4456, device='cuda:0')
batch 18 loss: tensor(0.4438, device='cuda:0')
batch 19 loss: tensor(0.4220, device='cuda:0')
batch 20 loss: tensor(0.4125, device='cuda:0')
batch 21 loss: tensor(0.3922, device='cuda:0')
batch 22 loss: tensor(0.4101, device='cuda:0')
batch 23 loss: tensor(0.3929, device='cuda:0')
batch 24 loss: tensor(0.3544, device='cuda:0')
batch 25 loss: tensor(0.3752, device='cuda:0')
batch 26 loss: tensor(0.3873, device='cuda:0')
batch 27 loss: tensor(0.3722, device='cuda:0')
batch 28 loss: tensor(0.3495, device='cuda:0')
batch 29 loss: tensor(0.3631, device='cuda:0')
batch 30 loss: tensor(0.3383, device='cuda:0')
batch 31 loss: tensor(0.3180, device='cuda:0')
batch 32 loss: tensor(0.3446, device='cuda:0')
batch 33 loss: tensor(0.3628, device='cuda:0')
batch 34 loss: tensor(0.3440, device='cuda:0')
batch 35 loss: tensor(0.3392, device='cuda:0')
batch 36 loss: tensor(0.3298, device='cuda:0')
batch 37 loss: tensor(0.3209, device='cuda:0')
batch 38 loss: tensor(0.3462, device='cuda:0')
batch 39 loss: tensor(0.3174, device='cuda:0')
batch 40 loss: tensor(0.3199, device='cuda:0')
batch 41 loss: tensor(0.3114, device='cuda:0')
batch 42 loss: tensor(0.3087, device='cuda:0')
batch 43 loss: tensor(0.3079, device='cuda:0')
batch 44 loss: tensor(0.3105, device='cuda:0')
batch 45 loss: tensor(0.2886, device='cuda:0')
batch 46 loss: tensor(0.3273, device='cuda:0')
batch 47 loss: tensor(0.3192, device='cuda:0')
batch 48 loss: tensor(0.3315, device='cuda:0')
batch 49 loss: tensor(0.3224, device='cuda:0')
batch 50 loss: tensor(0.3038, device='cuda:0')
batch 51 loss: tensor(0.3148, device='cuda:0')
batch 52 loss: tensor(0.2718, device='cuda:0')
batch 53 loss: tensor(0.2943, device='cuda:0')
batch 54 loss: tensor(0.2869, device='cuda:0')
batch 55 loss: tensor(0.3199, device='cuda:0')
batch 56 loss: tensor(0.3093, device='cuda:0')
batch 57 loss: tensor(0.3150, device='cuda:0')
batch 58 loss: tensor(0.2993, device='cuda:0')
batch 59 loss: tensor(0.2986, device='cuda:0')
batch 60 loss: tensor(0.2808, device='cuda:0')
batch 61 loss: tensor(0.3178, device='cuda:0')
batch 62 loss: tensor(0.2702, device='cuda:0')
batch 63 loss: tensor(0.2970, device='cuda:0')
batch 64 loss: tensor(0.2765, device='cuda:0')
batch 65 loss: tensor(0.2877, device='cuda:0')
batch 66 loss: tensor(0.2795, device='cuda:0')
batch 67 loss: tensor(0.2536, device='cuda:0')
batch 68 loss: tensor(0.2999, device='cuda:0')
batch 69 loss: tensor(0.2891, device='cuda:0')
batch 70 loss: tensor(0.2598, device='cuda:0')
batch 71 loss: tensor(0.2595, device='cuda:0')
batch 72 loss: tensor(0.2565, device='cuda:0')
batch 73 loss: tensor(0.2729, device='cuda:0')
batch 74 loss: tensor(0.3028, device='cuda:0')
batch 75 loss: tensor(0.2977, device='cuda:0')
batch 76 loss: tensor(0.3063, device='cuda:0')
batch 77 loss: tensor(0.2459, device='cuda:0')
batch 78 loss: tensor(0.2489, device='cuda:0')
batch 79 loss: tensor(0.2745, device='cuda:0')
batch 80 loss: tensor(0.2772, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5483, device='cuda:0')
batch 2 loss: tensor(0.3654, device='cuda:0')
batch 3 loss: tensor(0.3274, device='cuda:0')
batch 4 loss: tensor(0.2800, device='cuda:0')
batch 5 loss: tensor(0.2861, device='cuda:0')
batch 6 loss: tensor(0.3237, device='cuda:0')
batch 7 loss: tensor(0.3083, device='cuda:0')
batch 8 loss: tensor(0.2828, device='cuda:0')
batch 9 loss: tensor(0.2893, device='cuda:0')
batch 10 loss: tensor(0.2684, device='cuda:0')
batch 11 loss: tensor(0.3201, device='cuda:0')
batch 12 loss: tensor(0.2767, device='cuda:0')
batch 13 loss: tensor(0.3061, device='cuda:0')
batch 14 loss: tensor(0.2576, device='cuda:0')
batch 15 loss: tensor(0.2797, device='cuda:0')
batch 16 loss: tensor(0.2930, device='cuda:0')
batch 17 loss: tensor(0.2453, device='cuda:0')
batch 18 loss: tensor(0.2926, device='cuda:0')
batch 19 loss: tensor(0.2882, device='cuda:0')
batch 20 loss: tensor(0.2794, device='cuda:0')
batch 21 loss: tensor(0.2639, device='cuda:0')
batch 22 loss: tensor(0.2629, device='cuda:0')
batch 23 loss: tensor(0.2126, device='cuda:0')
batch 24 loss: tensor(0.2715, device='cuda:0')
batch 25 loss: tensor(0.2601, device='cuda:0')
batch 26 loss: tensor(0.2757, device='cuda:0')
batch 27 loss: tensor(0.2911, device='cuda:0')
batch 28 loss: tensor(0.2597, device='cuda:0')
batch 29 loss: tensor(0.2779, device='cuda:0')
batch 30 loss: tensor(0.2679, device='cuda:0')
batch 31 loss: tensor(0.2904, device='cuda:0')
batch 32 loss: tensor(0.2705, device='cuda:0')
batch 33 loss: tensor(0.2517, device='cuda:0')
batch 34 loss: tensor(0.2897, device='cuda:0')
batch 35 loss: tensor(0.2614, device='cuda:0')
batch 36 loss: tensor(0.2573, device='cuda:0')
batch 37 loss: tensor(0.2544, device='cuda:0')
batch 38 loss: tensor(0.2833, device='cuda:0')
batch 39 loss: tensor(0.2715, device='cuda:0')
batch 40 loss: tensor(0.2841, device='cuda:0')
batch 41 loss: tensor(0.2533, device='cuda:0')
batch 42 loss: tensor(0.2569, device='cuda:0')
batch 43 loss: tensor(0.2691, device='cuda:0')
batch 44 loss: tensor(0.2319, device='cuda:0')
batch 45 loss: tensor(0.2440, device='cuda:0')
batch 46 loss: tensor(0.2978, device='cuda:0')
batch 47 loss: tensor(0.2574, device='cuda:0')
batch 48 loss: tensor(0.2490, device='cuda:0')
batch 49 loss: tensor(0.2611, device='cuda:0')
batch 50 loss: tensor(0.2711, device='cuda:0')
batch 51 loss: tensor(0.2600, device='cuda:0')
batch 52 loss: tensor(0.2823, device='cuda:0')
batch 53 loss: tensor(0.2880, device='cuda:0')
batch 54 loss: tensor(0.2782, device='cuda:0')
batch 55 loss: tensor(0.2951, device='cuda:0')
batch 56 loss: tensor(0.2741, device='cuda:0')
batch 57 loss: tensor(0.2868, device='cuda:0')
batch 58 loss: tensor(0.2537, device='cuda:0')
batch 59 loss: tensor(0.2849, device='cuda:0')
batch 60 loss: tensor(0.2721, device='cuda:0')
batch 61 loss: tensor(0.2428, device='cuda:0')
batch 62 loss: tensor(0.2701, device='cuda:0')
batch 63 loss: tensor(0.2882, device='cuda:0')
batch 64 loss: tensor(0.2738, device='cuda:0')
batch 65 loss: tensor(0.2557, device='cuda:0')
batch 66 loss: tensor(0.2975, device='cuda:0')
batch 67 loss: tensor(0.2932, device='cuda:0')
batch 68 loss: tensor(0.2977, device='cuda:0')
batch 69 loss: tensor(0.2765, device='cuda:0')
batch 70 loss: tensor(0.2500, device='cuda:0')
batch 71 loss: tensor(0.2820, device='cuda:0')
batch 72 loss: tensor(0.2563, device='cuda:0')
batch 73 loss: tensor(0.2881, device='cuda:0')
batch 74 loss: tensor(0.2504, device='cuda:0')
batch 75 loss: tensor(0.2452, device='cuda:0')
batch 76 loss: tensor(0.2629, device='cuda:0')
batch 77 loss: tensor(0.2536, device='cuda:0')
batch 78 loss: tensor(0.2894, device='cuda:0')
batch 79 loss: tensor(0.2834, device='cuda:0')
batch 80 loss: tensor(0.2833, device='cuda:0')
accuracy in val: 0.892
accuracy in test: 0.887
average epoch time: 0.024720631539821625
total time: 3.95530104637146
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0786, device='cuda:0')
batch 2 loss: tensor(1.0480, device='cuda:0')
batch 3 loss: tensor(1.0103, device='cuda:0')
batch 4 loss: tensor(0.9629, device='cuda:0')
batch 5 loss: tensor(0.9078, device='cuda:0')
batch 6 loss: tensor(0.8490, device='cuda:0')
batch 7 loss: tensor(0.7963, device='cuda:0')
batch 8 loss: tensor(0.7269, device='cuda:0')
batch 9 loss: tensor(0.6816, device='cuda:0')
batch 10 loss: tensor(0.6157, device='cuda:0')
batch 11 loss: tensor(0.5954, device='cuda:0')
batch 12 loss: tensor(0.5663, device='cuda:0')
batch 13 loss: tensor(0.5420, device='cuda:0')
batch 14 loss: tensor(0.4997, device='cuda:0')
batch 15 loss: tensor(0.4672, device='cuda:0')
batch 16 loss: tensor(0.4371, device='cuda:0')
batch 17 loss: tensor(0.4353, device='cuda:0')
batch 18 loss: tensor(0.4285, device='cuda:0')
batch 19 loss: tensor(0.4350, device='cuda:0')
batch 20 loss: tensor(0.3983, device='cuda:0')
batch 21 loss: tensor(0.3814, device='cuda:0')
batch 22 loss: tensor(0.3990, device='cuda:0')
batch 23 loss: tensor(0.3893, device='cuda:0')
batch 24 loss: tensor(0.3522, device='cuda:0')
batch 25 loss: tensor(0.3974, device='cuda:0')
batch 26 loss: tensor(0.3823, device='cuda:0')
batch 27 loss: tensor(0.3595, device='cuda:0')
batch 28 loss: tensor(0.3631, device='cuda:0')
batch 29 loss: tensor(0.3424, device='cuda:0')
batch 30 loss: tensor(0.3940, device='cuda:0')
batch 31 loss: tensor(0.3072, device='cuda:0')
batch 32 loss: tensor(0.3268, device='cuda:0')
batch 33 loss: tensor(0.3101, device='cuda:0')
batch 34 loss: tensor(0.3231, device='cuda:0')
batch 35 loss: tensor(0.3362, device='cuda:0')
batch 36 loss: tensor(0.3193, device='cuda:0')
batch 37 loss: tensor(0.3179, device='cuda:0')
batch 38 loss: tensor(0.3104, device='cuda:0')
batch 39 loss: tensor(0.3383, device='cuda:0')
batch 40 loss: tensor(0.3137, device='cuda:0')
batch 41 loss: tensor(0.3089, device='cuda:0')
batch 42 loss: tensor(0.3198, device='cuda:0')
batch 43 loss: tensor(0.3323, device='cuda:0')
batch 44 loss: tensor(0.3274, device='cuda:0')
batch 45 loss: tensor(0.3251, device='cuda:0')
batch 46 loss: tensor(0.3217, device='cuda:0')
batch 47 loss: tensor(0.2762, device='cuda:0')
batch 48 loss: tensor(0.2937, device='cuda:0')
batch 49 loss: tensor(0.2992, device='cuda:0')
batch 50 loss: tensor(0.3038, device='cuda:0')
batch 51 loss: tensor(0.2720, device='cuda:0')
batch 52 loss: tensor(0.2775, device='cuda:0')
batch 53 loss: tensor(0.2758, device='cuda:0')
batch 54 loss: tensor(0.2934, device='cuda:0')
batch 55 loss: tensor(0.3251, device='cuda:0')
batch 56 loss: tensor(0.3027, device='cuda:0')
batch 57 loss: tensor(0.2960, device='cuda:0')
batch 58 loss: tensor(0.2817, device='cuda:0')
batch 59 loss: tensor(0.2919, device='cuda:0')
batch 60 loss: tensor(0.3021, device='cuda:0')
batch 61 loss: tensor(0.2923, device='cuda:0')
batch 62 loss: tensor(0.2974, device='cuda:0')
batch 63 loss: tensor(0.2786, device='cuda:0')
batch 64 loss: tensor(0.2843, device='cuda:0')
batch 65 loss: tensor(0.2954, device='cuda:0')
batch 66 loss: tensor(0.2977, device='cuda:0')
batch 67 loss: tensor(0.2926, device='cuda:0')
batch 68 loss: tensor(0.2993, device='cuda:0')
batch 69 loss: tensor(0.2847, device='cuda:0')
batch 70 loss: tensor(0.2577, device='cuda:0')
batch 71 loss: tensor(0.2586, device='cuda:0')
batch 72 loss: tensor(0.2384, device='cuda:0')
batch 73 loss: tensor(0.2414, device='cuda:0')
batch 74 loss: tensor(0.2672, device='cuda:0')
batch 75 loss: tensor(0.2799, device='cuda:0')
batch 76 loss: tensor(0.2854, device='cuda:0')
batch 77 loss: tensor(0.2380, device='cuda:0')
batch 78 loss: tensor(0.2588, device='cuda:0')
batch 79 loss: tensor(0.2603, device='cuda:0')
batch 80 loss: tensor(0.2454, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5680, device='cuda:0')
batch 2 loss: tensor(0.3919, device='cuda:0')
batch 3 loss: tensor(0.3237, device='cuda:0')
batch 4 loss: tensor(0.3000, device='cuda:0')
batch 5 loss: tensor(0.2880, device='cuda:0')
batch 6 loss: tensor(0.2961, device='cuda:0')
batch 7 loss: tensor(0.3073, device='cuda:0')
batch 8 loss: tensor(0.2799, device='cuda:0')
batch 9 loss: tensor(0.2645, device='cuda:0')
batch 10 loss: tensor(0.2752, device='cuda:0')
batch 11 loss: tensor(0.2848, device='cuda:0')
batch 12 loss: tensor(0.2626, device='cuda:0')
batch 13 loss: tensor(0.2525, device='cuda:0')
batch 14 loss: tensor(0.2914, device='cuda:0')
batch 15 loss: tensor(0.3074, device='cuda:0')
batch 16 loss: tensor(0.2792, device='cuda:0')
batch 17 loss: tensor(0.2492, device='cuda:0')
batch 18 loss: tensor(0.2556, device='cuda:0')
batch 19 loss: tensor(0.2614, device='cuda:0')
batch 20 loss: tensor(0.2455, device='cuda:0')
batch 21 loss: tensor(0.2576, device='cuda:0')
batch 22 loss: tensor(0.3087, device='cuda:0')
batch 23 loss: tensor(0.2620, device='cuda:0')
batch 24 loss: tensor(0.2604, device='cuda:0')
batch 25 loss: tensor(0.2641, device='cuda:0')
batch 26 loss: tensor(0.3093, device='cuda:0')
batch 27 loss: tensor(0.2789, device='cuda:0')
batch 28 loss: tensor(0.3168, device='cuda:0')
batch 29 loss: tensor(0.3340, device='cuda:0')
batch 30 loss: tensor(0.2502, device='cuda:0')
batch 31 loss: tensor(0.2584, device='cuda:0')
batch 32 loss: tensor(0.3266, device='cuda:0')
batch 33 loss: tensor(0.2804, device='cuda:0')
batch 34 loss: tensor(0.2941, device='cuda:0')
batch 35 loss: tensor(0.2901, device='cuda:0')
batch 36 loss: tensor(0.2708, device='cuda:0')
batch 37 loss: tensor(0.2497, device='cuda:0')
batch 38 loss: tensor(0.2658, device='cuda:0')
batch 39 loss: tensor(0.2696, device='cuda:0')
batch 40 loss: tensor(0.2641, device='cuda:0')
batch 41 loss: tensor(0.2969, device='cuda:0')
batch 42 loss: tensor(0.2702, device='cuda:0')
batch 43 loss: tensor(0.2638, device='cuda:0')
batch 44 loss: tensor(0.2491, device='cuda:0')
batch 45 loss: tensor(0.2765, device='cuda:0')
batch 46 loss: tensor(0.2755, device='cuda:0')
batch 47 loss: tensor(0.3100, device='cuda:0')
batch 48 loss: tensor(0.2963, device='cuda:0')
batch 49 loss: tensor(0.2361, device='cuda:0')
batch 50 loss: tensor(0.3111, device='cuda:0')
batch 51 loss: tensor(0.2595, device='cuda:0')
batch 52 loss: tensor(0.2598, device='cuda:0')
batch 53 loss: tensor(0.2900, device='cuda:0')
batch 54 loss: tensor(0.2854, device='cuda:0')
batch 55 loss: tensor(0.2433, device='cuda:0')
batch 56 loss: tensor(0.3067, device='cuda:0')
batch 57 loss: tensor(0.2869, device='cuda:0')
batch 58 loss: tensor(0.2438, device='cuda:0')
batch 59 loss: tensor(0.2576, device='cuda:0')
batch 60 loss: tensor(0.2389, device='cuda:0')
batch 61 loss: tensor(0.2831, device='cuda:0')
batch 62 loss: tensor(0.2690, device='cuda:0')
batch 63 loss: tensor(0.2676, device='cuda:0')
batch 64 loss: tensor(0.2652, device='cuda:0')
batch 65 loss: tensor(0.2650, device='cuda:0')
batch 66 loss: tensor(0.2797, device='cuda:0')
batch 67 loss: tensor(0.2680, device='cuda:0')
batch 68 loss: tensor(0.2519, device='cuda:0')
batch 69 loss: tensor(0.2562, device='cuda:0')
batch 70 loss: tensor(0.2809, device='cuda:0')
batch 71 loss: tensor(0.2258, device='cuda:0')
batch 72 loss: tensor(0.3058, device='cuda:0')
batch 73 loss: tensor(0.2633, device='cuda:0')
batch 74 loss: tensor(0.2570, device='cuda:0')
batch 75 loss: tensor(0.2588, device='cuda:0')
batch 76 loss: tensor(0.2775, device='cuda:0')
batch 77 loss: tensor(0.2667, device='cuda:0')
batch 78 loss: tensor(0.2533, device='cuda:0')
batch 79 loss: tensor(0.2606, device='cuda:0')
batch 80 loss: tensor(0.2582, device='cuda:0')
accuracy in val: 0.898
accuracy in test: 0.89
average epoch time: 0.021903853118419647
total time: 3.5046164989471436

0.8891 3.7668862342834473
0.0022113344387495997 0.28496393474881565
Thu Nov 21 15:42:58 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    58W / 149W |    352MiB / 12206MiB |     10%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   35C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28485      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:43:21 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    57W / 149W |    352MiB / 12206MiB |     10%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   35C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28485      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:43:43 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    58W / 149W |    352MiB / 12206MiB |     10%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   35C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28485      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:44:06 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    58W / 149W |    352MiB / 12206MiB |      9%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   35C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28485      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:44:29 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   36C    P0    58W / 149W |    352MiB / 12206MiB |      6%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   35C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28485      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:44:52 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   36C    P0    58W / 149W |    352MiB / 12206MiB |      6%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   35C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28485      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:45:14 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    57W / 149W |    352MiB / 12206MiB |      5%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   35C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28485      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:45:37 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    57W / 149W |    352MiB / 12206MiB |      7%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   35C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28485      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:46:00 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   36C    P0    57W / 149W |    352MiB / 12206MiB |      8%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   35C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28485      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 15:46:22 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   36C    P0    58W / 149W |    352MiB / 12206MiB |      7%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   35C    P8    30W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14827      G   /usr/bin/X                                    19MiB |
|    0     28485      C   python                                       321MiB |
|    1     14827      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
{'dataset': 'pubmed', 'config_file': 'pubmed.yaml', 'layer_num': 2, 'epoch_num': [100, 100]}
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0819, device='cuda:0')
batch 2 loss: tensor(1.0495, device='cuda:0')
batch 3 loss: tensor(1.0075, device='cuda:0')
batch 4 loss: tensor(0.9583, device='cuda:0')
batch 5 loss: tensor(0.9035, device='cuda:0')
batch 6 loss: tensor(0.8533, device='cuda:0')
batch 7 loss: tensor(0.7852, device='cuda:0')
batch 8 loss: tensor(0.7272, device='cuda:0')
batch 9 loss: tensor(0.6973, device='cuda:0')
batch 10 loss: tensor(0.6456, device='cuda:0')
batch 11 loss: tensor(0.6003, device='cuda:0')
batch 12 loss: tensor(0.5566, device='cuda:0')
batch 13 loss: tensor(0.5320, device='cuda:0')
batch 14 loss: tensor(0.5082, device='cuda:0')
batch 15 loss: tensor(0.5077, device='cuda:0')
batch 16 loss: tensor(0.4558, device='cuda:0')
batch 17 loss: tensor(0.4631, device='cuda:0')
batch 18 loss: tensor(0.4231, device='cuda:0')
batch 19 loss: tensor(0.3982, device='cuda:0')
batch 20 loss: tensor(0.4348, device='cuda:0')
batch 21 loss: tensor(0.4045, device='cuda:0')
batch 22 loss: tensor(0.3774, device='cuda:0')
batch 23 loss: tensor(0.3858, device='cuda:0')
batch 24 loss: tensor(0.3815, device='cuda:0')
batch 25 loss: tensor(0.3728, device='cuda:0')
batch 26 loss: tensor(0.3707, device='cuda:0')
batch 27 loss: tensor(0.3606, device='cuda:0')
batch 28 loss: tensor(0.3543, device='cuda:0')
batch 29 loss: tensor(0.3678, device='cuda:0')
batch 30 loss: tensor(0.3329, device='cuda:0')
batch 31 loss: tensor(0.3442, device='cuda:0')
batch 32 loss: tensor(0.3410, device='cuda:0')
batch 33 loss: tensor(0.3305, device='cuda:0')
batch 34 loss: tensor(0.3535, device='cuda:0')
batch 35 loss: tensor(0.3174, device='cuda:0')
batch 36 loss: tensor(0.3667, device='cuda:0')
batch 37 loss: tensor(0.3211, device='cuda:0')
batch 38 loss: tensor(0.3675, device='cuda:0')
batch 39 loss: tensor(0.3121, device='cuda:0')
batch 40 loss: tensor(0.3082, device='cuda:0')
batch 41 loss: tensor(0.3242, device='cuda:0')
batch 42 loss: tensor(0.3486, device='cuda:0')
batch 43 loss: tensor(0.2983, device='cuda:0')
batch 44 loss: tensor(0.3212, device='cuda:0')
batch 45 loss: tensor(0.3106, device='cuda:0')
batch 46 loss: tensor(0.3138, device='cuda:0')
batch 47 loss: tensor(0.2989, device='cuda:0')
batch 48 loss: tensor(0.3183, device='cuda:0')
batch 49 loss: tensor(0.2990, device='cuda:0')
batch 50 loss: tensor(0.3131, device='cuda:0')
batch 51 loss: tensor(0.3097, device='cuda:0')
batch 52 loss: tensor(0.2740, device='cuda:0')
batch 53 loss: tensor(0.2548, device='cuda:0')
batch 54 loss: tensor(0.2820, device='cuda:0')
batch 55 loss: tensor(0.2906, device='cuda:0')
batch 56 loss: tensor(0.2960, device='cuda:0')
batch 57 loss: tensor(0.2701, device='cuda:0')
batch 58 loss: tensor(0.2915, device='cuda:0')
batch 59 loss: tensor(0.2895, device='cuda:0')
batch 60 loss: tensor(0.3126, device='cuda:0')
batch 61 loss: tensor(0.2912, device='cuda:0')
batch 62 loss: tensor(0.3002, device='cuda:0')
batch 63 loss: tensor(0.2529, device='cuda:0')
batch 64 loss: tensor(0.2528, device='cuda:0')
batch 65 loss: tensor(0.2758, device='cuda:0')
batch 66 loss: tensor(0.2792, device='cuda:0')
batch 67 loss: tensor(0.3021, device='cuda:0')
batch 68 loss: tensor(0.2637, device='cuda:0')
batch 69 loss: tensor(0.2985, device='cuda:0')
batch 70 loss: tensor(0.2959, device='cuda:0')
batch 71 loss: tensor(0.2908, device='cuda:0')
batch 72 loss: tensor(0.2628, device='cuda:0')
batch 73 loss: tensor(0.2844, device='cuda:0')
batch 74 loss: tensor(0.2850, device='cuda:0')
batch 75 loss: tensor(0.2397, device='cuda:0')
batch 76 loss: tensor(0.2688, device='cuda:0')
batch 77 loss: tensor(0.2719, device='cuda:0')
batch 78 loss: tensor(0.2569, device='cuda:0')
batch 79 loss: tensor(0.2583, device='cuda:0')
batch 80 loss: tensor(0.2486, device='cuda:0')
batch 81 loss: tensor(0.3032, device='cuda:0')
batch 82 loss: tensor(0.2565, device='cuda:0')
batch 83 loss: tensor(0.2426, device='cuda:0')
batch 84 loss: tensor(0.2930, device='cuda:0')
batch 85 loss: tensor(0.2519, device='cuda:0')
batch 86 loss: tensor(0.2714, device='cuda:0')
batch 87 loss: tensor(0.2746, device='cuda:0')
batch 88 loss: tensor(0.2278, device='cuda:0')
batch 89 loss: tensor(0.2659, device='cuda:0')
batch 90 loss: tensor(0.2764, device='cuda:0')
batch 91 loss: tensor(0.2988, device='cuda:0')
batch 92 loss: tensor(0.3021, device='cuda:0')
batch 93 loss: tensor(0.2423, device='cuda:0')
batch 94 loss: tensor(0.2465, device='cuda:0')
batch 95 loss: tensor(0.2559, device='cuda:0')
batch 96 loss: tensor(0.2871, device='cuda:0')
batch 97 loss: tensor(0.2841, device='cuda:0')
batch 98 loss: tensor(0.2680, device='cuda:0')
batch 99 loss: tensor(0.2573, device='cuda:0')
batch 100 loss: tensor(0.2633, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.8560, device='cuda:0')
batch 2 loss: tensor(0.6014, device='cuda:0')
batch 3 loss: tensor(0.4191, device='cuda:0')
batch 4 loss: tensor(0.3260, device='cuda:0')
batch 5 loss: tensor(0.3071, device='cuda:0')
batch 6 loss: tensor(0.3043, device='cuda:0')
batch 7 loss: tensor(0.2906, device='cuda:0')
batch 8 loss: tensor(0.2490, device='cuda:0')
batch 9 loss: tensor(0.2881, device='cuda:0')
batch 10 loss: tensor(0.2750, device='cuda:0')
batch 11 loss: tensor(0.2798, device='cuda:0')
batch 12 loss: tensor(0.2719, device='cuda:0')
batch 13 loss: tensor(0.2772, device='cuda:0')
batch 14 loss: tensor(0.2572, device='cuda:0')
batch 15 loss: tensor(0.2945, device='cuda:0')
batch 16 loss: tensor(0.2492, device='cuda:0')
batch 17 loss: tensor(0.2781, device='cuda:0')
batch 18 loss: tensor(0.2453, device='cuda:0')
batch 19 loss: tensor(0.2482, device='cuda:0')
batch 20 loss: tensor(0.2531, device='cuda:0')
batch 21 loss: tensor(0.2729, device='cuda:0')
batch 22 loss: tensor(0.2661, device='cuda:0')
batch 23 loss: tensor(0.2678, device='cuda:0')
batch 24 loss: tensor(0.2190, device='cuda:0')
batch 25 loss: tensor(0.2584, device='cuda:0')
batch 26 loss: tensor(0.2692, device='cuda:0')
batch 27 loss: tensor(0.2506, device='cuda:0')
batch 28 loss: tensor(0.2729, device='cuda:0')
batch 29 loss: tensor(0.2793, device='cuda:0')
batch 30 loss: tensor(0.2640, device='cuda:0')
batch 31 loss: tensor(0.2827, device='cuda:0')
batch 32 loss: tensor(0.2496, device='cuda:0')
batch 33 loss: tensor(0.2587, device='cuda:0')
batch 34 loss: tensor(0.2708, device='cuda:0')
batch 35 loss: tensor(0.2674, device='cuda:0')
batch 36 loss: tensor(0.2574, device='cuda:0')
batch 37 loss: tensor(0.2452, device='cuda:0')
batch 38 loss: tensor(0.2538, device='cuda:0')
batch 39 loss: tensor(0.2307, device='cuda:0')
batch 40 loss: tensor(0.2647, device='cuda:0')
batch 41 loss: tensor(0.2605, device='cuda:0')
batch 42 loss: tensor(0.2577, device='cuda:0')
batch 43 loss: tensor(0.2442, device='cuda:0')
batch 44 loss: tensor(0.2742, device='cuda:0')
batch 45 loss: tensor(0.2552, device='cuda:0')
batch 46 loss: tensor(0.2451, device='cuda:0')
batch 47 loss: tensor(0.2607, device='cuda:0')
batch 48 loss: tensor(0.2643, device='cuda:0')
batch 49 loss: tensor(0.2621, device='cuda:0')
batch 50 loss: tensor(0.2522, device='cuda:0')
batch 51 loss: tensor(0.2993, device='cuda:0')
batch 52 loss: tensor(0.2764, device='cuda:0')
batch 53 loss: tensor(0.2850, device='cuda:0')
batch 54 loss: tensor(0.2837, device='cuda:0')
batch 55 loss: tensor(0.2539, device='cuda:0')
batch 56 loss: tensor(0.2388, device='cuda:0')
batch 57 loss: tensor(0.2387, device='cuda:0')
batch 58 loss: tensor(0.2546, device='cuda:0')
batch 59 loss: tensor(0.2800, device='cuda:0')
batch 60 loss: tensor(0.2647, device='cuda:0')
batch 61 loss: tensor(0.2603, device='cuda:0')
batch 62 loss: tensor(0.2764, device='cuda:0')
batch 63 loss: tensor(0.2480, device='cuda:0')
batch 64 loss: tensor(0.2248, device='cuda:0')
batch 65 loss: tensor(0.2137, device='cuda:0')
batch 66 loss: tensor(0.2459, device='cuda:0')
batch 67 loss: tensor(0.2645, device='cuda:0')
batch 68 loss: tensor(0.2373, device='cuda:0')
batch 69 loss: tensor(0.2725, device='cuda:0')
batch 70 loss: tensor(0.2497, device='cuda:0')
batch 71 loss: tensor(0.2450, device='cuda:0')
batch 72 loss: tensor(0.2537, device='cuda:0')
batch 73 loss: tensor(0.2660, device='cuda:0')
batch 74 loss: tensor(0.2462, device='cuda:0')
batch 75 loss: tensor(0.2407, device='cuda:0')
batch 76 loss: tensor(0.2902, device='cuda:0')
batch 77 loss: tensor(0.2545, device='cuda:0')
batch 78 loss: tensor(0.2465, device='cuda:0')
batch 79 loss: tensor(0.2449, device='cuda:0')
batch 80 loss: tensor(0.2495, device='cuda:0')
batch 81 loss: tensor(0.2711, device='cuda:0')
batch 82 loss: tensor(0.2555, device='cuda:0')
batch 83 loss: tensor(0.2768, device='cuda:0')
batch 84 loss: tensor(0.2675, device='cuda:0')
batch 85 loss: tensor(0.2561, device='cuda:0')
batch 86 loss: tensor(0.2742, device='cuda:0')
batch 87 loss: tensor(0.2905, device='cuda:0')
batch 88 loss: tensor(0.2691, device='cuda:0')
batch 89 loss: tensor(0.2620, device='cuda:0')
batch 90 loss: tensor(0.2483, device='cuda:0')
batch 91 loss: tensor(0.2647, device='cuda:0')
batch 92 loss: tensor(0.2624, device='cuda:0')
batch 93 loss: tensor(0.2747, device='cuda:0')
batch 94 loss: tensor(0.2467, device='cuda:0')
batch 95 loss: tensor(0.2594, device='cuda:0')
batch 96 loss: tensor(0.2632, device='cuda:0')
batch 97 loss: tensor(0.2800, device='cuda:0')
batch 98 loss: tensor(0.2429, device='cuda:0')
batch 99 loss: tensor(0.2714, device='cuda:0')
batch 100 loss: tensor(0.2510, device='cuda:0')
accuracy in val: 0.89
accuracy in test: 0.888
average epoch time: 0.022684944868087767
total time: 4.536988973617554
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0793, device='cuda:0')
batch 2 loss: tensor(1.0438, device='cuda:0')
batch 3 loss: tensor(1.0018, device='cuda:0')
batch 4 loss: tensor(0.9453, device='cuda:0')
batch 5 loss: tensor(0.8920, device='cuda:0')
batch 6 loss: tensor(0.8421, device='cuda:0')
batch 7 loss: tensor(0.7834, device='cuda:0')
batch 8 loss: tensor(0.7257, device='cuda:0')
batch 9 loss: tensor(0.6848, device='cuda:0')
batch 10 loss: tensor(0.6363, device='cuda:0')
batch 11 loss: tensor(0.5750, device='cuda:0')
batch 12 loss: tensor(0.5883, device='cuda:0')
batch 13 loss: tensor(0.5523, device='cuda:0')
batch 14 loss: tensor(0.4898, device='cuda:0')
batch 15 loss: tensor(0.4902, device='cuda:0')
batch 16 loss: tensor(0.4877, device='cuda:0')
batch 17 loss: tensor(0.4564, device='cuda:0')
batch 18 loss: tensor(0.4447, device='cuda:0')
batch 19 loss: tensor(0.3997, device='cuda:0')
batch 20 loss: tensor(0.4137, device='cuda:0')
batch 21 loss: tensor(0.3915, device='cuda:0')
batch 22 loss: tensor(0.3952, device='cuda:0')
batch 23 loss: tensor(0.3929, device='cuda:0')
batch 24 loss: tensor(0.3739, device='cuda:0')
batch 25 loss: tensor(0.3588, device='cuda:0')
batch 26 loss: tensor(0.3567, device='cuda:0')
batch 27 loss: tensor(0.3709, device='cuda:0')
batch 28 loss: tensor(0.3533, device='cuda:0')
batch 29 loss: tensor(0.3232, device='cuda:0')
batch 30 loss: tensor(0.3610, device='cuda:0')
batch 31 loss: tensor(0.3416, device='cuda:0')
batch 32 loss: tensor(0.3199, device='cuda:0')
batch 33 loss: tensor(0.3400, device='cuda:0')
batch 34 loss: tensor(0.3521, device='cuda:0')
batch 35 loss: tensor(0.3303, device='cuda:0')
batch 36 loss: tensor(0.3128, device='cuda:0')
batch 37 loss: tensor(0.3230, device='cuda:0')
batch 38 loss: tensor(0.3325, device='cuda:0')
batch 39 loss: tensor(0.3378, device='cuda:0')
batch 40 loss: tensor(0.3081, device='cuda:0')
batch 41 loss: tensor(0.3223, device='cuda:0')
batch 42 loss: tensor(0.3304, device='cuda:0')
batch 43 loss: tensor(0.3091, device='cuda:0')
batch 44 loss: tensor(0.2929, device='cuda:0')
batch 45 loss: tensor(0.3139, device='cuda:0')
batch 46 loss: tensor(0.3182, device='cuda:0')
batch 47 loss: tensor(0.3037, device='cuda:0')
batch 48 loss: tensor(0.3228, device='cuda:0')
batch 49 loss: tensor(0.2954, device='cuda:0')
batch 50 loss: tensor(0.2862, device='cuda:0')
batch 51 loss: tensor(0.3008, device='cuda:0')
batch 52 loss: tensor(0.2894, device='cuda:0')
batch 53 loss: tensor(0.2922, device='cuda:0')
batch 54 loss: tensor(0.3107, device='cuda:0')
batch 55 loss: tensor(0.2864, device='cuda:0')
batch 56 loss: tensor(0.3280, device='cuda:0')
batch 57 loss: tensor(0.2826, device='cuda:0')
batch 58 loss: tensor(0.3051, device='cuda:0')
batch 59 loss: tensor(0.2590, device='cuda:0')
batch 60 loss: tensor(0.2969, device='cuda:0')
batch 61 loss: tensor(0.2732, device='cuda:0')
batch 62 loss: tensor(0.3036, device='cuda:0')
batch 63 loss: tensor(0.2842, device='cuda:0')
batch 64 loss: tensor(0.2493, device='cuda:0')
batch 65 loss: tensor(0.2882, device='cuda:0')
batch 66 loss: tensor(0.2777, device='cuda:0')
batch 67 loss: tensor(0.2628, device='cuda:0')
batch 68 loss: tensor(0.2618, device='cuda:0')
batch 69 loss: tensor(0.3169, device='cuda:0')
batch 70 loss: tensor(0.3332, device='cuda:0')
batch 71 loss: tensor(0.2812, device='cuda:0')
batch 72 loss: tensor(0.2921, device='cuda:0')
batch 73 loss: tensor(0.2379, device='cuda:0')
batch 74 loss: tensor(0.3394, device='cuda:0')
batch 75 loss: tensor(0.2897, device='cuda:0')
batch 76 loss: tensor(0.2664, device='cuda:0')
batch 77 loss: tensor(0.2841, device='cuda:0')
batch 78 loss: tensor(0.2780, device='cuda:0')
batch 79 loss: tensor(0.2704, device='cuda:0')
batch 80 loss: tensor(0.2433, device='cuda:0')
batch 81 loss: tensor(0.2708, device='cuda:0')
batch 82 loss: tensor(0.2590, device='cuda:0')
batch 83 loss: tensor(0.3163, device='cuda:0')
batch 84 loss: tensor(0.2588, device='cuda:0')
batch 85 loss: tensor(0.2656, device='cuda:0')
batch 86 loss: tensor(0.2979, device='cuda:0')
batch 87 loss: tensor(0.2572, device='cuda:0')
batch 88 loss: tensor(0.2648, device='cuda:0')
batch 89 loss: tensor(0.2663, device='cuda:0')
batch 90 loss: tensor(0.2629, device='cuda:0')
batch 91 loss: tensor(0.2431, device='cuda:0')
batch 92 loss: tensor(0.2481, device='cuda:0')
batch 93 loss: tensor(0.2779, device='cuda:0')
batch 94 loss: tensor(0.2470, device='cuda:0')
batch 95 loss: tensor(0.2742, device='cuda:0')
batch 96 loss: tensor(0.2479, device='cuda:0')
batch 97 loss: tensor(0.2476, device='cuda:0')
batch 98 loss: tensor(0.2592, device='cuda:0')
batch 99 loss: tensor(0.2756, device='cuda:0')
batch 100 loss: tensor(0.2681, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.8754, device='cuda:0')
batch 2 loss: tensor(0.5808, device='cuda:0')
batch 3 loss: tensor(0.4486, device='cuda:0')
batch 4 loss: tensor(0.3791, device='cuda:0')
batch 5 loss: tensor(0.3094, device='cuda:0')
batch 6 loss: tensor(0.2934, device='cuda:0')
batch 7 loss: tensor(0.2843, device='cuda:0')
batch 8 loss: tensor(0.3160, device='cuda:0')
batch 9 loss: tensor(0.2982, device='cuda:0')
batch 10 loss: tensor(0.2820, device='cuda:0')
batch 11 loss: tensor(0.2581, device='cuda:0')
batch 12 loss: tensor(0.2663, device='cuda:0')
batch 13 loss: tensor(0.2729, device='cuda:0')
batch 14 loss: tensor(0.2770, device='cuda:0')
batch 15 loss: tensor(0.2696, device='cuda:0')
batch 16 loss: tensor(0.2336, device='cuda:0')
batch 17 loss: tensor(0.2548, device='cuda:0')
batch 18 loss: tensor(0.2847, device='cuda:0')
batch 19 loss: tensor(0.2679, device='cuda:0')
batch 20 loss: tensor(0.3064, device='cuda:0')
batch 21 loss: tensor(0.2499, device='cuda:0')
batch 22 loss: tensor(0.2810, device='cuda:0')
batch 23 loss: tensor(0.2840, device='cuda:0')
batch 24 loss: tensor(0.2803, device='cuda:0')
batch 25 loss: tensor(0.2982, device='cuda:0')
batch 26 loss: tensor(0.2626, device='cuda:0')
batch 27 loss: tensor(0.2812, device='cuda:0')
batch 28 loss: tensor(0.2560, device='cuda:0')
batch 29 loss: tensor(0.2731, device='cuda:0')
batch 30 loss: tensor(0.2583, device='cuda:0')
batch 31 loss: tensor(0.2819, device='cuda:0')
batch 32 loss: tensor(0.2312, device='cuda:0')
batch 33 loss: tensor(0.2857, device='cuda:0')
batch 34 loss: tensor(0.2321, device='cuda:0')
batch 35 loss: tensor(0.2676, device='cuda:0')
batch 36 loss: tensor(0.2210, device='cuda:0')
batch 37 loss: tensor(0.2592, device='cuda:0')
batch 38 loss: tensor(0.2732, device='cuda:0')
batch 39 loss: tensor(0.2588, device='cuda:0')
batch 40 loss: tensor(0.2882, device='cuda:0')
batch 41 loss: tensor(0.2749, device='cuda:0')
batch 42 loss: tensor(0.2526, device='cuda:0')
batch 43 loss: tensor(0.2507, device='cuda:0')
batch 44 loss: tensor(0.2372, device='cuda:0')
batch 45 loss: tensor(0.2753, device='cuda:0')
batch 46 loss: tensor(0.2519, device='cuda:0')
batch 47 loss: tensor(0.2595, device='cuda:0')
batch 48 loss: tensor(0.2708, device='cuda:0')
batch 49 loss: tensor(0.2323, device='cuda:0')
batch 50 loss: tensor(0.2981, device='cuda:0')
batch 51 loss: tensor(0.2904, device='cuda:0')
batch 52 loss: tensor(0.2706, device='cuda:0')
batch 53 loss: tensor(0.2421, device='cuda:0')
batch 54 loss: tensor(0.2693, device='cuda:0')
batch 55 loss: tensor(0.2610, device='cuda:0')
batch 56 loss: tensor(0.2828, device='cuda:0')
batch 57 loss: tensor(0.2562, device='cuda:0')
batch 58 loss: tensor(0.2329, device='cuda:0')
batch 59 loss: tensor(0.2691, device='cuda:0')
batch 60 loss: tensor(0.2826, device='cuda:0')
batch 61 loss: tensor(0.2442, device='cuda:0')
batch 62 loss: tensor(0.2688, device='cuda:0')
batch 63 loss: tensor(0.2852, device='cuda:0')
batch 64 loss: tensor(0.2714, device='cuda:0')
batch 65 loss: tensor(0.2774, device='cuda:0')
batch 66 loss: tensor(0.2984, device='cuda:0')
batch 67 loss: tensor(0.2902, device='cuda:0')
batch 68 loss: tensor(0.2753, device='cuda:0')
batch 69 loss: tensor(0.2389, device='cuda:0')
batch 70 loss: tensor(0.2783, device='cuda:0')
batch 71 loss: tensor(0.2549, device='cuda:0')
batch 72 loss: tensor(0.2401, device='cuda:0')
batch 73 loss: tensor(0.2575, device='cuda:0')
batch 74 loss: tensor(0.2525, device='cuda:0')
batch 75 loss: tensor(0.2156, device='cuda:0')
batch 76 loss: tensor(0.2616, device='cuda:0')
batch 77 loss: tensor(0.3026, device='cuda:0')
batch 78 loss: tensor(0.2734, device='cuda:0')
batch 79 loss: tensor(0.2525, device='cuda:0')
batch 80 loss: tensor(0.2758, device='cuda:0')
batch 81 loss: tensor(0.2508, device='cuda:0')
batch 82 loss: tensor(0.2031, device='cuda:0')
batch 83 loss: tensor(0.2473, device='cuda:0')
batch 84 loss: tensor(0.2810, device='cuda:0')
batch 85 loss: tensor(0.2232, device='cuda:0')
batch 86 loss: tensor(0.2703, device='cuda:0')
batch 87 loss: tensor(0.2813, device='cuda:0')
batch 88 loss: tensor(0.2607, device='cuda:0')
batch 89 loss: tensor(0.2673, device='cuda:0')
batch 90 loss: tensor(0.2422, device='cuda:0')
batch 91 loss: tensor(0.2774, device='cuda:0')
batch 92 loss: tensor(0.2885, device='cuda:0')
batch 93 loss: tensor(0.2607, device='cuda:0')
batch 94 loss: tensor(0.2769, device='cuda:0')
batch 95 loss: tensor(0.2264, device='cuda:0')
batch 96 loss: tensor(0.2477, device='cuda:0')
batch 97 loss: tensor(0.2471, device='cuda:0')
batch 98 loss: tensor(0.2519, device='cuda:0')
batch 99 loss: tensor(0.2793, device='cuda:0')
batch 100 loss: tensor(0.2763, device='cuda:0')
accuracy in val: 0.8960000000000001
accuracy in test: 0.888
average epoch time: 0.022017279863357542
total time: 4.403455972671509
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0746, device='cuda:0')
batch 2 loss: tensor(1.0377, device='cuda:0')
batch 3 loss: tensor(0.9947, device='cuda:0')
batch 4 loss: tensor(0.9535, device='cuda:0')
batch 5 loss: tensor(0.8987, device='cuda:0')
batch 6 loss: tensor(0.8621, device='cuda:0')
batch 7 loss: tensor(0.8099, device='cuda:0')
batch 8 loss: tensor(0.7575, device='cuda:0')
batch 9 loss: tensor(0.7018, device='cuda:0')
batch 10 loss: tensor(0.6684, device='cuda:0')
batch 11 loss: tensor(0.5964, device='cuda:0')
batch 12 loss: tensor(0.6061, device='cuda:0')
batch 13 loss: tensor(0.5547, device='cuda:0')
batch 14 loss: tensor(0.5240, device='cuda:0')
batch 15 loss: tensor(0.4726, device='cuda:0')
batch 16 loss: tensor(0.4670, device='cuda:0')
batch 17 loss: tensor(0.4485, device='cuda:0')
batch 18 loss: tensor(0.4465, device='cuda:0')
batch 19 loss: tensor(0.4318, device='cuda:0')
batch 20 loss: tensor(0.4077, device='cuda:0')
batch 21 loss: tensor(0.4380, device='cuda:0')
batch 22 loss: tensor(0.3869, device='cuda:0')
batch 23 loss: tensor(0.3799, device='cuda:0')
batch 24 loss: tensor(0.3804, device='cuda:0')
batch 25 loss: tensor(0.3621, device='cuda:0')
batch 26 loss: tensor(0.3932, device='cuda:0')
batch 27 loss: tensor(0.3747, device='cuda:0')
batch 28 loss: tensor(0.3498, device='cuda:0')
batch 29 loss: tensor(0.3560, device='cuda:0')
batch 30 loss: tensor(0.3577, device='cuda:0')
batch 31 loss: tensor(0.3315, device='cuda:0')
batch 32 loss: tensor(0.3313, device='cuda:0')
batch 33 loss: tensor(0.3572, device='cuda:0')
batch 34 loss: tensor(0.3453, device='cuda:0')
batch 35 loss: tensor(0.3202, device='cuda:0')
batch 36 loss: tensor(0.3303, device='cuda:0')
batch 37 loss: tensor(0.3093, device='cuda:0')
batch 38 loss: tensor(0.3400, device='cuda:0')
batch 39 loss: tensor(0.3288, device='cuda:0')
batch 40 loss: tensor(0.3318, device='cuda:0')
batch 41 loss: tensor(0.3165, device='cuda:0')
batch 42 loss: tensor(0.2983, device='cuda:0')
batch 43 loss: tensor(0.3390, device='cuda:0')
batch 44 loss: tensor(0.3257, device='cuda:0')
batch 45 loss: tensor(0.3112, device='cuda:0')
batch 46 loss: tensor(0.2977, device='cuda:0')
batch 47 loss: tensor(0.3281, device='cuda:0')
batch 48 loss: tensor(0.3046, device='cuda:0')
batch 49 loss: tensor(0.2984, device='cuda:0')
batch 50 loss: tensor(0.2982, device='cuda:0')
batch 51 loss: tensor(0.3145, device='cuda:0')
batch 52 loss: tensor(0.2790, device='cuda:0')
batch 53 loss: tensor(0.3035, device='cuda:0')
batch 54 loss: tensor(0.2816, device='cuda:0')
batch 55 loss: tensor(0.3027, device='cuda:0')
batch 56 loss: tensor(0.2781, device='cuda:0')
batch 57 loss: tensor(0.2861, device='cuda:0')
batch 58 loss: tensor(0.3055, device='cuda:0')
batch 59 loss: tensor(0.3218, device='cuda:0')
batch 60 loss: tensor(0.2970, device='cuda:0')
batch 61 loss: tensor(0.3023, device='cuda:0')
batch 62 loss: tensor(0.2863, device='cuda:0')
batch 63 loss: tensor(0.3000, device='cuda:0')
batch 64 loss: tensor(0.2828, device='cuda:0')
batch 65 loss: tensor(0.2728, device='cuda:0')
batch 66 loss: tensor(0.3042, device='cuda:0')
batch 67 loss: tensor(0.2659, device='cuda:0')
batch 68 loss: tensor(0.3032, device='cuda:0')
batch 69 loss: tensor(0.2799, device='cuda:0')
batch 70 loss: tensor(0.2823, device='cuda:0')
batch 71 loss: tensor(0.2770, device='cuda:0')
batch 72 loss: tensor(0.2863, device='cuda:0')
batch 73 loss: tensor(0.2515, device='cuda:0')
batch 74 loss: tensor(0.2746, device='cuda:0')
batch 75 loss: tensor(0.2743, device='cuda:0')
batch 76 loss: tensor(0.2332, device='cuda:0')
batch 77 loss: tensor(0.2670, device='cuda:0')
batch 78 loss: tensor(0.2828, device='cuda:0')
batch 79 loss: tensor(0.2579, device='cuda:0')
batch 80 loss: tensor(0.2444, device='cuda:0')
batch 81 loss: tensor(0.2514, device='cuda:0')
batch 82 loss: tensor(0.2674, device='cuda:0')
batch 83 loss: tensor(0.2470, device='cuda:0')
batch 84 loss: tensor(0.2559, device='cuda:0')
batch 85 loss: tensor(0.2640, device='cuda:0')
batch 86 loss: tensor(0.2950, device='cuda:0')
batch 87 loss: tensor(0.2553, device='cuda:0')
batch 88 loss: tensor(0.2557, device='cuda:0')
batch 89 loss: tensor(0.2672, device='cuda:0')
batch 90 loss: tensor(0.2504, device='cuda:0')
batch 91 loss: tensor(0.2705, device='cuda:0')
batch 92 loss: tensor(0.2457, device='cuda:0')
batch 93 loss: tensor(0.2673, device='cuda:0')
batch 94 loss: tensor(0.2662, device='cuda:0')
batch 95 loss: tensor(0.2525, device='cuda:0')
batch 96 loss: tensor(0.2712, device='cuda:0')
batch 97 loss: tensor(0.2476, device='cuda:0')
batch 98 loss: tensor(0.2457, device='cuda:0')
batch 99 loss: tensor(0.2368, device='cuda:0')
batch 100 loss: tensor(0.2598, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(1.0033, device='cuda:0')
batch 2 loss: tensor(0.5132, device='cuda:0')
batch 3 loss: tensor(0.3869, device='cuda:0')
batch 4 loss: tensor(0.3311, device='cuda:0')
batch 5 loss: tensor(0.3159, device='cuda:0')
batch 6 loss: tensor(0.3064, device='cuda:0')
batch 7 loss: tensor(0.2903, device='cuda:0')
batch 8 loss: tensor(0.2720, device='cuda:0')
batch 9 loss: tensor(0.2553, device='cuda:0')
batch 10 loss: tensor(0.2791, device='cuda:0')
batch 11 loss: tensor(0.2568, device='cuda:0')
batch 12 loss: tensor(0.2649, device='cuda:0')
batch 13 loss: tensor(0.2631, device='cuda:0')
batch 14 loss: tensor(0.2919, device='cuda:0')
batch 15 loss: tensor(0.2259, device='cuda:0')
batch 16 loss: tensor(0.2517, device='cuda:0')
batch 17 loss: tensor(0.2464, device='cuda:0')
batch 18 loss: tensor(0.2634, device='cuda:0')
batch 19 loss: tensor(0.2515, device='cuda:0')
batch 20 loss: tensor(0.2841, device='cuda:0')
batch 21 loss: tensor(0.2732, device='cuda:0')
batch 22 loss: tensor(0.2938, device='cuda:0')
batch 23 loss: tensor(0.2483, device='cuda:0')
batch 24 loss: tensor(0.2743, device='cuda:0')
batch 25 loss: tensor(0.2810, device='cuda:0')
batch 26 loss: tensor(0.2427, device='cuda:0')
batch 27 loss: tensor(0.2739, device='cuda:0')
batch 28 loss: tensor(0.2201, device='cuda:0')
batch 29 loss: tensor(0.2909, device='cuda:0')
batch 30 loss: tensor(0.2744, device='cuda:0')
batch 31 loss: tensor(0.2260, device='cuda:0')
batch 32 loss: tensor(0.2289, device='cuda:0')
batch 33 loss: tensor(0.2252, device='cuda:0')
batch 34 loss: tensor(0.2753, device='cuda:0')
batch 35 loss: tensor(0.2538, device='cuda:0')
batch 36 loss: tensor(0.2988, device='cuda:0')
batch 37 loss: tensor(0.2282, device='cuda:0')
batch 38 loss: tensor(0.2791, device='cuda:0')
batch 39 loss: tensor(0.2751, device='cuda:0')
batch 40 loss: tensor(0.2557, device='cuda:0')
batch 41 loss: tensor(0.2781, device='cuda:0')
batch 42 loss: tensor(0.2461, device='cuda:0')
batch 43 loss: tensor(0.2735, device='cuda:0')
batch 44 loss: tensor(0.2469, device='cuda:0')
batch 45 loss: tensor(0.2677, device='cuda:0')
batch 46 loss: tensor(0.2577, device='cuda:0')
batch 47 loss: tensor(0.2484, device='cuda:0')
batch 48 loss: tensor(0.2732, device='cuda:0')
batch 49 loss: tensor(0.2567, device='cuda:0')
batch 50 loss: tensor(0.2483, device='cuda:0')
batch 51 loss: tensor(0.2860, device='cuda:0')
batch 52 loss: tensor(0.2544, device='cuda:0')
batch 53 loss: tensor(0.2791, device='cuda:0')
batch 54 loss: tensor(0.3044, device='cuda:0')
batch 55 loss: tensor(0.2652, device='cuda:0')
batch 56 loss: tensor(0.2447, device='cuda:0')
batch 57 loss: tensor(0.2668, device='cuda:0')
batch 58 loss: tensor(0.2552, device='cuda:0')
batch 59 loss: tensor(0.2526, device='cuda:0')
batch 60 loss: tensor(0.3139, device='cuda:0')
batch 61 loss: tensor(0.2554, device='cuda:0')
batch 62 loss: tensor(0.2359, device='cuda:0')
batch 63 loss: tensor(0.2105, device='cuda:0')
batch 64 loss: tensor(0.2931, device='cuda:0')
batch 65 loss: tensor(0.2746, device='cuda:0')
batch 66 loss: tensor(0.2626, device='cuda:0')
batch 67 loss: tensor(0.2919, device='cuda:0')
batch 68 loss: tensor(0.2924, device='cuda:0')
batch 69 loss: tensor(0.2766, device='cuda:0')
batch 70 loss: tensor(0.2395, device='cuda:0')
batch 71 loss: tensor(0.2786, device='cuda:0')
batch 72 loss: tensor(0.2400, device='cuda:0')
batch 73 loss: tensor(0.2673, device='cuda:0')
batch 74 loss: tensor(0.2529, device='cuda:0')
batch 75 loss: tensor(0.2533, device='cuda:0')
batch 76 loss: tensor(0.2989, device='cuda:0')
batch 77 loss: tensor(0.2691, device='cuda:0')
batch 78 loss: tensor(0.2874, device='cuda:0')
batch 79 loss: tensor(0.2712, device='cuda:0')
batch 80 loss: tensor(0.2106, device='cuda:0')
batch 81 loss: tensor(0.2652, device='cuda:0')
batch 82 loss: tensor(0.2811, device='cuda:0')
batch 83 loss: tensor(0.2533, device='cuda:0')
batch 84 loss: tensor(0.2439, device='cuda:0')
batch 85 loss: tensor(0.2453, device='cuda:0')
batch 86 loss: tensor(0.2642, device='cuda:0')
batch 87 loss: tensor(0.2714, device='cuda:0')
batch 88 loss: tensor(0.2391, device='cuda:0')
batch 89 loss: tensor(0.2435, device='cuda:0')
batch 90 loss: tensor(0.2242, device='cuda:0')
batch 91 loss: tensor(0.2579, device='cuda:0')
batch 92 loss: tensor(0.2662, device='cuda:0')
batch 93 loss: tensor(0.2619, device='cuda:0')
batch 94 loss: tensor(0.2391, device='cuda:0')
batch 95 loss: tensor(0.2547, device='cuda:0')
batch 96 loss: tensor(0.2372, device='cuda:0')
batch 97 loss: tensor(0.2806, device='cuda:0')
batch 98 loss: tensor(0.2460, device='cuda:0')
batch 99 loss: tensor(0.2673, device='cuda:0')
batch 100 loss: tensor(0.2492, device='cuda:0')
accuracy in val: 0.8960000000000001
accuracy in test: 0.894
average epoch time: 0.022697038650512695
total time: 4.539407730102539
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0788, device='cuda:0')
batch 2 loss: tensor(1.0474, device='cuda:0')
batch 3 loss: tensor(1.0030, device='cuda:0')
batch 4 loss: tensor(0.9523, device='cuda:0')
batch 5 loss: tensor(0.8963, device='cuda:0')
batch 6 loss: tensor(0.8390, device='cuda:0')
batch 7 loss: tensor(0.7707, device='cuda:0')
batch 8 loss: tensor(0.7337, device='cuda:0')
batch 9 loss: tensor(0.6692, device='cuda:0')
batch 10 loss: tensor(0.6256, device='cuda:0')
batch 11 loss: tensor(0.5596, device='cuda:0')
batch 12 loss: tensor(0.5397, device='cuda:0')
batch 13 loss: tensor(0.5222, device='cuda:0')
batch 14 loss: tensor(0.4837, device='cuda:0')
batch 15 loss: tensor(0.4871, device='cuda:0')
batch 16 loss: tensor(0.4662, device='cuda:0')
batch 17 loss: tensor(0.4061, device='cuda:0')
batch 18 loss: tensor(0.4180, device='cuda:0')
batch 19 loss: tensor(0.4090, device='cuda:0')
batch 20 loss: tensor(0.3853, device='cuda:0')
batch 21 loss: tensor(0.3907, device='cuda:0')
batch 22 loss: tensor(0.3824, device='cuda:0')
batch 23 loss: tensor(0.3808, device='cuda:0')
batch 24 loss: tensor(0.3833, device='cuda:0')
batch 25 loss: tensor(0.3480, device='cuda:0')
batch 26 loss: tensor(0.3643, device='cuda:0')
batch 27 loss: tensor(0.3326, device='cuda:0')
batch 28 loss: tensor(0.3360, device='cuda:0')
batch 29 loss: tensor(0.3412, device='cuda:0')
batch 30 loss: tensor(0.3571, device='cuda:0')
batch 31 loss: tensor(0.3601, device='cuda:0')
batch 32 loss: tensor(0.3671, device='cuda:0')
batch 33 loss: tensor(0.3207, device='cuda:0')
batch 34 loss: tensor(0.3296, device='cuda:0')
batch 35 loss: tensor(0.3093, device='cuda:0')
batch 36 loss: tensor(0.3146, device='cuda:0')
batch 37 loss: tensor(0.3555, device='cuda:0')
batch 38 loss: tensor(0.3230, device='cuda:0')
batch 39 loss: tensor(0.2998, device='cuda:0')
batch 40 loss: tensor(0.3165, device='cuda:0')
batch 41 loss: tensor(0.3288, device='cuda:0')
batch 42 loss: tensor(0.3042, device='cuda:0')
batch 43 loss: tensor(0.3615, device='cuda:0')
batch 44 loss: tensor(0.3169, device='cuda:0')
batch 45 loss: tensor(0.2965, device='cuda:0')
batch 46 loss: tensor(0.3031, device='cuda:0')
batch 47 loss: tensor(0.2977, device='cuda:0')
batch 48 loss: tensor(0.3325, device='cuda:0')
batch 49 loss: tensor(0.3089, device='cuda:0')
batch 50 loss: tensor(0.2933, device='cuda:0')
batch 51 loss: tensor(0.3074, device='cuda:0')
batch 52 loss: tensor(0.2690, device='cuda:0')
batch 53 loss: tensor(0.2661, device='cuda:0')
batch 54 loss: tensor(0.2909, device='cuda:0')
batch 55 loss: tensor(0.2859, device='cuda:0')
batch 56 loss: tensor(0.2826, device='cuda:0')
batch 57 loss: tensor(0.2880, device='cuda:0')
batch 58 loss: tensor(0.2665, device='cuda:0')
batch 59 loss: tensor(0.2715, device='cuda:0')
batch 60 loss: tensor(0.2703, device='cuda:0')
batch 61 loss: tensor(0.2797, device='cuda:0')
batch 62 loss: tensor(0.2699, device='cuda:0')
batch 63 loss: tensor(0.2739, device='cuda:0')
batch 64 loss: tensor(0.2959, device='cuda:0')
batch 65 loss: tensor(0.2838, device='cuda:0')
batch 66 loss: tensor(0.2764, device='cuda:0')
batch 67 loss: tensor(0.2686, device='cuda:0')
batch 68 loss: tensor(0.2772, device='cuda:0')
batch 69 loss: tensor(0.2647, device='cuda:0')
batch 70 loss: tensor(0.2479, device='cuda:0')
batch 71 loss: tensor(0.2495, device='cuda:0')
batch 72 loss: tensor(0.2687, device='cuda:0')
batch 73 loss: tensor(0.2787, device='cuda:0')
batch 74 loss: tensor(0.2844, device='cuda:0')
batch 75 loss: tensor(0.2996, device='cuda:0')
batch 76 loss: tensor(0.2735, device='cuda:0')
batch 77 loss: tensor(0.2677, device='cuda:0')
batch 78 loss: tensor(0.2883, device='cuda:0')
batch 79 loss: tensor(0.2705, device='cuda:0')
batch 80 loss: tensor(0.2822, device='cuda:0')
batch 81 loss: tensor(0.2885, device='cuda:0')
batch 82 loss: tensor(0.2599, device='cuda:0')
batch 83 loss: tensor(0.2732, device='cuda:0')
batch 84 loss: tensor(0.2479, device='cuda:0')
batch 85 loss: tensor(0.2795, device='cuda:0')
batch 86 loss: tensor(0.3114, device='cuda:0')
batch 87 loss: tensor(0.2414, device='cuda:0')
batch 88 loss: tensor(0.2520, device='cuda:0')
batch 89 loss: tensor(0.2671, device='cuda:0')
batch 90 loss: tensor(0.2343, device='cuda:0')
batch 91 loss: tensor(0.2479, device='cuda:0')
batch 92 loss: tensor(0.2584, device='cuda:0')
batch 93 loss: tensor(0.2777, device='cuda:0')
batch 94 loss: tensor(0.2673, device='cuda:0')
batch 95 loss: tensor(0.2483, device='cuda:0')
batch 96 loss: tensor(0.2652, device='cuda:0')
batch 97 loss: tensor(0.2604, device='cuda:0')
batch 98 loss: tensor(0.2389, device='cuda:0')
batch 99 loss: tensor(0.2660, device='cuda:0')
batch 100 loss: tensor(0.2593, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.8809, device='cuda:0')
batch 2 loss: tensor(0.5025, device='cuda:0')
batch 3 loss: tensor(0.3524, device='cuda:0')
batch 4 loss: tensor(0.3127, device='cuda:0')
batch 5 loss: tensor(0.2780, device='cuda:0')
batch 6 loss: tensor(0.3082, device='cuda:0')
batch 7 loss: tensor(0.2774, device='cuda:0')
batch 8 loss: tensor(0.2668, device='cuda:0')
batch 9 loss: tensor(0.2989, device='cuda:0')
batch 10 loss: tensor(0.2816, device='cuda:0')
batch 11 loss: tensor(0.2754, device='cuda:0')
batch 12 loss: tensor(0.2752, device='cuda:0')
batch 13 loss: tensor(0.2859, device='cuda:0')
batch 14 loss: tensor(0.2892, device='cuda:0')
batch 15 loss: tensor(0.2814, device='cuda:0')
batch 16 loss: tensor(0.2728, device='cuda:0')
batch 17 loss: tensor(0.2570, device='cuda:0')
batch 18 loss: tensor(0.2750, device='cuda:0')
batch 19 loss: tensor(0.2714, device='cuda:0')
batch 20 loss: tensor(0.2271, device='cuda:0')
batch 21 loss: tensor(0.2603, device='cuda:0')
batch 22 loss: tensor(0.2767, device='cuda:0')
batch 23 loss: tensor(0.2620, device='cuda:0')
batch 24 loss: tensor(0.2608, device='cuda:0')
batch 25 loss: tensor(0.2624, device='cuda:0')
batch 26 loss: tensor(0.2547, device='cuda:0')
batch 27 loss: tensor(0.2298, device='cuda:0')
batch 28 loss: tensor(0.2586, device='cuda:0')
batch 29 loss: tensor(0.2470, device='cuda:0')
batch 30 loss: tensor(0.2428, device='cuda:0')
batch 31 loss: tensor(0.2593, device='cuda:0')
batch 32 loss: tensor(0.2668, device='cuda:0')
batch 33 loss: tensor(0.2691, device='cuda:0')
batch 34 loss: tensor(0.2574, device='cuda:0')
batch 35 loss: tensor(0.2818, device='cuda:0')
batch 36 loss: tensor(0.2826, device='cuda:0')
batch 37 loss: tensor(0.2617, device='cuda:0')
batch 38 loss: tensor(0.2948, device='cuda:0')
batch 39 loss: tensor(0.2931, device='cuda:0')
batch 40 loss: tensor(0.3114, device='cuda:0')
batch 41 loss: tensor(0.2888, device='cuda:0')
batch 42 loss: tensor(0.2437, device='cuda:0')
batch 43 loss: tensor(0.2501, device='cuda:0')
batch 44 loss: tensor(0.2673, device='cuda:0')
batch 45 loss: tensor(0.2558, device='cuda:0')
batch 46 loss: tensor(0.2733, device='cuda:0')
batch 47 loss: tensor(0.2379, device='cuda:0')
batch 48 loss: tensor(0.2513, device='cuda:0')
batch 49 loss: tensor(0.2272, device='cuda:0')
batch 50 loss: tensor(0.2792, device='cuda:0')
batch 51 loss: tensor(0.2506, device='cuda:0')
batch 52 loss: tensor(0.2568, device='cuda:0')
batch 53 loss: tensor(0.2342, device='cuda:0')
batch 54 loss: tensor(0.2695, device='cuda:0')
batch 55 loss: tensor(0.2611, device='cuda:0')
batch 56 loss: tensor(0.2763, device='cuda:0')
batch 57 loss: tensor(0.2645, device='cuda:0')
batch 58 loss: tensor(0.2600, device='cuda:0')
batch 59 loss: tensor(0.2661, device='cuda:0')
batch 60 loss: tensor(0.2358, device='cuda:0')
batch 61 loss: tensor(0.2739, device='cuda:0')
batch 62 loss: tensor(0.2380, device='cuda:0')
batch 63 loss: tensor(0.2450, device='cuda:0')
batch 64 loss: tensor(0.2642, device='cuda:0')
batch 65 loss: tensor(0.2562, device='cuda:0')
batch 66 loss: tensor(0.2936, device='cuda:0')
batch 67 loss: tensor(0.2333, device='cuda:0')
batch 68 loss: tensor(0.2535, device='cuda:0')
batch 69 loss: tensor(0.2819, device='cuda:0')
batch 70 loss: tensor(0.2603, device='cuda:0')
batch 71 loss: tensor(0.2551, device='cuda:0')
batch 72 loss: tensor(0.2427, device='cuda:0')
batch 73 loss: tensor(0.2533, device='cuda:0')
batch 74 loss: tensor(0.2695, device='cuda:0')
batch 75 loss: tensor(0.2711, device='cuda:0')
batch 76 loss: tensor(0.2357, device='cuda:0')
batch 77 loss: tensor(0.2233, device='cuda:0')
batch 78 loss: tensor(0.2896, device='cuda:0')
batch 79 loss: tensor(0.2753, device='cuda:0')
batch 80 loss: tensor(0.2421, device='cuda:0')
batch 81 loss: tensor(0.2606, device='cuda:0')
batch 82 loss: tensor(0.2480, device='cuda:0')
batch 83 loss: tensor(0.2697, device='cuda:0')
batch 84 loss: tensor(0.2952, device='cuda:0')
batch 85 loss: tensor(0.2628, device='cuda:0')
batch 86 loss: tensor(0.2702, device='cuda:0')
batch 87 loss: tensor(0.2625, device='cuda:0')
batch 88 loss: tensor(0.2656, device='cuda:0')
batch 89 loss: tensor(0.2529, device='cuda:0')
batch 90 loss: tensor(0.2327, device='cuda:0')
batch 91 loss: tensor(0.2470, device='cuda:0')
batch 92 loss: tensor(0.2260, device='cuda:0')
batch 93 loss: tensor(0.2591, device='cuda:0')
batch 94 loss: tensor(0.2601, device='cuda:0')
batch 95 loss: tensor(0.2580, device='cuda:0')
batch 96 loss: tensor(0.2569, device='cuda:0')
batch 97 loss: tensor(0.2542, device='cuda:0')
batch 98 loss: tensor(0.2322, device='cuda:0')
batch 99 loss: tensor(0.2487, device='cuda:0')
batch 100 loss: tensor(0.2542, device='cuda:0')
accuracy in val: 0.898
accuracy in test: 0.893
average epoch time: 0.024509363174438477
total time: 4.901872634887695
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0714, device='cuda:0')
batch 2 loss: tensor(1.0325, device='cuda:0')
batch 3 loss: tensor(0.9811, device='cuda:0')
batch 4 loss: tensor(0.9333, device='cuda:0')
batch 5 loss: tensor(0.8741, device='cuda:0')
batch 6 loss: tensor(0.8170, device='cuda:0')
batch 7 loss: tensor(0.7578, device='cuda:0')
batch 8 loss: tensor(0.6885, device='cuda:0')
batch 9 loss: tensor(0.6554, device='cuda:0')
batch 10 loss: tensor(0.6177, device='cuda:0')
batch 11 loss: tensor(0.5605, device='cuda:0')
batch 12 loss: tensor(0.5399, device='cuda:0')
batch 13 loss: tensor(0.5024, device='cuda:0')
batch 14 loss: tensor(0.4780, device='cuda:0')
batch 15 loss: tensor(0.4694, device='cuda:0')
batch 16 loss: tensor(0.4525, device='cuda:0')
batch 17 loss: tensor(0.4270, device='cuda:0')
batch 18 loss: tensor(0.4089, device='cuda:0')
batch 19 loss: tensor(0.4023, device='cuda:0')
batch 20 loss: tensor(0.4091, device='cuda:0')
batch 21 loss: tensor(0.3910, device='cuda:0')
batch 22 loss: tensor(0.3838, device='cuda:0')
batch 23 loss: tensor(0.3706, device='cuda:0')
batch 24 loss: tensor(0.3708, device='cuda:0')
batch 25 loss: tensor(0.3418, device='cuda:0')
batch 26 loss: tensor(0.3764, device='cuda:0')
batch 27 loss: tensor(0.3719, device='cuda:0')
batch 28 loss: tensor(0.3243, device='cuda:0')
batch 29 loss: tensor(0.3651, device='cuda:0')
batch 30 loss: tensor(0.3721, device='cuda:0')
batch 31 loss: tensor(0.3450, device='cuda:0')
batch 32 loss: tensor(0.3153, device='cuda:0')
batch 33 loss: tensor(0.3091, device='cuda:0')
batch 34 loss: tensor(0.3305, device='cuda:0')
batch 35 loss: tensor(0.3512, device='cuda:0')
batch 36 loss: tensor(0.3123, device='cuda:0')
batch 37 loss: tensor(0.3361, device='cuda:0')
batch 38 loss: tensor(0.3171, device='cuda:0')
batch 39 loss: tensor(0.3127, device='cuda:0')
batch 40 loss: tensor(0.3123, device='cuda:0')
batch 41 loss: tensor(0.3283, device='cuda:0')
batch 42 loss: tensor(0.2965, device='cuda:0')
batch 43 loss: tensor(0.2901, device='cuda:0')
batch 44 loss: tensor(0.3342, device='cuda:0')
batch 45 loss: tensor(0.3215, device='cuda:0')
batch 46 loss: tensor(0.3073, device='cuda:0')
batch 47 loss: tensor(0.3087, device='cuda:0')
batch 48 loss: tensor(0.3288, device='cuda:0')
batch 49 loss: tensor(0.2959, device='cuda:0')
batch 50 loss: tensor(0.3019, device='cuda:0')
batch 51 loss: tensor(0.2873, device='cuda:0')
batch 52 loss: tensor(0.2977, device='cuda:0')
batch 53 loss: tensor(0.2987, device='cuda:0')
batch 54 loss: tensor(0.2538, device='cuda:0')
batch 55 loss: tensor(0.3012, device='cuda:0')
batch 56 loss: tensor(0.3034, device='cuda:0')
batch 57 loss: tensor(0.2491, device='cuda:0')
batch 58 loss: tensor(0.2691, device='cuda:0')
batch 59 loss: tensor(0.3240, device='cuda:0')
batch 60 loss: tensor(0.3040, device='cuda:0')
batch 61 loss: tensor(0.2858, device='cuda:0')
batch 62 loss: tensor(0.2548, device='cuda:0')
batch 63 loss: tensor(0.2878, device='cuda:0')
batch 64 loss: tensor(0.2919, device='cuda:0')
batch 65 loss: tensor(0.2787, device='cuda:0')
batch 66 loss: tensor(0.2958, device='cuda:0')
batch 67 loss: tensor(0.2623, device='cuda:0')
batch 68 loss: tensor(0.2703, device='cuda:0')
batch 69 loss: tensor(0.2742, device='cuda:0')
batch 70 loss: tensor(0.2864, device='cuda:0')
batch 71 loss: tensor(0.2684, device='cuda:0')
batch 72 loss: tensor(0.2612, device='cuda:0')
batch 73 loss: tensor(0.2319, device='cuda:0')
batch 74 loss: tensor(0.3013, device='cuda:0')
batch 75 loss: tensor(0.2664, device='cuda:0')
batch 76 loss: tensor(0.2765, device='cuda:0')
batch 77 loss: tensor(0.2563, device='cuda:0')
batch 78 loss: tensor(0.2437, device='cuda:0')
batch 79 loss: tensor(0.2707, device='cuda:0')
batch 80 loss: tensor(0.2641, device='cuda:0')
batch 81 loss: tensor(0.2745, device='cuda:0')
batch 82 loss: tensor(0.2555, device='cuda:0')
batch 83 loss: tensor(0.2455, device='cuda:0')
batch 84 loss: tensor(0.2944, device='cuda:0')
batch 85 loss: tensor(0.2713, device='cuda:0')
batch 86 loss: tensor(0.2798, device='cuda:0')
batch 87 loss: tensor(0.2627, device='cuda:0')
batch 88 loss: tensor(0.2570, device='cuda:0')
batch 89 loss: tensor(0.2550, device='cuda:0')
batch 90 loss: tensor(0.2508, device='cuda:0')
batch 91 loss: tensor(0.2536, device='cuda:0')
batch 92 loss: tensor(0.2554, device='cuda:0')
batch 93 loss: tensor(0.2723, device='cuda:0')
batch 94 loss: tensor(0.2733, device='cuda:0')
batch 95 loss: tensor(0.2296, device='cuda:0')
batch 96 loss: tensor(0.2792, device='cuda:0')
batch 97 loss: tensor(0.2297, device='cuda:0')
batch 98 loss: tensor(0.2804, device='cuda:0')
batch 99 loss: tensor(0.2416, device='cuda:0')
batch 100 loss: tensor(0.2403, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(1.3000, device='cuda:0')
batch 2 loss: tensor(0.8780, device='cuda:0')
batch 3 loss: tensor(0.6818, device='cuda:0')
batch 4 loss: tensor(0.5870, device='cuda:0')
batch 5 loss: tensor(0.4949, device='cuda:0')
batch 6 loss: tensor(0.4255, device='cuda:0')
batch 7 loss: tensor(0.4258, device='cuda:0')
batch 8 loss: tensor(0.3983, device='cuda:0')
batch 9 loss: tensor(0.3737, device='cuda:0')
batch 10 loss: tensor(0.3635, device='cuda:0')
batch 11 loss: tensor(0.3044, device='cuda:0')
batch 12 loss: tensor(0.3356, device='cuda:0')
batch 13 loss: tensor(0.3249, device='cuda:0')
batch 14 loss: tensor(0.2966, device='cuda:0')
batch 15 loss: tensor(0.2674, device='cuda:0')
batch 16 loss: tensor(0.2621, device='cuda:0')
batch 17 loss: tensor(0.2657, device='cuda:0')
batch 18 loss: tensor(0.2670, device='cuda:0')
batch 19 loss: tensor(0.2759, device='cuda:0')
batch 20 loss: tensor(0.2699, device='cuda:0')
batch 21 loss: tensor(0.2581, device='cuda:0')
batch 22 loss: tensor(0.2749, device='cuda:0')
batch 23 loss: tensor(0.2558, device='cuda:0')
batch 24 loss: tensor(0.2508, device='cuda:0')
batch 25 loss: tensor(0.2435, device='cuda:0')
batch 26 loss: tensor(0.2766, device='cuda:0')
batch 27 loss: tensor(0.2670, device='cuda:0')
batch 28 loss: tensor(0.2843, device='cuda:0')
batch 29 loss: tensor(0.2734, device='cuda:0')
batch 30 loss: tensor(0.2608, device='cuda:0')
batch 31 loss: tensor(0.2878, device='cuda:0')
batch 32 loss: tensor(0.2530, device='cuda:0')
batch 33 loss: tensor(0.2626, device='cuda:0')
batch 34 loss: tensor(0.2558, device='cuda:0')
batch 35 loss: tensor(0.3137, device='cuda:0')
batch 36 loss: tensor(0.2641, device='cuda:0')
batch 37 loss: tensor(0.2813, device='cuda:0')
batch 38 loss: tensor(0.2582, device='cuda:0')
batch 39 loss: tensor(0.2455, device='cuda:0')
batch 40 loss: tensor(0.2425, device='cuda:0')
batch 41 loss: tensor(0.2490, device='cuda:0')
batch 42 loss: tensor(0.2395, device='cuda:0')
batch 43 loss: tensor(0.2382, device='cuda:0')
batch 44 loss: tensor(0.2387, device='cuda:0')
batch 45 loss: tensor(0.2550, device='cuda:0')
batch 46 loss: tensor(0.2573, device='cuda:0')
batch 47 loss: tensor(0.2564, device='cuda:0')
batch 48 loss: tensor(0.2817, device='cuda:0')
batch 49 loss: tensor(0.2610, device='cuda:0')
batch 50 loss: tensor(0.2630, device='cuda:0')
batch 51 loss: tensor(0.2718, device='cuda:0')
batch 52 loss: tensor(0.2709, device='cuda:0')
batch 53 loss: tensor(0.2785, device='cuda:0')
batch 54 loss: tensor(0.2759, device='cuda:0')
batch 55 loss: tensor(0.2739, device='cuda:0')
batch 56 loss: tensor(0.2506, device='cuda:0')
batch 57 loss: tensor(0.2611, device='cuda:0')
batch 58 loss: tensor(0.2694, device='cuda:0')
batch 59 loss: tensor(0.2682, device='cuda:0')
batch 60 loss: tensor(0.2675, device='cuda:0')
batch 61 loss: tensor(0.2833, device='cuda:0')
batch 62 loss: tensor(0.2703, device='cuda:0')
batch 63 loss: tensor(0.2594, device='cuda:0')
batch 64 loss: tensor(0.2668, device='cuda:0')
batch 65 loss: tensor(0.2794, device='cuda:0')
batch 66 loss: tensor(0.2919, device='cuda:0')
batch 67 loss: tensor(0.2517, device='cuda:0')
batch 68 loss: tensor(0.2570, device='cuda:0')
batch 69 loss: tensor(0.2785, device='cuda:0')
batch 70 loss: tensor(0.2498, device='cuda:0')
batch 71 loss: tensor(0.2399, device='cuda:0')
batch 72 loss: tensor(0.2422, device='cuda:0')
batch 73 loss: tensor(0.2639, device='cuda:0')
batch 74 loss: tensor(0.2364, device='cuda:0')
batch 75 loss: tensor(0.2844, device='cuda:0')
batch 76 loss: tensor(0.2734, device='cuda:0')
batch 77 loss: tensor(0.2524, device='cuda:0')
batch 78 loss: tensor(0.2771, device='cuda:0')
batch 79 loss: tensor(0.2889, device='cuda:0')
batch 80 loss: tensor(0.2697, device='cuda:0')
batch 81 loss: tensor(0.2521, device='cuda:0')
batch 82 loss: tensor(0.2445, device='cuda:0')
batch 83 loss: tensor(0.2394, device='cuda:0')
batch 84 loss: tensor(0.2813, device='cuda:0')
batch 85 loss: tensor(0.2509, device='cuda:0')
batch 86 loss: tensor(0.2801, device='cuda:0')
batch 87 loss: tensor(0.2440, device='cuda:0')
batch 88 loss: tensor(0.2726, device='cuda:0')
batch 89 loss: tensor(0.2435, device='cuda:0')
batch 90 loss: tensor(0.2809, device='cuda:0')
batch 91 loss: tensor(0.2749, device='cuda:0')
batch 92 loss: tensor(0.2198, device='cuda:0')
batch 93 loss: tensor(0.2650, device='cuda:0')
batch 94 loss: tensor(0.2603, device='cuda:0')
batch 95 loss: tensor(0.2502, device='cuda:0')
batch 96 loss: tensor(0.2241, device='cuda:0')
batch 97 loss: tensor(0.2493, device='cuda:0')
batch 98 loss: tensor(0.2797, device='cuda:0')
batch 99 loss: tensor(0.2917, device='cuda:0')
batch 100 loss: tensor(0.2333, device='cuda:0')
accuracy in val: 0.892
accuracy in test: 0.888
average epoch time: 0.022031625509262086
total time: 4.406325101852417
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0782, device='cuda:0')
batch 2 loss: tensor(1.0407, device='cuda:0')
batch 3 loss: tensor(0.9976, device='cuda:0')
batch 4 loss: tensor(0.9513, device='cuda:0')
batch 5 loss: tensor(0.8920, device='cuda:0')
batch 6 loss: tensor(0.8354, device='cuda:0')
batch 7 loss: tensor(0.7750, device='cuda:0')
batch 8 loss: tensor(0.7215, device='cuda:0')
batch 9 loss: tensor(0.6656, device='cuda:0')
batch 10 loss: tensor(0.6228, device='cuda:0')
batch 11 loss: tensor(0.5685, device='cuda:0')
batch 12 loss: tensor(0.5683, device='cuda:0')
batch 13 loss: tensor(0.5080, device='cuda:0')
batch 14 loss: tensor(0.4697, device='cuda:0')
batch 15 loss: tensor(0.4766, device='cuda:0')
batch 16 loss: tensor(0.4773, device='cuda:0')
batch 17 loss: tensor(0.4317, device='cuda:0')
batch 18 loss: tensor(0.4138, device='cuda:0')
batch 19 loss: tensor(0.4294, device='cuda:0')
batch 20 loss: tensor(0.4102, device='cuda:0')
batch 21 loss: tensor(0.4015, device='cuda:0')
batch 22 loss: tensor(0.4196, device='cuda:0')
batch 23 loss: tensor(0.3776, device='cuda:0')
batch 24 loss: tensor(0.3625, device='cuda:0')
batch 25 loss: tensor(0.4069, device='cuda:0')
batch 26 loss: tensor(0.3721, device='cuda:0')
batch 27 loss: tensor(0.3774, device='cuda:0')
batch 28 loss: tensor(0.3680, device='cuda:0')
batch 29 loss: tensor(0.3621, device='cuda:0')
batch 30 loss: tensor(0.3639, device='cuda:0')
batch 31 loss: tensor(0.3538, device='cuda:0')
batch 32 loss: tensor(0.3565, device='cuda:0')
batch 33 loss: tensor(0.3289, device='cuda:0')
batch 34 loss: tensor(0.2857, device='cuda:0')
batch 35 loss: tensor(0.3209, device='cuda:0')
batch 36 loss: tensor(0.3141, device='cuda:0')
batch 37 loss: tensor(0.3320, device='cuda:0')
batch 38 loss: tensor(0.3207, device='cuda:0')
batch 39 loss: tensor(0.3242, device='cuda:0')
batch 40 loss: tensor(0.3153, device='cuda:0')
batch 41 loss: tensor(0.2857, device='cuda:0')
batch 42 loss: tensor(0.3222, device='cuda:0')
batch 43 loss: tensor(0.3182, device='cuda:0')
batch 44 loss: tensor(0.3214, device='cuda:0')
batch 45 loss: tensor(0.2955, device='cuda:0')
batch 46 loss: tensor(0.3299, device='cuda:0')
batch 47 loss: tensor(0.3661, device='cuda:0')
batch 48 loss: tensor(0.2982, device='cuda:0')
batch 49 loss: tensor(0.3316, device='cuda:0')
batch 50 loss: tensor(0.2925, device='cuda:0')
batch 51 loss: tensor(0.3215, device='cuda:0')
batch 52 loss: tensor(0.3097, device='cuda:0')
batch 53 loss: tensor(0.3205, device='cuda:0')
batch 54 loss: tensor(0.3035, device='cuda:0')
batch 55 loss: tensor(0.3043, device='cuda:0')
batch 56 loss: tensor(0.3046, device='cuda:0')
batch 57 loss: tensor(0.2841, device='cuda:0')
batch 58 loss: tensor(0.2944, device='cuda:0')
batch 59 loss: tensor(0.3213, device='cuda:0')
batch 60 loss: tensor(0.3115, device='cuda:0')
batch 61 loss: tensor(0.3069, device='cuda:0')
batch 62 loss: tensor(0.3012, device='cuda:0')
batch 63 loss: tensor(0.3113, device='cuda:0')
batch 64 loss: tensor(0.3055, device='cuda:0')
batch 65 loss: tensor(0.2637, device='cuda:0')
batch 66 loss: tensor(0.2781, device='cuda:0')
batch 67 loss: tensor(0.2820, device='cuda:0')
batch 68 loss: tensor(0.2893, device='cuda:0')
batch 69 loss: tensor(0.2756, device='cuda:0')
batch 70 loss: tensor(0.2720, device='cuda:0')
batch 71 loss: tensor(0.2562, device='cuda:0')
batch 72 loss: tensor(0.2807, device='cuda:0')
batch 73 loss: tensor(0.3019, device='cuda:0')
batch 74 loss: tensor(0.2680, device='cuda:0')
batch 75 loss: tensor(0.2572, device='cuda:0')
batch 76 loss: tensor(0.2583, device='cuda:0')
batch 77 loss: tensor(0.2628, device='cuda:0')
batch 78 loss: tensor(0.2858, device='cuda:0')
batch 79 loss: tensor(0.2353, device='cuda:0')
batch 80 loss: tensor(0.2909, device='cuda:0')
batch 81 loss: tensor(0.2532, device='cuda:0')
batch 82 loss: tensor(0.2841, device='cuda:0')
batch 83 loss: tensor(0.2572, device='cuda:0')
batch 84 loss: tensor(0.2549, device='cuda:0')
batch 85 loss: tensor(0.2562, device='cuda:0')
batch 86 loss: tensor(0.2901, device='cuda:0')
batch 87 loss: tensor(0.2858, device='cuda:0')
batch 88 loss: tensor(0.2504, device='cuda:0')
batch 89 loss: tensor(0.2497, device='cuda:0')
batch 90 loss: tensor(0.2749, device='cuda:0')
batch 91 loss: tensor(0.2629, device='cuda:0')
batch 92 loss: tensor(0.2432, device='cuda:0')
batch 93 loss: tensor(0.2500, device='cuda:0')
batch 94 loss: tensor(0.2636, device='cuda:0')
batch 95 loss: tensor(0.2525, device='cuda:0')
batch 96 loss: tensor(0.2664, device='cuda:0')
batch 97 loss: tensor(0.2542, device='cuda:0')
batch 98 loss: tensor(0.2672, device='cuda:0')
batch 99 loss: tensor(0.2492, device='cuda:0')
batch 100 loss: tensor(0.2520, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.7365, device='cuda:0')
batch 2 loss: tensor(0.4770, device='cuda:0')
batch 3 loss: tensor(0.3774, device='cuda:0')
batch 4 loss: tensor(0.3204, device='cuda:0')
batch 5 loss: tensor(0.3185, device='cuda:0')
batch 6 loss: tensor(0.2949, device='cuda:0')
batch 7 loss: tensor(0.2879, device='cuda:0')
batch 8 loss: tensor(0.2758, device='cuda:0')
batch 9 loss: tensor(0.2607, device='cuda:0')
batch 10 loss: tensor(0.2550, device='cuda:0')
batch 11 loss: tensor(0.2423, device='cuda:0')
batch 12 loss: tensor(0.2344, device='cuda:0')
batch 13 loss: tensor(0.2787, device='cuda:0')
batch 14 loss: tensor(0.2559, device='cuda:0')
batch 15 loss: tensor(0.2824, device='cuda:0')
batch 16 loss: tensor(0.2816, device='cuda:0')
batch 17 loss: tensor(0.2760, device='cuda:0')
batch 18 loss: tensor(0.2611, device='cuda:0')
batch 19 loss: tensor(0.2717, device='cuda:0')
batch 20 loss: tensor(0.2726, device='cuda:0')
batch 21 loss: tensor(0.2302, device='cuda:0')
batch 22 loss: tensor(0.2538, device='cuda:0')
batch 23 loss: tensor(0.2776, device='cuda:0')
batch 24 loss: tensor(0.2658, device='cuda:0')
batch 25 loss: tensor(0.2372, device='cuda:0')
batch 26 loss: tensor(0.2635, device='cuda:0')
batch 27 loss: tensor(0.2906, device='cuda:0')
batch 28 loss: tensor(0.2577, device='cuda:0')
batch 29 loss: tensor(0.2719, device='cuda:0')
batch 30 loss: tensor(0.2607, device='cuda:0')
batch 31 loss: tensor(0.2325, device='cuda:0')
batch 32 loss: tensor(0.2871, device='cuda:0')
batch 33 loss: tensor(0.2902, device='cuda:0')
batch 34 loss: tensor(0.2503, device='cuda:0')
batch 35 loss: tensor(0.2485, device='cuda:0')
batch 36 loss: tensor(0.2570, device='cuda:0')
batch 37 loss: tensor(0.2801, device='cuda:0')
batch 38 loss: tensor(0.2747, device='cuda:0')
batch 39 loss: tensor(0.2461, device='cuda:0')
batch 40 loss: tensor(0.2703, device='cuda:0')
batch 41 loss: tensor(0.2809, device='cuda:0')
batch 42 loss: tensor(0.2477, device='cuda:0')
batch 43 loss: tensor(0.2633, device='cuda:0')
batch 44 loss: tensor(0.2689, device='cuda:0')
batch 45 loss: tensor(0.2883, device='cuda:0')
batch 46 loss: tensor(0.2424, device='cuda:0')
batch 47 loss: tensor(0.2563, device='cuda:0')
batch 48 loss: tensor(0.2524, device='cuda:0')
batch 49 loss: tensor(0.2560, device='cuda:0')
batch 50 loss: tensor(0.2644, device='cuda:0')
batch 51 loss: tensor(0.2719, device='cuda:0')
batch 52 loss: tensor(0.2883, device='cuda:0')
batch 53 loss: tensor(0.2760, device='cuda:0')
batch 54 loss: tensor(0.2290, device='cuda:0')
batch 55 loss: tensor(0.2602, device='cuda:0')
batch 56 loss: tensor(0.2529, device='cuda:0')
batch 57 loss: tensor(0.2561, device='cuda:0')
batch 58 loss: tensor(0.2516, device='cuda:0')
batch 59 loss: tensor(0.2658, device='cuda:0')
batch 60 loss: tensor(0.2603, device='cuda:0')
batch 61 loss: tensor(0.2891, device='cuda:0')
batch 62 loss: tensor(0.2461, device='cuda:0')
batch 63 loss: tensor(0.2809, device='cuda:0')
batch 64 loss: tensor(0.2789, device='cuda:0')
batch 65 loss: tensor(0.2671, device='cuda:0')
batch 66 loss: tensor(0.2618, device='cuda:0')
batch 67 loss: tensor(0.2557, device='cuda:0')
batch 68 loss: tensor(0.2184, device='cuda:0')
batch 69 loss: tensor(0.2653, device='cuda:0')
batch 70 loss: tensor(0.2472, device='cuda:0')
batch 71 loss: tensor(0.2564, device='cuda:0')
batch 72 loss: tensor(0.2570, device='cuda:0')
batch 73 loss: tensor(0.2639, device='cuda:0')
batch 74 loss: tensor(0.2384, device='cuda:0')
batch 75 loss: tensor(0.2440, device='cuda:0')
batch 76 loss: tensor(0.2707, device='cuda:0')
batch 77 loss: tensor(0.2847, device='cuda:0')
batch 78 loss: tensor(0.2420, device='cuda:0')
batch 79 loss: tensor(0.2806, device='cuda:0')
batch 80 loss: tensor(0.2255, device='cuda:0')
batch 81 loss: tensor(0.2646, device='cuda:0')
batch 82 loss: tensor(0.2460, device='cuda:0')
batch 83 loss: tensor(0.2676, device='cuda:0')
batch 84 loss: tensor(0.2440, device='cuda:0')
batch 85 loss: tensor(0.2334, device='cuda:0')
batch 86 loss: tensor(0.2918, device='cuda:0')
batch 87 loss: tensor(0.2571, device='cuda:0')
batch 88 loss: tensor(0.2697, device='cuda:0')
batch 89 loss: tensor(0.2673, device='cuda:0')
batch 90 loss: tensor(0.3014, device='cuda:0')
batch 91 loss: tensor(0.2766, device='cuda:0')
batch 92 loss: tensor(0.2502, device='cuda:0')
batch 93 loss: tensor(0.2757, device='cuda:0')
batch 94 loss: tensor(0.2941, device='cuda:0')
batch 95 loss: tensor(0.2818, device='cuda:0')
batch 96 loss: tensor(0.2505, device='cuda:0')
batch 97 loss: tensor(0.2236, device='cuda:0')
batch 98 loss: tensor(0.2724, device='cuda:0')
batch 99 loss: tensor(0.2605, device='cuda:0')
batch 100 loss: tensor(0.2568, device='cuda:0')
accuracy in val: 0.8960000000000001
accuracy in test: 0.89
average epoch time: 0.024411267042160033
total time: 4.882253408432007
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0790, device='cuda:0')
batch 2 loss: tensor(1.0458, device='cuda:0')
batch 3 loss: tensor(0.9986, device='cuda:0')
batch 4 loss: tensor(0.9484, device='cuda:0')
batch 5 loss: tensor(0.8942, device='cuda:0')
batch 6 loss: tensor(0.8320, device='cuda:0')
batch 7 loss: tensor(0.7768, device='cuda:0')
batch 8 loss: tensor(0.7118, device='cuda:0')
batch 9 loss: tensor(0.6775, device='cuda:0')
batch 10 loss: tensor(0.6277, device='cuda:0')
batch 11 loss: tensor(0.5673, device='cuda:0')
batch 12 loss: tensor(0.5598, device='cuda:0')
batch 13 loss: tensor(0.5211, device='cuda:0')
batch 14 loss: tensor(0.4964, device='cuda:0')
batch 15 loss: tensor(0.4727, device='cuda:0')
batch 16 loss: tensor(0.4348, device='cuda:0')
batch 17 loss: tensor(0.4676, device='cuda:0')
batch 18 loss: tensor(0.4368, device='cuda:0')
batch 19 loss: tensor(0.4362, device='cuda:0')
batch 20 loss: tensor(0.4097, device='cuda:0')
batch 21 loss: tensor(0.3939, device='cuda:0')
batch 22 loss: tensor(0.3848, device='cuda:0')
batch 23 loss: tensor(0.4007, device='cuda:0')
batch 24 loss: tensor(0.3818, device='cuda:0')
batch 25 loss: tensor(0.3778, device='cuda:0')
batch 26 loss: tensor(0.3748, device='cuda:0')
batch 27 loss: tensor(0.3796, device='cuda:0')
batch 28 loss: tensor(0.3279, device='cuda:0')
batch 29 loss: tensor(0.3316, device='cuda:0')
batch 30 loss: tensor(0.3623, device='cuda:0')
batch 31 loss: tensor(0.3684, device='cuda:0')
batch 32 loss: tensor(0.3291, device='cuda:0')
batch 33 loss: tensor(0.3521, device='cuda:0')
batch 34 loss: tensor(0.3142, device='cuda:0')
batch 35 loss: tensor(0.3328, device='cuda:0')
batch 36 loss: tensor(0.3662, device='cuda:0')
batch 37 loss: tensor(0.3362, device='cuda:0')
batch 38 loss: tensor(0.3064, device='cuda:0')
batch 39 loss: tensor(0.2840, device='cuda:0')
batch 40 loss: tensor(0.3443, device='cuda:0')
batch 41 loss: tensor(0.3193, device='cuda:0')
batch 42 loss: tensor(0.3156, device='cuda:0')
batch 43 loss: tensor(0.3074, device='cuda:0')
batch 44 loss: tensor(0.3130, device='cuda:0')
batch 45 loss: tensor(0.3171, device='cuda:0')
batch 46 loss: tensor(0.2978, device='cuda:0')
batch 47 loss: tensor(0.3181, device='cuda:0')
batch 48 loss: tensor(0.2788, device='cuda:0')
batch 49 loss: tensor(0.3435, device='cuda:0')
batch 50 loss: tensor(0.2739, device='cuda:0')
batch 51 loss: tensor(0.2996, device='cuda:0')
batch 52 loss: tensor(0.2664, device='cuda:0')
batch 53 loss: tensor(0.2961, device='cuda:0')
batch 54 loss: tensor(0.2709, device='cuda:0')
batch 55 loss: tensor(0.2803, device='cuda:0')
batch 56 loss: tensor(0.3046, device='cuda:0')
batch 57 loss: tensor(0.2821, device='cuda:0')
batch 58 loss: tensor(0.3059, device='cuda:0')
batch 59 loss: tensor(0.2952, device='cuda:0')
batch 60 loss: tensor(0.2721, device='cuda:0')
batch 61 loss: tensor(0.2786, device='cuda:0')
batch 62 loss: tensor(0.3090, device='cuda:0')
batch 63 loss: tensor(0.2629, device='cuda:0')
batch 64 loss: tensor(0.2966, device='cuda:0')
batch 65 loss: tensor(0.2851, device='cuda:0')
batch 66 loss: tensor(0.2945, device='cuda:0')
batch 67 loss: tensor(0.2863, device='cuda:0')
batch 68 loss: tensor(0.2962, device='cuda:0')
batch 69 loss: tensor(0.2669, device='cuda:0')
batch 70 loss: tensor(0.2792, device='cuda:0')
batch 71 loss: tensor(0.2942, device='cuda:0')
batch 72 loss: tensor(0.2536, device='cuda:0')
batch 73 loss: tensor(0.2548, device='cuda:0')
batch 74 loss: tensor(0.2494, device='cuda:0')
batch 75 loss: tensor(0.2623, device='cuda:0')
batch 76 loss: tensor(0.2941, device='cuda:0')
batch 77 loss: tensor(0.2726, device='cuda:0')
batch 78 loss: tensor(0.2593, device='cuda:0')
batch 79 loss: tensor(0.2921, device='cuda:0')
batch 80 loss: tensor(0.2717, device='cuda:0')
batch 81 loss: tensor(0.2674, device='cuda:0')
batch 82 loss: tensor(0.2791, device='cuda:0')
batch 83 loss: tensor(0.2484, device='cuda:0')
batch 84 loss: tensor(0.2447, device='cuda:0')
batch 85 loss: tensor(0.2742, device='cuda:0')
batch 86 loss: tensor(0.2450, device='cuda:0')
batch 87 loss: tensor(0.2409, device='cuda:0')
batch 88 loss: tensor(0.2580, device='cuda:0')
batch 89 loss: tensor(0.2537, device='cuda:0')
batch 90 loss: tensor(0.2408, device='cuda:0')
batch 91 loss: tensor(0.2785, device='cuda:0')
batch 92 loss: tensor(0.2549, device='cuda:0')
batch 93 loss: tensor(0.2807, device='cuda:0')
batch 94 loss: tensor(0.2508, device='cuda:0')
batch 95 loss: tensor(0.2565, device='cuda:0')
batch 96 loss: tensor(0.2691, device='cuda:0')
batch 97 loss: tensor(0.2558, device='cuda:0')
batch 98 loss: tensor(0.2256, device='cuda:0')
batch 99 loss: tensor(0.2588, device='cuda:0')
batch 100 loss: tensor(0.2517, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.9762, device='cuda:0')
batch 2 loss: tensor(0.5348, device='cuda:0')
batch 3 loss: tensor(0.3907, device='cuda:0')
batch 4 loss: tensor(0.3605, device='cuda:0')
batch 5 loss: tensor(0.2975, device='cuda:0')
batch 6 loss: tensor(0.2956, device='cuda:0')
batch 7 loss: tensor(0.2558, device='cuda:0')
batch 8 loss: tensor(0.2850, device='cuda:0')
batch 9 loss: tensor(0.2572, device='cuda:0')
batch 10 loss: tensor(0.2873, device='cuda:0')
batch 11 loss: tensor(0.2563, device='cuda:0')
batch 12 loss: tensor(0.2499, device='cuda:0')
batch 13 loss: tensor(0.2821, device='cuda:0')
batch 14 loss: tensor(0.2508, device='cuda:0')
batch 15 loss: tensor(0.2484, device='cuda:0')
batch 16 loss: tensor(0.3003, device='cuda:0')
batch 17 loss: tensor(0.2399, device='cuda:0')
batch 18 loss: tensor(0.2747, device='cuda:0')
batch 19 loss: tensor(0.2207, device='cuda:0')
batch 20 loss: tensor(0.2566, device='cuda:0')
batch 21 loss: tensor(0.2675, device='cuda:0')
batch 22 loss: tensor(0.2737, device='cuda:0')
batch 23 loss: tensor(0.2491, device='cuda:0')
batch 24 loss: tensor(0.2703, device='cuda:0')
batch 25 loss: tensor(0.2769, device='cuda:0')
batch 26 loss: tensor(0.2504, device='cuda:0')
batch 27 loss: tensor(0.2366, device='cuda:0')
batch 28 loss: tensor(0.2614, device='cuda:0')
batch 29 loss: tensor(0.2523, device='cuda:0')
batch 30 loss: tensor(0.2660, device='cuda:0')
batch 31 loss: tensor(0.2610, device='cuda:0')
batch 32 loss: tensor(0.2603, device='cuda:0')
batch 33 loss: tensor(0.2752, device='cuda:0')
batch 34 loss: tensor(0.3025, device='cuda:0')
batch 35 loss: tensor(0.2535, device='cuda:0')
batch 36 loss: tensor(0.2451, device='cuda:0')
batch 37 loss: tensor(0.2715, device='cuda:0')
batch 38 loss: tensor(0.2552, device='cuda:0')
batch 39 loss: tensor(0.2555, device='cuda:0')
batch 40 loss: tensor(0.2695, device='cuda:0')
batch 41 loss: tensor(0.2188, device='cuda:0')
batch 42 loss: tensor(0.2872, device='cuda:0')
batch 43 loss: tensor(0.2510, device='cuda:0')
batch 44 loss: tensor(0.2815, device='cuda:0')
batch 45 loss: tensor(0.2523, device='cuda:0')
batch 46 loss: tensor(0.2272, device='cuda:0')
batch 47 loss: tensor(0.2732, device='cuda:0')
batch 48 loss: tensor(0.2567, device='cuda:0')
batch 49 loss: tensor(0.2563, device='cuda:0')
batch 50 loss: tensor(0.2558, device='cuda:0')
batch 51 loss: tensor(0.2372, device='cuda:0')
batch 52 loss: tensor(0.2538, device='cuda:0')
batch 53 loss: tensor(0.2933, device='cuda:0')
batch 54 loss: tensor(0.2621, device='cuda:0')
batch 55 loss: tensor(0.2607, device='cuda:0')
batch 56 loss: tensor(0.2788, device='cuda:0')
batch 57 loss: tensor(0.2602, device='cuda:0')
batch 58 loss: tensor(0.2945, device='cuda:0')
batch 59 loss: tensor(0.2845, device='cuda:0')
batch 60 loss: tensor(0.2512, device='cuda:0')
batch 61 loss: tensor(0.2768, device='cuda:0')
batch 62 loss: tensor(0.2636, device='cuda:0')
batch 63 loss: tensor(0.2458, device='cuda:0')
batch 64 loss: tensor(0.2417, device='cuda:0')
batch 65 loss: tensor(0.2846, device='cuda:0')
batch 66 loss: tensor(0.2758, device='cuda:0')
batch 67 loss: tensor(0.2899, device='cuda:0')
batch 68 loss: tensor(0.2336, device='cuda:0')
batch 69 loss: tensor(0.2559, device='cuda:0')
batch 70 loss: tensor(0.2774, device='cuda:0')
batch 71 loss: tensor(0.2655, device='cuda:0')
batch 72 loss: tensor(0.3108, device='cuda:0')
batch 73 loss: tensor(0.2767, device='cuda:0')
batch 74 loss: tensor(0.2529, device='cuda:0')
batch 75 loss: tensor(0.2271, device='cuda:0')
batch 76 loss: tensor(0.2424, device='cuda:0')
batch 77 loss: tensor(0.2611, device='cuda:0')
batch 78 loss: tensor(0.2371, device='cuda:0')
batch 79 loss: tensor(0.2999, device='cuda:0')
batch 80 loss: tensor(0.2586, device='cuda:0')
batch 81 loss: tensor(0.2174, device='cuda:0')
batch 82 loss: tensor(0.2409, device='cuda:0')
batch 83 loss: tensor(0.2515, device='cuda:0')
batch 84 loss: tensor(0.2287, device='cuda:0')
batch 85 loss: tensor(0.2560, device='cuda:0')
batch 86 loss: tensor(0.2498, device='cuda:0')
batch 87 loss: tensor(0.2847, device='cuda:0')
batch 88 loss: tensor(0.2841, device='cuda:0')
batch 89 loss: tensor(0.2747, device='cuda:0')
batch 90 loss: tensor(0.2068, device='cuda:0')
batch 91 loss: tensor(0.2461, device='cuda:0')
batch 92 loss: tensor(0.2627, device='cuda:0')
batch 93 loss: tensor(0.2601, device='cuda:0')
batch 94 loss: tensor(0.2652, device='cuda:0')
batch 95 loss: tensor(0.2616, device='cuda:0')
batch 96 loss: tensor(0.2336, device='cuda:0')
batch 97 loss: tensor(0.2917, device='cuda:0')
batch 98 loss: tensor(0.2565, device='cuda:0')
batch 99 loss: tensor(0.2561, device='cuda:0')
batch 100 loss: tensor(0.2881, device='cuda:0')
accuracy in val: 0.894
accuracy in test: 0.89
average epoch time: 0.02194817066192627
total time: 4.389634132385254
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0752, device='cuda:0')
batch 2 loss: tensor(1.0336, device='cuda:0')
batch 3 loss: tensor(0.9892, device='cuda:0')
batch 4 loss: tensor(0.9349, device='cuda:0')
batch 5 loss: tensor(0.8802, device='cuda:0')
batch 6 loss: tensor(0.8179, device='cuda:0')
batch 7 loss: tensor(0.7636, device='cuda:0')
batch 8 loss: tensor(0.7133, device='cuda:0')
batch 9 loss: tensor(0.6568, device='cuda:0')
batch 10 loss: tensor(0.6285, device='cuda:0')
batch 11 loss: tensor(0.5763, device='cuda:0')
batch 12 loss: tensor(0.5483, device='cuda:0')
batch 13 loss: tensor(0.5382, device='cuda:0')
batch 14 loss: tensor(0.4907, device='cuda:0')
batch 15 loss: tensor(0.4710, device='cuda:0')
batch 16 loss: tensor(0.4642, device='cuda:0')
batch 17 loss: tensor(0.4253, device='cuda:0')
batch 18 loss: tensor(0.4426, device='cuda:0')
batch 19 loss: tensor(0.3969, device='cuda:0')
batch 20 loss: tensor(0.3897, device='cuda:0')
batch 21 loss: tensor(0.3799, device='cuda:0')
batch 22 loss: tensor(0.4328, device='cuda:0')
batch 23 loss: tensor(0.3966, device='cuda:0')
batch 24 loss: tensor(0.3846, device='cuda:0')
batch 25 loss: tensor(0.3593, device='cuda:0')
batch 26 loss: tensor(0.3820, device='cuda:0')
batch 27 loss: tensor(0.3836, device='cuda:0')
batch 28 loss: tensor(0.3497, device='cuda:0')
batch 29 loss: tensor(0.3558, device='cuda:0')
batch 30 loss: tensor(0.3492, device='cuda:0')
batch 31 loss: tensor(0.3612, device='cuda:0')
batch 32 loss: tensor(0.3571, device='cuda:0')
batch 33 loss: tensor(0.3380, device='cuda:0')
batch 34 loss: tensor(0.3389, device='cuda:0')
batch 35 loss: tensor(0.3287, device='cuda:0')
batch 36 loss: tensor(0.3317, device='cuda:0')
batch 37 loss: tensor(0.3274, device='cuda:0')
batch 38 loss: tensor(0.3002, device='cuda:0')
batch 39 loss: tensor(0.3442, device='cuda:0')
batch 40 loss: tensor(0.3065, device='cuda:0')
batch 41 loss: tensor(0.3231, device='cuda:0')
batch 42 loss: tensor(0.3359, device='cuda:0')
batch 43 loss: tensor(0.3021, device='cuda:0')
batch 44 loss: tensor(0.2929, device='cuda:0')
batch 45 loss: tensor(0.3117, device='cuda:0')
batch 46 loss: tensor(0.2788, device='cuda:0')
batch 47 loss: tensor(0.3046, device='cuda:0')
batch 48 loss: tensor(0.3087, device='cuda:0')
batch 49 loss: tensor(0.3685, device='cuda:0')
batch 50 loss: tensor(0.3132, device='cuda:0')
batch 51 loss: tensor(0.3390, device='cuda:0')
batch 52 loss: tensor(0.2818, device='cuda:0')
batch 53 loss: tensor(0.3030, device='cuda:0')
batch 54 loss: tensor(0.2892, device='cuda:0')
batch 55 loss: tensor(0.3315, device='cuda:0')
batch 56 loss: tensor(0.2633, device='cuda:0')
batch 57 loss: tensor(0.3197, device='cuda:0')
batch 58 loss: tensor(0.2708, device='cuda:0')
batch 59 loss: tensor(0.2672, device='cuda:0')
batch 60 loss: tensor(0.3001, device='cuda:0')
batch 61 loss: tensor(0.2642, device='cuda:0')
batch 62 loss: tensor(0.3072, device='cuda:0')
batch 63 loss: tensor(0.3022, device='cuda:0')
batch 64 loss: tensor(0.2859, device='cuda:0')
batch 65 loss: tensor(0.3170, device='cuda:0')
batch 66 loss: tensor(0.2703, device='cuda:0')
batch 67 loss: tensor(0.2828, device='cuda:0')
batch 68 loss: tensor(0.2408, device='cuda:0')
batch 69 loss: tensor(0.2920, device='cuda:0')
batch 70 loss: tensor(0.2642, device='cuda:0')
batch 71 loss: tensor(0.2656, device='cuda:0')
batch 72 loss: tensor(0.2371, device='cuda:0')
batch 73 loss: tensor(0.2779, device='cuda:0')
batch 74 loss: tensor(0.2574, device='cuda:0')
batch 75 loss: tensor(0.2488, device='cuda:0')
batch 76 loss: tensor(0.2589, device='cuda:0')
batch 77 loss: tensor(0.2940, device='cuda:0')
batch 78 loss: tensor(0.2608, device='cuda:0')
batch 79 loss: tensor(0.2730, device='cuda:0')
batch 80 loss: tensor(0.2740, device='cuda:0')
batch 81 loss: tensor(0.2672, device='cuda:0')
batch 82 loss: tensor(0.2577, device='cuda:0')
batch 83 loss: tensor(0.2904, device='cuda:0')
batch 84 loss: tensor(0.2441, device='cuda:0')
batch 85 loss: tensor(0.3009, device='cuda:0')
batch 86 loss: tensor(0.2503, device='cuda:0')
batch 87 loss: tensor(0.2683, device='cuda:0')
batch 88 loss: tensor(0.2353, device='cuda:0')
batch 89 loss: tensor(0.2727, device='cuda:0')
batch 90 loss: tensor(0.2880, device='cuda:0')
batch 91 loss: tensor(0.2523, device='cuda:0')
batch 92 loss: tensor(0.2723, device='cuda:0')
batch 93 loss: tensor(0.2405, device='cuda:0')
batch 94 loss: tensor(0.2820, device='cuda:0')
batch 95 loss: tensor(0.2591, device='cuda:0')
batch 96 loss: tensor(0.2524, device='cuda:0')
batch 97 loss: tensor(0.2563, device='cuda:0')
batch 98 loss: tensor(0.2346, device='cuda:0')
batch 99 loss: tensor(0.2434, device='cuda:0')
batch 100 loss: tensor(0.2906, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.6432, device='cuda:0')
batch 2 loss: tensor(0.4223, device='cuda:0')
batch 3 loss: tensor(0.3170, device='cuda:0')
batch 4 loss: tensor(0.2676, device='cuda:0')
batch 5 loss: tensor(0.2968, device='cuda:0')
batch 6 loss: tensor(0.2721, device='cuda:0')
batch 7 loss: tensor(0.2720, device='cuda:0')
batch 8 loss: tensor(0.2863, device='cuda:0')
batch 9 loss: tensor(0.2607, device='cuda:0')
batch 10 loss: tensor(0.2450, device='cuda:0')
batch 11 loss: tensor(0.2670, device='cuda:0')
batch 12 loss: tensor(0.2536, device='cuda:0')
batch 13 loss: tensor(0.2535, device='cuda:0')
batch 14 loss: tensor(0.2943, device='cuda:0')
batch 15 loss: tensor(0.2384, device='cuda:0')
batch 16 loss: tensor(0.2924, device='cuda:0')
batch 17 loss: tensor(0.2571, device='cuda:0')
batch 18 loss: tensor(0.2337, device='cuda:0')
batch 19 loss: tensor(0.2521, device='cuda:0')
batch 20 loss: tensor(0.2972, device='cuda:0')
batch 21 loss: tensor(0.2595, device='cuda:0')
batch 22 loss: tensor(0.2487, device='cuda:0')
batch 23 loss: tensor(0.2489, device='cuda:0')
batch 24 loss: tensor(0.2884, device='cuda:0')
batch 25 loss: tensor(0.2721, device='cuda:0')
batch 26 loss: tensor(0.2787, device='cuda:0')
batch 27 loss: tensor(0.2689, device='cuda:0')
batch 28 loss: tensor(0.2419, device='cuda:0')
batch 29 loss: tensor(0.2917, device='cuda:0')
batch 30 loss: tensor(0.2642, device='cuda:0')
batch 31 loss: tensor(0.2464, device='cuda:0')
batch 32 loss: tensor(0.2384, device='cuda:0')
batch 33 loss: tensor(0.2690, device='cuda:0')
batch 34 loss: tensor(0.2796, device='cuda:0')
batch 35 loss: tensor(0.2518, device='cuda:0')
batch 36 loss: tensor(0.2491, device='cuda:0')
batch 37 loss: tensor(0.2414, device='cuda:0')
batch 38 loss: tensor(0.2486, device='cuda:0')
batch 39 loss: tensor(0.2661, device='cuda:0')
batch 40 loss: tensor(0.2928, device='cuda:0')
batch 41 loss: tensor(0.2608, device='cuda:0')
batch 42 loss: tensor(0.2535, device='cuda:0')
batch 43 loss: tensor(0.2549, device='cuda:0')
batch 44 loss: tensor(0.2855, device='cuda:0')
batch 45 loss: tensor(0.2519, device='cuda:0')
batch 46 loss: tensor(0.2859, device='cuda:0')
batch 47 loss: tensor(0.2456, device='cuda:0')
batch 48 loss: tensor(0.2493, device='cuda:0')
batch 49 loss: tensor(0.2292, device='cuda:0')
batch 50 loss: tensor(0.2454, device='cuda:0')
batch 51 loss: tensor(0.2620, device='cuda:0')
batch 52 loss: tensor(0.2566, device='cuda:0')
batch 53 loss: tensor(0.2563, device='cuda:0')
batch 54 loss: tensor(0.2414, device='cuda:0')
batch 55 loss: tensor(0.2510, device='cuda:0')
batch 56 loss: tensor(0.2446, device='cuda:0')
batch 57 loss: tensor(0.2248, device='cuda:0')
batch 58 loss: tensor(0.2645, device='cuda:0')
batch 59 loss: tensor(0.2775, device='cuda:0')
batch 60 loss: tensor(0.2750, device='cuda:0')
batch 61 loss: tensor(0.2501, device='cuda:0')
batch 62 loss: tensor(0.2850, device='cuda:0')
batch 63 loss: tensor(0.2704, device='cuda:0')
batch 64 loss: tensor(0.2700, device='cuda:0')
batch 65 loss: tensor(0.2452, device='cuda:0')
batch 66 loss: tensor(0.2379, device='cuda:0')
batch 67 loss: tensor(0.2679, device='cuda:0')
batch 68 loss: tensor(0.2609, device='cuda:0')
batch 69 loss: tensor(0.2631, device='cuda:0')
batch 70 loss: tensor(0.2453, device='cuda:0')
batch 71 loss: tensor(0.2765, device='cuda:0')
batch 72 loss: tensor(0.2267, device='cuda:0')
batch 73 loss: tensor(0.2428, device='cuda:0')
batch 74 loss: tensor(0.2404, device='cuda:0')
batch 75 loss: tensor(0.2607, device='cuda:0')
batch 76 loss: tensor(0.2314, device='cuda:0')
batch 77 loss: tensor(0.2646, device='cuda:0')
batch 78 loss: tensor(0.2866, device='cuda:0')
batch 79 loss: tensor(0.2620, device='cuda:0')
batch 80 loss: tensor(0.2467, device='cuda:0')
batch 81 loss: tensor(0.2441, device='cuda:0')
batch 82 loss: tensor(0.2927, device='cuda:0')
batch 83 loss: tensor(0.2496, device='cuda:0')
batch 84 loss: tensor(0.2489, device='cuda:0')
batch 85 loss: tensor(0.2478, device='cuda:0')
batch 86 loss: tensor(0.2519, device='cuda:0')
batch 87 loss: tensor(0.2786, device='cuda:0')
batch 88 loss: tensor(0.2716, device='cuda:0')
batch 89 loss: tensor(0.2565, device='cuda:0')
batch 90 loss: tensor(0.2361, device='cuda:0')
batch 91 loss: tensor(0.2532, device='cuda:0')
batch 92 loss: tensor(0.2214, device='cuda:0')
batch 93 loss: tensor(0.2763, device='cuda:0')
batch 94 loss: tensor(0.2629, device='cuda:0')
batch 95 loss: tensor(0.2484, device='cuda:0')
batch 96 loss: tensor(0.2891, device='cuda:0')
batch 97 loss: tensor(0.2715, device='cuda:0')
batch 98 loss: tensor(0.2587, device='cuda:0')
batch 99 loss: tensor(0.2594, device='cuda:0')
batch 100 loss: tensor(0.2590, device='cuda:0')
accuracy in val: 0.892
accuracy in test: 0.887
average epoch time: 0.024586440324783326
total time: 4.917288064956665
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0795, device='cuda:0')
batch 2 loss: tensor(1.0459, device='cuda:0')
batch 3 loss: tensor(1.0025, device='cuda:0')
batch 4 loss: tensor(0.9475, device='cuda:0')
batch 5 loss: tensor(0.9039, device='cuda:0')
batch 6 loss: tensor(0.8318, device='cuda:0')
batch 7 loss: tensor(0.7907, device='cuda:0')
batch 8 loss: tensor(0.7169, device='cuda:0')
batch 9 loss: tensor(0.6821, device='cuda:0')
batch 10 loss: tensor(0.6261, device='cuda:0')
batch 11 loss: tensor(0.5692, device='cuda:0')
batch 12 loss: tensor(0.5695, device='cuda:0')
batch 13 loss: tensor(0.5217, device='cuda:0')
batch 14 loss: tensor(0.5151, device='cuda:0')
batch 15 loss: tensor(0.4745, device='cuda:0')
batch 16 loss: tensor(0.4769, device='cuda:0')
batch 17 loss: tensor(0.4456, device='cuda:0')
batch 18 loss: tensor(0.4438, device='cuda:0')
batch 19 loss: tensor(0.4220, device='cuda:0')
batch 20 loss: tensor(0.4125, device='cuda:0')
batch 21 loss: tensor(0.3922, device='cuda:0')
batch 22 loss: tensor(0.4101, device='cuda:0')
batch 23 loss: tensor(0.3929, device='cuda:0')
batch 24 loss: tensor(0.3544, device='cuda:0')
batch 25 loss: tensor(0.3752, device='cuda:0')
batch 26 loss: tensor(0.3873, device='cuda:0')
batch 27 loss: tensor(0.3722, device='cuda:0')
batch 28 loss: tensor(0.3495, device='cuda:0')
batch 29 loss: tensor(0.3631, device='cuda:0')
batch 30 loss: tensor(0.3383, device='cuda:0')
batch 31 loss: tensor(0.3180, device='cuda:0')
batch 32 loss: tensor(0.3446, device='cuda:0')
batch 33 loss: tensor(0.3628, device='cuda:0')
batch 34 loss: tensor(0.3440, device='cuda:0')
batch 35 loss: tensor(0.3392, device='cuda:0')
batch 36 loss: tensor(0.3298, device='cuda:0')
batch 37 loss: tensor(0.3209, device='cuda:0')
batch 38 loss: tensor(0.3462, device='cuda:0')
batch 39 loss: tensor(0.3174, device='cuda:0')
batch 40 loss: tensor(0.3199, device='cuda:0')
batch 41 loss: tensor(0.3114, device='cuda:0')
batch 42 loss: tensor(0.3087, device='cuda:0')
batch 43 loss: tensor(0.3079, device='cuda:0')
batch 44 loss: tensor(0.3105, device='cuda:0')
batch 45 loss: tensor(0.2886, device='cuda:0')
batch 46 loss: tensor(0.3273, device='cuda:0')
batch 47 loss: tensor(0.3192, device='cuda:0')
batch 48 loss: tensor(0.3315, device='cuda:0')
batch 49 loss: tensor(0.3224, device='cuda:0')
batch 50 loss: tensor(0.3038, device='cuda:0')
batch 51 loss: tensor(0.3148, device='cuda:0')
batch 52 loss: tensor(0.2718, device='cuda:0')
batch 53 loss: tensor(0.2943, device='cuda:0')
batch 54 loss: tensor(0.2869, device='cuda:0')
batch 55 loss: tensor(0.3199, device='cuda:0')
batch 56 loss: tensor(0.3093, device='cuda:0')
batch 57 loss: tensor(0.3150, device='cuda:0')
batch 58 loss: tensor(0.2993, device='cuda:0')
batch 59 loss: tensor(0.2986, device='cuda:0')
batch 60 loss: tensor(0.2808, device='cuda:0')
batch 61 loss: tensor(0.3178, device='cuda:0')
batch 62 loss: tensor(0.2702, device='cuda:0')
batch 63 loss: tensor(0.2970, device='cuda:0')
batch 64 loss: tensor(0.2765, device='cuda:0')
batch 65 loss: tensor(0.2877, device='cuda:0')
batch 66 loss: tensor(0.2795, device='cuda:0')
batch 67 loss: tensor(0.2536, device='cuda:0')
batch 68 loss: tensor(0.2999, device='cuda:0')
batch 69 loss: tensor(0.2891, device='cuda:0')
batch 70 loss: tensor(0.2598, device='cuda:0')
batch 71 loss: tensor(0.2595, device='cuda:0')
batch 72 loss: tensor(0.2565, device='cuda:0')
batch 73 loss: tensor(0.2729, device='cuda:0')
batch 74 loss: tensor(0.3028, device='cuda:0')
batch 75 loss: tensor(0.2977, device='cuda:0')
batch 76 loss: tensor(0.3063, device='cuda:0')
batch 77 loss: tensor(0.2459, device='cuda:0')
batch 78 loss: tensor(0.2489, device='cuda:0')
batch 79 loss: tensor(0.2745, device='cuda:0')
batch 80 loss: tensor(0.2772, device='cuda:0')
batch 81 loss: tensor(0.2837, device='cuda:0')
batch 82 loss: tensor(0.2574, device='cuda:0')
batch 83 loss: tensor(0.2595, device='cuda:0')
batch 84 loss: tensor(0.2397, device='cuda:0')
batch 85 loss: tensor(0.2497, device='cuda:0')
batch 86 loss: tensor(0.3028, device='cuda:0')
batch 87 loss: tensor(0.2819, device='cuda:0')
batch 88 loss: tensor(0.2559, device='cuda:0')
batch 89 loss: tensor(0.2477, device='cuda:0')
batch 90 loss: tensor(0.2520, device='cuda:0')
batch 91 loss: tensor(0.3025, device='cuda:0')
batch 92 loss: tensor(0.2586, device='cuda:0')
batch 93 loss: tensor(0.2925, device='cuda:0')
batch 94 loss: tensor(0.2337, device='cuda:0')
batch 95 loss: tensor(0.2550, device='cuda:0')
batch 96 loss: tensor(0.2698, device='cuda:0')
batch 97 loss: tensor(0.2314, device='cuda:0')
batch 98 loss: tensor(0.2728, device='cuda:0')
batch 99 loss: tensor(0.2686, device='cuda:0')
batch 100 loss: tensor(0.2623, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5128, device='cuda:0')
batch 2 loss: tensor(0.3566, device='cuda:0')
batch 3 loss: tensor(0.2719, device='cuda:0')
batch 4 loss: tensor(0.2873, device='cuda:0')
batch 5 loss: tensor(0.2769, device='cuda:0')
batch 6 loss: tensor(0.2831, device='cuda:0')
batch 7 loss: tensor(0.2898, device='cuda:0')
batch 8 loss: tensor(0.2578, device='cuda:0')
batch 9 loss: tensor(0.2715, device='cuda:0')
batch 10 loss: tensor(0.2629, device='cuda:0')
batch 11 loss: tensor(0.2886, device='cuda:0')
batch 12 loss: tensor(0.2615, device='cuda:0')
batch 13 loss: tensor(0.2460, device='cuda:0')
batch 14 loss: tensor(0.2809, device='cuda:0')
batch 15 loss: tensor(0.2544, device='cuda:0')
batch 16 loss: tensor(0.2472, device='cuda:0')
batch 17 loss: tensor(0.2501, device='cuda:0')
batch 18 loss: tensor(0.2757, device='cuda:0')
batch 19 loss: tensor(0.2615, device='cuda:0')
batch 20 loss: tensor(0.2724, device='cuda:0')
batch 21 loss: tensor(0.2443, device='cuda:0')
batch 22 loss: tensor(0.2503, device='cuda:0')
batch 23 loss: tensor(0.2614, device='cuda:0')
batch 24 loss: tensor(0.2238, device='cuda:0')
batch 25 loss: tensor(0.2369, device='cuda:0')
batch 26 loss: tensor(0.2862, device='cuda:0')
batch 27 loss: tensor(0.2452, device='cuda:0')
batch 28 loss: tensor(0.2426, device='cuda:0')
batch 29 loss: tensor(0.2525, device='cuda:0')
batch 30 loss: tensor(0.2612, device='cuda:0')
batch 31 loss: tensor(0.2494, device='cuda:0')
batch 32 loss: tensor(0.2715, device='cuda:0')
batch 33 loss: tensor(0.2771, device='cuda:0')
batch 34 loss: tensor(0.2701, device='cuda:0')
batch 35 loss: tensor(0.2837, device='cuda:0')
batch 36 loss: tensor(0.2637, device='cuda:0')
batch 37 loss: tensor(0.2761, device='cuda:0')
batch 38 loss: tensor(0.2410, device='cuda:0')
batch 39 loss: tensor(0.2741, device='cuda:0')
batch 40 loss: tensor(0.2625, device='cuda:0')
batch 41 loss: tensor(0.2324, device='cuda:0')
batch 42 loss: tensor(0.2630, device='cuda:0')
batch 43 loss: tensor(0.2784, device='cuda:0')
batch 44 loss: tensor(0.2636, device='cuda:0')
batch 45 loss: tensor(0.2443, device='cuda:0')
batch 46 loss: tensor(0.2876, device='cuda:0')
batch 47 loss: tensor(0.2843, device='cuda:0')
batch 48 loss: tensor(0.2880, device='cuda:0')
batch 49 loss: tensor(0.2678, device='cuda:0')
batch 50 loss: tensor(0.2387, device='cuda:0')
batch 51 loss: tensor(0.2710, device='cuda:0')
batch 52 loss: tensor(0.2452, device='cuda:0')
batch 53 loss: tensor(0.2781, device='cuda:0')
batch 54 loss: tensor(0.2389, device='cuda:0')
batch 55 loss: tensor(0.2371, device='cuda:0')
batch 56 loss: tensor(0.2515, device='cuda:0')
batch 57 loss: tensor(0.2436, device='cuda:0')
batch 58 loss: tensor(0.2801, device='cuda:0')
batch 59 loss: tensor(0.2707, device='cuda:0')
batch 60 loss: tensor(0.2712, device='cuda:0')
batch 61 loss: tensor(0.2213, device='cuda:0')
batch 62 loss: tensor(0.2662, device='cuda:0')
batch 63 loss: tensor(0.2587, device='cuda:0')
batch 64 loss: tensor(0.2926, device='cuda:0')
batch 65 loss: tensor(0.2674, device='cuda:0')
batch 66 loss: tensor(0.2734, device='cuda:0')
batch 67 loss: tensor(0.2653, device='cuda:0')
batch 68 loss: tensor(0.2533, device='cuda:0')
batch 69 loss: tensor(0.2303, device='cuda:0')
batch 70 loss: tensor(0.2620, device='cuda:0')
batch 71 loss: tensor(0.2368, device='cuda:0')
batch 72 loss: tensor(0.2718, device='cuda:0')
batch 73 loss: tensor(0.2321, device='cuda:0')
batch 74 loss: tensor(0.2888, device='cuda:0')
batch 75 loss: tensor(0.2487, device='cuda:0')
batch 76 loss: tensor(0.2812, device='cuda:0')
batch 77 loss: tensor(0.2272, device='cuda:0')
batch 78 loss: tensor(0.2340, device='cuda:0')
batch 79 loss: tensor(0.2607, device='cuda:0')
batch 80 loss: tensor(0.2796, device='cuda:0')
batch 81 loss: tensor(0.2453, device='cuda:0')
batch 82 loss: tensor(0.2746, device='cuda:0')
batch 83 loss: tensor(0.2387, device='cuda:0')
batch 84 loss: tensor(0.2592, device='cuda:0')
batch 85 loss: tensor(0.2840, device='cuda:0')
batch 86 loss: tensor(0.2355, device='cuda:0')
batch 87 loss: tensor(0.2850, device='cuda:0')
batch 88 loss: tensor(0.2676, device='cuda:0')
batch 89 loss: tensor(0.2626, device='cuda:0')
batch 90 loss: tensor(0.2640, device='cuda:0')
batch 91 loss: tensor(0.2743, device='cuda:0')
batch 92 loss: tensor(0.2522, device='cuda:0')
batch 93 loss: tensor(0.2493, device='cuda:0')
batch 94 loss: tensor(0.2992, device='cuda:0')
batch 95 loss: tensor(0.2353, device='cuda:0')
batch 96 loss: tensor(0.2773, device='cuda:0')
batch 97 loss: tensor(0.2366, device='cuda:0')
batch 98 loss: tensor(0.2842, device='cuda:0')
batch 99 loss: tensor(0.2627, device='cuda:0')
batch 100 loss: tensor(0.2514, device='cuda:0')
accuracy in val: 0.898
accuracy in test: 0.891
average epoch time: 0.022115869522094725
total time: 4.423173904418945
Finished loading dataset.
{'node_num': 19717, 'feat_dim': 500, 'class_num': 3, 'layer_num': 2, 'hidden_dim': 16, 'learning_rate': 0.001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0786, device='cuda:0')
batch 2 loss: tensor(1.0480, device='cuda:0')
batch 3 loss: tensor(1.0103, device='cuda:0')
batch 4 loss: tensor(0.9629, device='cuda:0')
batch 5 loss: tensor(0.9078, device='cuda:0')
batch 6 loss: tensor(0.8490, device='cuda:0')
batch 7 loss: tensor(0.7963, device='cuda:0')
batch 8 loss: tensor(0.7269, device='cuda:0')
batch 9 loss: tensor(0.6816, device='cuda:0')
batch 10 loss: tensor(0.6157, device='cuda:0')
batch 11 loss: tensor(0.5954, device='cuda:0')
batch 12 loss: tensor(0.5663, device='cuda:0')
batch 13 loss: tensor(0.5420, device='cuda:0')
batch 14 loss: tensor(0.4997, device='cuda:0')
batch 15 loss: tensor(0.4672, device='cuda:0')
batch 16 loss: tensor(0.4371, device='cuda:0')
batch 17 loss: tensor(0.4353, device='cuda:0')
batch 18 loss: tensor(0.4285, device='cuda:0')
batch 19 loss: tensor(0.4350, device='cuda:0')
batch 20 loss: tensor(0.3983, device='cuda:0')
batch 21 loss: tensor(0.3814, device='cuda:0')
batch 22 loss: tensor(0.3990, device='cuda:0')
batch 23 loss: tensor(0.3893, device='cuda:0')
batch 24 loss: tensor(0.3522, device='cuda:0')
batch 25 loss: tensor(0.3974, device='cuda:0')
batch 26 loss: tensor(0.3823, device='cuda:0')
batch 27 loss: tensor(0.3595, device='cuda:0')
batch 28 loss: tensor(0.3631, device='cuda:0')
batch 29 loss: tensor(0.3424, device='cuda:0')
batch 30 loss: tensor(0.3940, device='cuda:0')
batch 31 loss: tensor(0.3072, device='cuda:0')
batch 32 loss: tensor(0.3268, device='cuda:0')
batch 33 loss: tensor(0.3101, device='cuda:0')
batch 34 loss: tensor(0.3231, device='cuda:0')
batch 35 loss: tensor(0.3362, device='cuda:0')
batch 36 loss: tensor(0.3193, device='cuda:0')
batch 37 loss: tensor(0.3179, device='cuda:0')
batch 38 loss: tensor(0.3104, device='cuda:0')
batch 39 loss: tensor(0.3383, device='cuda:0')
batch 40 loss: tensor(0.3137, device='cuda:0')
batch 41 loss: tensor(0.3089, device='cuda:0')
batch 42 loss: tensor(0.3198, device='cuda:0')
batch 43 loss: tensor(0.3323, device='cuda:0')
batch 44 loss: tensor(0.3274, device='cuda:0')
batch 45 loss: tensor(0.3251, device='cuda:0')
batch 46 loss: tensor(0.3217, device='cuda:0')
batch 47 loss: tensor(0.2762, device='cuda:0')
batch 48 loss: tensor(0.2937, device='cuda:0')
batch 49 loss: tensor(0.2992, device='cuda:0')
batch 50 loss: tensor(0.3038, device='cuda:0')
batch 51 loss: tensor(0.2720, device='cuda:0')
batch 52 loss: tensor(0.2775, device='cuda:0')
batch 53 loss: tensor(0.2758, device='cuda:0')
batch 54 loss: tensor(0.2934, device='cuda:0')
batch 55 loss: tensor(0.3251, device='cuda:0')
batch 56 loss: tensor(0.3027, device='cuda:0')
batch 57 loss: tensor(0.2960, device='cuda:0')
batch 58 loss: tensor(0.2817, device='cuda:0')
batch 59 loss: tensor(0.2919, device='cuda:0')
batch 60 loss: tensor(0.3021, device='cuda:0')
batch 61 loss: tensor(0.2923, device='cuda:0')
batch 62 loss: tensor(0.2974, device='cuda:0')
batch 63 loss: tensor(0.2786, device='cuda:0')
batch 64 loss: tensor(0.2843, device='cuda:0')
batch 65 loss: tensor(0.2954, device='cuda:0')
batch 66 loss: tensor(0.2977, device='cuda:0')
batch 67 loss: tensor(0.2926, device='cuda:0')
batch 68 loss: tensor(0.2993, device='cuda:0')
batch 69 loss: tensor(0.2847, device='cuda:0')
batch 70 loss: tensor(0.2577, device='cuda:0')
batch 71 loss: tensor(0.2586, device='cuda:0')
batch 72 loss: tensor(0.2384, device='cuda:0')
batch 73 loss: tensor(0.2414, device='cuda:0')
batch 74 loss: tensor(0.2672, device='cuda:0')
batch 75 loss: tensor(0.2799, device='cuda:0')
batch 76 loss: tensor(0.2854, device='cuda:0')
batch 77 loss: tensor(0.2380, device='cuda:0')
batch 78 loss: tensor(0.2588, device='cuda:0')
batch 79 loss: tensor(0.2603, device='cuda:0')
batch 80 loss: tensor(0.2454, device='cuda:0')
batch 81 loss: tensor(0.2825, device='cuda:0')
batch 82 loss: tensor(0.2515, device='cuda:0')
batch 83 loss: tensor(0.2537, device='cuda:0')
batch 84 loss: tensor(0.2476, device='cuda:0')
batch 85 loss: tensor(0.2526, device='cuda:0')
batch 86 loss: tensor(0.2722, device='cuda:0')
batch 87 loss: tensor(0.2884, device='cuda:0')
batch 88 loss: tensor(0.2666, device='cuda:0')
batch 89 loss: tensor(0.2458, device='cuda:0')
batch 90 loss: tensor(0.2478, device='cuda:0')
batch 91 loss: tensor(0.2683, device='cuda:0')
batch 92 loss: tensor(0.2491, device='cuda:0')
batch 93 loss: tensor(0.2420, device='cuda:0')
batch 94 loss: tensor(0.2642, device='cuda:0')
batch 95 loss: tensor(0.2890, device='cuda:0')
batch 96 loss: tensor(0.2556, device='cuda:0')
batch 97 loss: tensor(0.2405, device='cuda:0')
batch 98 loss: tensor(0.2369, device='cuda:0')
batch 99 loss: tensor(0.2379, device='cuda:0')
batch 100 loss: tensor(0.2304, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5588, device='cuda:0')
batch 2 loss: tensor(0.4121, device='cuda:0')
batch 3 loss: tensor(0.3217, device='cuda:0')
batch 4 loss: tensor(0.2938, device='cuda:0')
batch 5 loss: tensor(0.2809, device='cuda:0')
batch 6 loss: tensor(0.3072, device='cuda:0')
batch 7 loss: tensor(0.2845, device='cuda:0')
batch 8 loss: tensor(0.3099, device='cuda:0')
batch 9 loss: tensor(0.3221, device='cuda:0')
batch 10 loss: tensor(0.2523, device='cuda:0')
batch 11 loss: tensor(0.2535, device='cuda:0')
batch 12 loss: tensor(0.3167, device='cuda:0')
batch 13 loss: tensor(0.2742, device='cuda:0')
batch 14 loss: tensor(0.2852, device='cuda:0')
batch 15 loss: tensor(0.2815, device='cuda:0')
batch 16 loss: tensor(0.2605, device='cuda:0')
batch 17 loss: tensor(0.2439, device='cuda:0')
batch 18 loss: tensor(0.2580, device='cuda:0')
batch 19 loss: tensor(0.2610, device='cuda:0')
batch 20 loss: tensor(0.2552, device='cuda:0')
batch 21 loss: tensor(0.2860, device='cuda:0')
batch 22 loss: tensor(0.2611, device='cuda:0')
batch 23 loss: tensor(0.2574, device='cuda:0')
batch 24 loss: tensor(0.2419, device='cuda:0')
batch 25 loss: tensor(0.2666, device='cuda:0')
batch 26 loss: tensor(0.2671, device='cuda:0')
batch 27 loss: tensor(0.2978, device='cuda:0')
batch 28 loss: tensor(0.2896, device='cuda:0')
batch 29 loss: tensor(0.2291, device='cuda:0')
batch 30 loss: tensor(0.2996, device='cuda:0')
batch 31 loss: tensor(0.2483, device='cuda:0')
batch 32 loss: tensor(0.2506, device='cuda:0')
batch 33 loss: tensor(0.2807, device='cuda:0')
batch 34 loss: tensor(0.2754, device='cuda:0')
batch 35 loss: tensor(0.2342, device='cuda:0')
batch 36 loss: tensor(0.2967, device='cuda:0')
batch 37 loss: tensor(0.2795, device='cuda:0')
batch 38 loss: tensor(0.2350, device='cuda:0')
batch 39 loss: tensor(0.2506, device='cuda:0')
batch 40 loss: tensor(0.2311, device='cuda:0')
batch 41 loss: tensor(0.2737, device='cuda:0')
batch 42 loss: tensor(0.2584, device='cuda:0')
batch 43 loss: tensor(0.2579, device='cuda:0')
batch 44 loss: tensor(0.2555, device='cuda:0')
batch 45 loss: tensor(0.2556, device='cuda:0')
batch 46 loss: tensor(0.2691, device='cuda:0')
batch 47 loss: tensor(0.2568, device='cuda:0')
batch 48 loss: tensor(0.2413, device='cuda:0')
batch 49 loss: tensor(0.2450, device='cuda:0')
batch 50 loss: tensor(0.2718, device='cuda:0')
batch 51 loss: tensor(0.2182, device='cuda:0')
batch 52 loss: tensor(0.2954, device='cuda:0')
batch 53 loss: tensor(0.2548, device='cuda:0')
batch 54 loss: tensor(0.2467, device='cuda:0')
batch 55 loss: tensor(0.2471, device='cuda:0')
batch 56 loss: tensor(0.2669, device='cuda:0')
batch 57 loss: tensor(0.2575, device='cuda:0')
batch 58 loss: tensor(0.2451, device='cuda:0')
batch 59 loss: tensor(0.2524, device='cuda:0')
batch 60 loss: tensor(0.2464, device='cuda:0')
batch 61 loss: tensor(0.2593, device='cuda:0')
batch 62 loss: tensor(0.2593, device='cuda:0')
batch 63 loss: tensor(0.2692, device='cuda:0')
batch 64 loss: tensor(0.2606, device='cuda:0')
batch 65 loss: tensor(0.2477, device='cuda:0')
batch 66 loss: tensor(0.2425, device='cuda:0')
batch 67 loss: tensor(0.2507, device='cuda:0')
batch 68 loss: tensor(0.2724, device='cuda:0')
batch 69 loss: tensor(0.3014, device='cuda:0')
batch 70 loss: tensor(0.2432, device='cuda:0')
batch 71 loss: tensor(0.2465, device='cuda:0')
batch 72 loss: tensor(0.2791, device='cuda:0')
batch 73 loss: tensor(0.2452, device='cuda:0')
batch 74 loss: tensor(0.2680, device='cuda:0')
batch 75 loss: tensor(0.3121, device='cuda:0')
batch 76 loss: tensor(0.2723, device='cuda:0')
batch 77 loss: tensor(0.2800, device='cuda:0')
batch 78 loss: tensor(0.2645, device='cuda:0')
batch 79 loss: tensor(0.2536, device='cuda:0')
batch 80 loss: tensor(0.2876, device='cuda:0')
batch 81 loss: tensor(0.3026, device='cuda:0')
batch 82 loss: tensor(0.2499, device='cuda:0')
batch 83 loss: tensor(0.2773, device='cuda:0')
batch 84 loss: tensor(0.2255, device='cuda:0')
batch 85 loss: tensor(0.2689, device='cuda:0')
batch 86 loss: tensor(0.2876, device='cuda:0')
batch 87 loss: tensor(0.2759, device='cuda:0')
batch 88 loss: tensor(0.2657, device='cuda:0')
batch 89 loss: tensor(0.2714, device='cuda:0')
batch 90 loss: tensor(0.2586, device='cuda:0')
batch 91 loss: tensor(0.2470, device='cuda:0')
batch 92 loss: tensor(0.2722, device='cuda:0')
batch 93 loss: tensor(0.2688, device='cuda:0')
batch 94 loss: tensor(0.2955, device='cuda:0')
batch 95 loss: tensor(0.2379, device='cuda:0')
batch 96 loss: tensor(0.2486, device='cuda:0')
batch 97 loss: tensor(0.2781, device='cuda:0')
batch 98 loss: tensor(0.2854, device='cuda:0')
batch 99 loss: tensor(0.2286, device='cuda:0')
batch 100 loss: tensor(0.2813, device='cuda:0')
accuracy in val: 0.8960000000000001
accuracy in test: 0.89
average epoch time: 0.022527931928634642
total time: 4.505586385726929

0.8899000000000001 4.590598630905151
0.0021656407827707735 0.20947516878733363
