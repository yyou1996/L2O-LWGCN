Thu Nov 21 15:53:57 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      4922      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 16:12:28 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |      5%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      4922      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 16:30:45 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      4922      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 16:49:16 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    57W / 149W |    335MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      4922      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 17:07:42 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      4922      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 17:26:11 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |      7%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      4922      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 17:44:46 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |      8%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      4922      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 18:02:56 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |     12%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      4922      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 18:21:48 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |     11%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      4922      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 18:40:09 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      4922      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
{'dataset': 'amazon_3m', 'config_file': 'amazon_3m.yaml', 'layer_num': 2, 'epoch_num': [60, 60]}
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9925, device='cuda:0')
batch 2 loss: tensor(0.7091, device='cuda:0')
batch 3 loss: tensor(0.6199, device='cuda:0')
batch 4 loss: tensor(0.7127, device='cuda:0')
batch 5 loss: tensor(0.6283, device='cuda:0')
batch 6 loss: tensor(0.5583, device='cuda:0')
batch 7 loss: tensor(0.5950, device='cuda:0')
batch 8 loss: tensor(0.5381, device='cuda:0')
batch 9 loss: tensor(0.5799, device='cuda:0')
batch 10 loss: tensor(0.5934, device='cuda:0')
batch 11 loss: tensor(0.5605, device='cuda:0')
batch 12 loss: tensor(0.5496, device='cuda:0')
batch 13 loss: tensor(0.4884, device='cuda:0')
batch 14 loss: tensor(0.5645, device='cuda:0')
batch 15 loss: tensor(0.5060, device='cuda:0')
batch 16 loss: tensor(0.5386, device='cuda:0')
batch 17 loss: tensor(0.4734, device='cuda:0')
batch 18 loss: tensor(0.5027, device='cuda:0')
batch 19 loss: tensor(0.4963, device='cuda:0')
batch 20 loss: tensor(0.4539, device='cuda:0')
batch 21 loss: tensor(0.4839, device='cuda:0')
batch 22 loss: tensor(0.4935, device='cuda:0')
batch 23 loss: tensor(0.4714, device='cuda:0')
batch 24 loss: tensor(0.4351, device='cuda:0')
batch 25 loss: tensor(0.5329, device='cuda:0')
batch 26 loss: tensor(0.4589, device='cuda:0')
batch 27 loss: tensor(0.5158, device='cuda:0')
batch 28 loss: tensor(0.4742, device='cuda:0')
batch 29 loss: tensor(0.4814, device='cuda:0')
batch 30 loss: tensor(0.4705, device='cuda:0')
batch 31 loss: tensor(0.4929, device='cuda:0')
batch 32 loss: tensor(0.4731, device='cuda:0')
batch 33 loss: tensor(0.4581, device='cuda:0')
batch 34 loss: tensor(0.5056, device='cuda:0')
batch 35 loss: tensor(0.4596, device='cuda:0')
batch 36 loss: tensor(0.4340, device='cuda:0')
batch 37 loss: tensor(0.4519, device='cuda:0')
batch 38 loss: tensor(0.4432, device='cuda:0')
batch 39 loss: tensor(0.4837, device='cuda:0')
batch 40 loss: tensor(0.4969, device='cuda:0')
batch 41 loss: tensor(0.4214, device='cuda:0')
batch 42 loss: tensor(0.4430, device='cuda:0')
batch 43 loss: tensor(0.4465, device='cuda:0')
batch 44 loss: tensor(0.4748, device='cuda:0')
batch 45 loss: tensor(0.4291, device='cuda:0')
batch 46 loss: tensor(0.5028, device='cuda:0')
batch 47 loss: tensor(0.3935, device='cuda:0')
batch 48 loss: tensor(0.4514, device='cuda:0')
batch 49 loss: tensor(0.4325, device='cuda:0')
batch 50 loss: tensor(0.4117, device='cuda:0')
batch 51 loss: tensor(0.3905, device='cuda:0')
batch 52 loss: tensor(0.4753, device='cuda:0')
batch 53 loss: tensor(0.4673, device='cuda:0')
batch 54 loss: tensor(0.5720, device='cuda:0')
batch 55 loss: tensor(0.4823, device='cuda:0')
batch 56 loss: tensor(0.4294, device='cuda:0')
batch 57 loss: tensor(0.4970, device='cuda:0')
batch 58 loss: tensor(0.4533, device='cuda:0')
batch 59 loss: tensor(0.5129, device='cuda:0')
batch 60 loss: tensor(0.4986, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5692, device='cuda:0')
batch 2 loss: tensor(0.4807, device='cuda:0')
batch 3 loss: tensor(0.3974, device='cuda:0')
batch 4 loss: tensor(0.4638, device='cuda:0')
batch 5 loss: tensor(0.3724, device='cuda:0')
batch 6 loss: tensor(0.4184, device='cuda:0')
batch 7 loss: tensor(0.4273, device='cuda:0')
batch 8 loss: tensor(0.4901, device='cuda:0')
batch 9 loss: tensor(0.3945, device='cuda:0')
batch 10 loss: tensor(0.3767, device='cuda:0')
batch 11 loss: tensor(0.3977, device='cuda:0')
batch 12 loss: tensor(0.4268, device='cuda:0')
batch 13 loss: tensor(0.3412, device='cuda:0')
batch 14 loss: tensor(0.4073, device='cuda:0')
batch 15 loss: tensor(0.3854, device='cuda:0')
batch 16 loss: tensor(0.4263, device='cuda:0')
batch 17 loss: tensor(0.3958, device='cuda:0')
batch 18 loss: tensor(0.3643, device='cuda:0')
batch 19 loss: tensor(0.3535, device='cuda:0')
batch 20 loss: tensor(0.3725, device='cuda:0')
batch 21 loss: tensor(0.3730, device='cuda:0')
batch 22 loss: tensor(0.3493, device='cuda:0')
batch 23 loss: tensor(0.4063, device='cuda:0')
batch 24 loss: tensor(0.3505, device='cuda:0')
batch 25 loss: tensor(0.3975, device='cuda:0')
batch 26 loss: tensor(0.3670, device='cuda:0')
batch 27 loss: tensor(0.4378, device='cuda:0')
batch 28 loss: tensor(0.3440, device='cuda:0')
batch 29 loss: tensor(0.3717, device='cuda:0')
batch 30 loss: tensor(0.3957, device='cuda:0')
batch 31 loss: tensor(0.3914, device='cuda:0')
batch 32 loss: tensor(0.4127, device='cuda:0')
batch 33 loss: tensor(0.3636, device='cuda:0')
batch 34 loss: tensor(0.3328, device='cuda:0')
batch 35 loss: tensor(0.4165, device='cuda:0')
batch 36 loss: tensor(0.4282, device='cuda:0')
batch 37 loss: tensor(0.4095, device='cuda:0')
batch 38 loss: tensor(0.3181, device='cuda:0')
batch 39 loss: tensor(0.3611, device='cuda:0')
batch 40 loss: tensor(0.3435, device='cuda:0')
batch 41 loss: tensor(0.3807, device='cuda:0')
batch 42 loss: tensor(0.3954, device='cuda:0')
batch 43 loss: tensor(0.3594, device='cuda:0')
batch 44 loss: tensor(0.3555, device='cuda:0')
batch 45 loss: tensor(0.3815, device='cuda:0')
batch 46 loss: tensor(0.4123, device='cuda:0')
batch 47 loss: tensor(0.3683, device='cuda:0')
batch 48 loss: tensor(0.3727, device='cuda:0')
batch 49 loss: tensor(0.4095, device='cuda:0')
batch 50 loss: tensor(0.4082, device='cuda:0')
batch 51 loss: tensor(0.4142, device='cuda:0')
batch 52 loss: tensor(0.3244, device='cuda:0')
batch 53 loss: tensor(0.3821, device='cuda:0')
batch 54 loss: tensor(0.3531, device='cuda:0')
batch 55 loss: tensor(0.3740, device='cuda:0')
batch 56 loss: tensor(0.3533, device='cuda:0')
batch 57 loss: tensor(0.4102, device='cuda:0')
batch 58 loss: tensor(0.3743, device='cuda:0')
batch 59 loss: tensor(0.3555, device='cuda:0')
batch 60 loss: tensor(0.4230, device='cuda:0')
accuracy in val: 0.83767
accuracy in test: 0.8845880192160258
average epoch time: 1.7849705517292023
total time: 214.19646620750427
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9650, device='cuda:0')
batch 2 loss: tensor(0.7997, device='cuda:0')
batch 3 loss: tensor(0.6127, device='cuda:0')
batch 4 loss: tensor(0.6613, device='cuda:0')
batch 5 loss: tensor(0.5608, device='cuda:0')
batch 6 loss: tensor(0.5189, device='cuda:0')
batch 7 loss: tensor(0.6004, device='cuda:0')
batch 8 loss: tensor(0.5694, device='cuda:0')
batch 9 loss: tensor(0.5247, device='cuda:0')
batch 10 loss: tensor(0.5353, device='cuda:0')
batch 11 loss: tensor(0.5901, device='cuda:0')
batch 12 loss: tensor(0.5235, device='cuda:0')
batch 13 loss: tensor(0.4975, device='cuda:0')
batch 14 loss: tensor(0.5504, device='cuda:0')
batch 15 loss: tensor(0.5018, device='cuda:0')
batch 16 loss: tensor(0.6032, device='cuda:0')
batch 17 loss: tensor(0.4670, device='cuda:0')
batch 18 loss: tensor(0.4556, device='cuda:0')
batch 19 loss: tensor(0.4611, device='cuda:0')
batch 20 loss: tensor(0.4692, device='cuda:0')
batch 21 loss: tensor(0.5574, device='cuda:0')
batch 22 loss: tensor(0.4859, device='cuda:0')
batch 23 loss: tensor(0.4934, device='cuda:0')
batch 24 loss: tensor(0.4570, device='cuda:0')
batch 25 loss: tensor(0.4983, device='cuda:0')
batch 26 loss: tensor(0.4450, device='cuda:0')
batch 27 loss: tensor(0.4343, device='cuda:0')
batch 28 loss: tensor(0.5545, device='cuda:0')
batch 29 loss: tensor(0.5522, device='cuda:0')
batch 30 loss: tensor(0.5095, device='cuda:0')
batch 31 loss: tensor(0.4482, device='cuda:0')
batch 32 loss: tensor(0.4436, device='cuda:0')
batch 33 loss: tensor(0.5026, device='cuda:0')
batch 34 loss: tensor(0.4499, device='cuda:0')
batch 35 loss: tensor(0.4644, device='cuda:0')
batch 36 loss: tensor(0.4673, device='cuda:0')
batch 37 loss: tensor(0.4860, device='cuda:0')
batch 38 loss: tensor(0.4478, device='cuda:0')
batch 39 loss: tensor(0.4534, device='cuda:0')
batch 40 loss: tensor(0.5430, device='cuda:0')
batch 41 loss: tensor(0.4772, device='cuda:0')
batch 42 loss: tensor(0.4279, device='cuda:0')
batch 43 loss: tensor(0.4746, device='cuda:0')
batch 44 loss: tensor(0.4778, device='cuda:0')
batch 45 loss: tensor(0.4893, device='cuda:0')
batch 46 loss: tensor(0.4691, device='cuda:0')
batch 47 loss: tensor(0.4774, device='cuda:0')
batch 48 loss: tensor(0.4249, device='cuda:0')
batch 49 loss: tensor(0.4398, device='cuda:0')
batch 50 loss: tensor(0.4812, device='cuda:0')
batch 51 loss: tensor(0.4537, device='cuda:0')
batch 52 loss: tensor(0.4852, device='cuda:0')
batch 53 loss: tensor(0.5154, device='cuda:0')
batch 54 loss: tensor(0.4603, device='cuda:0')
batch 55 loss: tensor(0.5003, device='cuda:0')
batch 56 loss: tensor(0.4554, device='cuda:0')
batch 57 loss: tensor(0.4670, device='cuda:0')
batch 58 loss: tensor(0.4523, device='cuda:0')
batch 59 loss: tensor(0.5004, device='cuda:0')
batch 60 loss: tensor(0.4961, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.4581, device='cuda:0')
batch 2 loss: tensor(0.4453, device='cuda:0')
batch 3 loss: tensor(0.4909, device='cuda:0')
batch 4 loss: tensor(0.4148, device='cuda:0')
batch 5 loss: tensor(0.3521, device='cuda:0')
batch 6 loss: tensor(0.4067, device='cuda:0')
batch 7 loss: tensor(0.4823, device='cuda:0')
batch 8 loss: tensor(0.3884, device='cuda:0')
batch 9 loss: tensor(0.4028, device='cuda:0')
batch 10 loss: tensor(0.3726, device='cuda:0')
batch 11 loss: tensor(0.4620, device='cuda:0')
batch 12 loss: tensor(0.3702, device='cuda:0')
batch 13 loss: tensor(0.3669, device='cuda:0')
batch 14 loss: tensor(0.4225, device='cuda:0')
batch 15 loss: tensor(0.4396, device='cuda:0')
batch 16 loss: tensor(0.3939, device='cuda:0')
batch 17 loss: tensor(0.3837, device='cuda:0')
batch 18 loss: tensor(0.4105, device='cuda:0')
batch 19 loss: tensor(0.4027, device='cuda:0')
batch 20 loss: tensor(0.3673, device='cuda:0')
batch 21 loss: tensor(0.4146, device='cuda:0')
batch 22 loss: tensor(0.3709, device='cuda:0')
batch 23 loss: tensor(0.3995, device='cuda:0')
batch 24 loss: tensor(0.4269, device='cuda:0')
batch 25 loss: tensor(0.3589, device='cuda:0')
batch 26 loss: tensor(0.3693, device='cuda:0')
batch 27 loss: tensor(0.3976, device='cuda:0')
batch 28 loss: tensor(0.4095, device='cuda:0')
batch 29 loss: tensor(0.4717, device='cuda:0')
batch 30 loss: tensor(0.4294, device='cuda:0')
batch 31 loss: tensor(0.4136, device='cuda:0')
batch 32 loss: tensor(0.3884, device='cuda:0')
batch 33 loss: tensor(0.3438, device='cuda:0')
batch 34 loss: tensor(0.3458, device='cuda:0')
batch 35 loss: tensor(0.3723, device='cuda:0')
batch 36 loss: tensor(0.4092, device='cuda:0')
batch 37 loss: tensor(0.4035, device='cuda:0')
batch 38 loss: tensor(0.3810, device='cuda:0')
batch 39 loss: tensor(0.3953, device='cuda:0')
batch 40 loss: tensor(0.3531, device='cuda:0')
batch 41 loss: tensor(0.4356, device='cuda:0')
batch 42 loss: tensor(0.4152, device='cuda:0')
batch 43 loss: tensor(0.3572, device='cuda:0')
batch 44 loss: tensor(0.3192, device='cuda:0')
batch 45 loss: tensor(0.3543, device='cuda:0')
batch 46 loss: tensor(0.3540, device='cuda:0')
batch 47 loss: tensor(0.3566, device='cuda:0')
batch 48 loss: tensor(0.3492, device='cuda:0')
batch 49 loss: tensor(0.3994, device='cuda:0')
batch 50 loss: tensor(0.3717, device='cuda:0')
batch 51 loss: tensor(0.3663, device='cuda:0')
batch 52 loss: tensor(0.3948, device='cuda:0')
batch 53 loss: tensor(0.4479, device='cuda:0')
batch 54 loss: tensor(0.3467, device='cuda:0')
batch 55 loss: tensor(0.3694, device='cuda:0')
batch 56 loss: tensor(0.3852, device='cuda:0')
batch 57 loss: tensor(0.4717, device='cuda:0')
batch 58 loss: tensor(0.3908, device='cuda:0')
batch 59 loss: tensor(0.3483, device='cuda:0')
batch 60 loss: tensor(0.4438, device='cuda:0')
accuracy in val: 0.83703
accuracy in test: 0.8841316110243951
average epoch time: 1.8047350843747456
total time: 216.56821012496948
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.8757, device='cuda:0')
batch 2 loss: tensor(0.7549, device='cuda:0')
batch 3 loss: tensor(0.6479, device='cuda:0')
batch 4 loss: tensor(0.6459, device='cuda:0')
batch 5 loss: tensor(0.6122, device='cuda:0')
batch 6 loss: tensor(0.6440, device='cuda:0')
batch 7 loss: tensor(0.5750, device='cuda:0')
batch 8 loss: tensor(0.5236, device='cuda:0')
batch 9 loss: tensor(0.5260, device='cuda:0')
batch 10 loss: tensor(0.5415, device='cuda:0')
batch 11 loss: tensor(0.5051, device='cuda:0')
batch 12 loss: tensor(0.5792, device='cuda:0')
batch 13 loss: tensor(0.5128, device='cuda:0')
batch 14 loss: tensor(0.4948, device='cuda:0')
batch 15 loss: tensor(0.4927, device='cuda:0')
batch 16 loss: tensor(0.5885, device='cuda:0')
batch 17 loss: tensor(0.4662, device='cuda:0')
batch 18 loss: tensor(0.4803, device='cuda:0')
batch 19 loss: tensor(0.5685, device='cuda:0')
batch 20 loss: tensor(0.4518, device='cuda:0')
batch 21 loss: tensor(0.5616, device='cuda:0')
batch 22 loss: tensor(0.4835, device='cuda:0')
batch 23 loss: tensor(0.4938, device='cuda:0')
batch 24 loss: tensor(0.5302, device='cuda:0')
batch 25 loss: tensor(0.4774, device='cuda:0')
batch 26 loss: tensor(0.5454, device='cuda:0')
batch 27 loss: tensor(0.4455, device='cuda:0')
batch 28 loss: tensor(0.4688, device='cuda:0')
batch 29 loss: tensor(0.4894, device='cuda:0')
batch 30 loss: tensor(0.4811, device='cuda:0')
batch 31 loss: tensor(0.4820, device='cuda:0')
batch 32 loss: tensor(0.4872, device='cuda:0')
batch 33 loss: tensor(0.4752, device='cuda:0')
batch 34 loss: tensor(0.5000, device='cuda:0')
batch 35 loss: tensor(0.4837, device='cuda:0')
batch 36 loss: tensor(0.4974, device='cuda:0')
batch 37 loss: tensor(0.4190, device='cuda:0')
batch 38 loss: tensor(0.4455, device='cuda:0')
batch 39 loss: tensor(0.4666, device='cuda:0')
batch 40 loss: tensor(0.4456, device='cuda:0')
batch 41 loss: tensor(0.4754, device='cuda:0')
batch 42 loss: tensor(0.5122, device='cuda:0')
batch 43 loss: tensor(0.4625, device='cuda:0')
batch 44 loss: tensor(0.4795, device='cuda:0')
batch 45 loss: tensor(0.4800, device='cuda:0')
batch 46 loss: tensor(0.4206, device='cuda:0')
batch 47 loss: tensor(0.5119, device='cuda:0')
batch 48 loss: tensor(0.4966, device='cuda:0')
batch 49 loss: tensor(0.5172, device='cuda:0')
batch 50 loss: tensor(0.4633, device='cuda:0')
batch 51 loss: tensor(0.4833, device='cuda:0')
batch 52 loss: tensor(0.4255, device='cuda:0')
batch 53 loss: tensor(0.4799, device='cuda:0')
batch 54 loss: tensor(0.5992, device='cuda:0')
batch 55 loss: tensor(0.4627, device='cuda:0')
batch 56 loss: tensor(0.5018, device='cuda:0')
batch 57 loss: tensor(0.4244, device='cuda:0')
batch 58 loss: tensor(0.5031, device='cuda:0')
batch 59 loss: tensor(0.4499, device='cuda:0')
batch 60 loss: tensor(0.4309, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5793, device='cuda:0')
batch 2 loss: tensor(0.4727, device='cuda:0')
batch 3 loss: tensor(0.4293, device='cuda:0')
batch 4 loss: tensor(0.4190, device='cuda:0')
batch 5 loss: tensor(0.4220, device='cuda:0')
batch 6 loss: tensor(0.4132, device='cuda:0')
batch 7 loss: tensor(0.4373, device='cuda:0')
batch 8 loss: tensor(0.3773, device='cuda:0')
batch 9 loss: tensor(0.4122, device='cuda:0')
batch 10 loss: tensor(0.3711, device='cuda:0')
batch 11 loss: tensor(0.3996, device='cuda:0')
batch 12 loss: tensor(0.4144, device='cuda:0')
batch 13 loss: tensor(0.3243, device='cuda:0')
batch 14 loss: tensor(0.4120, device='cuda:0')
batch 15 loss: tensor(0.3871, device='cuda:0')
batch 16 loss: tensor(0.3637, device='cuda:0')
batch 17 loss: tensor(0.4120, device='cuda:0')
batch 18 loss: tensor(0.4071, device='cuda:0')
batch 19 loss: tensor(0.4161, device='cuda:0')
batch 20 loss: tensor(0.3977, device='cuda:0')
batch 21 loss: tensor(0.4694, device='cuda:0')
batch 22 loss: tensor(0.3925, device='cuda:0')
batch 23 loss: tensor(0.3924, device='cuda:0')
batch 24 loss: tensor(0.4165, device='cuda:0')
batch 25 loss: tensor(0.4123, device='cuda:0')
batch 26 loss: tensor(0.3734, device='cuda:0')
batch 27 loss: tensor(0.3535, device='cuda:0')
batch 28 loss: tensor(0.4098, device='cuda:0')
batch 29 loss: tensor(0.3852, device='cuda:0')
batch 30 loss: tensor(0.4001, device='cuda:0')
batch 31 loss: tensor(0.3910, device='cuda:0')
batch 32 loss: tensor(0.3796, device='cuda:0')
batch 33 loss: tensor(0.3815, device='cuda:0')
batch 34 loss: tensor(0.3138, device='cuda:0')
batch 35 loss: tensor(0.3196, device='cuda:0')
batch 36 loss: tensor(0.3854, device='cuda:0')
batch 37 loss: tensor(0.3910, device='cuda:0')
batch 38 loss: tensor(0.3511, device='cuda:0')
batch 39 loss: tensor(0.3823, device='cuda:0')
batch 40 loss: tensor(0.3439, device='cuda:0')
batch 41 loss: tensor(0.3528, device='cuda:0')
batch 42 loss: tensor(0.3433, device='cuda:0')
batch 43 loss: tensor(0.2749, device='cuda:0')
batch 44 loss: tensor(0.3895, device='cuda:0')
batch 45 loss: tensor(0.3814, device='cuda:0')
batch 46 loss: tensor(0.3875, device='cuda:0')
batch 47 loss: tensor(0.3439, device='cuda:0')
batch 48 loss: tensor(0.3750, device='cuda:0')
batch 49 loss: tensor(0.3885, device='cuda:0')
batch 50 loss: tensor(0.3294, device='cuda:0')
batch 51 loss: tensor(0.3383, device='cuda:0')
batch 52 loss: tensor(0.4084, device='cuda:0')
batch 53 loss: tensor(0.3583, device='cuda:0')
batch 54 loss: tensor(0.3569, device='cuda:0')
batch 55 loss: tensor(0.3693, device='cuda:0')
batch 56 loss: tensor(0.4134, device='cuda:0')
batch 57 loss: tensor(0.4002, device='cuda:0')
batch 58 loss: tensor(0.4001, device='cuda:0')
batch 59 loss: tensor(0.4010, device='cuda:0')
batch 60 loss: tensor(0.3748, device='cuda:0')
accuracy in val: 0.83769
accuracy in test: 0.8848307015173159
average epoch time: 1.7778474370638528
total time: 213.34169244766235
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0219, device='cuda:0')
batch 2 loss: tensor(0.7932, device='cuda:0')
batch 3 loss: tensor(0.6715, device='cuda:0')
batch 4 loss: tensor(0.6398, device='cuda:0')
batch 5 loss: tensor(0.5342, device='cuda:0')
batch 6 loss: tensor(0.5085, device='cuda:0')
batch 7 loss: tensor(0.5902, device='cuda:0')
batch 8 loss: tensor(0.5967, device='cuda:0')
batch 9 loss: tensor(0.5492, device='cuda:0')
batch 10 loss: tensor(0.5432, device='cuda:0')
batch 11 loss: tensor(0.5239, device='cuda:0')
batch 12 loss: tensor(0.5346, device='cuda:0')
batch 13 loss: tensor(0.5320, device='cuda:0')
batch 14 loss: tensor(0.5738, device='cuda:0')
batch 15 loss: tensor(0.5728, device='cuda:0')
batch 16 loss: tensor(0.4786, device='cuda:0')
batch 17 loss: tensor(0.5080, device='cuda:0')
batch 18 loss: tensor(0.4729, device='cuda:0')
batch 19 loss: tensor(0.4740, device='cuda:0')
batch 20 loss: tensor(0.5145, device='cuda:0')
batch 21 loss: tensor(0.5004, device='cuda:0')
batch 22 loss: tensor(0.4940, device='cuda:0')
batch 23 loss: tensor(0.4072, device='cuda:0')
batch 24 loss: tensor(0.4369, device='cuda:0')
batch 25 loss: tensor(0.4294, device='cuda:0')
batch 26 loss: tensor(0.5166, device='cuda:0')
batch 27 loss: tensor(0.4543, device='cuda:0')
batch 28 loss: tensor(0.5446, device='cuda:0')
batch 29 loss: tensor(0.5133, device='cuda:0')
batch 30 loss: tensor(0.4756, device='cuda:0')
batch 31 loss: tensor(0.4731, device='cuda:0')
batch 32 loss: tensor(0.4782, device='cuda:0')
batch 33 loss: tensor(0.5379, device='cuda:0')
batch 34 loss: tensor(0.5165, device='cuda:0')
batch 35 loss: tensor(0.4207, device='cuda:0')
batch 36 loss: tensor(0.4626, device='cuda:0')
batch 37 loss: tensor(0.4770, device='cuda:0')
batch 38 loss: tensor(0.4566, device='cuda:0')
batch 39 loss: tensor(0.5439, device='cuda:0')
batch 40 loss: tensor(0.4446, device='cuda:0')
batch 41 loss: tensor(0.5344, device='cuda:0')
batch 42 loss: tensor(0.5467, device='cuda:0')
batch 43 loss: tensor(0.4710, device='cuda:0')
batch 44 loss: tensor(0.5015, device='cuda:0')
batch 45 loss: tensor(0.5347, device='cuda:0')
batch 46 loss: tensor(0.4656, device='cuda:0')
batch 47 loss: tensor(0.4810, device='cuda:0')
batch 48 loss: tensor(0.4540, device='cuda:0')
batch 49 loss: tensor(0.4538, device='cuda:0')
batch 50 loss: tensor(0.4300, device='cuda:0')
batch 51 loss: tensor(0.4439, device='cuda:0')
batch 52 loss: tensor(0.4246, device='cuda:0')
batch 53 loss: tensor(0.4480, device='cuda:0')
batch 54 loss: tensor(0.4370, device='cuda:0')
batch 55 loss: tensor(0.3967, device='cuda:0')
batch 56 loss: tensor(0.4902, device='cuda:0')
batch 57 loss: tensor(0.4400, device='cuda:0')
batch 58 loss: tensor(0.5236, device='cuda:0')
batch 59 loss: tensor(0.4124, device='cuda:0')
batch 60 loss: tensor(0.3888, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5500, device='cuda:0')
batch 2 loss: tensor(0.4685, device='cuda:0')
batch 3 loss: tensor(0.4954, device='cuda:0')
batch 4 loss: tensor(0.4975, device='cuda:0')
batch 5 loss: tensor(0.3857, device='cuda:0')
batch 6 loss: tensor(0.4435, device='cuda:0')
batch 7 loss: tensor(0.3756, device='cuda:0')
batch 8 loss: tensor(0.3978, device='cuda:0')
batch 9 loss: tensor(0.3686, device='cuda:0')
batch 10 loss: tensor(0.4274, device='cuda:0')
batch 11 loss: tensor(0.4024, device='cuda:0')
batch 12 loss: tensor(0.4163, device='cuda:0')
batch 13 loss: tensor(0.3915, device='cuda:0')
batch 14 loss: tensor(0.3833, device='cuda:0')
batch 15 loss: tensor(0.3696, device='cuda:0')
batch 16 loss: tensor(0.3854, device='cuda:0')
batch 17 loss: tensor(0.3972, device='cuda:0')
batch 18 loss: tensor(0.4276, device='cuda:0')
batch 19 loss: tensor(0.4355, device='cuda:0')
batch 20 loss: tensor(0.3749, device='cuda:0')
batch 21 loss: tensor(0.3588, device='cuda:0')
batch 22 loss: tensor(0.3328, device='cuda:0')
batch 23 loss: tensor(0.4040, device='cuda:0')
batch 24 loss: tensor(0.3944, device='cuda:0')
batch 25 loss: tensor(0.3402, device='cuda:0')
batch 26 loss: tensor(0.3640, device='cuda:0')
batch 27 loss: tensor(0.3438, device='cuda:0')
batch 28 loss: tensor(0.3953, device='cuda:0')
batch 29 loss: tensor(0.3441, device='cuda:0')
batch 30 loss: tensor(0.4092, device='cuda:0')
batch 31 loss: tensor(0.3529, device='cuda:0')
batch 32 loss: tensor(0.4169, device='cuda:0')
batch 33 loss: tensor(0.3741, device='cuda:0')
batch 34 loss: tensor(0.3886, device='cuda:0')
batch 35 loss: tensor(0.3869, device='cuda:0')
batch 36 loss: tensor(0.3824, device='cuda:0')
batch 37 loss: tensor(0.3473, device='cuda:0')
batch 38 loss: tensor(0.3696, device='cuda:0')
batch 39 loss: tensor(0.3938, device='cuda:0')
batch 40 loss: tensor(0.3963, device='cuda:0')
batch 41 loss: tensor(0.3557, device='cuda:0')
batch 42 loss: tensor(0.3854, device='cuda:0')
batch 43 loss: tensor(0.3324, device='cuda:0')
batch 44 loss: tensor(0.3765, device='cuda:0')
batch 45 loss: tensor(0.3566, device='cuda:0')
batch 46 loss: tensor(0.4175, device='cuda:0')
batch 47 loss: tensor(0.3736, device='cuda:0')
batch 48 loss: tensor(0.3761, device='cuda:0')
batch 49 loss: tensor(0.4298, device='cuda:0')
batch 50 loss: tensor(0.3381, device='cuda:0')
batch 51 loss: tensor(0.4187, device='cuda:0')
batch 52 loss: tensor(0.3989, device='cuda:0')
batch 53 loss: tensor(0.3508, device='cuda:0')
batch 54 loss: tensor(0.3843, device='cuda:0')
batch 55 loss: tensor(0.3565, device='cuda:0')
batch 56 loss: tensor(0.3826, device='cuda:0')
batch 57 loss: tensor(0.3617, device='cuda:0')
batch 58 loss: tensor(0.3529, device='cuda:0')
batch 59 loss: tensor(0.3862, device='cuda:0')
batch 60 loss: tensor(0.3866, device='cuda:0')
accuracy in val: 0.83799
accuracy in test: 0.8841867660928701
average epoch time: 1.8493657290935517
total time: 221.9238874912262
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9919, device='cuda:0')
batch 2 loss: tensor(0.8030, device='cuda:0')
batch 3 loss: tensor(0.6614, device='cuda:0')
batch 4 loss: tensor(0.6260, device='cuda:0')
batch 5 loss: tensor(0.6439, device='cuda:0')
batch 6 loss: tensor(0.5537, device='cuda:0')
batch 7 loss: tensor(0.5671, device='cuda:0')
batch 8 loss: tensor(0.5447, device='cuda:0')
batch 9 loss: tensor(0.5646, device='cuda:0')
batch 10 loss: tensor(0.4945, device='cuda:0')
batch 11 loss: tensor(0.5383, device='cuda:0')
batch 12 loss: tensor(0.4896, device='cuda:0')
batch 13 loss: tensor(0.5360, device='cuda:0')
batch 14 loss: tensor(0.5186, device='cuda:0')
batch 15 loss: tensor(0.4912, device='cuda:0')
batch 16 loss: tensor(0.4864, device='cuda:0')
batch 17 loss: tensor(0.4601, device='cuda:0')
batch 18 loss: tensor(0.4898, device='cuda:0')
batch 19 loss: tensor(0.5383, device='cuda:0')
batch 20 loss: tensor(0.4686, device='cuda:0')
batch 21 loss: tensor(0.5115, device='cuda:0')
batch 22 loss: tensor(0.5062, device='cuda:0')
batch 23 loss: tensor(0.5056, device='cuda:0')
batch 24 loss: tensor(0.5284, device='cuda:0')
batch 25 loss: tensor(0.4937, device='cuda:0')
batch 26 loss: tensor(0.4936, device='cuda:0')
batch 27 loss: tensor(0.4922, device='cuda:0')
batch 28 loss: tensor(0.5095, device='cuda:0')
batch 29 loss: tensor(0.5139, device='cuda:0')
batch 30 loss: tensor(0.5145, device='cuda:0')
batch 31 loss: tensor(0.5389, device='cuda:0')
batch 32 loss: tensor(0.5056, device='cuda:0')
batch 33 loss: tensor(0.5020, device='cuda:0')
batch 34 loss: tensor(0.5042, device='cuda:0')
batch 35 loss: tensor(0.4848, device='cuda:0')
batch 36 loss: tensor(0.5501, device='cuda:0')
batch 37 loss: tensor(0.5396, device='cuda:0')
batch 38 loss: tensor(0.4018, device='cuda:0')
batch 39 loss: tensor(0.5054, device='cuda:0')
batch 40 loss: tensor(0.4598, device='cuda:0')
batch 41 loss: tensor(0.4836, device='cuda:0')
batch 42 loss: tensor(0.4294, device='cuda:0')
batch 43 loss: tensor(0.5163, device='cuda:0')
batch 44 loss: tensor(0.4944, device='cuda:0')
batch 45 loss: tensor(0.5205, device='cuda:0')
batch 46 loss: tensor(0.4831, device='cuda:0')
batch 47 loss: tensor(0.4836, device='cuda:0')
batch 48 loss: tensor(0.4689, device='cuda:0')
batch 49 loss: tensor(0.4999, device='cuda:0')
batch 50 loss: tensor(0.4619, device='cuda:0')
batch 51 loss: tensor(0.4389, device='cuda:0')
batch 52 loss: tensor(0.4899, device='cuda:0')
batch 53 loss: tensor(0.4467, device='cuda:0')
batch 54 loss: tensor(0.4317, device='cuda:0')
batch 55 loss: tensor(0.4759, device='cuda:0')
batch 56 loss: tensor(0.4445, device='cuda:0')
batch 57 loss: tensor(0.4725, device='cuda:0')
batch 58 loss: tensor(0.4270, device='cuda:0')
batch 59 loss: tensor(0.4396, device='cuda:0')
batch 60 loss: tensor(0.4876, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5177, device='cuda:0')
batch 2 loss: tensor(0.4818, device='cuda:0')
batch 3 loss: tensor(0.4067, device='cuda:0')
batch 4 loss: tensor(0.4481, device='cuda:0')
batch 5 loss: tensor(0.4283, device='cuda:0')
batch 6 loss: tensor(0.3506, device='cuda:0')
batch 7 loss: tensor(0.3835, device='cuda:0')
batch 8 loss: tensor(0.3998, device='cuda:0')
batch 9 loss: tensor(0.3495, device='cuda:0')
batch 10 loss: tensor(0.4534, device='cuda:0')
batch 11 loss: tensor(0.3692, device='cuda:0')
batch 12 loss: tensor(0.4060, device='cuda:0')
batch 13 loss: tensor(0.3892, device='cuda:0')
batch 14 loss: tensor(0.3809, device='cuda:0')
batch 15 loss: tensor(0.3966, device='cuda:0')
batch 16 loss: tensor(0.4482, device='cuda:0')
batch 17 loss: tensor(0.4144, device='cuda:0')
batch 18 loss: tensor(0.3838, device='cuda:0')
batch 19 loss: tensor(0.3452, device='cuda:0')
batch 20 loss: tensor(0.3999, device='cuda:0')
batch 21 loss: tensor(0.4402, device='cuda:0')
batch 22 loss: tensor(0.3889, device='cuda:0')
batch 23 loss: tensor(0.3620, device='cuda:0')
batch 24 loss: tensor(0.3431, device='cuda:0')
batch 25 loss: tensor(0.4037, device='cuda:0')
batch 26 loss: tensor(0.3845, device='cuda:0')
batch 27 loss: tensor(0.4189, device='cuda:0')
batch 28 loss: tensor(0.3410, device='cuda:0')
batch 29 loss: tensor(0.3687, device='cuda:0')
batch 30 loss: tensor(0.4014, device='cuda:0')
batch 31 loss: tensor(0.3514, device='cuda:0')
batch 32 loss: tensor(0.3876, device='cuda:0')
batch 33 loss: tensor(0.3710, device='cuda:0')
batch 34 loss: tensor(0.3547, device='cuda:0')
batch 35 loss: tensor(0.3938, device='cuda:0')
batch 36 loss: tensor(0.3376, device='cuda:0')
batch 37 loss: tensor(0.3046, device='cuda:0')
batch 38 loss: tensor(0.3801, device='cuda:0')
batch 39 loss: tensor(0.4265, device='cuda:0')
batch 40 loss: tensor(0.3404, device='cuda:0')
batch 41 loss: tensor(0.3470, device='cuda:0')
batch 42 loss: tensor(0.3524, device='cuda:0')
batch 43 loss: tensor(0.3988, device='cuda:0')
batch 44 loss: tensor(0.3931, device='cuda:0')
batch 45 loss: tensor(0.3798, device='cuda:0')
batch 46 loss: tensor(0.3322, device='cuda:0')
batch 47 loss: tensor(0.4016, device='cuda:0')
batch 48 loss: tensor(0.4815, device='cuda:0')
batch 49 loss: tensor(0.3830, device='cuda:0')
batch 50 loss: tensor(0.3507, device='cuda:0')
batch 51 loss: tensor(0.4047, device='cuda:0')
batch 52 loss: tensor(0.3617, device='cuda:0')
batch 53 loss: tensor(0.3924, device='cuda:0')
batch 54 loss: tensor(0.3873, device='cuda:0')
batch 55 loss: tensor(0.3160, device='cuda:0')
batch 56 loss: tensor(0.3406, device='cuda:0')
batch 57 loss: tensor(0.3850, device='cuda:0')
batch 58 loss: tensor(0.3281, device='cuda:0')
batch 59 loss: tensor(0.3700, device='cuda:0')
batch 60 loss: tensor(0.3043, device='cuda:0')
accuracy in val: 0.8360733333333333
accuracy in test: 0.8843729144489733
average epoch time: 1.8031923373540242
total time: 216.3830804824829
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9648, device='cuda:0')
batch 2 loss: tensor(0.8066, device='cuda:0')
batch 3 loss: tensor(0.6363, device='cuda:0')
batch 4 loss: tensor(0.6625, device='cuda:0')
batch 5 loss: tensor(0.5798, device='cuda:0')
batch 6 loss: tensor(0.5697, device='cuda:0')
batch 7 loss: tensor(0.5671, device='cuda:0')
batch 8 loss: tensor(0.4998, device='cuda:0')
batch 9 loss: tensor(0.5650, device='cuda:0')
batch 10 loss: tensor(0.4972, device='cuda:0')
batch 11 loss: tensor(0.5321, device='cuda:0')
batch 12 loss: tensor(0.5540, device='cuda:0')
batch 13 loss: tensor(0.5231, device='cuda:0')
batch 14 loss: tensor(0.4971, device='cuda:0')
batch 15 loss: tensor(0.5491, device='cuda:0')
batch 16 loss: tensor(0.5499, device='cuda:0')
batch 17 loss: tensor(0.5227, device='cuda:0')
batch 18 loss: tensor(0.5293, device='cuda:0')
batch 19 loss: tensor(0.4792, device='cuda:0')
batch 20 loss: tensor(0.5131, device='cuda:0')
batch 21 loss: tensor(0.4853, device='cuda:0')
batch 22 loss: tensor(0.4481, device='cuda:0')
batch 23 loss: tensor(0.5215, device='cuda:0')
batch 24 loss: tensor(0.4663, device='cuda:0')
batch 25 loss: tensor(0.4947, device='cuda:0')
batch 26 loss: tensor(0.4841, device='cuda:0')
batch 27 loss: tensor(0.5000, device='cuda:0')
batch 28 loss: tensor(0.5196, device='cuda:0')
batch 29 loss: tensor(0.4509, device='cuda:0')
batch 30 loss: tensor(0.4780, device='cuda:0')
batch 31 loss: tensor(0.4627, device='cuda:0')
batch 32 loss: tensor(0.4658, device='cuda:0')
batch 33 loss: tensor(0.5126, device='cuda:0')
batch 34 loss: tensor(0.4739, device='cuda:0')
batch 35 loss: tensor(0.5173, device='cuda:0')
batch 36 loss: tensor(0.4503, device='cuda:0')
batch 37 loss: tensor(0.4742, device='cuda:0')
batch 38 loss: tensor(0.4481, device='cuda:0')
batch 39 loss: tensor(0.4449, device='cuda:0')
batch 40 loss: tensor(0.4677, device='cuda:0')
batch 41 loss: tensor(0.4492, device='cuda:0')
batch 42 loss: tensor(0.5054, device='cuda:0')
batch 43 loss: tensor(0.4551, device='cuda:0')
batch 44 loss: tensor(0.4920, device='cuda:0')
batch 45 loss: tensor(0.4359, device='cuda:0')
batch 46 loss: tensor(0.4932, device='cuda:0')
batch 47 loss: tensor(0.5214, device='cuda:0')
batch 48 loss: tensor(0.4646, device='cuda:0')
batch 49 loss: tensor(0.4941, device='cuda:0')
batch 50 loss: tensor(0.4849, device='cuda:0')
batch 51 loss: tensor(0.4940, device='cuda:0')
batch 52 loss: tensor(0.4711, device='cuda:0')
batch 53 loss: tensor(0.4569, device='cuda:0')
batch 54 loss: tensor(0.4512, device='cuda:0')
batch 55 loss: tensor(0.4861, device='cuda:0')
batch 56 loss: tensor(0.4869, device='cuda:0')
batch 57 loss: tensor(0.4441, device='cuda:0')
batch 58 loss: tensor(0.5065, device='cuda:0')
batch 59 loss: tensor(0.4230, device='cuda:0')
batch 60 loss: tensor(0.4372, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5616, device='cuda:0')
batch 2 loss: tensor(0.4910, device='cuda:0')
batch 3 loss: tensor(0.4038, device='cuda:0')
batch 4 loss: tensor(0.4832, device='cuda:0')
batch 5 loss: tensor(0.3912, device='cuda:0')
batch 6 loss: tensor(0.4269, device='cuda:0')
batch 7 loss: tensor(0.4383, device='cuda:0')
batch 8 loss: tensor(0.4090, device='cuda:0')
batch 9 loss: tensor(0.4156, device='cuda:0')
batch 10 loss: tensor(0.4428, device='cuda:0')
batch 11 loss: tensor(0.3715, device='cuda:0')
batch 12 loss: tensor(0.3596, device='cuda:0')
batch 13 loss: tensor(0.3496, device='cuda:0')
batch 14 loss: tensor(0.4264, device='cuda:0')
batch 15 loss: tensor(0.3698, device='cuda:0')
batch 16 loss: tensor(0.3771, device='cuda:0')
batch 17 loss: tensor(0.3491, device='cuda:0')
batch 18 loss: tensor(0.3747, device='cuda:0')
batch 19 loss: tensor(0.3960, device='cuda:0')
batch 20 loss: tensor(0.4271, device='cuda:0')
batch 21 loss: tensor(0.3638, device='cuda:0')
batch 22 loss: tensor(0.3994, device='cuda:0')
batch 23 loss: tensor(0.3513, device='cuda:0')
batch 24 loss: tensor(0.3770, device='cuda:0')
batch 25 loss: tensor(0.3877, device='cuda:0')
batch 26 loss: tensor(0.4424, device='cuda:0')
batch 27 loss: tensor(0.3987, device='cuda:0')
batch 28 loss: tensor(0.4109, device='cuda:0')
batch 29 loss: tensor(0.3342, device='cuda:0')
batch 30 loss: tensor(0.3478, device='cuda:0')
batch 31 loss: tensor(0.3861, device='cuda:0')
batch 32 loss: tensor(0.4064, device='cuda:0')
batch 33 loss: tensor(0.3996, device='cuda:0')
batch 34 loss: tensor(0.3728, device='cuda:0')
batch 35 loss: tensor(0.4078, device='cuda:0')
batch 36 loss: tensor(0.3754, device='cuda:0')
batch 37 loss: tensor(0.3448, device='cuda:0')
batch 38 loss: tensor(0.3501, device='cuda:0')
batch 39 loss: tensor(0.3470, device='cuda:0')
batch 40 loss: tensor(0.3608, device='cuda:0')
batch 41 loss: tensor(0.3870, device='cuda:0')
batch 42 loss: tensor(0.4263, device='cuda:0')
batch 43 loss: tensor(0.3547, device='cuda:0')
batch 44 loss: tensor(0.3440, device='cuda:0')
batch 45 loss: tensor(0.3030, device='cuda:0')
batch 46 loss: tensor(0.3489, device='cuda:0')
batch 47 loss: tensor(0.3787, device='cuda:0')
batch 48 loss: tensor(0.3747, device='cuda:0')
batch 49 loss: tensor(0.3611, device='cuda:0')
batch 50 loss: tensor(0.4896, device='cuda:0')
batch 51 loss: tensor(0.3921, device='cuda:0')
batch 52 loss: tensor(0.4378, device='cuda:0')
batch 53 loss: tensor(0.3624, device='cuda:0')
batch 54 loss: tensor(0.3905, device='cuda:0')
batch 55 loss: tensor(0.3832, device='cuda:0')
batch 56 loss: tensor(0.3489, device='cuda:0')
batch 57 loss: tensor(0.3686, device='cuda:0')
batch 58 loss: tensor(0.3856, device='cuda:0')
batch 59 loss: tensor(0.3972, device='cuda:0')
batch 60 loss: tensor(0.2975, device='cuda:0')
accuracy in val: 0.8363966666666667
accuracy in test: 0.8843343059010408
average epoch time: 1.8129021942615509
total time: 217.5482633113861
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9502, device='cuda:0')
batch 2 loss: tensor(0.7399, device='cuda:0')
batch 3 loss: tensor(0.7171, device='cuda:0')
batch 4 loss: tensor(0.6365, device='cuda:0')
batch 5 loss: tensor(0.6206, device='cuda:0')
batch 6 loss: tensor(0.7218, device='cuda:0')
batch 7 loss: tensor(0.6163, device='cuda:0')
batch 8 loss: tensor(0.6279, device='cuda:0')
batch 9 loss: tensor(0.5212, device='cuda:0')
batch 10 loss: tensor(0.5644, device='cuda:0')
batch 11 loss: tensor(0.5590, device='cuda:0')
batch 12 loss: tensor(0.5504, device='cuda:0')
batch 13 loss: tensor(0.5312, device='cuda:0')
batch 14 loss: tensor(0.5192, device='cuda:0')
batch 15 loss: tensor(0.4969, device='cuda:0')
batch 16 loss: tensor(0.5189, device='cuda:0')
batch 17 loss: tensor(0.4819, device='cuda:0')
batch 18 loss: tensor(0.4549, device='cuda:0')
batch 19 loss: tensor(0.4784, device='cuda:0')
batch 20 loss: tensor(0.4966, device='cuda:0')
batch 21 loss: tensor(0.4761, device='cuda:0')
batch 22 loss: tensor(0.4719, device='cuda:0')
batch 23 loss: tensor(0.5242, device='cuda:0')
batch 24 loss: tensor(0.5462, device='cuda:0')
batch 25 loss: tensor(0.4842, device='cuda:0')
batch 26 loss: tensor(0.4389, device='cuda:0')
batch 27 loss: tensor(0.4766, device='cuda:0')
batch 28 loss: tensor(0.5083, device='cuda:0')
batch 29 loss: tensor(0.4310, device='cuda:0')
batch 30 loss: tensor(0.4697, device='cuda:0')
batch 31 loss: tensor(0.5392, device='cuda:0')
batch 32 loss: tensor(0.4775, device='cuda:0')
batch 33 loss: tensor(0.4981, device='cuda:0')
batch 34 loss: tensor(0.4805, device='cuda:0')
batch 35 loss: tensor(0.4493, device='cuda:0')
batch 36 loss: tensor(0.4344, device='cuda:0')
batch 37 loss: tensor(0.5198, device='cuda:0')
batch 38 loss: tensor(0.4413, device='cuda:0')
batch 39 loss: tensor(0.4661, device='cuda:0')
batch 40 loss: tensor(0.4256, device='cuda:0')
batch 41 loss: tensor(0.5066, device='cuda:0')
batch 42 loss: tensor(0.5247, device='cuda:0')
batch 43 loss: tensor(0.4308, device='cuda:0')
batch 44 loss: tensor(0.5208, device='cuda:0')
batch 45 loss: tensor(0.4634, device='cuda:0')
batch 46 loss: tensor(0.4454, device='cuda:0')
batch 47 loss: tensor(0.4152, device='cuda:0')
batch 48 loss: tensor(0.5001, device='cuda:0')
batch 49 loss: tensor(0.4574, device='cuda:0')
batch 50 loss: tensor(0.4134, device='cuda:0')
batch 51 loss: tensor(0.4407, device='cuda:0')
batch 52 loss: tensor(0.4161, device='cuda:0')
batch 53 loss: tensor(0.4819, device='cuda:0')
batch 54 loss: tensor(0.4534, device='cuda:0')
batch 55 loss: tensor(0.4908, device='cuda:0')
batch 56 loss: tensor(0.5052, device='cuda:0')
batch 57 loss: tensor(0.4486, device='cuda:0')
batch 58 loss: tensor(0.4476, device='cuda:0')
batch 59 loss: tensor(0.4607, device='cuda:0')
batch 60 loss: tensor(0.4364, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.4986, device='cuda:0')
batch 2 loss: tensor(0.4379, device='cuda:0')
batch 3 loss: tensor(0.4360, device='cuda:0')
batch 4 loss: tensor(0.4482, device='cuda:0')
batch 5 loss: tensor(0.3975, device='cuda:0')
batch 6 loss: tensor(0.4405, device='cuda:0')
batch 7 loss: tensor(0.4204, device='cuda:0')
batch 8 loss: tensor(0.4080, device='cuda:0')
batch 9 loss: tensor(0.3827, device='cuda:0')
batch 10 loss: tensor(0.4105, device='cuda:0')
batch 11 loss: tensor(0.4104, device='cuda:0')
batch 12 loss: tensor(0.3867, device='cuda:0')
batch 13 loss: tensor(0.3949, device='cuda:0')
batch 14 loss: tensor(0.3838, device='cuda:0')
batch 15 loss: tensor(0.4018, device='cuda:0')
batch 16 loss: tensor(0.3772, device='cuda:0')
batch 17 loss: tensor(0.4442, device='cuda:0')
batch 18 loss: tensor(0.3857, device='cuda:0')
batch 19 loss: tensor(0.3917, device='cuda:0')
batch 20 loss: tensor(0.4224, device='cuda:0')
batch 21 loss: tensor(0.4120, device='cuda:0')
batch 22 loss: tensor(0.4350, device='cuda:0')
batch 23 loss: tensor(0.3835, device='cuda:0')
batch 24 loss: tensor(0.4324, device='cuda:0')
batch 25 loss: tensor(0.3585, device='cuda:0')
batch 26 loss: tensor(0.3738, device='cuda:0')
batch 27 loss: tensor(0.3818, device='cuda:0')
batch 28 loss: tensor(0.3714, device='cuda:0')
batch 29 loss: tensor(0.3806, device='cuda:0')
batch 30 loss: tensor(0.4073, device='cuda:0')
batch 31 loss: tensor(0.3935, device='cuda:0')
batch 32 loss: tensor(0.4119, device='cuda:0')
batch 33 loss: tensor(0.3655, device='cuda:0')
batch 34 loss: tensor(0.3726, device='cuda:0')
batch 35 loss: tensor(0.3949, device='cuda:0')
batch 36 loss: tensor(0.4009, device='cuda:0')
batch 37 loss: tensor(0.3944, device='cuda:0')
batch 38 loss: tensor(0.4076, device='cuda:0')
batch 39 loss: tensor(0.3257, device='cuda:0')
batch 40 loss: tensor(0.3869, device='cuda:0')
batch 41 loss: tensor(0.3781, device='cuda:0')
batch 42 loss: tensor(0.3667, device='cuda:0')
batch 43 loss: tensor(0.4003, device='cuda:0')
batch 44 loss: tensor(0.3356, device='cuda:0')
batch 45 loss: tensor(0.3618, device='cuda:0')
batch 46 loss: tensor(0.3368, device='cuda:0')
batch 47 loss: tensor(0.4019, device='cuda:0')
batch 48 loss: tensor(0.3590, device='cuda:0')
batch 49 loss: tensor(0.4078, device='cuda:0')
batch 50 loss: tensor(0.4087, device='cuda:0')
batch 51 loss: tensor(0.4201, device='cuda:0')
batch 52 loss: tensor(0.3539, device='cuda:0')
batch 53 loss: tensor(0.2941, device='cuda:0')
batch 54 loss: tensor(0.3880, device='cuda:0')
batch 55 loss: tensor(0.3775, device='cuda:0')
batch 56 loss: tensor(0.4303, device='cuda:0')
batch 57 loss: tensor(0.3890, device='cuda:0')
batch 58 loss: tensor(0.3648, device='cuda:0')
batch 59 loss: tensor(0.3347, device='cuda:0')
batch 60 loss: tensor(0.3552, device='cuda:0')
accuracy in val: 0.8370766666666666
accuracy in test: 0.8846569630516197
average epoch time: 1.9323676844437918
total time: 231.884122133255
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9489, device='cuda:0')
batch 2 loss: tensor(0.7448, device='cuda:0')
batch 3 loss: tensor(0.7290, device='cuda:0')
batch 4 loss: tensor(0.6912, device='cuda:0')
batch 5 loss: tensor(0.6524, device='cuda:0')
batch 6 loss: tensor(0.5840, device='cuda:0')
batch 7 loss: tensor(0.5508, device='cuda:0')
batch 8 loss: tensor(0.5633, device='cuda:0')
batch 9 loss: tensor(0.5799, device='cuda:0')
batch 10 loss: tensor(0.5322, device='cuda:0')
batch 11 loss: tensor(0.6165, device='cuda:0')
batch 12 loss: tensor(0.5459, device='cuda:0')
batch 13 loss: tensor(0.5506, device='cuda:0')
batch 14 loss: tensor(0.5370, device='cuda:0')
batch 15 loss: tensor(0.5179, device='cuda:0')
batch 16 loss: tensor(0.5152, device='cuda:0')
batch 17 loss: tensor(0.5945, device='cuda:0')
batch 18 loss: tensor(0.5756, device='cuda:0')
batch 19 loss: tensor(0.5081, device='cuda:0')
batch 20 loss: tensor(0.4917, device='cuda:0')
batch 21 loss: tensor(0.5455, device='cuda:0')
batch 22 loss: tensor(0.5007, device='cuda:0')
batch 23 loss: tensor(0.5106, device='cuda:0')
batch 24 loss: tensor(0.4713, device='cuda:0')
batch 25 loss: tensor(0.4749, device='cuda:0')
batch 26 loss: tensor(0.5131, device='cuda:0')
batch 27 loss: tensor(0.5143, device='cuda:0')
batch 28 loss: tensor(0.5004, device='cuda:0')
batch 29 loss: tensor(0.4494, device='cuda:0')
batch 30 loss: tensor(0.5068, device='cuda:0')
batch 31 loss: tensor(0.5276, device='cuda:0')
batch 32 loss: tensor(0.4523, device='cuda:0')
batch 33 loss: tensor(0.4770, device='cuda:0')
batch 34 loss: tensor(0.4917, device='cuda:0')
batch 35 loss: tensor(0.4127, device='cuda:0')
batch 36 loss: tensor(0.4542, device='cuda:0')
batch 37 loss: tensor(0.4959, device='cuda:0')
batch 38 loss: tensor(0.4311, device='cuda:0')
batch 39 loss: tensor(0.4833, device='cuda:0')
batch 40 loss: tensor(0.5215, device='cuda:0')
batch 41 loss: tensor(0.4547, device='cuda:0')
batch 42 loss: tensor(0.4321, device='cuda:0')
batch 43 loss: tensor(0.4693, device='cuda:0')
batch 44 loss: tensor(0.4801, device='cuda:0')
batch 45 loss: tensor(0.4452, device='cuda:0')
batch 46 loss: tensor(0.4139, device='cuda:0')
batch 47 loss: tensor(0.4407, device='cuda:0')
batch 48 loss: tensor(0.4590, device='cuda:0')
batch 49 loss: tensor(0.4249, device='cuda:0')
batch 50 loss: tensor(0.4290, device='cuda:0')
batch 51 loss: tensor(0.4703, device='cuda:0')
batch 52 loss: tensor(0.4908, device='cuda:0')
batch 53 loss: tensor(0.4618, device='cuda:0')
batch 54 loss: tensor(0.4472, device='cuda:0')
batch 55 loss: tensor(0.4711, device='cuda:0')
batch 56 loss: tensor(0.4204, device='cuda:0')
batch 57 loss: tensor(0.4782, device='cuda:0')
batch 58 loss: tensor(0.4288, device='cuda:0')
batch 59 loss: tensor(0.5024, device='cuda:0')
batch 60 loss: tensor(0.4986, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5490, device='cuda:0')
batch 2 loss: tensor(0.4268, device='cuda:0')
batch 3 loss: tensor(0.5101, device='cuda:0')
batch 4 loss: tensor(0.4445, device='cuda:0')
batch 5 loss: tensor(0.4192, device='cuda:0')
batch 6 loss: tensor(0.3937, device='cuda:0')
batch 7 loss: tensor(0.4371, device='cuda:0')
batch 8 loss: tensor(0.4002, device='cuda:0')
batch 9 loss: tensor(0.3766, device='cuda:0')
batch 10 loss: tensor(0.4376, device='cuda:0')
batch 11 loss: tensor(0.4159, device='cuda:0')
batch 12 loss: tensor(0.3937, device='cuda:0')
batch 13 loss: tensor(0.4494, device='cuda:0')
batch 14 loss: tensor(0.4311, device='cuda:0')
batch 15 loss: tensor(0.3704, device='cuda:0')
batch 16 loss: tensor(0.4350, device='cuda:0')
batch 17 loss: tensor(0.3683, device='cuda:0')
batch 18 loss: tensor(0.3670, device='cuda:0')
batch 19 loss: tensor(0.3482, device='cuda:0')
batch 20 loss: tensor(0.3629, device='cuda:0')
batch 21 loss: tensor(0.4164, device='cuda:0')
batch 22 loss: tensor(0.4022, device='cuda:0')
batch 23 loss: tensor(0.4027, device='cuda:0')
batch 24 loss: tensor(0.4247, device='cuda:0')
batch 25 loss: tensor(0.3536, device='cuda:0')
batch 26 loss: tensor(0.4078, device='cuda:0')
batch 27 loss: tensor(0.4252, device='cuda:0')
batch 28 loss: tensor(0.4066, device='cuda:0')
batch 29 loss: tensor(0.3835, device='cuda:0')
batch 30 loss: tensor(0.3427, device='cuda:0')
batch 31 loss: tensor(0.4141, device='cuda:0')
batch 32 loss: tensor(0.3572, device='cuda:0')
batch 33 loss: tensor(0.3923, device='cuda:0')
batch 34 loss: tensor(0.4103, device='cuda:0')
batch 35 loss: tensor(0.3184, device='cuda:0')
batch 36 loss: tensor(0.3303, device='cuda:0')
batch 37 loss: tensor(0.4282, device='cuda:0')
batch 38 loss: tensor(0.4035, device='cuda:0')
batch 39 loss: tensor(0.4314, device='cuda:0')
batch 40 loss: tensor(0.4098, device='cuda:0')
batch 41 loss: tensor(0.3679, device='cuda:0')
batch 42 loss: tensor(0.3101, device='cuda:0')
batch 43 loss: tensor(0.3983, device='cuda:0')
batch 44 loss: tensor(0.3722, device='cuda:0')
batch 45 loss: tensor(0.3759, device='cuda:0')
batch 46 loss: tensor(0.4113, device='cuda:0')
batch 47 loss: tensor(0.3656, device='cuda:0')
batch 48 loss: tensor(0.4109, device='cuda:0')
batch 49 loss: tensor(0.3681, device='cuda:0')
batch 50 loss: tensor(0.3032, device='cuda:0')
batch 51 loss: tensor(0.3813, device='cuda:0')
batch 52 loss: tensor(0.3678, device='cuda:0')
batch 53 loss: tensor(0.3682, device='cuda:0')
batch 54 loss: tensor(0.3933, device='cuda:0')
batch 55 loss: tensor(0.3719, device='cuda:0')
batch 56 loss: tensor(0.3720, device='cuda:0')
batch 57 loss: tensor(0.4225, device='cuda:0')
batch 58 loss: tensor(0.3778, device='cuda:0')
batch 59 loss: tensor(0.3461, device='cuda:0')
batch 60 loss: tensor(0.3850, device='cuda:0')
accuracy in val: 0.8380166666666666
accuracy in test: 0.8846100812434159
average epoch time: 1.7803623576958973
total time: 213.6434829235077
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9847, device='cuda:0')
batch 2 loss: tensor(0.7527, device='cuda:0')
batch 3 loss: tensor(0.6302, device='cuda:0')
batch 4 loss: tensor(0.5770, device='cuda:0')
batch 5 loss: tensor(0.5894, device='cuda:0')
batch 6 loss: tensor(0.5563, device='cuda:0')
batch 7 loss: tensor(0.5397, device='cuda:0')
batch 8 loss: tensor(0.5863, device='cuda:0')
batch 9 loss: tensor(0.5688, device='cuda:0')
batch 10 loss: tensor(0.5451, device='cuda:0')
batch 11 loss: tensor(0.5800, device='cuda:0')
batch 12 loss: tensor(0.5012, device='cuda:0')
batch 13 loss: tensor(0.5037, device='cuda:0')
batch 14 loss: tensor(0.5265, device='cuda:0')
batch 15 loss: tensor(0.5708, device='cuda:0')
batch 16 loss: tensor(0.5490, device='cuda:0')
batch 17 loss: tensor(0.5587, device='cuda:0')
batch 18 loss: tensor(0.4716, device='cuda:0')
batch 19 loss: tensor(0.5326, device='cuda:0')
batch 20 loss: tensor(0.5445, device='cuda:0')
batch 21 loss: tensor(0.4736, device='cuda:0')
batch 22 loss: tensor(0.4381, device='cuda:0')
batch 23 loss: tensor(0.4979, device='cuda:0')
batch 24 loss: tensor(0.4748, device='cuda:0')
batch 25 loss: tensor(0.4614, device='cuda:0')
batch 26 loss: tensor(0.4603, device='cuda:0')
batch 27 loss: tensor(0.5272, device='cuda:0')
batch 28 loss: tensor(0.4826, device='cuda:0')
batch 29 loss: tensor(0.4573, device='cuda:0')
batch 30 loss: tensor(0.4944, device='cuda:0')
batch 31 loss: tensor(0.4636, device='cuda:0')
batch 32 loss: tensor(0.4540, device='cuda:0')
batch 33 loss: tensor(0.4362, device='cuda:0')
batch 34 loss: tensor(0.5765, device='cuda:0')
batch 35 loss: tensor(0.4551, device='cuda:0')
batch 36 loss: tensor(0.4749, device='cuda:0')
batch 37 loss: tensor(0.4954, device='cuda:0')
batch 38 loss: tensor(0.4632, device='cuda:0')
batch 39 loss: tensor(0.5722, device='cuda:0')
batch 40 loss: tensor(0.4364, device='cuda:0')
batch 41 loss: tensor(0.4636, device='cuda:0')
batch 42 loss: tensor(0.4631, device='cuda:0')
batch 43 loss: tensor(0.4207, device='cuda:0')
batch 44 loss: tensor(0.5562, device='cuda:0')
batch 45 loss: tensor(0.4397, device='cuda:0')
batch 46 loss: tensor(0.4203, device='cuda:0')
batch 47 loss: tensor(0.4486, device='cuda:0')
batch 48 loss: tensor(0.4930, device='cuda:0')
batch 49 loss: tensor(0.4248, device='cuda:0')
batch 50 loss: tensor(0.3671, device='cuda:0')
batch 51 loss: tensor(0.4801, device='cuda:0')
batch 52 loss: tensor(0.4059, device='cuda:0')
batch 53 loss: tensor(0.4623, device='cuda:0')
batch 54 loss: tensor(0.4242, device='cuda:0')
batch 55 loss: tensor(0.4323, device='cuda:0')
batch 56 loss: tensor(0.4416, device='cuda:0')
batch 57 loss: tensor(0.4565, device='cuda:0')
batch 58 loss: tensor(0.4785, device='cuda:0')
batch 59 loss: tensor(0.4431, device='cuda:0')
batch 60 loss: tensor(0.5186, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5021, device='cuda:0')
batch 2 loss: tensor(0.4409, device='cuda:0')
batch 3 loss: tensor(0.4500, device='cuda:0')
batch 4 loss: tensor(0.3928, device='cuda:0')
batch 5 loss: tensor(0.4253, device='cuda:0')
batch 6 loss: tensor(0.4638, device='cuda:0')
batch 7 loss: tensor(0.4074, device='cuda:0')
batch 8 loss: tensor(0.4483, device='cuda:0')
batch 9 loss: tensor(0.3839, device='cuda:0')
batch 10 loss: tensor(0.4249, device='cuda:0')
batch 11 loss: tensor(0.3637, device='cuda:0')
batch 12 loss: tensor(0.4153, device='cuda:0')
batch 13 loss: tensor(0.3125, device='cuda:0')
batch 14 loss: tensor(0.3725, device='cuda:0')
batch 15 loss: tensor(0.3788, device='cuda:0')
batch 16 loss: tensor(0.3809, device='cuda:0')
batch 17 loss: tensor(0.4193, device='cuda:0')
batch 18 loss: tensor(0.4044, device='cuda:0')
batch 19 loss: tensor(0.4281, device='cuda:0')
batch 20 loss: tensor(0.3962, device='cuda:0')
batch 21 loss: tensor(0.3866, device='cuda:0')
batch 22 loss: tensor(0.3464, device='cuda:0')
batch 23 loss: tensor(0.4028, device='cuda:0')
batch 24 loss: tensor(0.3615, device='cuda:0')
batch 25 loss: tensor(0.4346, device='cuda:0')
batch 26 loss: tensor(0.4037, device='cuda:0')
batch 27 loss: tensor(0.3639, device='cuda:0')
batch 28 loss: tensor(0.3657, device='cuda:0')
batch 29 loss: tensor(0.4080, device='cuda:0')
batch 30 loss: tensor(0.3729, device='cuda:0')
batch 31 loss: tensor(0.3682, device='cuda:0')
batch 32 loss: tensor(0.3761, device='cuda:0')
batch 33 loss: tensor(0.3866, device='cuda:0')
batch 34 loss: tensor(0.3728, device='cuda:0')
batch 35 loss: tensor(0.3635, device='cuda:0')
batch 36 loss: tensor(0.4324, device='cuda:0')
batch 37 loss: tensor(0.3794, device='cuda:0')
batch 38 loss: tensor(0.3442, device='cuda:0')
batch 39 loss: tensor(0.4107, device='cuda:0')
batch 40 loss: tensor(0.3928, device='cuda:0')
batch 41 loss: tensor(0.3528, device='cuda:0')
batch 42 loss: tensor(0.3723, device='cuda:0')
batch 43 loss: tensor(0.3799, device='cuda:0')
batch 44 loss: tensor(0.3766, device='cuda:0')
batch 45 loss: tensor(0.4014, device='cuda:0')
batch 46 loss: tensor(0.4063, device='cuda:0')
batch 47 loss: tensor(0.3694, device='cuda:0')
batch 48 loss: tensor(0.3608, device='cuda:0')
batch 49 loss: tensor(0.3500, device='cuda:0')
batch 50 loss: tensor(0.3548, device='cuda:0')
batch 51 loss: tensor(0.4118, device='cuda:0')
batch 52 loss: tensor(0.3548, device='cuda:0')
batch 53 loss: tensor(0.4064, device='cuda:0')
batch 54 loss: tensor(0.3639, device='cuda:0')
batch 55 loss: tensor(0.3738, device='cuda:0')
batch 56 loss: tensor(0.4225, device='cuda:0')
batch 57 loss: tensor(0.3515, device='cuda:0')
batch 58 loss: tensor(0.3295, device='cuda:0')
batch 59 loss: tensor(0.3409, device='cuda:0')
batch 60 loss: tensor(0.3504, device='cuda:0')
accuracy in val: 0.8352
accuracy in test: 0.8842557099284639
average epoch time: 2.0003102560838064
total time: 240.03723073005676
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [60, 60], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9367, device='cuda:0')
batch 2 loss: tensor(0.7052, device='cuda:0')
batch 3 loss: tensor(0.7515, device='cuda:0')
batch 4 loss: tensor(0.5812, device='cuda:0')
batch 5 loss: tensor(0.5438, device='cuda:0')
batch 6 loss: tensor(0.5347, device='cuda:0')
batch 7 loss: tensor(0.5412, device='cuda:0')
batch 8 loss: tensor(0.5972, device='cuda:0')
batch 9 loss: tensor(0.6158, device='cuda:0')
batch 10 loss: tensor(0.5547, device='cuda:0')
batch 11 loss: tensor(0.5529, device='cuda:0')
batch 12 loss: tensor(0.5680, device='cuda:0')
batch 13 loss: tensor(0.5509, device='cuda:0')
batch 14 loss: tensor(0.5407, device='cuda:0')
batch 15 loss: tensor(0.5333, device='cuda:0')
batch 16 loss: tensor(0.5574, device='cuda:0')
batch 17 loss: tensor(0.5654, device='cuda:0')
batch 18 loss: tensor(0.4598, device='cuda:0')
batch 19 loss: tensor(0.5011, device='cuda:0')
batch 20 loss: tensor(0.5379, device='cuda:0')
batch 21 loss: tensor(0.4742, device='cuda:0')
batch 22 loss: tensor(0.5100, device='cuda:0')
batch 23 loss: tensor(0.4780, device='cuda:0')
batch 24 loss: tensor(0.4487, device='cuda:0')
batch 25 loss: tensor(0.5060, device='cuda:0')
batch 26 loss: tensor(0.5204, device='cuda:0')
batch 27 loss: tensor(0.4827, device='cuda:0')
batch 28 loss: tensor(0.4797, device='cuda:0')
batch 29 loss: tensor(0.4738, device='cuda:0')
batch 30 loss: tensor(0.5104, device='cuda:0')
batch 31 loss: tensor(0.4788, device='cuda:0')
batch 32 loss: tensor(0.4900, device='cuda:0')
batch 33 loss: tensor(0.4388, device='cuda:0')
batch 34 loss: tensor(0.4508, device='cuda:0')
batch 35 loss: tensor(0.4347, device='cuda:0')
batch 36 loss: tensor(0.4802, device='cuda:0')
batch 37 loss: tensor(0.5125, device='cuda:0')
batch 38 loss: tensor(0.4616, device='cuda:0')
batch 39 loss: tensor(0.5394, device='cuda:0')
batch 40 loss: tensor(0.4410, device='cuda:0')
batch 41 loss: tensor(0.4343, device='cuda:0')
batch 42 loss: tensor(0.5310, device='cuda:0')
batch 43 loss: tensor(0.4978, device='cuda:0')
batch 44 loss: tensor(0.4494, device='cuda:0')
batch 45 loss: tensor(0.4893, device='cuda:0')
batch 46 loss: tensor(0.4219, device='cuda:0')
batch 47 loss: tensor(0.4990, device='cuda:0')
batch 48 loss: tensor(0.5371, device='cuda:0')
batch 49 loss: tensor(0.4723, device='cuda:0')
batch 50 loss: tensor(0.4421, device='cuda:0')
batch 51 loss: tensor(0.4433, device='cuda:0')
batch 52 loss: tensor(0.4919, device='cuda:0')
batch 53 loss: tensor(0.4996, device='cuda:0')
batch 54 loss: tensor(0.4839, device='cuda:0')
batch 55 loss: tensor(0.4645, device='cuda:0')
batch 56 loss: tensor(0.4285, device='cuda:0')
batch 57 loss: tensor(0.4118, device='cuda:0')
batch 58 loss: tensor(0.4731, device='cuda:0')
batch 59 loss: tensor(0.4379, device='cuda:0')
batch 60 loss: tensor(0.5114, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5167, device='cuda:0')
batch 2 loss: tensor(0.4342, device='cuda:0')
batch 3 loss: tensor(0.4229, device='cuda:0')
batch 4 loss: tensor(0.4198, device='cuda:0')
batch 5 loss: tensor(0.3801, device='cuda:0')
batch 6 loss: tensor(0.4385, device='cuda:0')
batch 7 loss: tensor(0.4629, device='cuda:0')
batch 8 loss: tensor(0.4119, device='cuda:0')
batch 9 loss: tensor(0.3656, device='cuda:0')
batch 10 loss: tensor(0.4178, device='cuda:0')
batch 11 loss: tensor(0.3975, device='cuda:0')
batch 12 loss: tensor(0.4480, device='cuda:0')
batch 13 loss: tensor(0.3917, device='cuda:0')
batch 14 loss: tensor(0.4050, device='cuda:0')
batch 15 loss: tensor(0.3197, device='cuda:0')
batch 16 loss: tensor(0.3842, device='cuda:0')
batch 17 loss: tensor(0.3658, device='cuda:0')
batch 18 loss: tensor(0.3733, device='cuda:0')
batch 19 loss: tensor(0.3983, device='cuda:0')
batch 20 loss: tensor(0.3660, device='cuda:0')
batch 21 loss: tensor(0.3579, device='cuda:0')
batch 22 loss: tensor(0.4555, device='cuda:0')
batch 23 loss: tensor(0.3513, device='cuda:0')
batch 24 loss: tensor(0.3209, device='cuda:0')
batch 25 loss: tensor(0.3827, device='cuda:0')
batch 26 loss: tensor(0.4178, device='cuda:0')
batch 27 loss: tensor(0.3793, device='cuda:0')
batch 28 loss: tensor(0.3857, device='cuda:0')
batch 29 loss: tensor(0.4225, device='cuda:0')
batch 30 loss: tensor(0.3808, device='cuda:0')
batch 31 loss: tensor(0.3718, device='cuda:0')
batch 32 loss: tensor(0.4036, device='cuda:0')
batch 33 loss: tensor(0.3652, device='cuda:0')
batch 34 loss: tensor(0.3742, device='cuda:0')
batch 35 loss: tensor(0.3693, device='cuda:0')
batch 36 loss: tensor(0.3942, device='cuda:0')
batch 37 loss: tensor(0.3333, device='cuda:0')
batch 38 loss: tensor(0.4095, device='cuda:0')
batch 39 loss: tensor(0.4131, device='cuda:0')
batch 40 loss: tensor(0.3181, device='cuda:0')
batch 41 loss: tensor(0.3379, device='cuda:0')
batch 42 loss: tensor(0.4125, device='cuda:0')
batch 43 loss: tensor(0.3519, device='cuda:0')
batch 44 loss: tensor(0.3757, device='cuda:0')
batch 45 loss: tensor(0.3444, device='cuda:0')
batch 46 loss: tensor(0.3667, device='cuda:0')
batch 47 loss: tensor(0.3759, device='cuda:0')
batch 48 loss: tensor(0.4042, device='cuda:0')
batch 49 loss: tensor(0.3937, device='cuda:0')
batch 50 loss: tensor(0.3693, device='cuda:0')
batch 51 loss: tensor(0.3551, device='cuda:0')
batch 52 loss: tensor(0.3581, device='cuda:0')
batch 53 loss: tensor(0.3437, device='cuda:0')
batch 54 loss: tensor(0.3166, device='cuda:0')
batch 55 loss: tensor(0.4389, device='cuda:0')
batch 56 loss: tensor(0.3485, device='cuda:0')
batch 57 loss: tensor(0.3764, device='cuda:0')
batch 58 loss: tensor(0.3544, device='cuda:0')
batch 59 loss: tensor(0.3798, device='cuda:0')
batch 60 loss: tensor(0.3636, device='cuda:0')
accuracy in val: 0.8367266666666666
accuracy in test: 0.8841398842846664
average epoch time: 1.7819434603055317
total time: 213.83321523666382

0.8844106956708787 219.93596510887147
0.0002325737906099152 8.56564195813597
Thu Nov 21 19:04:19 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |      5%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     28842      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 19:27:38 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |     10%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     28842      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 19:51:10 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |     11%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     28842      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 20:14:43 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |     12%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     28842      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 20:38:24 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    57W / 149W |    335MiB / 12206MiB |      8%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     28842      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 21:02:03 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    32W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     28842      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 21:25:31 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |     11%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     28842      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 21:49:06 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |      8%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     28842      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 22:12:42 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     28842      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 22:36:15 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     28842      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
{'dataset': 'amazon_3m', 'config_file': 'amazon_3m.yaml', 'layer_num': 2, 'epoch_num': [80, 80]}
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9925, device='cuda:0')
batch 2 loss: tensor(0.7091, device='cuda:0')
batch 3 loss: tensor(0.6199, device='cuda:0')
batch 4 loss: tensor(0.7127, device='cuda:0')
batch 5 loss: tensor(0.6283, device='cuda:0')
batch 6 loss: tensor(0.5583, device='cuda:0')
batch 7 loss: tensor(0.5950, device='cuda:0')
batch 8 loss: tensor(0.5381, device='cuda:0')
batch 9 loss: tensor(0.5799, device='cuda:0')
batch 10 loss: tensor(0.5934, device='cuda:0')
batch 11 loss: tensor(0.5605, device='cuda:0')
batch 12 loss: tensor(0.5496, device='cuda:0')
batch 13 loss: tensor(0.4884, device='cuda:0')
batch 14 loss: tensor(0.5645, device='cuda:0')
batch 15 loss: tensor(0.5060, device='cuda:0')
batch 16 loss: tensor(0.5386, device='cuda:0')
batch 17 loss: tensor(0.4734, device='cuda:0')
batch 18 loss: tensor(0.5027, device='cuda:0')
batch 19 loss: tensor(0.4963, device='cuda:0')
batch 20 loss: tensor(0.4539, device='cuda:0')
batch 21 loss: tensor(0.4839, device='cuda:0')
batch 22 loss: tensor(0.4935, device='cuda:0')
batch 23 loss: tensor(0.4714, device='cuda:0')
batch 24 loss: tensor(0.4351, device='cuda:0')
batch 25 loss: tensor(0.5329, device='cuda:0')
batch 26 loss: tensor(0.4589, device='cuda:0')
batch 27 loss: tensor(0.5158, device='cuda:0')
batch 28 loss: tensor(0.4742, device='cuda:0')
batch 29 loss: tensor(0.4814, device='cuda:0')
batch 30 loss: tensor(0.4705, device='cuda:0')
batch 31 loss: tensor(0.4929, device='cuda:0')
batch 32 loss: tensor(0.4731, device='cuda:0')
batch 33 loss: tensor(0.4581, device='cuda:0')
batch 34 loss: tensor(0.5056, device='cuda:0')
batch 35 loss: tensor(0.4596, device='cuda:0')
batch 36 loss: tensor(0.4340, device='cuda:0')
batch 37 loss: tensor(0.4519, device='cuda:0')
batch 38 loss: tensor(0.4432, device='cuda:0')
batch 39 loss: tensor(0.4837, device='cuda:0')
batch 40 loss: tensor(0.4969, device='cuda:0')
batch 41 loss: tensor(0.4214, device='cuda:0')
batch 42 loss: tensor(0.4430, device='cuda:0')
batch 43 loss: tensor(0.4465, device='cuda:0')
batch 44 loss: tensor(0.4748, device='cuda:0')
batch 45 loss: tensor(0.4291, device='cuda:0')
batch 46 loss: tensor(0.5028, device='cuda:0')
batch 47 loss: tensor(0.3935, device='cuda:0')
batch 48 loss: tensor(0.4514, device='cuda:0')
batch 49 loss: tensor(0.4325, device='cuda:0')
batch 50 loss: tensor(0.4117, device='cuda:0')
batch 51 loss: tensor(0.3905, device='cuda:0')
batch 52 loss: tensor(0.4753, device='cuda:0')
batch 53 loss: tensor(0.4673, device='cuda:0')
batch 54 loss: tensor(0.5720, device='cuda:0')
batch 55 loss: tensor(0.4823, device='cuda:0')
batch 56 loss: tensor(0.4294, device='cuda:0')
batch 57 loss: tensor(0.4970, device='cuda:0')
batch 58 loss: tensor(0.4533, device='cuda:0')
batch 59 loss: tensor(0.5129, device='cuda:0')
batch 60 loss: tensor(0.4986, device='cuda:0')
batch 61 loss: tensor(0.5251, device='cuda:0')
batch 62 loss: tensor(0.5022, device='cuda:0')
batch 63 loss: tensor(0.4124, device='cuda:0')
batch 64 loss: tensor(0.4963, device='cuda:0')
batch 65 loss: tensor(0.4293, device='cuda:0')
batch 66 loss: tensor(0.4820, device='cuda:0')
batch 67 loss: tensor(0.4864, device='cuda:0')
batch 68 loss: tensor(0.5550, device='cuda:0')
batch 69 loss: tensor(0.4356, device='cuda:0')
batch 70 loss: tensor(0.4176, device='cuda:0')
batch 71 loss: tensor(0.4698, device='cuda:0')
batch 72 loss: tensor(0.4930, device='cuda:0')
batch 73 loss: tensor(0.4048, device='cuda:0')
batch 74 loss: tensor(0.4672, device='cuda:0')
batch 75 loss: tensor(0.4473, device='cuda:0')
batch 76 loss: tensor(0.5001, device='cuda:0')
batch 77 loss: tensor(0.4502, device='cuda:0')
batch 78 loss: tensor(0.4096, device='cuda:0')
batch 79 loss: tensor(0.4106, device='cuda:0')
batch 80 loss: tensor(0.4432, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5129, device='cuda:0')
batch 2 loss: tensor(0.4066, device='cuda:0')
batch 3 loss: tensor(0.4893, device='cuda:0')
batch 4 loss: tensor(0.3871, device='cuda:0')
batch 5 loss: tensor(0.4227, device='cuda:0')
batch 6 loss: tensor(0.3858, device='cuda:0')
batch 7 loss: tensor(0.4536, device='cuda:0')
batch 8 loss: tensor(0.3568, device='cuda:0')
batch 9 loss: tensor(0.3945, device='cuda:0')
batch 10 loss: tensor(0.4188, device='cuda:0')
batch 11 loss: tensor(0.4028, device='cuda:0')
batch 12 loss: tensor(0.4176, device='cuda:0')
batch 13 loss: tensor(0.3813, device='cuda:0')
batch 14 loss: tensor(0.3518, device='cuda:0')
batch 15 loss: tensor(0.4312, device='cuda:0')
batch 16 loss: tensor(0.4443, device='cuda:0')
batch 17 loss: tensor(0.4175, device='cuda:0')
batch 18 loss: tensor(0.3232, device='cuda:0')
batch 19 loss: tensor(0.3639, device='cuda:0')
batch 20 loss: tensor(0.3563, device='cuda:0')
batch 21 loss: tensor(0.3797, device='cuda:0')
batch 22 loss: tensor(0.3998, device='cuda:0')
batch 23 loss: tensor(0.3656, device='cuda:0')
batch 24 loss: tensor(0.3616, device='cuda:0')
batch 25 loss: tensor(0.3826, device='cuda:0')
batch 26 loss: tensor(0.4199, device='cuda:0')
batch 27 loss: tensor(0.3744, device='cuda:0')
batch 28 loss: tensor(0.3922, device='cuda:0')
batch 29 loss: tensor(0.4166, device='cuda:0')
batch 30 loss: tensor(0.4143, device='cuda:0')
batch 31 loss: tensor(0.4660, device='cuda:0')
batch 32 loss: tensor(0.3362, device='cuda:0')
batch 33 loss: tensor(0.3830, device='cuda:0')
batch 34 loss: tensor(0.3563, device='cuda:0')
batch 35 loss: tensor(0.3745, device='cuda:0')
batch 36 loss: tensor(0.3600, device='cuda:0')
batch 37 loss: tensor(0.4193, device='cuda:0')
batch 38 loss: tensor(0.3882, device='cuda:0')
batch 39 loss: tensor(0.3528, device='cuda:0')
batch 40 loss: tensor(0.4232, device='cuda:0')
batch 41 loss: tensor(0.4085, device='cuda:0')
batch 42 loss: tensor(0.3822, device='cuda:0')
batch 43 loss: tensor(0.3814, device='cuda:0')
batch 44 loss: tensor(0.3701, device='cuda:0')
batch 45 loss: tensor(0.3819, device='cuda:0')
batch 46 loss: tensor(0.4089, device='cuda:0')
batch 47 loss: tensor(0.3414, device='cuda:0')
batch 48 loss: tensor(0.3366, device='cuda:0')
batch 49 loss: tensor(0.3317, device='cuda:0')
batch 50 loss: tensor(0.3839, device='cuda:0')
batch 51 loss: tensor(0.3211, device='cuda:0')
batch 52 loss: tensor(0.4070, device='cuda:0')
batch 53 loss: tensor(0.3846, device='cuda:0')
batch 54 loss: tensor(0.3520, device='cuda:0')
batch 55 loss: tensor(0.3931, device='cuda:0')
batch 56 loss: tensor(0.4409, device='cuda:0')
batch 57 loss: tensor(0.3927, device='cuda:0')
batch 58 loss: tensor(0.3608, device='cuda:0')
batch 59 loss: tensor(0.3623, device='cuda:0')
batch 60 loss: tensor(0.3104, device='cuda:0')
batch 61 loss: tensor(0.3956, device='cuda:0')
batch 62 loss: tensor(0.3810, device='cuda:0')
batch 63 loss: tensor(0.3389, device='cuda:0')
batch 64 loss: tensor(0.3791, device='cuda:0')
batch 65 loss: tensor(0.3914, device='cuda:0')
batch 66 loss: tensor(0.3635, device='cuda:0')
batch 67 loss: tensor(0.3539, device='cuda:0')
batch 68 loss: tensor(0.4275, device='cuda:0')
batch 69 loss: tensor(0.4121, device='cuda:0')
batch 70 loss: tensor(0.3608, device='cuda:0')
batch 71 loss: tensor(0.3363, device='cuda:0')
batch 72 loss: tensor(0.3703, device='cuda:0')
batch 73 loss: tensor(0.3492, device='cuda:0')
batch 74 loss: tensor(0.3435, device='cuda:0')
batch 75 loss: tensor(0.3775, device='cuda:0')
batch 76 loss: tensor(0.4307, device='cuda:0')
batch 77 loss: tensor(0.3912, device='cuda:0')
batch 78 loss: tensor(0.4141, device='cuda:0')
batch 79 loss: tensor(0.3139, device='cuda:0')
batch 80 loss: tensor(0.3169, device='cuda:0')
accuracy in val: 0.8384066666666666
accuracy in test: 0.8859117408594263
average epoch time: 1.734909462928772
total time: 277.5855140686035
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9650, device='cuda:0')
batch 2 loss: tensor(0.7997, device='cuda:0')
batch 3 loss: tensor(0.6127, device='cuda:0')
batch 4 loss: tensor(0.6613, device='cuda:0')
batch 5 loss: tensor(0.5608, device='cuda:0')
batch 6 loss: tensor(0.5189, device='cuda:0')
batch 7 loss: tensor(0.6004, device='cuda:0')
batch 8 loss: tensor(0.5694, device='cuda:0')
batch 9 loss: tensor(0.5247, device='cuda:0')
batch 10 loss: tensor(0.5353, device='cuda:0')
batch 11 loss: tensor(0.5901, device='cuda:0')
batch 12 loss: tensor(0.5235, device='cuda:0')
batch 13 loss: tensor(0.4975, device='cuda:0')
batch 14 loss: tensor(0.5504, device='cuda:0')
batch 15 loss: tensor(0.5018, device='cuda:0')
batch 16 loss: tensor(0.6032, device='cuda:0')
batch 17 loss: tensor(0.4670, device='cuda:0')
batch 18 loss: tensor(0.4556, device='cuda:0')
batch 19 loss: tensor(0.4611, device='cuda:0')
batch 20 loss: tensor(0.4692, device='cuda:0')
batch 21 loss: tensor(0.5574, device='cuda:0')
batch 22 loss: tensor(0.4859, device='cuda:0')
batch 23 loss: tensor(0.4934, device='cuda:0')
batch 24 loss: tensor(0.4570, device='cuda:0')
batch 25 loss: tensor(0.4983, device='cuda:0')
batch 26 loss: tensor(0.4450, device='cuda:0')
batch 27 loss: tensor(0.4343, device='cuda:0')
batch 28 loss: tensor(0.5545, device='cuda:0')
batch 29 loss: tensor(0.5522, device='cuda:0')
batch 30 loss: tensor(0.5095, device='cuda:0')
batch 31 loss: tensor(0.4482, device='cuda:0')
batch 32 loss: tensor(0.4436, device='cuda:0')
batch 33 loss: tensor(0.5026, device='cuda:0')
batch 34 loss: tensor(0.4499, device='cuda:0')
batch 35 loss: tensor(0.4644, device='cuda:0')
batch 36 loss: tensor(0.4673, device='cuda:0')
batch 37 loss: tensor(0.4860, device='cuda:0')
batch 38 loss: tensor(0.4478, device='cuda:0')
batch 39 loss: tensor(0.4534, device='cuda:0')
batch 40 loss: tensor(0.5430, device='cuda:0')
batch 41 loss: tensor(0.4772, device='cuda:0')
batch 42 loss: tensor(0.4279, device='cuda:0')
batch 43 loss: tensor(0.4746, device='cuda:0')
batch 44 loss: tensor(0.4778, device='cuda:0')
batch 45 loss: tensor(0.4893, device='cuda:0')
batch 46 loss: tensor(0.4691, device='cuda:0')
batch 47 loss: tensor(0.4774, device='cuda:0')
batch 48 loss: tensor(0.4249, device='cuda:0')
batch 49 loss: tensor(0.4398, device='cuda:0')
batch 50 loss: tensor(0.4812, device='cuda:0')
batch 51 loss: tensor(0.4537, device='cuda:0')
batch 52 loss: tensor(0.4852, device='cuda:0')
batch 53 loss: tensor(0.5154, device='cuda:0')
batch 54 loss: tensor(0.4603, device='cuda:0')
batch 55 loss: tensor(0.5003, device='cuda:0')
batch 56 loss: tensor(0.4554, device='cuda:0')
batch 57 loss: tensor(0.4670, device='cuda:0')
batch 58 loss: tensor(0.4523, device='cuda:0')
batch 59 loss: tensor(0.5004, device='cuda:0')
batch 60 loss: tensor(0.4961, device='cuda:0')
batch 61 loss: tensor(0.4196, device='cuda:0')
batch 62 loss: tensor(0.4616, device='cuda:0')
batch 63 loss: tensor(0.4684, device='cuda:0')
batch 64 loss: tensor(0.4104, device='cuda:0')
batch 65 loss: tensor(0.4002, device='cuda:0')
batch 66 loss: tensor(0.4429, device='cuda:0')
batch 67 loss: tensor(0.5206, device='cuda:0')
batch 68 loss: tensor(0.4420, device='cuda:0')
batch 69 loss: tensor(0.4556, device='cuda:0')
batch 70 loss: tensor(0.4138, device='cuda:0')
batch 71 loss: tensor(0.5063, device='cuda:0')
batch 72 loss: tensor(0.4257, device='cuda:0')
batch 73 loss: tensor(0.4206, device='cuda:0')
batch 74 loss: tensor(0.4788, device='cuda:0')
batch 75 loss: tensor(0.4871, device='cuda:0')
batch 76 loss: tensor(0.4358, device='cuda:0')
batch 77 loss: tensor(0.4345, device='cuda:0')
batch 78 loss: tensor(0.4891, device='cuda:0')
batch 79 loss: tensor(0.4753, device='cuda:0')
batch 80 loss: tensor(0.4230, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5400, device='cuda:0')
batch 2 loss: tensor(0.4397, device='cuda:0')
batch 3 loss: tensor(0.4496, device='cuda:0')
batch 4 loss: tensor(0.4660, device='cuda:0')
batch 5 loss: tensor(0.3828, device='cuda:0')
batch 6 loss: tensor(0.3786, device='cuda:0')
batch 7 loss: tensor(0.4085, device='cuda:0')
batch 8 loss: tensor(0.4258, device='cuda:0')
batch 9 loss: tensor(0.4998, device='cuda:0')
batch 10 loss: tensor(0.4552, device='cuda:0')
batch 11 loss: tensor(0.4289, device='cuda:0')
batch 12 loss: tensor(0.4009, device='cuda:0')
batch 13 loss: tensor(0.3630, device='cuda:0')
batch 14 loss: tensor(0.3564, device='cuda:0')
batch 15 loss: tensor(0.3897, device='cuda:0')
batch 16 loss: tensor(0.4177, device='cuda:0')
batch 17 loss: tensor(0.4164, device='cuda:0')
batch 18 loss: tensor(0.3930, device='cuda:0')
batch 19 loss: tensor(0.3970, device='cuda:0')
batch 20 loss: tensor(0.3542, device='cuda:0')
batch 21 loss: tensor(0.4466, device='cuda:0')
batch 22 loss: tensor(0.4185, device='cuda:0')
batch 23 loss: tensor(0.3703, device='cuda:0')
batch 24 loss: tensor(0.3292, device='cuda:0')
batch 25 loss: tensor(0.3710, device='cuda:0')
batch 26 loss: tensor(0.3559, device='cuda:0')
batch 27 loss: tensor(0.3648, device='cuda:0')
batch 28 loss: tensor(0.3600, device='cuda:0')
batch 29 loss: tensor(0.3999, device='cuda:0')
batch 30 loss: tensor(0.3829, device='cuda:0')
batch 31 loss: tensor(0.3687, device='cuda:0')
batch 32 loss: tensor(0.3967, device='cuda:0')
batch 33 loss: tensor(0.4489, device='cuda:0')
batch 34 loss: tensor(0.3543, device='cuda:0')
batch 35 loss: tensor(0.3734, device='cuda:0')
batch 36 loss: tensor(0.3844, device='cuda:0')
batch 37 loss: tensor(0.4755, device='cuda:0')
batch 38 loss: tensor(0.3950, device='cuda:0')
batch 39 loss: tensor(0.3483, device='cuda:0')
batch 40 loss: tensor(0.4547, device='cuda:0')
batch 41 loss: tensor(0.3323, device='cuda:0')
batch 42 loss: tensor(0.3173, device='cuda:0')
batch 43 loss: tensor(0.4148, device='cuda:0')
batch 44 loss: tensor(0.3498, device='cuda:0')
batch 45 loss: tensor(0.4430, device='cuda:0')
batch 46 loss: tensor(0.3744, device='cuda:0')
batch 47 loss: tensor(0.4120, device='cuda:0')
batch 48 loss: tensor(0.3564, device='cuda:0')
batch 49 loss: tensor(0.3476, device='cuda:0')
batch 50 loss: tensor(0.3624, device='cuda:0')
batch 51 loss: tensor(0.3747, device='cuda:0')
batch 52 loss: tensor(0.3387, device='cuda:0')
batch 53 loss: tensor(0.3597, device='cuda:0')
batch 54 loss: tensor(0.4036, device='cuda:0')
batch 55 loss: tensor(0.4402, device='cuda:0')
batch 56 loss: tensor(0.4002, device='cuda:0')
batch 57 loss: tensor(0.3913, device='cuda:0')
batch 58 loss: tensor(0.3309, device='cuda:0')
batch 59 loss: tensor(0.3471, device='cuda:0')
batch 60 loss: tensor(0.3224, device='cuda:0')
batch 61 loss: tensor(0.4192, device='cuda:0')
batch 62 loss: tensor(0.3487, device='cuda:0')
batch 63 loss: tensor(0.3406, device='cuda:0')
batch 64 loss: tensor(0.3346, device='cuda:0')
batch 65 loss: tensor(0.3485, device='cuda:0')
batch 66 loss: tensor(0.3561, device='cuda:0')
batch 67 loss: tensor(0.4132, device='cuda:0')
batch 68 loss: tensor(0.3289, device='cuda:0')
batch 69 loss: tensor(0.3086, device='cuda:0')
batch 70 loss: tensor(0.3581, device='cuda:0')
batch 71 loss: tensor(0.3916, device='cuda:0')
batch 72 loss: tensor(0.3700, device='cuda:0')
batch 73 loss: tensor(0.3471, device='cuda:0')
batch 74 loss: tensor(0.3913, device='cuda:0')
batch 75 loss: tensor(0.3968, device='cuda:0')
batch 76 loss: tensor(0.3383, device='cuda:0')
batch 77 loss: tensor(0.4009, device='cuda:0')
batch 78 loss: tensor(0.3520, device='cuda:0')
batch 79 loss: tensor(0.3588, device='cuda:0')
batch 80 loss: tensor(0.3990, device='cuda:0')
accuracy in val: 0.8378266666666667
accuracy in test: 0.8850651105583348
average epoch time: 1.732763621211052
total time: 277.2421793937683
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.8757, device='cuda:0')
batch 2 loss: tensor(0.7549, device='cuda:0')
batch 3 loss: tensor(0.6479, device='cuda:0')
batch 4 loss: tensor(0.6459, device='cuda:0')
batch 5 loss: tensor(0.6122, device='cuda:0')
batch 6 loss: tensor(0.6440, device='cuda:0')
batch 7 loss: tensor(0.5750, device='cuda:0')
batch 8 loss: tensor(0.5236, device='cuda:0')
batch 9 loss: tensor(0.5260, device='cuda:0')
batch 10 loss: tensor(0.5415, device='cuda:0')
batch 11 loss: tensor(0.5051, device='cuda:0')
batch 12 loss: tensor(0.5792, device='cuda:0')
batch 13 loss: tensor(0.5128, device='cuda:0')
batch 14 loss: tensor(0.4948, device='cuda:0')
batch 15 loss: tensor(0.4927, device='cuda:0')
batch 16 loss: tensor(0.5885, device='cuda:0')
batch 17 loss: tensor(0.4662, device='cuda:0')
batch 18 loss: tensor(0.4803, device='cuda:0')
batch 19 loss: tensor(0.5685, device='cuda:0')
batch 20 loss: tensor(0.4518, device='cuda:0')
batch 21 loss: tensor(0.5616, device='cuda:0')
batch 22 loss: tensor(0.4835, device='cuda:0')
batch 23 loss: tensor(0.4938, device='cuda:0')
batch 24 loss: tensor(0.5302, device='cuda:0')
batch 25 loss: tensor(0.4774, device='cuda:0')
batch 26 loss: tensor(0.5454, device='cuda:0')
batch 27 loss: tensor(0.4455, device='cuda:0')
batch 28 loss: tensor(0.4688, device='cuda:0')
batch 29 loss: tensor(0.4894, device='cuda:0')
batch 30 loss: tensor(0.4811, device='cuda:0')
batch 31 loss: tensor(0.4820, device='cuda:0')
batch 32 loss: tensor(0.4872, device='cuda:0')
batch 33 loss: tensor(0.4752, device='cuda:0')
batch 34 loss: tensor(0.5000, device='cuda:0')
batch 35 loss: tensor(0.4837, device='cuda:0')
batch 36 loss: tensor(0.4974, device='cuda:0')
batch 37 loss: tensor(0.4190, device='cuda:0')
batch 38 loss: tensor(0.4455, device='cuda:0')
batch 39 loss: tensor(0.4666, device='cuda:0')
batch 40 loss: tensor(0.4456, device='cuda:0')
batch 41 loss: tensor(0.4754, device='cuda:0')
batch 42 loss: tensor(0.5122, device='cuda:0')
batch 43 loss: tensor(0.4625, device='cuda:0')
batch 44 loss: tensor(0.4795, device='cuda:0')
batch 45 loss: tensor(0.4800, device='cuda:0')
batch 46 loss: tensor(0.4206, device='cuda:0')
batch 47 loss: tensor(0.5119, device='cuda:0')
batch 48 loss: tensor(0.4966, device='cuda:0')
batch 49 loss: tensor(0.5172, device='cuda:0')
batch 50 loss: tensor(0.4633, device='cuda:0')
batch 51 loss: tensor(0.4833, device='cuda:0')
batch 52 loss: tensor(0.4255, device='cuda:0')
batch 53 loss: tensor(0.4799, device='cuda:0')
batch 54 loss: tensor(0.5992, device='cuda:0')
batch 55 loss: tensor(0.4627, device='cuda:0')
batch 56 loss: tensor(0.5018, device='cuda:0')
batch 57 loss: tensor(0.4244, device='cuda:0')
batch 58 loss: tensor(0.5031, device='cuda:0')
batch 59 loss: tensor(0.4499, device='cuda:0')
batch 60 loss: tensor(0.4309, device='cuda:0')
batch 61 loss: tensor(0.5341, device='cuda:0')
batch 62 loss: tensor(0.4686, device='cuda:0')
batch 63 loss: tensor(0.4753, device='cuda:0')
batch 64 loss: tensor(0.4670, device='cuda:0')
batch 65 loss: tensor(0.4553, device='cuda:0')
batch 66 loss: tensor(0.4480, device='cuda:0')
batch 67 loss: tensor(0.4735, device='cuda:0')
batch 68 loss: tensor(0.4299, device='cuda:0')
batch 69 loss: tensor(0.4610, device='cuda:0')
batch 70 loss: tensor(0.4299, device='cuda:0')
batch 71 loss: tensor(0.4541, device='cuda:0')
batch 72 loss: tensor(0.4827, device='cuda:0')
batch 73 loss: tensor(0.3699, device='cuda:0')
batch 74 loss: tensor(0.4824, device='cuda:0')
batch 75 loss: tensor(0.4489, device='cuda:0')
batch 76 loss: tensor(0.4197, device='cuda:0')
batch 77 loss: tensor(0.4877, device='cuda:0')
batch 78 loss: tensor(0.4538, device='cuda:0')
batch 79 loss: tensor(0.4744, device='cuda:0')
batch 80 loss: tensor(0.4654, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5973, device='cuda:0')
batch 2 loss: tensor(0.4777, device='cuda:0')
batch 3 loss: tensor(0.4369, device='cuda:0')
batch 4 loss: tensor(0.4666, device='cuda:0')
batch 5 loss: tensor(0.4478, device='cuda:0')
batch 6 loss: tensor(0.3988, device='cuda:0')
batch 7 loss: tensor(0.3779, device='cuda:0')
batch 8 loss: tensor(0.4424, device='cuda:0')
batch 9 loss: tensor(0.4092, device='cuda:0')
batch 10 loss: tensor(0.4158, device='cuda:0')
batch 11 loss: tensor(0.4021, device='cuda:0')
batch 12 loss: tensor(0.3932, device='cuda:0')
batch 13 loss: tensor(0.3916, device='cuda:0')
batch 14 loss: tensor(0.3272, device='cuda:0')
batch 15 loss: tensor(0.3279, device='cuda:0')
batch 16 loss: tensor(0.3982, device='cuda:0')
batch 17 loss: tensor(0.4098, device='cuda:0')
batch 18 loss: tensor(0.3633, device='cuda:0')
batch 19 loss: tensor(0.3970, device='cuda:0')
batch 20 loss: tensor(0.3575, device='cuda:0')
batch 21 loss: tensor(0.3700, device='cuda:0')
batch 22 loss: tensor(0.3483, device='cuda:0')
batch 23 loss: tensor(0.2754, device='cuda:0')
batch 24 loss: tensor(0.3981, device='cuda:0')
batch 25 loss: tensor(0.3840, device='cuda:0')
batch 26 loss: tensor(0.3997, device='cuda:0')
batch 27 loss: tensor(0.3540, device='cuda:0')
batch 28 loss: tensor(0.3826, device='cuda:0')
batch 29 loss: tensor(0.3946, device='cuda:0')
batch 30 loss: tensor(0.3348, device='cuda:0')
batch 31 loss: tensor(0.3426, device='cuda:0')
batch 32 loss: tensor(0.4094, device='cuda:0')
batch 33 loss: tensor(0.3642, device='cuda:0')
batch 34 loss: tensor(0.3650, device='cuda:0')
batch 35 loss: tensor(0.3735, device='cuda:0')
batch 36 loss: tensor(0.4168, device='cuda:0')
batch 37 loss: tensor(0.3985, device='cuda:0')
batch 38 loss: tensor(0.4049, device='cuda:0')
batch 39 loss: tensor(0.4109, device='cuda:0')
batch 40 loss: tensor(0.3792, device='cuda:0')
batch 41 loss: tensor(0.3663, device='cuda:0')
batch 42 loss: tensor(0.3640, device='cuda:0')
batch 43 loss: tensor(0.3213, device='cuda:0')
batch 44 loss: tensor(0.3505, device='cuda:0')
batch 45 loss: tensor(0.3797, device='cuda:0')
batch 46 loss: tensor(0.3787, device='cuda:0')
batch 47 loss: tensor(0.3775, device='cuda:0')
batch 48 loss: tensor(0.3554, device='cuda:0')
batch 49 loss: tensor(0.3890, device='cuda:0')
batch 50 loss: tensor(0.3651, device='cuda:0')
batch 51 loss: tensor(0.3758, device='cuda:0')
batch 52 loss: tensor(0.3134, device='cuda:0')
batch 53 loss: tensor(0.3687, device='cuda:0')
batch 54 loss: tensor(0.3630, device='cuda:0')
batch 55 loss: tensor(0.3565, device='cuda:0')
batch 56 loss: tensor(0.3355, device='cuda:0')
batch 57 loss: tensor(0.3651, device='cuda:0')
batch 58 loss: tensor(0.3678, device='cuda:0')
batch 59 loss: tensor(0.3321, device='cuda:0')
batch 60 loss: tensor(0.4106, device='cuda:0')
batch 61 loss: tensor(0.4113, device='cuda:0')
batch 62 loss: tensor(0.2804, device='cuda:0')
batch 63 loss: tensor(0.4004, device='cuda:0')
batch 64 loss: tensor(0.3524, device='cuda:0')
batch 65 loss: tensor(0.3193, device='cuda:0')
batch 66 loss: tensor(0.3627, device='cuda:0')
batch 67 loss: tensor(0.3390, device='cuda:0')
batch 68 loss: tensor(0.3971, device='cuda:0')
batch 69 loss: tensor(0.4040, device='cuda:0')
batch 70 loss: tensor(0.3392, device='cuda:0')
batch 71 loss: tensor(0.3959, device='cuda:0')
batch 72 loss: tensor(0.3212, device='cuda:0')
batch 73 loss: tensor(0.3473, device='cuda:0')
batch 74 loss: tensor(0.3207, device='cuda:0')
batch 75 loss: tensor(0.3450, device='cuda:0')
batch 76 loss: tensor(0.4132, device='cuda:0')
batch 77 loss: tensor(0.3600, device='cuda:0')
batch 78 loss: tensor(0.3345, device='cuda:0')
batch 79 loss: tensor(0.3276, device='cuda:0')
batch 80 loss: tensor(0.3275, device='cuda:0')
accuracy in val: 0.8374866666666667
accuracy in test: 0.8855863259554236
average epoch time: 1.7384596422314644
total time: 278.1535427570343
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0219, device='cuda:0')
batch 2 loss: tensor(0.7932, device='cuda:0')
batch 3 loss: tensor(0.6715, device='cuda:0')
batch 4 loss: tensor(0.6398, device='cuda:0')
batch 5 loss: tensor(0.5342, device='cuda:0')
batch 6 loss: tensor(0.5085, device='cuda:0')
batch 7 loss: tensor(0.5902, device='cuda:0')
batch 8 loss: tensor(0.5967, device='cuda:0')
batch 9 loss: tensor(0.5492, device='cuda:0')
batch 10 loss: tensor(0.5432, device='cuda:0')
batch 11 loss: tensor(0.5239, device='cuda:0')
batch 12 loss: tensor(0.5346, device='cuda:0')
batch 13 loss: tensor(0.5320, device='cuda:0')
batch 14 loss: tensor(0.5738, device='cuda:0')
batch 15 loss: tensor(0.5728, device='cuda:0')
batch 16 loss: tensor(0.4786, device='cuda:0')
batch 17 loss: tensor(0.5080, device='cuda:0')
batch 18 loss: tensor(0.4729, device='cuda:0')
batch 19 loss: tensor(0.4740, device='cuda:0')
batch 20 loss: tensor(0.5145, device='cuda:0')
batch 21 loss: tensor(0.5004, device='cuda:0')
batch 22 loss: tensor(0.4940, device='cuda:0')
batch 23 loss: tensor(0.4072, device='cuda:0')
batch 24 loss: tensor(0.4369, device='cuda:0')
batch 25 loss: tensor(0.4294, device='cuda:0')
batch 26 loss: tensor(0.5166, device='cuda:0')
batch 27 loss: tensor(0.4543, device='cuda:0')
batch 28 loss: tensor(0.5446, device='cuda:0')
batch 29 loss: tensor(0.5133, device='cuda:0')
batch 30 loss: tensor(0.4756, device='cuda:0')
batch 31 loss: tensor(0.4731, device='cuda:0')
batch 32 loss: tensor(0.4782, device='cuda:0')
batch 33 loss: tensor(0.5379, device='cuda:0')
batch 34 loss: tensor(0.5165, device='cuda:0')
batch 35 loss: tensor(0.4207, device='cuda:0')
batch 36 loss: tensor(0.4626, device='cuda:0')
batch 37 loss: tensor(0.4770, device='cuda:0')
batch 38 loss: tensor(0.4566, device='cuda:0')
batch 39 loss: tensor(0.5439, device='cuda:0')
batch 40 loss: tensor(0.4446, device='cuda:0')
batch 41 loss: tensor(0.5344, device='cuda:0')
batch 42 loss: tensor(0.5467, device='cuda:0')
batch 43 loss: tensor(0.4710, device='cuda:0')
batch 44 loss: tensor(0.5015, device='cuda:0')
batch 45 loss: tensor(0.5347, device='cuda:0')
batch 46 loss: tensor(0.4656, device='cuda:0')
batch 47 loss: tensor(0.4810, device='cuda:0')
batch 48 loss: tensor(0.4540, device='cuda:0')
batch 49 loss: tensor(0.4538, device='cuda:0')
batch 50 loss: tensor(0.4300, device='cuda:0')
batch 51 loss: tensor(0.4439, device='cuda:0')
batch 52 loss: tensor(0.4246, device='cuda:0')
batch 53 loss: tensor(0.4480, device='cuda:0')
batch 54 loss: tensor(0.4370, device='cuda:0')
batch 55 loss: tensor(0.3967, device='cuda:0')
batch 56 loss: tensor(0.4902, device='cuda:0')
batch 57 loss: tensor(0.4400, device='cuda:0')
batch 58 loss: tensor(0.5236, device='cuda:0')
batch 59 loss: tensor(0.4124, device='cuda:0')
batch 60 loss: tensor(0.3888, device='cuda:0')
batch 61 loss: tensor(0.4473, device='cuda:0')
batch 62 loss: tensor(0.4476, device='cuda:0')
batch 63 loss: tensor(0.5210, device='cuda:0')
batch 64 loss: tensor(0.5296, device='cuda:0')
batch 65 loss: tensor(0.4122, device='cuda:0')
batch 66 loss: tensor(0.4790, device='cuda:0')
batch 67 loss: tensor(0.4279, device='cuda:0')
batch 68 loss: tensor(0.4514, device='cuda:0')
batch 69 loss: tensor(0.4487, device='cuda:0')
batch 70 loss: tensor(0.4858, device='cuda:0')
batch 71 loss: tensor(0.4626, device='cuda:0')
batch 72 loss: tensor(0.4732, device='cuda:0')
batch 73 loss: tensor(0.4689, device='cuda:0')
batch 74 loss: tensor(0.4510, device='cuda:0')
batch 75 loss: tensor(0.4204, device='cuda:0')
batch 76 loss: tensor(0.4538, device='cuda:0')
batch 77 loss: tensor(0.4820, device='cuda:0')
batch 78 loss: tensor(0.4948, device='cuda:0')
batch 79 loss: tensor(0.4875, device='cuda:0')
batch 80 loss: tensor(0.4310, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.4670, device='cuda:0')
batch 2 loss: tensor(0.4150, device='cuda:0')
batch 3 loss: tensor(0.4538, device='cuda:0')
batch 4 loss: tensor(0.4424, device='cuda:0')
batch 5 loss: tensor(0.3699, device='cuda:0')
batch 6 loss: tensor(0.3796, device='cuda:0')
batch 7 loss: tensor(0.3634, device='cuda:0')
batch 8 loss: tensor(0.4085, device='cuda:0')
batch 9 loss: tensor(0.3613, device='cuda:0')
batch 10 loss: tensor(0.4210, device='cuda:0')
batch 11 loss: tensor(0.3669, device='cuda:0')
batch 12 loss: tensor(0.4225, device='cuda:0')
batch 13 loss: tensor(0.3852, device='cuda:0')
batch 14 loss: tensor(0.3976, device='cuda:0')
batch 15 loss: tensor(0.3976, device='cuda:0')
batch 16 loss: tensor(0.3824, device='cuda:0')
batch 17 loss: tensor(0.3593, device='cuda:0')
batch 18 loss: tensor(0.3858, device='cuda:0')
batch 19 loss: tensor(0.4085, device='cuda:0')
batch 20 loss: tensor(0.4088, device='cuda:0')
batch 21 loss: tensor(0.3603, device='cuda:0')
batch 22 loss: tensor(0.3919, device='cuda:0')
batch 23 loss: tensor(0.3430, device='cuda:0')
batch 24 loss: tensor(0.3815, device='cuda:0')
batch 25 loss: tensor(0.3613, device='cuda:0')
batch 26 loss: tensor(0.4244, device='cuda:0')
batch 27 loss: tensor(0.3828, device='cuda:0')
batch 28 loss: tensor(0.3830, device='cuda:0')
batch 29 loss: tensor(0.4343, device='cuda:0')
batch 30 loss: tensor(0.3396, device='cuda:0')
batch 31 loss: tensor(0.4242, device='cuda:0')
batch 32 loss: tensor(0.4066, device='cuda:0')
batch 33 loss: tensor(0.3614, device='cuda:0')
batch 34 loss: tensor(0.3843, device='cuda:0')
batch 35 loss: tensor(0.3658, device='cuda:0')
batch 36 loss: tensor(0.3889, device='cuda:0')
batch 37 loss: tensor(0.3663, device='cuda:0')
batch 38 loss: tensor(0.3567, device='cuda:0')
batch 39 loss: tensor(0.3852, device='cuda:0')
batch 40 loss: tensor(0.3823, device='cuda:0')
batch 41 loss: tensor(0.3571, device='cuda:0')
batch 42 loss: tensor(0.3166, device='cuda:0')
batch 43 loss: tensor(0.4039, device='cuda:0')
batch 44 loss: tensor(0.4161, device='cuda:0')
batch 45 loss: tensor(0.3416, device='cuda:0')
batch 46 loss: tensor(0.3622, device='cuda:0')
batch 47 loss: tensor(0.2886, device='cuda:0')
batch 48 loss: tensor(0.3884, device='cuda:0')
batch 49 loss: tensor(0.3660, device='cuda:0')
batch 50 loss: tensor(0.3569, device='cuda:0')
batch 51 loss: tensor(0.3732, device='cuda:0')
batch 52 loss: tensor(0.3943, device='cuda:0')
batch 53 loss: tensor(0.3309, device='cuda:0')
batch 54 loss: tensor(0.3567, device='cuda:0')
batch 55 loss: tensor(0.3549, device='cuda:0')
batch 56 loss: tensor(0.4112, device='cuda:0')
batch 57 loss: tensor(0.4082, device='cuda:0')
batch 58 loss: tensor(0.3969, device='cuda:0')
batch 59 loss: tensor(0.3933, device='cuda:0')
batch 60 loss: tensor(0.3496, device='cuda:0')
batch 61 loss: tensor(0.3611, device='cuda:0')
batch 62 loss: tensor(0.3575, device='cuda:0')
batch 63 loss: tensor(0.3849, device='cuda:0')
batch 64 loss: tensor(0.3510, device='cuda:0')
batch 65 loss: tensor(0.4096, device='cuda:0')
batch 66 loss: tensor(0.3517, device='cuda:0')
batch 67 loss: tensor(0.3872, device='cuda:0')
batch 68 loss: tensor(0.3866, device='cuda:0')
batch 69 loss: tensor(0.4089, device='cuda:0')
batch 70 loss: tensor(0.3763, device='cuda:0')
batch 71 loss: tensor(0.3688, device='cuda:0')
batch 72 loss: tensor(0.3669, device='cuda:0')
batch 73 loss: tensor(0.4132, device='cuda:0')
batch 74 loss: tensor(0.3172, device='cuda:0')
batch 75 loss: tensor(0.3511, device='cuda:0')
batch 76 loss: tensor(0.3197, device='cuda:0')
batch 77 loss: tensor(0.4186, device='cuda:0')
batch 78 loss: tensor(0.3000, device='cuda:0')
batch 79 loss: tensor(0.3441, device='cuda:0')
batch 80 loss: tensor(0.3201, device='cuda:0')
accuracy in val: 0.8382933333333333
accuracy in test: 0.8850995824761316
average epoch time: 1.7511891737580298
total time: 280.1902678012848
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9919, device='cuda:0')
batch 2 loss: tensor(0.8030, device='cuda:0')
batch 3 loss: tensor(0.6614, device='cuda:0')
batch 4 loss: tensor(0.6260, device='cuda:0')
batch 5 loss: tensor(0.6439, device='cuda:0')
batch 6 loss: tensor(0.5537, device='cuda:0')
batch 7 loss: tensor(0.5671, device='cuda:0')
batch 8 loss: tensor(0.5447, device='cuda:0')
batch 9 loss: tensor(0.5646, device='cuda:0')
batch 10 loss: tensor(0.4945, device='cuda:0')
batch 11 loss: tensor(0.5383, device='cuda:0')
batch 12 loss: tensor(0.4896, device='cuda:0')
batch 13 loss: tensor(0.5360, device='cuda:0')
batch 14 loss: tensor(0.5186, device='cuda:0')
batch 15 loss: tensor(0.4912, device='cuda:0')
batch 16 loss: tensor(0.4864, device='cuda:0')
batch 17 loss: tensor(0.4601, device='cuda:0')
batch 18 loss: tensor(0.4898, device='cuda:0')
batch 19 loss: tensor(0.5383, device='cuda:0')
batch 20 loss: tensor(0.4686, device='cuda:0')
batch 21 loss: tensor(0.5115, device='cuda:0')
batch 22 loss: tensor(0.5062, device='cuda:0')
batch 23 loss: tensor(0.5056, device='cuda:0')
batch 24 loss: tensor(0.5284, device='cuda:0')
batch 25 loss: tensor(0.4937, device='cuda:0')
batch 26 loss: tensor(0.4936, device='cuda:0')
batch 27 loss: tensor(0.4922, device='cuda:0')
batch 28 loss: tensor(0.5095, device='cuda:0')
batch 29 loss: tensor(0.5139, device='cuda:0')
batch 30 loss: tensor(0.5145, device='cuda:0')
batch 31 loss: tensor(0.5389, device='cuda:0')
batch 32 loss: tensor(0.5056, device='cuda:0')
batch 33 loss: tensor(0.5020, device='cuda:0')
batch 34 loss: tensor(0.5042, device='cuda:0')
batch 35 loss: tensor(0.4848, device='cuda:0')
batch 36 loss: tensor(0.5501, device='cuda:0')
batch 37 loss: tensor(0.5396, device='cuda:0')
batch 38 loss: tensor(0.4018, device='cuda:0')
batch 39 loss: tensor(0.5054, device='cuda:0')
batch 40 loss: tensor(0.4598, device='cuda:0')
batch 41 loss: tensor(0.4836, device='cuda:0')
batch 42 loss: tensor(0.4294, device='cuda:0')
batch 43 loss: tensor(0.5163, device='cuda:0')
batch 44 loss: tensor(0.4944, device='cuda:0')
batch 45 loss: tensor(0.5205, device='cuda:0')
batch 46 loss: tensor(0.4831, device='cuda:0')
batch 47 loss: tensor(0.4836, device='cuda:0')
batch 48 loss: tensor(0.4689, device='cuda:0')
batch 49 loss: tensor(0.4999, device='cuda:0')
batch 50 loss: tensor(0.4619, device='cuda:0')
batch 51 loss: tensor(0.4389, device='cuda:0')
batch 52 loss: tensor(0.4899, device='cuda:0')
batch 53 loss: tensor(0.4467, device='cuda:0')
batch 54 loss: tensor(0.4317, device='cuda:0')
batch 55 loss: tensor(0.4759, device='cuda:0')
batch 56 loss: tensor(0.4445, device='cuda:0')
batch 57 loss: tensor(0.4725, device='cuda:0')
batch 58 loss: tensor(0.4270, device='cuda:0')
batch 59 loss: tensor(0.4396, device='cuda:0')
batch 60 loss: tensor(0.4876, device='cuda:0')
batch 61 loss: tensor(0.4414, device='cuda:0')
batch 62 loss: tensor(0.4973, device='cuda:0')
batch 63 loss: tensor(0.4334, device='cuda:0')
batch 64 loss: tensor(0.4703, device='cuda:0')
batch 65 loss: tensor(0.4510, device='cuda:0')
batch 66 loss: tensor(0.4004, device='cuda:0')
batch 67 loss: tensor(0.4339, device='cuda:0')
batch 68 loss: tensor(0.4538, device='cuda:0')
batch 69 loss: tensor(0.3988, device='cuda:0')
batch 70 loss: tensor(0.4887, device='cuda:0')
batch 71 loss: tensor(0.4183, device='cuda:0')
batch 72 loss: tensor(0.4668, device='cuda:0')
batch 73 loss: tensor(0.4427, device='cuda:0')
batch 74 loss: tensor(0.4276, device='cuda:0')
batch 75 loss: tensor(0.4504, device='cuda:0')
batch 76 loss: tensor(0.5356, device='cuda:0')
batch 77 loss: tensor(0.4644, device='cuda:0')
batch 78 loss: tensor(0.4375, device='cuda:0')
batch 79 loss: tensor(0.4209, device='cuda:0')
batch 80 loss: tensor(0.4887, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.6092, device='cuda:0')
batch 2 loss: tensor(0.4588, device='cuda:0')
batch 3 loss: tensor(0.4288, device='cuda:0')
batch 4 loss: tensor(0.3842, device='cuda:0')
batch 5 loss: tensor(0.4389, device='cuda:0')
batch 6 loss: tensor(0.4190, device='cuda:0')
batch 7 loss: tensor(0.4418, device='cuda:0')
batch 8 loss: tensor(0.3618, device='cuda:0')
batch 9 loss: tensor(0.3788, device='cuda:0')
batch 10 loss: tensor(0.4120, device='cuda:0')
batch 11 loss: tensor(0.3662, device='cuda:0')
batch 12 loss: tensor(0.4007, device='cuda:0')
batch 13 loss: tensor(0.3870, device='cuda:0')
batch 14 loss: tensor(0.3588, device='cuda:0')
batch 15 loss: tensor(0.4048, device='cuda:0')
batch 16 loss: tensor(0.3452, device='cuda:0')
batch 17 loss: tensor(0.3132, device='cuda:0')
batch 18 loss: tensor(0.3826, device='cuda:0')
batch 19 loss: tensor(0.4393, device='cuda:0')
batch 20 loss: tensor(0.3525, device='cuda:0')
batch 21 loss: tensor(0.3576, device='cuda:0')
batch 22 loss: tensor(0.3617, device='cuda:0')
batch 23 loss: tensor(0.4072, device='cuda:0')
batch 24 loss: tensor(0.3956, device='cuda:0')
batch 25 loss: tensor(0.3891, device='cuda:0')
batch 26 loss: tensor(0.3301, device='cuda:0')
batch 27 loss: tensor(0.4110, device='cuda:0')
batch 28 loss: tensor(0.4755, device='cuda:0')
batch 29 loss: tensor(0.3883, device='cuda:0')
batch 30 loss: tensor(0.3555, device='cuda:0')
batch 31 loss: tensor(0.4017, device='cuda:0')
batch 32 loss: tensor(0.3726, device='cuda:0')
batch 33 loss: tensor(0.3973, device='cuda:0')
batch 34 loss: tensor(0.3933, device='cuda:0')
batch 35 loss: tensor(0.3175, device='cuda:0')
batch 36 loss: tensor(0.3414, device='cuda:0')
batch 37 loss: tensor(0.3893, device='cuda:0')
batch 38 loss: tensor(0.3351, device='cuda:0')
batch 39 loss: tensor(0.3789, device='cuda:0')
batch 40 loss: tensor(0.3118, device='cuda:0')
batch 41 loss: tensor(0.3347, device='cuda:0')
batch 42 loss: tensor(0.3434, device='cuda:0')
batch 43 loss: tensor(0.3722, device='cuda:0')
batch 44 loss: tensor(0.3506, device='cuda:0')
batch 45 loss: tensor(0.3325, device='cuda:0')
batch 46 loss: tensor(0.3815, device='cuda:0')
batch 47 loss: tensor(0.3128, device='cuda:0')
batch 48 loss: tensor(0.3730, device='cuda:0')
batch 49 loss: tensor(0.3720, device='cuda:0')
batch 50 loss: tensor(0.3829, device='cuda:0')
batch 51 loss: tensor(0.3520, device='cuda:0')
batch 52 loss: tensor(0.3153, device='cuda:0')
batch 53 loss: tensor(0.4288, device='cuda:0')
batch 54 loss: tensor(0.3802, device='cuda:0')
batch 55 loss: tensor(0.3745, device='cuda:0')
batch 56 loss: tensor(0.2945, device='cuda:0')
batch 57 loss: tensor(0.3835, device='cuda:0')
batch 58 loss: tensor(0.3633, device='cuda:0')
batch 59 loss: tensor(0.3282, device='cuda:0')
batch 60 loss: tensor(0.4484, device='cuda:0')
batch 61 loss: tensor(0.3432, device='cuda:0')
batch 62 loss: tensor(0.3503, device='cuda:0')
batch 63 loss: tensor(0.3527, device='cuda:0')
batch 64 loss: tensor(0.3540, device='cuda:0')
batch 65 loss: tensor(0.3352, device='cuda:0')
batch 66 loss: tensor(0.3871, device='cuda:0')
batch 67 loss: tensor(0.2910, device='cuda:0')
batch 68 loss: tensor(0.3359, device='cuda:0')
batch 69 loss: tensor(0.3961, device='cuda:0')
batch 70 loss: tensor(0.3537, device='cuda:0')
batch 71 loss: tensor(0.3962, device='cuda:0')
batch 72 loss: tensor(0.3553, device='cuda:0')
batch 73 loss: tensor(0.3385, device='cuda:0')
batch 74 loss: tensor(0.4439, device='cuda:0')
batch 75 loss: tensor(0.3432, device='cuda:0')
batch 76 loss: tensor(0.3336, device='cuda:0')
batch 77 loss: tensor(0.3866, device='cuda:0')
batch 78 loss: tensor(0.3676, device='cuda:0')
batch 79 loss: tensor(0.4150, device='cuda:0')
batch 80 loss: tensor(0.3311, device='cuda:0')
accuracy in val: 0.8369866666666667
accuracy in test: 0.8856924994622379
average epoch time: 1.7282063633203506
total time: 276.5130181312561
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9648, device='cuda:0')
batch 2 loss: tensor(0.8066, device='cuda:0')
batch 3 loss: tensor(0.6363, device='cuda:0')
batch 4 loss: tensor(0.6625, device='cuda:0')
batch 5 loss: tensor(0.5798, device='cuda:0')
batch 6 loss: tensor(0.5697, device='cuda:0')
batch 7 loss: tensor(0.5671, device='cuda:0')
batch 8 loss: tensor(0.4998, device='cuda:0')
batch 9 loss: tensor(0.5650, device='cuda:0')
batch 10 loss: tensor(0.4972, device='cuda:0')
batch 11 loss: tensor(0.5321, device='cuda:0')
batch 12 loss: tensor(0.5540, device='cuda:0')
batch 13 loss: tensor(0.5231, device='cuda:0')
batch 14 loss: tensor(0.4971, device='cuda:0')
batch 15 loss: tensor(0.5491, device='cuda:0')
batch 16 loss: tensor(0.5499, device='cuda:0')
batch 17 loss: tensor(0.5227, device='cuda:0')
batch 18 loss: tensor(0.5293, device='cuda:0')
batch 19 loss: tensor(0.4792, device='cuda:0')
batch 20 loss: tensor(0.5131, device='cuda:0')
batch 21 loss: tensor(0.4853, device='cuda:0')
batch 22 loss: tensor(0.4481, device='cuda:0')
batch 23 loss: tensor(0.5215, device='cuda:0')
batch 24 loss: tensor(0.4663, device='cuda:0')
batch 25 loss: tensor(0.4947, device='cuda:0')
batch 26 loss: tensor(0.4841, device='cuda:0')
batch 27 loss: tensor(0.5000, device='cuda:0')
batch 28 loss: tensor(0.5196, device='cuda:0')
batch 29 loss: tensor(0.4509, device='cuda:0')
batch 30 loss: tensor(0.4780, device='cuda:0')
batch 31 loss: tensor(0.4627, device='cuda:0')
batch 32 loss: tensor(0.4658, device='cuda:0')
batch 33 loss: tensor(0.5126, device='cuda:0')
batch 34 loss: tensor(0.4739, device='cuda:0')
batch 35 loss: tensor(0.5173, device='cuda:0')
batch 36 loss: tensor(0.4503, device='cuda:0')
batch 37 loss: tensor(0.4742, device='cuda:0')
batch 38 loss: tensor(0.4481, device='cuda:0')
batch 39 loss: tensor(0.4449, device='cuda:0')
batch 40 loss: tensor(0.4677, device='cuda:0')
batch 41 loss: tensor(0.4492, device='cuda:0')
batch 42 loss: tensor(0.5054, device='cuda:0')
batch 43 loss: tensor(0.4551, device='cuda:0')
batch 44 loss: tensor(0.4920, device='cuda:0')
batch 45 loss: tensor(0.4359, device='cuda:0')
batch 46 loss: tensor(0.4932, device='cuda:0')
batch 47 loss: tensor(0.5214, device='cuda:0')
batch 48 loss: tensor(0.4646, device='cuda:0')
batch 49 loss: tensor(0.4941, device='cuda:0')
batch 50 loss: tensor(0.4849, device='cuda:0')
batch 51 loss: tensor(0.4940, device='cuda:0')
batch 52 loss: tensor(0.4711, device='cuda:0')
batch 53 loss: tensor(0.4569, device='cuda:0')
batch 54 loss: tensor(0.4512, device='cuda:0')
batch 55 loss: tensor(0.4861, device='cuda:0')
batch 56 loss: tensor(0.4869, device='cuda:0')
batch 57 loss: tensor(0.4441, device='cuda:0')
batch 58 loss: tensor(0.5065, device='cuda:0')
batch 59 loss: tensor(0.4230, device='cuda:0')
batch 60 loss: tensor(0.4372, device='cuda:0')
batch 61 loss: tensor(0.4832, device='cuda:0')
batch 62 loss: tensor(0.5104, device='cuda:0')
batch 63 loss: tensor(0.4122, device='cuda:0')
batch 64 loss: tensor(0.4970, device='cuda:0')
batch 65 loss: tensor(0.4601, device='cuda:0')
batch 66 loss: tensor(0.4561, device='cuda:0')
batch 67 loss: tensor(0.4803, device='cuda:0')
batch 68 loss: tensor(0.4545, device='cuda:0')
batch 69 loss: tensor(0.4611, device='cuda:0')
batch 70 loss: tensor(0.4666, device='cuda:0')
batch 71 loss: tensor(0.4213, device='cuda:0')
batch 72 loss: tensor(0.4287, device='cuda:0')
batch 73 loss: tensor(0.3929, device='cuda:0')
batch 74 loss: tensor(0.4687, device='cuda:0')
batch 75 loss: tensor(0.4375, device='cuda:0')
batch 76 loss: tensor(0.4196, device='cuda:0')
batch 77 loss: tensor(0.4262, device='cuda:0')
batch 78 loss: tensor(0.4422, device='cuda:0')
batch 79 loss: tensor(0.4647, device='cuda:0')
batch 80 loss: tensor(0.5087, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5272, device='cuda:0')
batch 2 loss: tensor(0.4976, device='cuda:0')
batch 3 loss: tensor(0.4051, device='cuda:0')
batch 4 loss: tensor(0.3994, device='cuda:0')
batch 5 loss: tensor(0.4091, device='cuda:0')
batch 6 loss: tensor(0.4617, device='cuda:0')
batch 7 loss: tensor(0.4271, device='cuda:0')
batch 8 loss: tensor(0.4242, device='cuda:0')
batch 9 loss: tensor(0.3483, device='cuda:0')
batch 10 loss: tensor(0.3651, device='cuda:0')
batch 11 loss: tensor(0.3877, device='cuda:0')
batch 12 loss: tensor(0.4198, device='cuda:0')
batch 13 loss: tensor(0.4077, device='cuda:0')
batch 14 loss: tensor(0.3860, device='cuda:0')
batch 15 loss: tensor(0.4222, device='cuda:0')
batch 16 loss: tensor(0.3821, device='cuda:0')
batch 17 loss: tensor(0.3594, device='cuda:0')
batch 18 loss: tensor(0.3658, device='cuda:0')
batch 19 loss: tensor(0.3537, device='cuda:0')
batch 20 loss: tensor(0.3672, device='cuda:0')
batch 21 loss: tensor(0.3865, device='cuda:0')
batch 22 loss: tensor(0.4270, device='cuda:0')
batch 23 loss: tensor(0.3604, device='cuda:0')
batch 24 loss: tensor(0.3533, device='cuda:0')
batch 25 loss: tensor(0.3077, device='cuda:0')
batch 26 loss: tensor(0.3534, device='cuda:0')
batch 27 loss: tensor(0.3835, device='cuda:0')
batch 28 loss: tensor(0.3805, device='cuda:0')
batch 29 loss: tensor(0.3632, device='cuda:0')
batch 30 loss: tensor(0.4905, device='cuda:0')
batch 31 loss: tensor(0.3982, device='cuda:0')
batch 32 loss: tensor(0.4423, device='cuda:0')
batch 33 loss: tensor(0.3714, device='cuda:0')
batch 34 loss: tensor(0.3999, device='cuda:0')
batch 35 loss: tensor(0.3906, device='cuda:0')
batch 36 loss: tensor(0.3573, device='cuda:0')
batch 37 loss: tensor(0.3720, device='cuda:0')
batch 38 loss: tensor(0.3898, device='cuda:0')
batch 39 loss: tensor(0.4004, device='cuda:0')
batch 40 loss: tensor(0.2959, device='cuda:0')
batch 41 loss: tensor(0.3579, device='cuda:0')
batch 42 loss: tensor(0.3539, device='cuda:0')
batch 43 loss: tensor(0.3852, device='cuda:0')
batch 44 loss: tensor(0.3848, device='cuda:0')
batch 45 loss: tensor(0.3737, device='cuda:0')
batch 46 loss: tensor(0.4102, device='cuda:0')
batch 47 loss: tensor(0.3464, device='cuda:0')
batch 48 loss: tensor(0.3920, device='cuda:0')
batch 49 loss: tensor(0.3762, device='cuda:0')
batch 50 loss: tensor(0.3439, device='cuda:0')
batch 51 loss: tensor(0.4464, device='cuda:0')
batch 52 loss: tensor(0.4183, device='cuda:0')
batch 53 loss: tensor(0.3868, device='cuda:0')
batch 54 loss: tensor(0.4019, device='cuda:0')
batch 55 loss: tensor(0.4319, device='cuda:0')
batch 56 loss: tensor(0.3984, device='cuda:0')
batch 57 loss: tensor(0.3159, device='cuda:0')
batch 58 loss: tensor(0.3461, device='cuda:0')
batch 59 loss: tensor(0.3787, device='cuda:0')
batch 60 loss: tensor(0.3447, device='cuda:0')
batch 61 loss: tensor(0.3576, device='cuda:0')
batch 62 loss: tensor(0.3903, device='cuda:0')
batch 63 loss: tensor(0.3854, device='cuda:0')
batch 64 loss: tensor(0.3223, device='cuda:0')
batch 65 loss: tensor(0.3561, device='cuda:0')
batch 66 loss: tensor(0.3722, device='cuda:0')
batch 67 loss: tensor(0.3661, device='cuda:0')
batch 68 loss: tensor(0.3520, device='cuda:0')
batch 69 loss: tensor(0.3097, device='cuda:0')
batch 70 loss: tensor(0.3501, device='cuda:0')
batch 71 loss: tensor(0.3702, device='cuda:0')
batch 72 loss: tensor(0.3654, device='cuda:0')
batch 73 loss: tensor(0.3748, device='cuda:0')
batch 74 loss: tensor(0.3337, device='cuda:0')
batch 75 loss: tensor(0.3397, device='cuda:0')
batch 76 loss: tensor(0.3464, device='cuda:0')
batch 77 loss: tensor(0.4191, device='cuda:0')
batch 78 loss: tensor(0.3353, device='cuda:0')
batch 79 loss: tensor(0.3691, device='cuda:0')
batch 80 loss: tensor(0.3616, device='cuda:0')
accuracy in val: 0.8376766666666665
accuracy in test: 0.8855821893252881
average epoch time: 1.7366457670927047
total time: 277.86332273483276
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9502, device='cuda:0')
batch 2 loss: tensor(0.7399, device='cuda:0')
batch 3 loss: tensor(0.7171, device='cuda:0')
batch 4 loss: tensor(0.6365, device='cuda:0')
batch 5 loss: tensor(0.6206, device='cuda:0')
batch 6 loss: tensor(0.7218, device='cuda:0')
batch 7 loss: tensor(0.6163, device='cuda:0')
batch 8 loss: tensor(0.6279, device='cuda:0')
batch 9 loss: tensor(0.5212, device='cuda:0')
batch 10 loss: tensor(0.5644, device='cuda:0')
batch 11 loss: tensor(0.5590, device='cuda:0')
batch 12 loss: tensor(0.5504, device='cuda:0')
batch 13 loss: tensor(0.5312, device='cuda:0')
batch 14 loss: tensor(0.5192, device='cuda:0')
batch 15 loss: tensor(0.4969, device='cuda:0')
batch 16 loss: tensor(0.5189, device='cuda:0')
batch 17 loss: tensor(0.4819, device='cuda:0')
batch 18 loss: tensor(0.4549, device='cuda:0')
batch 19 loss: tensor(0.4784, device='cuda:0')
batch 20 loss: tensor(0.4966, device='cuda:0')
batch 21 loss: tensor(0.4761, device='cuda:0')
batch 22 loss: tensor(0.4719, device='cuda:0')
batch 23 loss: tensor(0.5242, device='cuda:0')
batch 24 loss: tensor(0.5462, device='cuda:0')
batch 25 loss: tensor(0.4842, device='cuda:0')
batch 26 loss: tensor(0.4389, device='cuda:0')
batch 27 loss: tensor(0.4766, device='cuda:0')
batch 28 loss: tensor(0.5083, device='cuda:0')
batch 29 loss: tensor(0.4310, device='cuda:0')
batch 30 loss: tensor(0.4697, device='cuda:0')
batch 31 loss: tensor(0.5392, device='cuda:0')
batch 32 loss: tensor(0.4775, device='cuda:0')
batch 33 loss: tensor(0.4981, device='cuda:0')
batch 34 loss: tensor(0.4805, device='cuda:0')
batch 35 loss: tensor(0.4493, device='cuda:0')
batch 36 loss: tensor(0.4344, device='cuda:0')
batch 37 loss: tensor(0.5198, device='cuda:0')
batch 38 loss: tensor(0.4413, device='cuda:0')
batch 39 loss: tensor(0.4661, device='cuda:0')
batch 40 loss: tensor(0.4256, device='cuda:0')
batch 41 loss: tensor(0.5066, device='cuda:0')
batch 42 loss: tensor(0.5247, device='cuda:0')
batch 43 loss: tensor(0.4308, device='cuda:0')
batch 44 loss: tensor(0.5208, device='cuda:0')
batch 45 loss: tensor(0.4634, device='cuda:0')
batch 46 loss: tensor(0.4454, device='cuda:0')
batch 47 loss: tensor(0.4152, device='cuda:0')
batch 48 loss: tensor(0.5001, device='cuda:0')
batch 49 loss: tensor(0.4574, device='cuda:0')
batch 50 loss: tensor(0.4134, device='cuda:0')
batch 51 loss: tensor(0.4407, device='cuda:0')
batch 52 loss: tensor(0.4161, device='cuda:0')
batch 53 loss: tensor(0.4819, device='cuda:0')
batch 54 loss: tensor(0.4534, device='cuda:0')
batch 55 loss: tensor(0.4908, device='cuda:0')
batch 56 loss: tensor(0.5052, device='cuda:0')
batch 57 loss: tensor(0.4486, device='cuda:0')
batch 58 loss: tensor(0.4476, device='cuda:0')
batch 59 loss: tensor(0.4607, device='cuda:0')
batch 60 loss: tensor(0.4364, device='cuda:0')
batch 61 loss: tensor(0.4573, device='cuda:0')
batch 62 loss: tensor(0.4493, device='cuda:0')
batch 63 loss: tensor(0.4526, device='cuda:0')
batch 64 loss: tensor(0.4761, device='cuda:0')
batch 65 loss: tensor(0.4520, device='cuda:0')
batch 66 loss: tensor(0.4619, device='cuda:0')
batch 67 loss: tensor(0.4883, device='cuda:0')
batch 68 loss: tensor(0.4588, device='cuda:0')
batch 69 loss: tensor(0.4237, device='cuda:0')
batch 70 loss: tensor(0.4715, device='cuda:0')
batch 71 loss: tensor(0.4764, device='cuda:0')
batch 72 loss: tensor(0.4612, device='cuda:0')
batch 73 loss: tensor(0.4600, device='cuda:0')
batch 74 loss: tensor(0.4435, device='cuda:0')
batch 75 loss: tensor(0.4763, device='cuda:0')
batch 76 loss: tensor(0.4257, device='cuda:0')
batch 77 loss: tensor(0.5150, device='cuda:0')
batch 78 loss: tensor(0.4536, device='cuda:0')
batch 79 loss: tensor(0.4643, device='cuda:0')
batch 80 loss: tensor(0.4774, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5302, device='cuda:0')
batch 2 loss: tensor(0.5183, device='cuda:0')
batch 3 loss: tensor(0.5081, device='cuda:0')
batch 4 loss: tensor(0.4882, device='cuda:0')
batch 5 loss: tensor(0.3903, device='cuda:0')
batch 6 loss: tensor(0.4074, device='cuda:0')
batch 7 loss: tensor(0.4007, device='cuda:0')
batch 8 loss: tensor(0.3944, device='cuda:0')
batch 9 loss: tensor(0.4039, device='cuda:0')
batch 10 loss: tensor(0.4174, device='cuda:0')
batch 11 loss: tensor(0.4114, device='cuda:0')
batch 12 loss: tensor(0.4317, device='cuda:0')
batch 13 loss: tensor(0.3800, device='cuda:0')
batch 14 loss: tensor(0.3829, device='cuda:0')
batch 15 loss: tensor(0.4061, device='cuda:0')
batch 16 loss: tensor(0.4120, device='cuda:0')
batch 17 loss: tensor(0.4054, device='cuda:0')
batch 18 loss: tensor(0.4177, device='cuda:0')
batch 19 loss: tensor(0.3372, device='cuda:0')
batch 20 loss: tensor(0.3976, device='cuda:0')
batch 21 loss: tensor(0.3855, device='cuda:0')
batch 22 loss: tensor(0.3624, device='cuda:0')
batch 23 loss: tensor(0.4067, device='cuda:0')
batch 24 loss: tensor(0.3368, device='cuda:0')
batch 25 loss: tensor(0.3704, device='cuda:0')
batch 26 loss: tensor(0.3434, device='cuda:0')
batch 27 loss: tensor(0.4057, device='cuda:0')
batch 28 loss: tensor(0.3637, device='cuda:0')
batch 29 loss: tensor(0.4118, device='cuda:0')
batch 30 loss: tensor(0.4203, device='cuda:0')
batch 31 loss: tensor(0.4204, device='cuda:0')
batch 32 loss: tensor(0.3616, device='cuda:0')
batch 33 loss: tensor(0.3013, device='cuda:0')
batch 34 loss: tensor(0.3992, device='cuda:0')
batch 35 loss: tensor(0.3822, device='cuda:0')
batch 36 loss: tensor(0.4352, device='cuda:0')
batch 37 loss: tensor(0.3958, device='cuda:0')
batch 38 loss: tensor(0.3663, device='cuda:0')
batch 39 loss: tensor(0.3359, device='cuda:0')
batch 40 loss: tensor(0.3638, device='cuda:0')
batch 41 loss: tensor(0.3052, device='cuda:0')
batch 42 loss: tensor(0.3686, device='cuda:0')
batch 43 loss: tensor(0.3663, device='cuda:0')
batch 44 loss: tensor(0.4621, device='cuda:0')
batch 45 loss: tensor(0.3885, device='cuda:0')
batch 46 loss: tensor(0.3841, device='cuda:0')
batch 47 loss: tensor(0.3430, device='cuda:0')
batch 48 loss: tensor(0.4280, device='cuda:0')
batch 49 loss: tensor(0.3682, device='cuda:0')
batch 50 loss: tensor(0.3115, device='cuda:0')
batch 51 loss: tensor(0.3292, device='cuda:0')
batch 52 loss: tensor(0.4047, device='cuda:0')
batch 53 loss: tensor(0.2926, device='cuda:0')
batch 54 loss: tensor(0.4088, device='cuda:0')
batch 55 loss: tensor(0.3577, device='cuda:0')
batch 56 loss: tensor(0.3985, device='cuda:0')
batch 57 loss: tensor(0.4299, device='cuda:0')
batch 58 loss: tensor(0.4244, device='cuda:0')
batch 59 loss: tensor(0.4084, device='cuda:0')
batch 60 loss: tensor(0.3479, device='cuda:0')
batch 61 loss: tensor(0.4000, device='cuda:0')
batch 62 loss: tensor(0.4033, device='cuda:0')
batch 63 loss: tensor(0.4258, device='cuda:0')
batch 64 loss: tensor(0.4123, device='cuda:0')
batch 65 loss: tensor(0.3382, device='cuda:0')
batch 66 loss: tensor(0.4200, device='cuda:0')
batch 67 loss: tensor(0.3429, device='cuda:0')
batch 68 loss: tensor(0.3693, device='cuda:0')
batch 69 loss: tensor(0.3831, device='cuda:0')
batch 70 loss: tensor(0.3786, device='cuda:0')
batch 71 loss: tensor(0.3132, device='cuda:0')
batch 72 loss: tensor(0.3494, device='cuda:0')
batch 73 loss: tensor(0.3496, device='cuda:0')
batch 74 loss: tensor(0.3844, device='cuda:0')
batch 75 loss: tensor(0.4216, device='cuda:0')
batch 76 loss: tensor(0.3714, device='cuda:0')
batch 77 loss: tensor(0.3843, device='cuda:0')
batch 78 loss: tensor(0.3503, device='cuda:0')
batch 79 loss: tensor(0.3868, device='cuda:0')
batch 80 loss: tensor(0.3008, device='cuda:0')
accuracy in val: 0.8379
accuracy in test: 0.8858869210786126
average epoch time: 1.7383561223745345
total time: 278.13697957992554
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9489, device='cuda:0')
batch 2 loss: tensor(0.7448, device='cuda:0')
batch 3 loss: tensor(0.7290, device='cuda:0')
batch 4 loss: tensor(0.6912, device='cuda:0')
batch 5 loss: tensor(0.6524, device='cuda:0')
batch 6 loss: tensor(0.5840, device='cuda:0')
batch 7 loss: tensor(0.5508, device='cuda:0')
batch 8 loss: tensor(0.5633, device='cuda:0')
batch 9 loss: tensor(0.5799, device='cuda:0')
batch 10 loss: tensor(0.5322, device='cuda:0')
batch 11 loss: tensor(0.6165, device='cuda:0')
batch 12 loss: tensor(0.5459, device='cuda:0')
batch 13 loss: tensor(0.5506, device='cuda:0')
batch 14 loss: tensor(0.5370, device='cuda:0')
batch 15 loss: tensor(0.5179, device='cuda:0')
batch 16 loss: tensor(0.5152, device='cuda:0')
batch 17 loss: tensor(0.5945, device='cuda:0')
batch 18 loss: tensor(0.5756, device='cuda:0')
batch 19 loss: tensor(0.5081, device='cuda:0')
batch 20 loss: tensor(0.4917, device='cuda:0')
batch 21 loss: tensor(0.5455, device='cuda:0')
batch 22 loss: tensor(0.5007, device='cuda:0')
batch 23 loss: tensor(0.5106, device='cuda:0')
batch 24 loss: tensor(0.4713, device='cuda:0')
batch 25 loss: tensor(0.4749, device='cuda:0')
batch 26 loss: tensor(0.5131, device='cuda:0')
batch 27 loss: tensor(0.5143, device='cuda:0')
batch 28 loss: tensor(0.5004, device='cuda:0')
batch 29 loss: tensor(0.4494, device='cuda:0')
batch 30 loss: tensor(0.5068, device='cuda:0')
batch 31 loss: tensor(0.5276, device='cuda:0')
batch 32 loss: tensor(0.4523, device='cuda:0')
batch 33 loss: tensor(0.4770, device='cuda:0')
batch 34 loss: tensor(0.4917, device='cuda:0')
batch 35 loss: tensor(0.4127, device='cuda:0')
batch 36 loss: tensor(0.4542, device='cuda:0')
batch 37 loss: tensor(0.4959, device='cuda:0')
batch 38 loss: tensor(0.4311, device='cuda:0')
batch 39 loss: tensor(0.4833, device='cuda:0')
batch 40 loss: tensor(0.5215, device='cuda:0')
batch 41 loss: tensor(0.4547, device='cuda:0')
batch 42 loss: tensor(0.4321, device='cuda:0')
batch 43 loss: tensor(0.4693, device='cuda:0')
batch 44 loss: tensor(0.4801, device='cuda:0')
batch 45 loss: tensor(0.4452, device='cuda:0')
batch 46 loss: tensor(0.4139, device='cuda:0')
batch 47 loss: tensor(0.4407, device='cuda:0')
batch 48 loss: tensor(0.4590, device='cuda:0')
batch 49 loss: tensor(0.4249, device='cuda:0')
batch 50 loss: tensor(0.4290, device='cuda:0')
batch 51 loss: tensor(0.4703, device='cuda:0')
batch 52 loss: tensor(0.4908, device='cuda:0')
batch 53 loss: tensor(0.4618, device='cuda:0')
batch 54 loss: tensor(0.4472, device='cuda:0')
batch 55 loss: tensor(0.4711, device='cuda:0')
batch 56 loss: tensor(0.4204, device='cuda:0')
batch 57 loss: tensor(0.4782, device='cuda:0')
batch 58 loss: tensor(0.4288, device='cuda:0')
batch 59 loss: tensor(0.5024, device='cuda:0')
batch 60 loss: tensor(0.4986, device='cuda:0')
batch 61 loss: tensor(0.4887, device='cuda:0')
batch 62 loss: tensor(0.4465, device='cuda:0')
batch 63 loss: tensor(0.5411, device='cuda:0')
batch 64 loss: tensor(0.4873, device='cuda:0')
batch 65 loss: tensor(0.4636, device='cuda:0')
batch 66 loss: tensor(0.4348, device='cuda:0')
batch 67 loss: tensor(0.5003, device='cuda:0')
batch 68 loss: tensor(0.4377, device='cuda:0')
batch 69 loss: tensor(0.4320, device='cuda:0')
batch 70 loss: tensor(0.4809, device='cuda:0')
batch 71 loss: tensor(0.4806, device='cuda:0')
batch 72 loss: tensor(0.4545, device='cuda:0')
batch 73 loss: tensor(0.5124, device='cuda:0')
batch 74 loss: tensor(0.4939, device='cuda:0')
batch 75 loss: tensor(0.4329, device='cuda:0')
batch 76 loss: tensor(0.5114, device='cuda:0')
batch 77 loss: tensor(0.4290, device='cuda:0')
batch 78 loss: tensor(0.4173, device='cuda:0')
batch 79 loss: tensor(0.4143, device='cuda:0')
batch 80 loss: tensor(0.4259, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5556, device='cuda:0')
batch 2 loss: tensor(0.4670, device='cuda:0')
batch 3 loss: tensor(0.4493, device='cuda:0')
batch 4 loss: tensor(0.4699, device='cuda:0')
batch 5 loss: tensor(0.3931, device='cuda:0')
batch 6 loss: tensor(0.4318, device='cuda:0')
batch 7 loss: tensor(0.4437, device='cuda:0')
batch 8 loss: tensor(0.4224, device='cuda:0')
batch 9 loss: tensor(0.3892, device='cuda:0')
batch 10 loss: tensor(0.3530, device='cuda:0')
batch 11 loss: tensor(0.4160, device='cuda:0')
batch 12 loss: tensor(0.3639, device='cuda:0')
batch 13 loss: tensor(0.3993, device='cuda:0')
batch 14 loss: tensor(0.4189, device='cuda:0')
batch 15 loss: tensor(0.3304, device='cuda:0')
batch 16 loss: tensor(0.3375, device='cuda:0')
batch 17 loss: tensor(0.4390, device='cuda:0')
batch 18 loss: tensor(0.4171, device='cuda:0')
batch 19 loss: tensor(0.4395, device='cuda:0')
batch 20 loss: tensor(0.4189, device='cuda:0')
batch 21 loss: tensor(0.3749, device='cuda:0')
batch 22 loss: tensor(0.3161, device='cuda:0')
batch 23 loss: tensor(0.4112, device='cuda:0')
batch 24 loss: tensor(0.3837, device='cuda:0')
batch 25 loss: tensor(0.3870, device='cuda:0')
batch 26 loss: tensor(0.4162, device='cuda:0')
batch 27 loss: tensor(0.3745, device='cuda:0')
batch 28 loss: tensor(0.4212, device='cuda:0')
batch 29 loss: tensor(0.3715, device='cuda:0')
batch 30 loss: tensor(0.3105, device='cuda:0')
batch 31 loss: tensor(0.3884, device='cuda:0')
batch 32 loss: tensor(0.3736, device='cuda:0')
batch 33 loss: tensor(0.3688, device='cuda:0')
batch 34 loss: tensor(0.3892, device='cuda:0')
batch 35 loss: tensor(0.3760, device='cuda:0')
batch 36 loss: tensor(0.3822, device='cuda:0')
batch 37 loss: tensor(0.4223, device='cuda:0')
batch 38 loss: tensor(0.3821, device='cuda:0')
batch 39 loss: tensor(0.3512, device='cuda:0')
batch 40 loss: tensor(0.3957, device='cuda:0')
batch 41 loss: tensor(0.3987, device='cuda:0')
batch 42 loss: tensor(0.3757, device='cuda:0')
batch 43 loss: tensor(0.3056, device='cuda:0')
batch 44 loss: tensor(0.4034, device='cuda:0')
batch 45 loss: tensor(0.3703, device='cuda:0')
batch 46 loss: tensor(0.3588, device='cuda:0')
batch 47 loss: tensor(0.4221, device='cuda:0')
batch 48 loss: tensor(0.3413, device='cuda:0')
batch 49 loss: tensor(0.3382, device='cuda:0')
batch 50 loss: tensor(0.3853, device='cuda:0')
batch 51 loss: tensor(0.4359, device='cuda:0')
batch 52 loss: tensor(0.3684, device='cuda:0')
batch 53 loss: tensor(0.3667, device='cuda:0')
batch 54 loss: tensor(0.4027, device='cuda:0')
batch 55 loss: tensor(0.3690, device='cuda:0')
batch 56 loss: tensor(0.3930, device='cuda:0')
batch 57 loss: tensor(0.4090, device='cuda:0')
batch 58 loss: tensor(0.3754, device='cuda:0')
batch 59 loss: tensor(0.3640, device='cuda:0')
batch 60 loss: tensor(0.3798, device='cuda:0')
batch 61 loss: tensor(0.3592, device='cuda:0')
batch 62 loss: tensor(0.3954, device='cuda:0')
batch 63 loss: tensor(0.3477, device='cuda:0')
batch 64 loss: tensor(0.3470, device='cuda:0')
batch 65 loss: tensor(0.3414, device='cuda:0')
batch 66 loss: tensor(0.3963, device='cuda:0')
batch 67 loss: tensor(0.3223, device='cuda:0')
batch 68 loss: tensor(0.3312, device='cuda:0')
batch 69 loss: tensor(0.3726, device='cuda:0')
batch 70 loss: tensor(0.3874, device='cuda:0')
batch 71 loss: tensor(0.3325, device='cuda:0')
batch 72 loss: tensor(0.3743, device='cuda:0')
batch 73 loss: tensor(0.3254, device='cuda:0')
batch 74 loss: tensor(0.3590, device='cuda:0')
batch 75 loss: tensor(0.3422, device='cuda:0')
batch 76 loss: tensor(0.3797, device='cuda:0')
batch 77 loss: tensor(0.3958, device='cuda:0')
batch 78 loss: tensor(0.3280, device='cuda:0')
batch 79 loss: tensor(0.3350, device='cuda:0')
batch 80 loss: tensor(0.3741, device='cuda:0')
accuracy in val: 0.8384833333333334
accuracy in test: 0.885704909352645
average epoch time: 1.762802393734455
total time: 282.0483829975128
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9847, device='cuda:0')
batch 2 loss: tensor(0.7527, device='cuda:0')
batch 3 loss: tensor(0.6302, device='cuda:0')
batch 4 loss: tensor(0.5770, device='cuda:0')
batch 5 loss: tensor(0.5894, device='cuda:0')
batch 6 loss: tensor(0.5563, device='cuda:0')
batch 7 loss: tensor(0.5397, device='cuda:0')
batch 8 loss: tensor(0.5863, device='cuda:0')
batch 9 loss: tensor(0.5688, device='cuda:0')
batch 10 loss: tensor(0.5451, device='cuda:0')
batch 11 loss: tensor(0.5800, device='cuda:0')
batch 12 loss: tensor(0.5012, device='cuda:0')
batch 13 loss: tensor(0.5037, device='cuda:0')
batch 14 loss: tensor(0.5265, device='cuda:0')
batch 15 loss: tensor(0.5708, device='cuda:0')
batch 16 loss: tensor(0.5490, device='cuda:0')
batch 17 loss: tensor(0.5587, device='cuda:0')
batch 18 loss: tensor(0.4716, device='cuda:0')
batch 19 loss: tensor(0.5326, device='cuda:0')
batch 20 loss: tensor(0.5445, device='cuda:0')
batch 21 loss: tensor(0.4736, device='cuda:0')
batch 22 loss: tensor(0.4381, device='cuda:0')
batch 23 loss: tensor(0.4979, device='cuda:0')
batch 24 loss: tensor(0.4748, device='cuda:0')
batch 25 loss: tensor(0.4614, device='cuda:0')
batch 26 loss: tensor(0.4603, device='cuda:0')
batch 27 loss: tensor(0.5272, device='cuda:0')
batch 28 loss: tensor(0.4826, device='cuda:0')
batch 29 loss: tensor(0.4573, device='cuda:0')
batch 30 loss: tensor(0.4944, device='cuda:0')
batch 31 loss: tensor(0.4636, device='cuda:0')
batch 32 loss: tensor(0.4540, device='cuda:0')
batch 33 loss: tensor(0.4362, device='cuda:0')
batch 34 loss: tensor(0.5765, device='cuda:0')
batch 35 loss: tensor(0.4551, device='cuda:0')
batch 36 loss: tensor(0.4749, device='cuda:0')
batch 37 loss: tensor(0.4954, device='cuda:0')
batch 38 loss: tensor(0.4632, device='cuda:0')
batch 39 loss: tensor(0.5722, device='cuda:0')
batch 40 loss: tensor(0.4364, device='cuda:0')
batch 41 loss: tensor(0.4636, device='cuda:0')
batch 42 loss: tensor(0.4631, device='cuda:0')
batch 43 loss: tensor(0.4207, device='cuda:0')
batch 44 loss: tensor(0.5562, device='cuda:0')
batch 45 loss: tensor(0.4397, device='cuda:0')
batch 46 loss: tensor(0.4203, device='cuda:0')
batch 47 loss: tensor(0.4486, device='cuda:0')
batch 48 loss: tensor(0.4930, device='cuda:0')
batch 49 loss: tensor(0.4248, device='cuda:0')
batch 50 loss: tensor(0.3671, device='cuda:0')
batch 51 loss: tensor(0.4801, device='cuda:0')
batch 52 loss: tensor(0.4059, device='cuda:0')
batch 53 loss: tensor(0.4623, device='cuda:0')
batch 54 loss: tensor(0.4242, device='cuda:0')
batch 55 loss: tensor(0.4323, device='cuda:0')
batch 56 loss: tensor(0.4416, device='cuda:0')
batch 57 loss: tensor(0.4565, device='cuda:0')
batch 58 loss: tensor(0.4785, device='cuda:0')
batch 59 loss: tensor(0.4431, device='cuda:0')
batch 60 loss: tensor(0.5186, device='cuda:0')
batch 61 loss: tensor(0.4131, device='cuda:0')
batch 62 loss: tensor(0.4385, device='cuda:0')
batch 63 loss: tensor(0.4923, device='cuda:0')
batch 64 loss: tensor(0.4376, device='cuda:0')
batch 65 loss: tensor(0.4342, device='cuda:0')
batch 66 loss: tensor(0.4889, device='cuda:0')
batch 67 loss: tensor(0.4521, device='cuda:0')
batch 68 loss: tensor(0.4854, device='cuda:0')
batch 69 loss: tensor(0.4392, device='cuda:0')
batch 70 loss: tensor(0.4795, device='cuda:0')
batch 71 loss: tensor(0.4251, device='cuda:0')
batch 72 loss: tensor(0.4718, device='cuda:0')
batch 73 loss: tensor(0.3847, device='cuda:0')
batch 74 loss: tensor(0.4377, device='cuda:0')
batch 75 loss: tensor(0.4475, device='cuda:0')
batch 76 loss: tensor(0.4597, device='cuda:0')
batch 77 loss: tensor(0.4767, device='cuda:0')
batch 78 loss: tensor(0.4692, device='cuda:0')
batch 79 loss: tensor(0.4600, device='cuda:0')
batch 80 loss: tensor(0.4785, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5545, device='cuda:0')
batch 2 loss: tensor(0.4138, device='cuda:0')
batch 3 loss: tensor(0.4519, device='cuda:0')
batch 4 loss: tensor(0.3749, device='cuda:0')
batch 5 loss: tensor(0.4759, device='cuda:0')
batch 6 loss: tensor(0.4204, device='cuda:0')
batch 7 loss: tensor(0.3780, device='cuda:0')
batch 8 loss: tensor(0.3845, device='cuda:0')
batch 9 loss: tensor(0.4128, device='cuda:0')
batch 10 loss: tensor(0.3887, device='cuda:0')
batch 11 loss: tensor(0.3823, device='cuda:0')
batch 12 loss: tensor(0.3997, device='cuda:0')
batch 13 loss: tensor(0.3906, device='cuda:0')
batch 14 loss: tensor(0.3859, device='cuda:0')
batch 15 loss: tensor(0.3714, device='cuda:0')
batch 16 loss: tensor(0.4414, device='cuda:0')
batch 17 loss: tensor(0.3831, device='cuda:0')
batch 18 loss: tensor(0.3538, device='cuda:0')
batch 19 loss: tensor(0.4145, device='cuda:0')
batch 20 loss: tensor(0.4117, device='cuda:0')
batch 21 loss: tensor(0.3561, device='cuda:0')
batch 22 loss: tensor(0.3834, device='cuda:0')
batch 23 loss: tensor(0.3892, device='cuda:0')
batch 24 loss: tensor(0.3898, device='cuda:0')
batch 25 loss: tensor(0.4087, device='cuda:0')
batch 26 loss: tensor(0.4070, device='cuda:0')
batch 27 loss: tensor(0.3745, device='cuda:0')
batch 28 loss: tensor(0.3690, device='cuda:0')
batch 29 loss: tensor(0.3540, device='cuda:0')
batch 30 loss: tensor(0.3636, device='cuda:0')
batch 31 loss: tensor(0.4037, device='cuda:0')
batch 32 loss: tensor(0.3682, device='cuda:0')
batch 33 loss: tensor(0.4076, device='cuda:0')
batch 34 loss: tensor(0.3682, device='cuda:0')
batch 35 loss: tensor(0.3854, device='cuda:0')
batch 36 loss: tensor(0.4229, device='cuda:0')
batch 37 loss: tensor(0.3477, device='cuda:0')
batch 38 loss: tensor(0.3295, device='cuda:0')
batch 39 loss: tensor(0.3508, device='cuda:0')
batch 40 loss: tensor(0.3492, device='cuda:0')
batch 41 loss: tensor(0.3849, device='cuda:0')
batch 42 loss: tensor(0.4029, device='cuda:0')
batch 43 loss: tensor(0.3283, device='cuda:0')
batch 44 loss: tensor(0.3645, device='cuda:0')
batch 45 loss: tensor(0.3842, device='cuda:0')
batch 46 loss: tensor(0.3611, device='cuda:0')
batch 47 loss: tensor(0.3448, device='cuda:0')
batch 48 loss: tensor(0.4116, device='cuda:0')
batch 49 loss: tensor(0.3845, device='cuda:0')
batch 50 loss: tensor(0.3898, device='cuda:0')
batch 51 loss: tensor(0.3933, device='cuda:0')
batch 52 loss: tensor(0.4008, device='cuda:0')
batch 53 loss: tensor(0.3917, device='cuda:0')
batch 54 loss: tensor(0.3496, device='cuda:0')
batch 55 loss: tensor(0.3637, device='cuda:0')
batch 56 loss: tensor(0.3384, device='cuda:0')
batch 57 loss: tensor(0.3728, device='cuda:0')
batch 58 loss: tensor(0.3572, device='cuda:0')
batch 59 loss: tensor(0.2895, device='cuda:0')
batch 60 loss: tensor(0.3520, device='cuda:0')
batch 61 loss: tensor(0.3135, device='cuda:0')
batch 62 loss: tensor(0.3409, device='cuda:0')
batch 63 loss: tensor(0.4028, device='cuda:0')
batch 64 loss: tensor(0.3673, device='cuda:0')
batch 65 loss: tensor(0.3260, device='cuda:0')
batch 66 loss: tensor(0.3344, device='cuda:0')
batch 67 loss: tensor(0.3617, device='cuda:0')
batch 68 loss: tensor(0.3728, device='cuda:0')
batch 69 loss: tensor(0.3239, device='cuda:0')
batch 70 loss: tensor(0.3280, device='cuda:0')
batch 71 loss: tensor(0.3506, device='cuda:0')
batch 72 loss: tensor(0.3839, device='cuda:0')
batch 73 loss: tensor(0.3744, device='cuda:0')
batch 74 loss: tensor(0.4551, device='cuda:0')
batch 75 loss: tensor(0.3836, device='cuda:0')
batch 76 loss: tensor(0.3369, device='cuda:0')
batch 77 loss: tensor(0.3786, device='cuda:0')
batch 78 loss: tensor(0.3517, device='cuda:0')
batch 79 loss: tensor(0.4324, device='cuda:0')
batch 80 loss: tensor(0.3823, device='cuda:0')
accuracy in val: 0.83671
accuracy in test: 0.886114435736072
average epoch time: 1.7477124124765395
total time: 279.63398599624634
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9367, device='cuda:0')
batch 2 loss: tensor(0.7052, device='cuda:0')
batch 3 loss: tensor(0.7515, device='cuda:0')
batch 4 loss: tensor(0.5812, device='cuda:0')
batch 5 loss: tensor(0.5438, device='cuda:0')
batch 6 loss: tensor(0.5347, device='cuda:0')
batch 7 loss: tensor(0.5412, device='cuda:0')
batch 8 loss: tensor(0.5972, device='cuda:0')
batch 9 loss: tensor(0.6158, device='cuda:0')
batch 10 loss: tensor(0.5547, device='cuda:0')
batch 11 loss: tensor(0.5529, device='cuda:0')
batch 12 loss: tensor(0.5680, device='cuda:0')
batch 13 loss: tensor(0.5509, device='cuda:0')
batch 14 loss: tensor(0.5407, device='cuda:0')
batch 15 loss: tensor(0.5333, device='cuda:0')
batch 16 loss: tensor(0.5574, device='cuda:0')
batch 17 loss: tensor(0.5654, device='cuda:0')
batch 18 loss: tensor(0.4598, device='cuda:0')
batch 19 loss: tensor(0.5011, device='cuda:0')
batch 20 loss: tensor(0.5379, device='cuda:0')
batch 21 loss: tensor(0.4742, device='cuda:0')
batch 22 loss: tensor(0.5100, device='cuda:0')
batch 23 loss: tensor(0.4780, device='cuda:0')
batch 24 loss: tensor(0.4487, device='cuda:0')
batch 25 loss: tensor(0.5060, device='cuda:0')
batch 26 loss: tensor(0.5204, device='cuda:0')
batch 27 loss: tensor(0.4827, device='cuda:0')
batch 28 loss: tensor(0.4797, device='cuda:0')
batch 29 loss: tensor(0.4738, device='cuda:0')
batch 30 loss: tensor(0.5104, device='cuda:0')
batch 31 loss: tensor(0.4788, device='cuda:0')
batch 32 loss: tensor(0.4900, device='cuda:0')
batch 33 loss: tensor(0.4388, device='cuda:0')
batch 34 loss: tensor(0.4508, device='cuda:0')
batch 35 loss: tensor(0.4347, device='cuda:0')
batch 36 loss: tensor(0.4802, device='cuda:0')
batch 37 loss: tensor(0.5125, device='cuda:0')
batch 38 loss: tensor(0.4616, device='cuda:0')
batch 39 loss: tensor(0.5394, device='cuda:0')
batch 40 loss: tensor(0.4410, device='cuda:0')
batch 41 loss: tensor(0.4343, device='cuda:0')
batch 42 loss: tensor(0.5310, device='cuda:0')
batch 43 loss: tensor(0.4978, device='cuda:0')
batch 44 loss: tensor(0.4494, device='cuda:0')
batch 45 loss: tensor(0.4893, device='cuda:0')
batch 46 loss: tensor(0.4219, device='cuda:0')
batch 47 loss: tensor(0.4990, device='cuda:0')
batch 48 loss: tensor(0.5371, device='cuda:0')
batch 49 loss: tensor(0.4723, device='cuda:0')
batch 50 loss: tensor(0.4421, device='cuda:0')
batch 51 loss: tensor(0.4433, device='cuda:0')
batch 52 loss: tensor(0.4919, device='cuda:0')
batch 53 loss: tensor(0.4996, device='cuda:0')
batch 54 loss: tensor(0.4839, device='cuda:0')
batch 55 loss: tensor(0.4645, device='cuda:0')
batch 56 loss: tensor(0.4285, device='cuda:0')
batch 57 loss: tensor(0.4118, device='cuda:0')
batch 58 loss: tensor(0.4731, device='cuda:0')
batch 59 loss: tensor(0.4379, device='cuda:0')
batch 60 loss: tensor(0.5114, device='cuda:0')
batch 61 loss: tensor(0.4866, device='cuda:0')
batch 62 loss: tensor(0.4473, device='cuda:0')
batch 63 loss: tensor(0.4506, device='cuda:0')
batch 64 loss: tensor(0.4453, device='cuda:0')
batch 65 loss: tensor(0.4154, device='cuda:0')
batch 66 loss: tensor(0.4738, device='cuda:0')
batch 67 loss: tensor(0.5047, device='cuda:0')
batch 68 loss: tensor(0.4634, device='cuda:0')
batch 69 loss: tensor(0.4198, device='cuda:0')
batch 70 loss: tensor(0.4836, device='cuda:0')
batch 71 loss: tensor(0.4538, device='cuda:0')
batch 72 loss: tensor(0.5243, device='cuda:0')
batch 73 loss: tensor(0.4588, device='cuda:0')
batch 74 loss: tensor(0.4490, device='cuda:0')
batch 75 loss: tensor(0.3953, device='cuda:0')
batch 76 loss: tensor(0.4519, device='cuda:0')
batch 77 loss: tensor(0.4390, device='cuda:0')
batch 78 loss: tensor(0.4398, device='cuda:0')
batch 79 loss: tensor(0.4528, device='cuda:0')
batch 80 loss: tensor(0.4362, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.4825, device='cuda:0')
batch 2 loss: tensor(0.5544, device='cuda:0')
batch 3 loss: tensor(0.3941, device='cuda:0')
batch 4 loss: tensor(0.3617, device='cuda:0')
batch 5 loss: tensor(0.4165, device='cuda:0')
batch 6 loss: tensor(0.4338, device='cuda:0')
batch 7 loss: tensor(0.3966, device='cuda:0')
batch 8 loss: tensor(0.4018, device='cuda:0')
batch 9 loss: tensor(0.4340, device='cuda:0')
batch 10 loss: tensor(0.3865, device='cuda:0')
batch 11 loss: tensor(0.3889, device='cuda:0')
batch 12 loss: tensor(0.4248, device='cuda:0')
batch 13 loss: tensor(0.3831, device='cuda:0')
batch 14 loss: tensor(0.3699, device='cuda:0')
batch 15 loss: tensor(0.3792, device='cuda:0')
batch 16 loss: tensor(0.4095, device='cuda:0')
batch 17 loss: tensor(0.3382, device='cuda:0')
batch 18 loss: tensor(0.4201, device='cuda:0')
batch 19 loss: tensor(0.4266, device='cuda:0')
batch 20 loss: tensor(0.3303, device='cuda:0')
batch 21 loss: tensor(0.3423, device='cuda:0')
batch 22 loss: tensor(0.4123, device='cuda:0')
batch 23 loss: tensor(0.3642, device='cuda:0')
batch 24 loss: tensor(0.3784, device='cuda:0')
batch 25 loss: tensor(0.3432, device='cuda:0')
batch 26 loss: tensor(0.3873, device='cuda:0')
batch 27 loss: tensor(0.3851, device='cuda:0')
batch 28 loss: tensor(0.4065, device='cuda:0')
batch 29 loss: tensor(0.4016, device='cuda:0')
batch 30 loss: tensor(0.3785, device='cuda:0')
batch 31 loss: tensor(0.3611, device='cuda:0')
batch 32 loss: tensor(0.3594, device='cuda:0')
batch 33 loss: tensor(0.3433, device='cuda:0')
batch 34 loss: tensor(0.3133, device='cuda:0')
batch 35 loss: tensor(0.4399, device='cuda:0')
batch 36 loss: tensor(0.3543, device='cuda:0')
batch 37 loss: tensor(0.3867, device='cuda:0')
batch 38 loss: tensor(0.3614, device='cuda:0')
batch 39 loss: tensor(0.3883, device='cuda:0')
batch 40 loss: tensor(0.3627, device='cuda:0')
batch 41 loss: tensor(0.4128, device='cuda:0')
batch 42 loss: tensor(0.3784, device='cuda:0')
batch 43 loss: tensor(0.3435, device='cuda:0')
batch 44 loss: tensor(0.4098, device='cuda:0')
batch 45 loss: tensor(0.3520, device='cuda:0')
batch 46 loss: tensor(0.3303, device='cuda:0')
batch 47 loss: tensor(0.3846, device='cuda:0')
batch 48 loss: tensor(0.4288, device='cuda:0')
batch 49 loss: tensor(0.4062, device='cuda:0')
batch 50 loss: tensor(0.3748, device='cuda:0')
batch 51 loss: tensor(0.3864, device='cuda:0')
batch 52 loss: tensor(0.3917, device='cuda:0')
batch 53 loss: tensor(0.3391, device='cuda:0')
batch 54 loss: tensor(0.3871, device='cuda:0')
batch 55 loss: tensor(0.3643, device='cuda:0')
batch 56 loss: tensor(0.3772, device='cuda:0')
batch 57 loss: tensor(0.3467, device='cuda:0')
batch 58 loss: tensor(0.4058, device='cuda:0')
batch 59 loss: tensor(0.3537, device='cuda:0')
batch 60 loss: tensor(0.4371, device='cuda:0')
batch 61 loss: tensor(0.4104, device='cuda:0')
batch 62 loss: tensor(0.3680, device='cuda:0')
batch 63 loss: tensor(0.3820, device='cuda:0')
batch 64 loss: tensor(0.3737, device='cuda:0')
batch 65 loss: tensor(0.3922, device='cuda:0')
batch 66 loss: tensor(0.4020, device='cuda:0')
batch 67 loss: tensor(0.3831, device='cuda:0')
batch 68 loss: tensor(0.3806, device='cuda:0')
batch 69 loss: tensor(0.3545, device='cuda:0')
batch 70 loss: tensor(0.4168, device='cuda:0')
batch 71 loss: tensor(0.3188, device='cuda:0')
batch 72 loss: tensor(0.3548, device='cuda:0')
batch 73 loss: tensor(0.3482, device='cuda:0')
batch 74 loss: tensor(0.3327, device='cuda:0')
batch 75 loss: tensor(0.3990, device='cuda:0')
batch 76 loss: tensor(0.3906, device='cuda:0')
batch 77 loss: tensor(0.3382, device='cuda:0')
batch 78 loss: tensor(0.3725, device='cuda:0')
batch 79 loss: tensor(0.3540, device='cuda:0')
batch 80 loss: tensor(0.3745, device='cuda:0')
accuracy in val: 0.83893
accuracy in test: 0.8857862630786456
average epoch time: 1.746891549229622
total time: 279.5026478767395

0.8856429977882818 278.6869841337204
0.00031889602807908245 1.5624753440728247
Thu Nov 21 23:06:16 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |      7%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      2654      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Thu Nov 21 23:35:39 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |     12%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      2654      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 00:05:13 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |     11%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      2654      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 00:34:42 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      2654      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 01:03:58 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    57W / 149W |    335MiB / 12206MiB |     11%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      2654      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 01:33:19 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |     11%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      2654      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 02:02:36 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |     10%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      2654      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 02:31:50 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |     12%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      2654      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 03:01:36 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      2654      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 03:31:10 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |      9%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      2654      C   python                                       303MiB |
|    0     14758      G   /usr/bin/X                                    20MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
{'dataset': 'amazon_3m', 'config_file': 'amazon_3m.yaml', 'layer_num': 2, 'epoch_num': [100, 100]}
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9925, device='cuda:0')
batch 2 loss: tensor(0.7091, device='cuda:0')
batch 3 loss: tensor(0.6199, device='cuda:0')
batch 4 loss: tensor(0.7127, device='cuda:0')
batch 5 loss: tensor(0.6283, device='cuda:0')
batch 6 loss: tensor(0.5583, device='cuda:0')
batch 7 loss: tensor(0.5950, device='cuda:0')
batch 8 loss: tensor(0.5381, device='cuda:0')
batch 9 loss: tensor(0.5799, device='cuda:0')
batch 10 loss: tensor(0.5934, device='cuda:0')
batch 11 loss: tensor(0.5605, device='cuda:0')
batch 12 loss: tensor(0.5496, device='cuda:0')
batch 13 loss: tensor(0.4884, device='cuda:0')
batch 14 loss: tensor(0.5645, device='cuda:0')
batch 15 loss: tensor(0.5060, device='cuda:0')
batch 16 loss: tensor(0.5386, device='cuda:0')
batch 17 loss: tensor(0.4734, device='cuda:0')
batch 18 loss: tensor(0.5027, device='cuda:0')
batch 19 loss: tensor(0.4963, device='cuda:0')
batch 20 loss: tensor(0.4539, device='cuda:0')
batch 21 loss: tensor(0.4839, device='cuda:0')
batch 22 loss: tensor(0.4935, device='cuda:0')
batch 23 loss: tensor(0.4714, device='cuda:0')
batch 24 loss: tensor(0.4351, device='cuda:0')
batch 25 loss: tensor(0.5329, device='cuda:0')
batch 26 loss: tensor(0.4589, device='cuda:0')
batch 27 loss: tensor(0.5158, device='cuda:0')
batch 28 loss: tensor(0.4742, device='cuda:0')
batch 29 loss: tensor(0.4814, device='cuda:0')
batch 30 loss: tensor(0.4705, device='cuda:0')
batch 31 loss: tensor(0.4929, device='cuda:0')
batch 32 loss: tensor(0.4731, device='cuda:0')
batch 33 loss: tensor(0.4581, device='cuda:0')
batch 34 loss: tensor(0.5056, device='cuda:0')
batch 35 loss: tensor(0.4596, device='cuda:0')
batch 36 loss: tensor(0.4340, device='cuda:0')
batch 37 loss: tensor(0.4519, device='cuda:0')
batch 38 loss: tensor(0.4432, device='cuda:0')
batch 39 loss: tensor(0.4837, device='cuda:0')
batch 40 loss: tensor(0.4969, device='cuda:0')
batch 41 loss: tensor(0.4214, device='cuda:0')
batch 42 loss: tensor(0.4430, device='cuda:0')
batch 43 loss: tensor(0.4465, device='cuda:0')
batch 44 loss: tensor(0.4748, device='cuda:0')
batch 45 loss: tensor(0.4291, device='cuda:0')
batch 46 loss: tensor(0.5028, device='cuda:0')
batch 47 loss: tensor(0.3935, device='cuda:0')
batch 48 loss: tensor(0.4514, device='cuda:0')
batch 49 loss: tensor(0.4325, device='cuda:0')
batch 50 loss: tensor(0.4117, device='cuda:0')
batch 51 loss: tensor(0.3905, device='cuda:0')
batch 52 loss: tensor(0.4753, device='cuda:0')
batch 53 loss: tensor(0.4673, device='cuda:0')
batch 54 loss: tensor(0.5720, device='cuda:0')
batch 55 loss: tensor(0.4823, device='cuda:0')
batch 56 loss: tensor(0.4294, device='cuda:0')
batch 57 loss: tensor(0.4970, device='cuda:0')
batch 58 loss: tensor(0.4533, device='cuda:0')
batch 59 loss: tensor(0.5129, device='cuda:0')
batch 60 loss: tensor(0.4986, device='cuda:0')
batch 61 loss: tensor(0.5251, device='cuda:0')
batch 62 loss: tensor(0.5022, device='cuda:0')
batch 63 loss: tensor(0.4124, device='cuda:0')
batch 64 loss: tensor(0.4963, device='cuda:0')
batch 65 loss: tensor(0.4293, device='cuda:0')
batch 66 loss: tensor(0.4820, device='cuda:0')
batch 67 loss: tensor(0.4864, device='cuda:0')
batch 68 loss: tensor(0.5550, device='cuda:0')
batch 69 loss: tensor(0.4356, device='cuda:0')
batch 70 loss: tensor(0.4176, device='cuda:0')
batch 71 loss: tensor(0.4698, device='cuda:0')
batch 72 loss: tensor(0.4930, device='cuda:0')
batch 73 loss: tensor(0.4048, device='cuda:0')
batch 74 loss: tensor(0.4672, device='cuda:0')
batch 75 loss: tensor(0.4473, device='cuda:0')
batch 76 loss: tensor(0.5001, device='cuda:0')
batch 77 loss: tensor(0.4502, device='cuda:0')
batch 78 loss: tensor(0.4096, device='cuda:0')
batch 79 loss: tensor(0.4106, device='cuda:0')
batch 80 loss: tensor(0.4432, device='cuda:0')
batch 81 loss: tensor(0.4348, device='cuda:0')
batch 82 loss: tensor(0.4326, device='cuda:0')
batch 83 loss: tensor(0.4762, device='cuda:0')
batch 84 loss: tensor(0.4406, device='cuda:0')
batch 85 loss: tensor(0.4683, device='cuda:0')
batch 86 loss: tensor(0.4255, device='cuda:0')
batch 87 loss: tensor(0.4781, device='cuda:0')
batch 88 loss: tensor(0.4374, device='cuda:0')
batch 89 loss: tensor(0.4556, device='cuda:0')
batch 90 loss: tensor(0.4692, device='cuda:0')
batch 91 loss: tensor(0.4658, device='cuda:0')
batch 92 loss: tensor(0.4593, device='cuda:0')
batch 93 loss: tensor(0.4475, device='cuda:0')
batch 94 loss: tensor(0.3803, device='cuda:0')
batch 95 loss: tensor(0.5047, device='cuda:0')
batch 96 loss: tensor(0.5000, device='cuda:0')
batch 97 loss: tensor(0.4703, device='cuda:0')
batch 98 loss: tensor(0.3872, device='cuda:0')
batch 99 loss: tensor(0.4366, device='cuda:0')
batch 100 loss: tensor(0.4135, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5035, device='cuda:0')
batch 2 loss: tensor(0.4752, device='cuda:0')
batch 3 loss: tensor(0.4140, device='cuda:0')
batch 4 loss: tensor(0.3935, device='cuda:0')
batch 5 loss: tensor(0.4165, device='cuda:0')
batch 6 loss: tensor(0.4505, device='cuda:0')
batch 7 loss: tensor(0.3928, device='cuda:0')
batch 8 loss: tensor(0.4142, device='cuda:0')
batch 9 loss: tensor(0.4337, device='cuda:0')
batch 10 loss: tensor(0.4298, device='cuda:0')
batch 11 loss: tensor(0.4561, device='cuda:0')
batch 12 loss: tensor(0.3554, device='cuda:0')
batch 13 loss: tensor(0.3982, device='cuda:0')
batch 14 loss: tensor(0.3653, device='cuda:0')
batch 15 loss: tensor(0.3839, device='cuda:0')
batch 16 loss: tensor(0.3754, device='cuda:0')
batch 17 loss: tensor(0.4248, device='cuda:0')
batch 18 loss: tensor(0.4013, device='cuda:0')
batch 19 loss: tensor(0.3649, device='cuda:0')
batch 20 loss: tensor(0.4311, device='cuda:0')
batch 21 loss: tensor(0.4133, device='cuda:0')
batch 22 loss: tensor(0.3953, device='cuda:0')
batch 23 loss: tensor(0.3946, device='cuda:0')
batch 24 loss: tensor(0.3805, device='cuda:0')
batch 25 loss: tensor(0.3781, device='cuda:0')
batch 26 loss: tensor(0.4172, device='cuda:0')
batch 27 loss: tensor(0.3473, device='cuda:0')
batch 28 loss: tensor(0.3399, device='cuda:0')
batch 29 loss: tensor(0.3405, device='cuda:0')
batch 30 loss: tensor(0.3892, device='cuda:0')
batch 31 loss: tensor(0.3282, device='cuda:0')
batch 32 loss: tensor(0.4150, device='cuda:0')
batch 33 loss: tensor(0.3997, device='cuda:0')
batch 34 loss: tensor(0.3518, device='cuda:0')
batch 35 loss: tensor(0.3956, device='cuda:0')
batch 36 loss: tensor(0.4500, device='cuda:0')
batch 37 loss: tensor(0.3903, device='cuda:0')
batch 38 loss: tensor(0.3601, device='cuda:0')
batch 39 loss: tensor(0.3608, device='cuda:0')
batch 40 loss: tensor(0.3138, device='cuda:0')
batch 41 loss: tensor(0.3947, device='cuda:0')
batch 42 loss: tensor(0.3869, device='cuda:0')
batch 43 loss: tensor(0.3412, device='cuda:0')
batch 44 loss: tensor(0.3825, device='cuda:0')
batch 45 loss: tensor(0.3950, device='cuda:0')
batch 46 loss: tensor(0.3684, device='cuda:0')
batch 47 loss: tensor(0.3596, device='cuda:0')
batch 48 loss: tensor(0.4284, device='cuda:0')
batch 49 loss: tensor(0.4083, device='cuda:0')
batch 50 loss: tensor(0.3692, device='cuda:0')
batch 51 loss: tensor(0.3463, device='cuda:0')
batch 52 loss: tensor(0.3693, device='cuda:0')
batch 53 loss: tensor(0.3469, device='cuda:0')
batch 54 loss: tensor(0.3489, device='cuda:0')
batch 55 loss: tensor(0.3757, device='cuda:0')
batch 56 loss: tensor(0.4277, device='cuda:0')
batch 57 loss: tensor(0.3935, device='cuda:0')
batch 58 loss: tensor(0.4117, device='cuda:0')
batch 59 loss: tensor(0.3076, device='cuda:0')
batch 60 loss: tensor(0.3291, device='cuda:0')
batch 61 loss: tensor(0.3636, device='cuda:0')
batch 62 loss: tensor(0.3517, device='cuda:0')
batch 63 loss: tensor(0.3437, device='cuda:0')
batch 64 loss: tensor(0.3747, device='cuda:0')
batch 65 loss: tensor(0.3871, device='cuda:0')
batch 66 loss: tensor(0.3629, device='cuda:0')
batch 67 loss: tensor(0.3519, device='cuda:0')
batch 68 loss: tensor(0.3711, device='cuda:0')
batch 69 loss: tensor(0.3450, device='cuda:0')
batch 70 loss: tensor(0.3601, device='cuda:0')
batch 71 loss: tensor(0.3458, device='cuda:0')
batch 72 loss: tensor(0.3621, device='cuda:0')
batch 73 loss: tensor(0.3667, device='cuda:0')
batch 74 loss: tensor(0.3433, device='cuda:0')
batch 75 loss: tensor(0.4210, device='cuda:0')
batch 76 loss: tensor(0.3733, device='cuda:0')
batch 77 loss: tensor(0.3533, device='cuda:0')
batch 78 loss: tensor(0.3998, device='cuda:0')
batch 79 loss: tensor(0.3371, device='cuda:0')
batch 80 loss: tensor(0.3839, device='cuda:0')
batch 81 loss: tensor(0.3323, device='cuda:0')
batch 82 loss: tensor(0.3430, device='cuda:0')
batch 83 loss: tensor(0.3617, device='cuda:0')
batch 84 loss: tensor(0.3491, device='cuda:0')
batch 85 loss: tensor(0.3278, device='cuda:0')
batch 86 loss: tensor(0.3505, device='cuda:0')
batch 87 loss: tensor(0.3594, device='cuda:0')
batch 88 loss: tensor(0.3440, device='cuda:0')
batch 89 loss: tensor(0.3615, device='cuda:0')
batch 90 loss: tensor(0.3877, device='cuda:0')
batch 91 loss: tensor(0.3420, device='cuda:0')
batch 92 loss: tensor(0.3757, device='cuda:0')
batch 93 loss: tensor(0.3476, device='cuda:0')
batch 94 loss: tensor(0.4084, device='cuda:0')
batch 95 loss: tensor(0.3327, device='cuda:0')
batch 96 loss: tensor(0.3425, device='cuda:0')
batch 97 loss: tensor(0.3428, device='cuda:0')
batch 98 loss: tensor(0.3756, device='cuda:0')
batch 99 loss: tensor(0.3622, device='cuda:0')
batch 100 loss: tensor(0.3552, device='cuda:0')
accuracy in val: 0.8393133333333334
accuracy in test: 0.8868507559002134
average epoch time: 1.7840892612934112
total time: 356.81785225868225
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9650, device='cuda:0')
batch 2 loss: tensor(0.7997, device='cuda:0')
batch 3 loss: tensor(0.6127, device='cuda:0')
batch 4 loss: tensor(0.6613, device='cuda:0')
batch 5 loss: tensor(0.5608, device='cuda:0')
batch 6 loss: tensor(0.5189, device='cuda:0')
batch 7 loss: tensor(0.6004, device='cuda:0')
batch 8 loss: tensor(0.5694, device='cuda:0')
batch 9 loss: tensor(0.5247, device='cuda:0')
batch 10 loss: tensor(0.5353, device='cuda:0')
batch 11 loss: tensor(0.5901, device='cuda:0')
batch 12 loss: tensor(0.5235, device='cuda:0')
batch 13 loss: tensor(0.4975, device='cuda:0')
batch 14 loss: tensor(0.5504, device='cuda:0')
batch 15 loss: tensor(0.5018, device='cuda:0')
batch 16 loss: tensor(0.6032, device='cuda:0')
batch 17 loss: tensor(0.4670, device='cuda:0')
batch 18 loss: tensor(0.4556, device='cuda:0')
batch 19 loss: tensor(0.4611, device='cuda:0')
batch 20 loss: tensor(0.4692, device='cuda:0')
batch 21 loss: tensor(0.5574, device='cuda:0')
batch 22 loss: tensor(0.4859, device='cuda:0')
batch 23 loss: tensor(0.4934, device='cuda:0')
batch 24 loss: tensor(0.4570, device='cuda:0')
batch 25 loss: tensor(0.4983, device='cuda:0')
batch 26 loss: tensor(0.4450, device='cuda:0')
batch 27 loss: tensor(0.4343, device='cuda:0')
batch 28 loss: tensor(0.5545, device='cuda:0')
batch 29 loss: tensor(0.5522, device='cuda:0')
batch 30 loss: tensor(0.5095, device='cuda:0')
batch 31 loss: tensor(0.4482, device='cuda:0')
batch 32 loss: tensor(0.4436, device='cuda:0')
batch 33 loss: tensor(0.5026, device='cuda:0')
batch 34 loss: tensor(0.4499, device='cuda:0')
batch 35 loss: tensor(0.4644, device='cuda:0')
batch 36 loss: tensor(0.4673, device='cuda:0')
batch 37 loss: tensor(0.4860, device='cuda:0')
batch 38 loss: tensor(0.4478, device='cuda:0')
batch 39 loss: tensor(0.4534, device='cuda:0')
batch 40 loss: tensor(0.5430, device='cuda:0')
batch 41 loss: tensor(0.4772, device='cuda:0')
batch 42 loss: tensor(0.4279, device='cuda:0')
batch 43 loss: tensor(0.4746, device='cuda:0')
batch 44 loss: tensor(0.4778, device='cuda:0')
batch 45 loss: tensor(0.4893, device='cuda:0')
batch 46 loss: tensor(0.4691, device='cuda:0')
batch 47 loss: tensor(0.4774, device='cuda:0')
batch 48 loss: tensor(0.4249, device='cuda:0')
batch 49 loss: tensor(0.4398, device='cuda:0')
batch 50 loss: tensor(0.4812, device='cuda:0')
batch 51 loss: tensor(0.4537, device='cuda:0')
batch 52 loss: tensor(0.4852, device='cuda:0')
batch 53 loss: tensor(0.5154, device='cuda:0')
batch 54 loss: tensor(0.4603, device='cuda:0')
batch 55 loss: tensor(0.5003, device='cuda:0')
batch 56 loss: tensor(0.4554, device='cuda:0')
batch 57 loss: tensor(0.4670, device='cuda:0')
batch 58 loss: tensor(0.4523, device='cuda:0')
batch 59 loss: tensor(0.5004, device='cuda:0')
batch 60 loss: tensor(0.4961, device='cuda:0')
batch 61 loss: tensor(0.4196, device='cuda:0')
batch 62 loss: tensor(0.4616, device='cuda:0')
batch 63 loss: tensor(0.4684, device='cuda:0')
batch 64 loss: tensor(0.4104, device='cuda:0')
batch 65 loss: tensor(0.4002, device='cuda:0')
batch 66 loss: tensor(0.4429, device='cuda:0')
batch 67 loss: tensor(0.5206, device='cuda:0')
batch 68 loss: tensor(0.4420, device='cuda:0')
batch 69 loss: tensor(0.4556, device='cuda:0')
batch 70 loss: tensor(0.4138, device='cuda:0')
batch 71 loss: tensor(0.5063, device='cuda:0')
batch 72 loss: tensor(0.4257, device='cuda:0')
batch 73 loss: tensor(0.4206, device='cuda:0')
batch 74 loss: tensor(0.4788, device='cuda:0')
batch 75 loss: tensor(0.4871, device='cuda:0')
batch 76 loss: tensor(0.4358, device='cuda:0')
batch 77 loss: tensor(0.4345, device='cuda:0')
batch 78 loss: tensor(0.4891, device='cuda:0')
batch 79 loss: tensor(0.4753, device='cuda:0')
batch 80 loss: tensor(0.4230, device='cuda:0')
batch 81 loss: tensor(0.4632, device='cuda:0')
batch 82 loss: tensor(0.4403, device='cuda:0')
batch 83 loss: tensor(0.4466, device='cuda:0')
batch 84 loss: tensor(0.4874, device='cuda:0')
batch 85 loss: tensor(0.4238, device='cuda:0')
batch 86 loss: tensor(0.4058, device='cuda:0')
batch 87 loss: tensor(0.4574, device='cuda:0')
batch 88 loss: tensor(0.4707, device='cuda:0')
batch 89 loss: tensor(0.5618, device='cuda:0')
batch 90 loss: tensor(0.4893, device='cuda:0')
batch 91 loss: tensor(0.4827, device='cuda:0')
batch 92 loss: tensor(0.4522, device='cuda:0')
batch 93 loss: tensor(0.4171, device='cuda:0')
batch 94 loss: tensor(0.4174, device='cuda:0')
batch 95 loss: tensor(0.4408, device='cuda:0')
batch 96 loss: tensor(0.4953, device='cuda:0')
batch 97 loss: tensor(0.4635, device='cuda:0')
batch 98 loss: tensor(0.4598, device='cuda:0')
batch 99 loss: tensor(0.4754, device='cuda:0')
batch 100 loss: tensor(0.4175, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5733, device='cuda:0')
batch 2 loss: tensor(0.4851, device='cuda:0')
batch 3 loss: tensor(0.4341, device='cuda:0')
batch 4 loss: tensor(0.3625, device='cuda:0')
batch 5 loss: tensor(0.4068, device='cuda:0')
batch 6 loss: tensor(0.3976, device='cuda:0')
batch 7 loss: tensor(0.3847, device='cuda:0')
batch 8 loss: tensor(0.3835, device='cuda:0')
batch 9 loss: tensor(0.4120, device='cuda:0')
batch 10 loss: tensor(0.3999, device='cuda:0')
batch 11 loss: tensor(0.3843, device='cuda:0')
batch 12 loss: tensor(0.4058, device='cuda:0')
batch 13 loss: tensor(0.4615, device='cuda:0')
batch 14 loss: tensor(0.3640, device='cuda:0')
batch 15 loss: tensor(0.3798, device='cuda:0')
batch 16 loss: tensor(0.3983, device='cuda:0')
batch 17 loss: tensor(0.4902, device='cuda:0')
batch 18 loss: tensor(0.4063, device='cuda:0')
batch 19 loss: tensor(0.3501, device='cuda:0')
batch 20 loss: tensor(0.4674, device='cuda:0')
batch 21 loss: tensor(0.3466, device='cuda:0')
batch 22 loss: tensor(0.3280, device='cuda:0')
batch 23 loss: tensor(0.4287, device='cuda:0')
batch 24 loss: tensor(0.3480, device='cuda:0')
batch 25 loss: tensor(0.4305, device='cuda:0')
batch 26 loss: tensor(0.3795, device='cuda:0')
batch 27 loss: tensor(0.4234, device='cuda:0')
batch 28 loss: tensor(0.3625, device='cuda:0')
batch 29 loss: tensor(0.3554, device='cuda:0')
batch 30 loss: tensor(0.3612, device='cuda:0')
batch 31 loss: tensor(0.3800, device='cuda:0')
batch 32 loss: tensor(0.3469, device='cuda:0')
batch 33 loss: tensor(0.3612, device='cuda:0')
batch 34 loss: tensor(0.4144, device='cuda:0')
batch 35 loss: tensor(0.4491, device='cuda:0')
batch 36 loss: tensor(0.4019, device='cuda:0')
batch 37 loss: tensor(0.3953, device='cuda:0')
batch 38 loss: tensor(0.3367, device='cuda:0')
batch 39 loss: tensor(0.3508, device='cuda:0')
batch 40 loss: tensor(0.3292, device='cuda:0')
batch 41 loss: tensor(0.4210, device='cuda:0')
batch 42 loss: tensor(0.3514, device='cuda:0')
batch 43 loss: tensor(0.3462, device='cuda:0')
batch 44 loss: tensor(0.3349, device='cuda:0')
batch 45 loss: tensor(0.3586, device='cuda:0')
batch 46 loss: tensor(0.3571, device='cuda:0')
batch 47 loss: tensor(0.4140, device='cuda:0')
batch 48 loss: tensor(0.3260, device='cuda:0')
batch 49 loss: tensor(0.3194, device='cuda:0')
batch 50 loss: tensor(0.3555, device='cuda:0')
batch 51 loss: tensor(0.3948, device='cuda:0')
batch 52 loss: tensor(0.3720, device='cuda:0')
batch 53 loss: tensor(0.3604, device='cuda:0')
batch 54 loss: tensor(0.3938, device='cuda:0')
batch 55 loss: tensor(0.4062, device='cuda:0')
batch 56 loss: tensor(0.3402, device='cuda:0')
batch 57 loss: tensor(0.3918, device='cuda:0')
batch 58 loss: tensor(0.3482, device='cuda:0')
batch 59 loss: tensor(0.3570, device='cuda:0')
batch 60 loss: tensor(0.4067, device='cuda:0')
batch 61 loss: tensor(0.3782, device='cuda:0')
batch 62 loss: tensor(0.3132, device='cuda:0')
batch 63 loss: tensor(0.3501, device='cuda:0')
batch 64 loss: tensor(0.3966, device='cuda:0')
batch 65 loss: tensor(0.3824, device='cuda:0')
batch 66 loss: tensor(0.4119, device='cuda:0')
batch 67 loss: tensor(0.3296, device='cuda:0')
batch 68 loss: tensor(0.3895, device='cuda:0')
batch 69 loss: tensor(0.3262, device='cuda:0')
batch 70 loss: tensor(0.3031, device='cuda:0')
batch 71 loss: tensor(0.3907, device='cuda:0')
batch 72 loss: tensor(0.3230, device='cuda:0')
batch 73 loss: tensor(0.3603, device='cuda:0')
batch 74 loss: tensor(0.2936, device='cuda:0')
batch 75 loss: tensor(0.3261, device='cuda:0')
batch 76 loss: tensor(0.3950, device='cuda:0')
batch 77 loss: tensor(0.3579, device='cuda:0')
batch 78 loss: tensor(0.3959, device='cuda:0')
batch 79 loss: tensor(0.3749, device='cuda:0')
batch 80 loss: tensor(0.3752, device='cuda:0')
batch 81 loss: tensor(0.3841, device='cuda:0')
batch 82 loss: tensor(0.3471, device='cuda:0')
batch 83 loss: tensor(0.3983, device='cuda:0')
batch 84 loss: tensor(0.3795, device='cuda:0')
batch 85 loss: tensor(0.3289, device='cuda:0')
batch 86 loss: tensor(0.3297, device='cuda:0')
batch 87 loss: tensor(0.4200, device='cuda:0')
batch 88 loss: tensor(0.3633, device='cuda:0')
batch 89 loss: tensor(0.3751, device='cuda:0')
batch 90 loss: tensor(0.3900, device='cuda:0')
batch 91 loss: tensor(0.3863, device='cuda:0')
batch 92 loss: tensor(0.2942, device='cuda:0')
batch 93 loss: tensor(0.3800, device='cuda:0')
batch 94 loss: tensor(0.3399, device='cuda:0')
batch 95 loss: tensor(0.3791, device='cuda:0')
batch 96 loss: tensor(0.3866, device='cuda:0')
batch 97 loss: tensor(0.3720, device='cuda:0')
batch 98 loss: tensor(0.4013, device='cuda:0')
batch 99 loss: tensor(0.3441, device='cuda:0')
batch 100 loss: tensor(0.3522, device='cuda:0')
accuracy in val: 0.8379566666666667
accuracy in test: 0.8862040627223439
average epoch time: 1.7539499282836915
total time: 350.7899856567383
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.8757, device='cuda:0')
batch 2 loss: tensor(0.7549, device='cuda:0')
batch 3 loss: tensor(0.6479, device='cuda:0')
batch 4 loss: tensor(0.6459, device='cuda:0')
batch 5 loss: tensor(0.6122, device='cuda:0')
batch 6 loss: tensor(0.6440, device='cuda:0')
batch 7 loss: tensor(0.5750, device='cuda:0')
batch 8 loss: tensor(0.5236, device='cuda:0')
batch 9 loss: tensor(0.5260, device='cuda:0')
batch 10 loss: tensor(0.5415, device='cuda:0')
batch 11 loss: tensor(0.5051, device='cuda:0')
batch 12 loss: tensor(0.5792, device='cuda:0')
batch 13 loss: tensor(0.5128, device='cuda:0')
batch 14 loss: tensor(0.4948, device='cuda:0')
batch 15 loss: tensor(0.4927, device='cuda:0')
batch 16 loss: tensor(0.5885, device='cuda:0')
batch 17 loss: tensor(0.4662, device='cuda:0')
batch 18 loss: tensor(0.4803, device='cuda:0')
batch 19 loss: tensor(0.5685, device='cuda:0')
batch 20 loss: tensor(0.4518, device='cuda:0')
batch 21 loss: tensor(0.5616, device='cuda:0')
batch 22 loss: tensor(0.4835, device='cuda:0')
batch 23 loss: tensor(0.4938, device='cuda:0')
batch 24 loss: tensor(0.5302, device='cuda:0')
batch 25 loss: tensor(0.4774, device='cuda:0')
batch 26 loss: tensor(0.5454, device='cuda:0')
batch 27 loss: tensor(0.4455, device='cuda:0')
batch 28 loss: tensor(0.4688, device='cuda:0')
batch 29 loss: tensor(0.4894, device='cuda:0')
batch 30 loss: tensor(0.4811, device='cuda:0')
batch 31 loss: tensor(0.4820, device='cuda:0')
batch 32 loss: tensor(0.4872, device='cuda:0')
batch 33 loss: tensor(0.4752, device='cuda:0')
batch 34 loss: tensor(0.5000, device='cuda:0')
batch 35 loss: tensor(0.4837, device='cuda:0')
batch 36 loss: tensor(0.4974, device='cuda:0')
batch 37 loss: tensor(0.4190, device='cuda:0')
batch 38 loss: tensor(0.4455, device='cuda:0')
batch 39 loss: tensor(0.4666, device='cuda:0')
batch 40 loss: tensor(0.4456, device='cuda:0')
batch 41 loss: tensor(0.4754, device='cuda:0')
batch 42 loss: tensor(0.5122, device='cuda:0')
batch 43 loss: tensor(0.4625, device='cuda:0')
batch 44 loss: tensor(0.4795, device='cuda:0')
batch 45 loss: tensor(0.4800, device='cuda:0')
batch 46 loss: tensor(0.4206, device='cuda:0')
batch 47 loss: tensor(0.5119, device='cuda:0')
batch 48 loss: tensor(0.4966, device='cuda:0')
batch 49 loss: tensor(0.5172, device='cuda:0')
batch 50 loss: tensor(0.4633, device='cuda:0')
batch 51 loss: tensor(0.4833, device='cuda:0')
batch 52 loss: tensor(0.4255, device='cuda:0')
batch 53 loss: tensor(0.4799, device='cuda:0')
batch 54 loss: tensor(0.5992, device='cuda:0')
batch 55 loss: tensor(0.4627, device='cuda:0')
batch 56 loss: tensor(0.5018, device='cuda:0')
batch 57 loss: tensor(0.4244, device='cuda:0')
batch 58 loss: tensor(0.5031, device='cuda:0')
batch 59 loss: tensor(0.4499, device='cuda:0')
batch 60 loss: tensor(0.4309, device='cuda:0')
batch 61 loss: tensor(0.5341, device='cuda:0')
batch 62 loss: tensor(0.4686, device='cuda:0')
batch 63 loss: tensor(0.4753, device='cuda:0')
batch 64 loss: tensor(0.4670, device='cuda:0')
batch 65 loss: tensor(0.4553, device='cuda:0')
batch 66 loss: tensor(0.4480, device='cuda:0')
batch 67 loss: tensor(0.4735, device='cuda:0')
batch 68 loss: tensor(0.4299, device='cuda:0')
batch 69 loss: tensor(0.4610, device='cuda:0')
batch 70 loss: tensor(0.4299, device='cuda:0')
batch 71 loss: tensor(0.4541, device='cuda:0')
batch 72 loss: tensor(0.4827, device='cuda:0')
batch 73 loss: tensor(0.3699, device='cuda:0')
batch 74 loss: tensor(0.4824, device='cuda:0')
batch 75 loss: tensor(0.4489, device='cuda:0')
batch 76 loss: tensor(0.4197, device='cuda:0')
batch 77 loss: tensor(0.4877, device='cuda:0')
batch 78 loss: tensor(0.4538, device='cuda:0')
batch 79 loss: tensor(0.4744, device='cuda:0')
batch 80 loss: tensor(0.4654, device='cuda:0')
batch 81 loss: tensor(0.5141, device='cuda:0')
batch 82 loss: tensor(0.4725, device='cuda:0')
batch 83 loss: tensor(0.4599, device='cuda:0')
batch 84 loss: tensor(0.5010, device='cuda:0')
batch 85 loss: tensor(0.4914, device='cuda:0')
batch 86 loss: tensor(0.4254, device='cuda:0')
batch 87 loss: tensor(0.4128, device='cuda:0')
batch 88 loss: tensor(0.4976, device='cuda:0')
batch 89 loss: tensor(0.4562, device='cuda:0')
batch 90 loss: tensor(0.4505, device='cuda:0')
batch 91 loss: tensor(0.4256, device='cuda:0')
batch 92 loss: tensor(0.4487, device='cuda:0')
batch 93 loss: tensor(0.4302, device='cuda:0')
batch 94 loss: tensor(0.3941, device='cuda:0')
batch 95 loss: tensor(0.4013, device='cuda:0')
batch 96 loss: tensor(0.4487, device='cuda:0')
batch 97 loss: tensor(0.4893, device='cuda:0')
batch 98 loss: tensor(0.4192, device='cuda:0')
batch 99 loss: tensor(0.4581, device='cuda:0')
batch 100 loss: tensor(0.4170, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5036, device='cuda:0')
batch 2 loss: tensor(0.3997, device='cuda:0')
batch 3 loss: tensor(0.3248, device='cuda:0')
batch 4 loss: tensor(0.4431, device='cuda:0')
batch 5 loss: tensor(0.4139, device='cuda:0')
batch 6 loss: tensor(0.4336, device='cuda:0')
batch 7 loss: tensor(0.3739, device='cuda:0')
batch 8 loss: tensor(0.4054, device='cuda:0')
batch 9 loss: tensor(0.4081, device='cuda:0')
batch 10 loss: tensor(0.3533, device='cuda:0')
batch 11 loss: tensor(0.3525, device='cuda:0')
batch 12 loss: tensor(0.4274, device='cuda:0')
batch 13 loss: tensor(0.3773, device='cuda:0')
batch 14 loss: tensor(0.3772, device='cuda:0')
batch 15 loss: tensor(0.3824, device='cuda:0')
batch 16 loss: tensor(0.4229, device='cuda:0')
batch 17 loss: tensor(0.4029, device='cuda:0')
batch 18 loss: tensor(0.4119, device='cuda:0')
batch 19 loss: tensor(0.4142, device='cuda:0')
batch 20 loss: tensor(0.3864, device='cuda:0')
batch 21 loss: tensor(0.3801, device='cuda:0')
batch 22 loss: tensor(0.3738, device='cuda:0')
batch 23 loss: tensor(0.3290, device='cuda:0')
batch 24 loss: tensor(0.3561, device='cuda:0')
batch 25 loss: tensor(0.3930, device='cuda:0')
batch 26 loss: tensor(0.3841, device='cuda:0')
batch 27 loss: tensor(0.3889, device='cuda:0')
batch 28 loss: tensor(0.3674, device='cuda:0')
batch 29 loss: tensor(0.3968, device='cuda:0')
batch 30 loss: tensor(0.3663, device='cuda:0')
batch 31 loss: tensor(0.3829, device='cuda:0')
batch 32 loss: tensor(0.3265, device='cuda:0')
batch 33 loss: tensor(0.3768, device='cuda:0')
batch 34 loss: tensor(0.3661, device='cuda:0')
batch 35 loss: tensor(0.3609, device='cuda:0')
batch 36 loss: tensor(0.3375, device='cuda:0')
batch 37 loss: tensor(0.3691, device='cuda:0')
batch 38 loss: tensor(0.3827, device='cuda:0')
batch 39 loss: tensor(0.3383, device='cuda:0')
batch 40 loss: tensor(0.4186, device='cuda:0')
batch 41 loss: tensor(0.4174, device='cuda:0')
batch 42 loss: tensor(0.2804, device='cuda:0')
batch 43 loss: tensor(0.4080, device='cuda:0')
batch 44 loss: tensor(0.3530, device='cuda:0')
batch 45 loss: tensor(0.3245, device='cuda:0')
batch 46 loss: tensor(0.3654, device='cuda:0')
batch 47 loss: tensor(0.3457, device='cuda:0')
batch 48 loss: tensor(0.4079, device='cuda:0')
batch 49 loss: tensor(0.4056, device='cuda:0')
batch 50 loss: tensor(0.3430, device='cuda:0')
batch 51 loss: tensor(0.3890, device='cuda:0')
batch 52 loss: tensor(0.3131, device='cuda:0')
batch 53 loss: tensor(0.3555, device='cuda:0')
batch 54 loss: tensor(0.3243, device='cuda:0')
batch 55 loss: tensor(0.3537, device='cuda:0')
batch 56 loss: tensor(0.4177, device='cuda:0')
batch 57 loss: tensor(0.3720, device='cuda:0')
batch 58 loss: tensor(0.3425, device='cuda:0')
batch 59 loss: tensor(0.3282, device='cuda:0')
batch 60 loss: tensor(0.3276, device='cuda:0')
batch 61 loss: tensor(0.3568, device='cuda:0')
batch 62 loss: tensor(0.3174, device='cuda:0')
batch 63 loss: tensor(0.3353, device='cuda:0')
batch 64 loss: tensor(0.3890, device='cuda:0')
batch 65 loss: tensor(0.4111, device='cuda:0')
batch 66 loss: tensor(0.3591, device='cuda:0')
batch 67 loss: tensor(0.3674, device='cuda:0')
batch 68 loss: tensor(0.3383, device='cuda:0')
batch 69 loss: tensor(0.3669, device='cuda:0')
batch 70 loss: tensor(0.3095, device='cuda:0')
batch 71 loss: tensor(0.3782, device='cuda:0')
batch 72 loss: tensor(0.3504, device='cuda:0')
batch 73 loss: tensor(0.3478, device='cuda:0')
batch 74 loss: tensor(0.3153, device='cuda:0')
batch 75 loss: tensor(0.3344, device='cuda:0')
batch 76 loss: tensor(0.4149, device='cuda:0')
batch 77 loss: tensor(0.3809, device='cuda:0')
batch 78 loss: tensor(0.3204, device='cuda:0')
batch 79 loss: tensor(0.3511, device='cuda:0')
batch 80 loss: tensor(0.3528, device='cuda:0')
batch 81 loss: tensor(0.3362, device='cuda:0')
batch 82 loss: tensor(0.3730, device='cuda:0')
batch 83 loss: tensor(0.3759, device='cuda:0')
batch 84 loss: tensor(0.3605, device='cuda:0')
batch 85 loss: tensor(0.4061, device='cuda:0')
batch 86 loss: tensor(0.3897, device='cuda:0')
batch 87 loss: tensor(0.3736, device='cuda:0')
batch 88 loss: tensor(0.4225, device='cuda:0')
batch 89 loss: tensor(0.3428, device='cuda:0')
batch 90 loss: tensor(0.3492, device='cuda:0')
batch 91 loss: tensor(0.3273, device='cuda:0')
batch 92 loss: tensor(0.3355, device='cuda:0')
batch 93 loss: tensor(0.3264, device='cuda:0')
batch 94 loss: tensor(0.4451, device='cuda:0')
batch 95 loss: tensor(0.3630, device='cuda:0')
batch 96 loss: tensor(0.3230, device='cuda:0')
batch 97 loss: tensor(0.3785, device='cuda:0')
batch 98 loss: tensor(0.3571, device='cuda:0')
batch 99 loss: tensor(0.3499, device='cuda:0')
batch 100 loss: tensor(0.3390, device='cuda:0')
accuracy in val: 0.8382633333333334
accuracy in test: 0.8862495656538357
average epoch time: 1.7501169157028198
total time: 350.02338314056396
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0219, device='cuda:0')
batch 2 loss: tensor(0.7932, device='cuda:0')
batch 3 loss: tensor(0.6715, device='cuda:0')
batch 4 loss: tensor(0.6398, device='cuda:0')
batch 5 loss: tensor(0.5342, device='cuda:0')
batch 6 loss: tensor(0.5085, device='cuda:0')
batch 7 loss: tensor(0.5902, device='cuda:0')
batch 8 loss: tensor(0.5967, device='cuda:0')
batch 9 loss: tensor(0.5492, device='cuda:0')
batch 10 loss: tensor(0.5432, device='cuda:0')
batch 11 loss: tensor(0.5239, device='cuda:0')
batch 12 loss: tensor(0.5346, device='cuda:0')
batch 13 loss: tensor(0.5320, device='cuda:0')
batch 14 loss: tensor(0.5738, device='cuda:0')
batch 15 loss: tensor(0.5728, device='cuda:0')
batch 16 loss: tensor(0.4786, device='cuda:0')
batch 17 loss: tensor(0.5080, device='cuda:0')
batch 18 loss: tensor(0.4729, device='cuda:0')
batch 19 loss: tensor(0.4740, device='cuda:0')
batch 20 loss: tensor(0.5145, device='cuda:0')
batch 21 loss: tensor(0.5004, device='cuda:0')
batch 22 loss: tensor(0.4940, device='cuda:0')
batch 23 loss: tensor(0.4072, device='cuda:0')
batch 24 loss: tensor(0.4369, device='cuda:0')
batch 25 loss: tensor(0.4294, device='cuda:0')
batch 26 loss: tensor(0.5166, device='cuda:0')
batch 27 loss: tensor(0.4543, device='cuda:0')
batch 28 loss: tensor(0.5446, device='cuda:0')
batch 29 loss: tensor(0.5133, device='cuda:0')
batch 30 loss: tensor(0.4756, device='cuda:0')
batch 31 loss: tensor(0.4731, device='cuda:0')
batch 32 loss: tensor(0.4782, device='cuda:0')
batch 33 loss: tensor(0.5379, device='cuda:0')
batch 34 loss: tensor(0.5165, device='cuda:0')
batch 35 loss: tensor(0.4207, device='cuda:0')
batch 36 loss: tensor(0.4626, device='cuda:0')
batch 37 loss: tensor(0.4770, device='cuda:0')
batch 38 loss: tensor(0.4566, device='cuda:0')
batch 39 loss: tensor(0.5439, device='cuda:0')
batch 40 loss: tensor(0.4446, device='cuda:0')
batch 41 loss: tensor(0.5344, device='cuda:0')
batch 42 loss: tensor(0.5467, device='cuda:0')
batch 43 loss: tensor(0.4710, device='cuda:0')
batch 44 loss: tensor(0.5015, device='cuda:0')
batch 45 loss: tensor(0.5347, device='cuda:0')
batch 46 loss: tensor(0.4656, device='cuda:0')
batch 47 loss: tensor(0.4810, device='cuda:0')
batch 48 loss: tensor(0.4540, device='cuda:0')
batch 49 loss: tensor(0.4538, device='cuda:0')
batch 50 loss: tensor(0.4300, device='cuda:0')
batch 51 loss: tensor(0.4439, device='cuda:0')
batch 52 loss: tensor(0.4246, device='cuda:0')
batch 53 loss: tensor(0.4480, device='cuda:0')
batch 54 loss: tensor(0.4370, device='cuda:0')
batch 55 loss: tensor(0.3967, device='cuda:0')
batch 56 loss: tensor(0.4902, device='cuda:0')
batch 57 loss: tensor(0.4400, device='cuda:0')
batch 58 loss: tensor(0.5236, device='cuda:0')
batch 59 loss: tensor(0.4124, device='cuda:0')
batch 60 loss: tensor(0.3888, device='cuda:0')
batch 61 loss: tensor(0.4473, device='cuda:0')
batch 62 loss: tensor(0.4476, device='cuda:0')
batch 63 loss: tensor(0.5210, device='cuda:0')
batch 64 loss: tensor(0.5296, device='cuda:0')
batch 65 loss: tensor(0.4122, device='cuda:0')
batch 66 loss: tensor(0.4790, device='cuda:0')
batch 67 loss: tensor(0.4279, device='cuda:0')
batch 68 loss: tensor(0.4514, device='cuda:0')
batch 69 loss: tensor(0.4487, device='cuda:0')
batch 70 loss: tensor(0.4858, device='cuda:0')
batch 71 loss: tensor(0.4626, device='cuda:0')
batch 72 loss: tensor(0.4732, device='cuda:0')
batch 73 loss: tensor(0.4689, device='cuda:0')
batch 74 loss: tensor(0.4510, device='cuda:0')
batch 75 loss: tensor(0.4204, device='cuda:0')
batch 76 loss: tensor(0.4538, device='cuda:0')
batch 77 loss: tensor(0.4820, device='cuda:0')
batch 78 loss: tensor(0.4948, device='cuda:0')
batch 79 loss: tensor(0.4875, device='cuda:0')
batch 80 loss: tensor(0.4310, device='cuda:0')
batch 81 loss: tensor(0.3974, device='cuda:0')
batch 82 loss: tensor(0.4239, device='cuda:0')
batch 83 loss: tensor(0.4648, device='cuda:0')
batch 84 loss: tensor(0.4688, device='cuda:0')
batch 85 loss: tensor(0.4125, device='cuda:0')
batch 86 loss: tensor(0.4269, device='cuda:0')
batch 87 loss: tensor(0.4181, device='cuda:0')
batch 88 loss: tensor(0.4424, device='cuda:0')
batch 89 loss: tensor(0.4124, device='cuda:0')
batch 90 loss: tensor(0.4789, device='cuda:0')
batch 91 loss: tensor(0.4270, device='cuda:0')
batch 92 loss: tensor(0.4788, device='cuda:0')
batch 93 loss: tensor(0.4314, device='cuda:0')
batch 94 loss: tensor(0.4594, device='cuda:0')
batch 95 loss: tensor(0.4472, device='cuda:0')
batch 96 loss: tensor(0.4454, device='cuda:0')
batch 97 loss: tensor(0.4137, device='cuda:0')
batch 98 loss: tensor(0.4500, device='cuda:0')
batch 99 loss: tensor(0.4623, device='cuda:0')
batch 100 loss: tensor(0.4716, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5023, device='cuda:0')
batch 2 loss: tensor(0.4692, device='cuda:0')
batch 3 loss: tensor(0.4001, device='cuda:0')
batch 4 loss: tensor(0.4238, device='cuda:0')
batch 5 loss: tensor(0.3887, device='cuda:0')
batch 6 loss: tensor(0.4493, device='cuda:0')
batch 7 loss: tensor(0.4068, device='cuda:0')
batch 8 loss: tensor(0.4005, device='cuda:0')
batch 9 loss: tensor(0.4453, device='cuda:0')
batch 10 loss: tensor(0.3599, device='cuda:0')
batch 11 loss: tensor(0.4339, device='cuda:0')
batch 12 loss: tensor(0.4161, device='cuda:0')
batch 13 loss: tensor(0.3759, device='cuda:0')
batch 14 loss: tensor(0.3985, device='cuda:0')
batch 15 loss: tensor(0.3758, device='cuda:0')
batch 16 loss: tensor(0.3948, device='cuda:0')
batch 17 loss: tensor(0.3774, device='cuda:0')
batch 18 loss: tensor(0.3685, device='cuda:0')
batch 19 loss: tensor(0.3931, device='cuda:0')
batch 20 loss: tensor(0.3908, device='cuda:0')
batch 21 loss: tensor(0.3630, device='cuda:0')
batch 22 loss: tensor(0.3216, device='cuda:0')
batch 23 loss: tensor(0.4178, device='cuda:0')
batch 24 loss: tensor(0.4216, device='cuda:0')
batch 25 loss: tensor(0.3506, device='cuda:0')
batch 26 loss: tensor(0.3725, device='cuda:0')
batch 27 loss: tensor(0.2998, device='cuda:0')
batch 28 loss: tensor(0.3933, device='cuda:0')
batch 29 loss: tensor(0.3663, device='cuda:0')
batch 30 loss: tensor(0.3594, device='cuda:0')
batch 31 loss: tensor(0.3742, device='cuda:0')
batch 32 loss: tensor(0.4087, device='cuda:0')
batch 33 loss: tensor(0.3365, device='cuda:0')
batch 34 loss: tensor(0.3642, device='cuda:0')
batch 35 loss: tensor(0.3591, device='cuda:0')
batch 36 loss: tensor(0.4217, device='cuda:0')
batch 37 loss: tensor(0.4142, device='cuda:0')
batch 38 loss: tensor(0.4015, device='cuda:0')
batch 39 loss: tensor(0.3979, device='cuda:0')
batch 40 loss: tensor(0.3541, device='cuda:0')
batch 41 loss: tensor(0.3711, device='cuda:0')
batch 42 loss: tensor(0.3613, device='cuda:0')
batch 43 loss: tensor(0.3866, device='cuda:0')
batch 44 loss: tensor(0.3540, device='cuda:0')
batch 45 loss: tensor(0.4127, device='cuda:0')
batch 46 loss: tensor(0.3626, device='cuda:0')
batch 47 loss: tensor(0.3764, device='cuda:0')
batch 48 loss: tensor(0.3839, device='cuda:0')
batch 49 loss: tensor(0.4080, device='cuda:0')
batch 50 loss: tensor(0.3701, device='cuda:0')
batch 51 loss: tensor(0.3730, device='cuda:0')
batch 52 loss: tensor(0.3707, device='cuda:0')
batch 53 loss: tensor(0.4178, device='cuda:0')
batch 54 loss: tensor(0.3149, device='cuda:0')
batch 55 loss: tensor(0.3546, device='cuda:0')
batch 56 loss: tensor(0.3360, device='cuda:0')
batch 57 loss: tensor(0.4258, device='cuda:0')
batch 58 loss: tensor(0.3039, device='cuda:0')
batch 59 loss: tensor(0.3469, device='cuda:0')
batch 60 loss: tensor(0.3222, device='cuda:0')
batch 61 loss: tensor(0.3638, device='cuda:0')
batch 62 loss: tensor(0.3582, device='cuda:0')
batch 63 loss: tensor(0.3926, device='cuda:0')
batch 64 loss: tensor(0.3197, device='cuda:0')
batch 65 loss: tensor(0.3853, device='cuda:0')
batch 66 loss: tensor(0.3807, device='cuda:0')
batch 67 loss: tensor(0.3900, device='cuda:0')
batch 68 loss: tensor(0.3731, device='cuda:0')
batch 69 loss: tensor(0.3666, device='cuda:0')
batch 70 loss: tensor(0.3968, device='cuda:0')
batch 71 loss: tensor(0.3864, device='cuda:0')
batch 72 loss: tensor(0.3694, device='cuda:0')
batch 73 loss: tensor(0.3375, device='cuda:0')
batch 74 loss: tensor(0.3534, device='cuda:0')
batch 75 loss: tensor(0.3355, device='cuda:0')
batch 76 loss: tensor(0.4075, device='cuda:0')
batch 77 loss: tensor(0.3407, device='cuda:0')
batch 78 loss: tensor(0.3170, device='cuda:0')
batch 79 loss: tensor(0.3394, device='cuda:0')
batch 80 loss: tensor(0.3342, device='cuda:0')
batch 81 loss: tensor(0.3567, device='cuda:0')
batch 82 loss: tensor(0.3434, device='cuda:0')
batch 83 loss: tensor(0.3309, device='cuda:0')
batch 84 loss: tensor(0.3712, device='cuda:0')
batch 85 loss: tensor(0.3484, device='cuda:0')
batch 86 loss: tensor(0.3175, device='cuda:0')
batch 87 loss: tensor(0.3768, device='cuda:0')
batch 88 loss: tensor(0.3705, device='cuda:0')
batch 89 loss: tensor(0.3558, device='cuda:0')
batch 90 loss: tensor(0.3766, device='cuda:0')
batch 91 loss: tensor(0.3455, device='cuda:0')
batch 92 loss: tensor(0.3515, device='cuda:0')
batch 93 loss: tensor(0.3413, device='cuda:0')
batch 94 loss: tensor(0.4037, device='cuda:0')
batch 95 loss: tensor(0.4324, device='cuda:0')
batch 96 loss: tensor(0.3717, device='cuda:0')
batch 97 loss: tensor(0.3723, device='cuda:0')
batch 98 loss: tensor(0.3160, device='cuda:0')
batch 99 loss: tensor(0.4024, device='cuda:0')
batch 100 loss: tensor(0.3059, device='cuda:0')
accuracy in val: 0.8384100000000001
accuracy in test: 0.8863764223113283
average epoch time: 1.7544199454784393
total time: 350.88398909568787
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9919, device='cuda:0')
batch 2 loss: tensor(0.8030, device='cuda:0')
batch 3 loss: tensor(0.6614, device='cuda:0')
batch 4 loss: tensor(0.6260, device='cuda:0')
batch 5 loss: tensor(0.6439, device='cuda:0')
batch 6 loss: tensor(0.5537, device='cuda:0')
batch 7 loss: tensor(0.5671, device='cuda:0')
batch 8 loss: tensor(0.5447, device='cuda:0')
batch 9 loss: tensor(0.5646, device='cuda:0')
batch 10 loss: tensor(0.4945, device='cuda:0')
batch 11 loss: tensor(0.5383, device='cuda:0')
batch 12 loss: tensor(0.4896, device='cuda:0')
batch 13 loss: tensor(0.5360, device='cuda:0')
batch 14 loss: tensor(0.5186, device='cuda:0')
batch 15 loss: tensor(0.4912, device='cuda:0')
batch 16 loss: tensor(0.4864, device='cuda:0')
batch 17 loss: tensor(0.4601, device='cuda:0')
batch 18 loss: tensor(0.4898, device='cuda:0')
batch 19 loss: tensor(0.5383, device='cuda:0')
batch 20 loss: tensor(0.4686, device='cuda:0')
batch 21 loss: tensor(0.5115, device='cuda:0')
batch 22 loss: tensor(0.5062, device='cuda:0')
batch 23 loss: tensor(0.5056, device='cuda:0')
batch 24 loss: tensor(0.5284, device='cuda:0')
batch 25 loss: tensor(0.4937, device='cuda:0')
batch 26 loss: tensor(0.4936, device='cuda:0')
batch 27 loss: tensor(0.4922, device='cuda:0')
batch 28 loss: tensor(0.5095, device='cuda:0')
batch 29 loss: tensor(0.5139, device='cuda:0')
batch 30 loss: tensor(0.5145, device='cuda:0')
batch 31 loss: tensor(0.5389, device='cuda:0')
batch 32 loss: tensor(0.5056, device='cuda:0')
batch 33 loss: tensor(0.5020, device='cuda:0')
batch 34 loss: tensor(0.5042, device='cuda:0')
batch 35 loss: tensor(0.4848, device='cuda:0')
batch 36 loss: tensor(0.5501, device='cuda:0')
batch 37 loss: tensor(0.5396, device='cuda:0')
batch 38 loss: tensor(0.4018, device='cuda:0')
batch 39 loss: tensor(0.5054, device='cuda:0')
batch 40 loss: tensor(0.4598, device='cuda:0')
batch 41 loss: tensor(0.4836, device='cuda:0')
batch 42 loss: tensor(0.4294, device='cuda:0')
batch 43 loss: tensor(0.5163, device='cuda:0')
batch 44 loss: tensor(0.4944, device='cuda:0')
batch 45 loss: tensor(0.5205, device='cuda:0')
batch 46 loss: tensor(0.4831, device='cuda:0')
batch 47 loss: tensor(0.4836, device='cuda:0')
batch 48 loss: tensor(0.4689, device='cuda:0')
batch 49 loss: tensor(0.4999, device='cuda:0')
batch 50 loss: tensor(0.4619, device='cuda:0')
batch 51 loss: tensor(0.4389, device='cuda:0')
batch 52 loss: tensor(0.4899, device='cuda:0')
batch 53 loss: tensor(0.4467, device='cuda:0')
batch 54 loss: tensor(0.4317, device='cuda:0')
batch 55 loss: tensor(0.4759, device='cuda:0')
batch 56 loss: tensor(0.4445, device='cuda:0')
batch 57 loss: tensor(0.4725, device='cuda:0')
batch 58 loss: tensor(0.4270, device='cuda:0')
batch 59 loss: tensor(0.4396, device='cuda:0')
batch 60 loss: tensor(0.4876, device='cuda:0')
batch 61 loss: tensor(0.4414, device='cuda:0')
batch 62 loss: tensor(0.4973, device='cuda:0')
batch 63 loss: tensor(0.4334, device='cuda:0')
batch 64 loss: tensor(0.4703, device='cuda:0')
batch 65 loss: tensor(0.4510, device='cuda:0')
batch 66 loss: tensor(0.4004, device='cuda:0')
batch 67 loss: tensor(0.4339, device='cuda:0')
batch 68 loss: tensor(0.4538, device='cuda:0')
batch 69 loss: tensor(0.3988, device='cuda:0')
batch 70 loss: tensor(0.4887, device='cuda:0')
batch 71 loss: tensor(0.4183, device='cuda:0')
batch 72 loss: tensor(0.4668, device='cuda:0')
batch 73 loss: tensor(0.4427, device='cuda:0')
batch 74 loss: tensor(0.4276, device='cuda:0')
batch 75 loss: tensor(0.4504, device='cuda:0')
batch 76 loss: tensor(0.5356, device='cuda:0')
batch 77 loss: tensor(0.4644, device='cuda:0')
batch 78 loss: tensor(0.4375, device='cuda:0')
batch 79 loss: tensor(0.4209, device='cuda:0')
batch 80 loss: tensor(0.4887, device='cuda:0')
batch 81 loss: tensor(0.5185, device='cuda:0')
batch 82 loss: tensor(0.4444, device='cuda:0')
batch 83 loss: tensor(0.4185, device='cuda:0')
batch 84 loss: tensor(0.3979, device='cuda:0')
batch 85 loss: tensor(0.4672, device='cuda:0')
batch 86 loss: tensor(0.4467, device='cuda:0')
batch 87 loss: tensor(0.4718, device='cuda:0')
batch 88 loss: tensor(0.4102, device='cuda:0')
batch 89 loss: tensor(0.4285, device='cuda:0')
batch 90 loss: tensor(0.4765, device='cuda:0')
batch 91 loss: tensor(0.4120, device='cuda:0')
batch 92 loss: tensor(0.4435, device='cuda:0')
batch 93 loss: tensor(0.4536, device='cuda:0')
batch 94 loss: tensor(0.4071, device='cuda:0')
batch 95 loss: tensor(0.4565, device='cuda:0')
batch 96 loss: tensor(0.3899, device='cuda:0')
batch 97 loss: tensor(0.3626, device='cuda:0')
batch 98 loss: tensor(0.4424, device='cuda:0')
batch 99 loss: tensor(0.4796, device='cuda:0')
batch 100 loss: tensor(0.4082, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.4717, device='cuda:0')
batch 2 loss: tensor(0.4370, device='cuda:0')
batch 3 loss: tensor(0.4440, device='cuda:0')
batch 4 loss: tensor(0.4382, device='cuda:0')
batch 5 loss: tensor(0.4102, device='cuda:0')
batch 6 loss: tensor(0.3552, device='cuda:0')
batch 7 loss: tensor(0.4367, device='cuda:0')
batch 8 loss: tensor(0.5053, device='cuda:0')
batch 9 loss: tensor(0.4038, device='cuda:0')
batch 10 loss: tensor(0.3706, device='cuda:0')
batch 11 loss: tensor(0.4137, device='cuda:0')
batch 12 loss: tensor(0.3904, device='cuda:0')
batch 13 loss: tensor(0.4020, device='cuda:0')
batch 14 loss: tensor(0.4119, device='cuda:0')
batch 15 loss: tensor(0.3321, device='cuda:0')
batch 16 loss: tensor(0.3594, device='cuda:0')
batch 17 loss: tensor(0.3929, device='cuda:0')
batch 18 loss: tensor(0.3512, device='cuda:0')
batch 19 loss: tensor(0.3890, device='cuda:0')
batch 20 loss: tensor(0.3297, device='cuda:0')
batch 21 loss: tensor(0.3458, device='cuda:0')
batch 22 loss: tensor(0.3584, device='cuda:0')
batch 23 loss: tensor(0.3834, device='cuda:0')
batch 24 loss: tensor(0.3668, device='cuda:0')
batch 25 loss: tensor(0.3378, device='cuda:0')
batch 26 loss: tensor(0.3972, device='cuda:0')
batch 27 loss: tensor(0.3147, device='cuda:0')
batch 28 loss: tensor(0.3772, device='cuda:0')
batch 29 loss: tensor(0.3814, device='cuda:0')
batch 30 loss: tensor(0.3921, device='cuda:0')
batch 31 loss: tensor(0.3526, device='cuda:0')
batch 32 loss: tensor(0.3222, device='cuda:0')
batch 33 loss: tensor(0.4354, device='cuda:0')
batch 34 loss: tensor(0.3824, device='cuda:0')
batch 35 loss: tensor(0.3743, device='cuda:0')
batch 36 loss: tensor(0.2952, device='cuda:0')
batch 37 loss: tensor(0.3901, device='cuda:0')
batch 38 loss: tensor(0.3749, device='cuda:0')
batch 39 loss: tensor(0.3337, device='cuda:0')
batch 40 loss: tensor(0.4609, device='cuda:0')
batch 41 loss: tensor(0.3529, device='cuda:0')
batch 42 loss: tensor(0.3500, device='cuda:0')
batch 43 loss: tensor(0.3515, device='cuda:0')
batch 44 loss: tensor(0.3633, device='cuda:0')
batch 45 loss: tensor(0.3416, device='cuda:0')
batch 46 loss: tensor(0.3929, device='cuda:0')
batch 47 loss: tensor(0.2959, device='cuda:0')
batch 48 loss: tensor(0.3338, device='cuda:0')
batch 49 loss: tensor(0.3953, device='cuda:0')
batch 50 loss: tensor(0.3621, device='cuda:0')
batch 51 loss: tensor(0.4028, device='cuda:0')
batch 52 loss: tensor(0.3528, device='cuda:0')
batch 53 loss: tensor(0.3437, device='cuda:0')
batch 54 loss: tensor(0.4464, device='cuda:0')
batch 55 loss: tensor(0.3408, device='cuda:0')
batch 56 loss: tensor(0.3293, device='cuda:0')
batch 57 loss: tensor(0.3890, device='cuda:0')
batch 58 loss: tensor(0.3657, device='cuda:0')
batch 59 loss: tensor(0.4244, device='cuda:0')
batch 60 loss: tensor(0.3345, device='cuda:0')
batch 61 loss: tensor(0.3473, device='cuda:0')
batch 62 loss: tensor(0.3558, device='cuda:0')
batch 63 loss: tensor(0.3933, device='cuda:0')
batch 64 loss: tensor(0.3196, device='cuda:0')
batch 65 loss: tensor(0.3641, device='cuda:0')
batch 66 loss: tensor(0.3844, device='cuda:0')
batch 67 loss: tensor(0.3904, device='cuda:0')
batch 68 loss: tensor(0.3838, device='cuda:0')
batch 69 loss: tensor(0.3325, device='cuda:0')
batch 70 loss: tensor(0.4019, device='cuda:0')
batch 71 loss: tensor(0.3458, device='cuda:0')
batch 72 loss: tensor(0.3949, device='cuda:0')
batch 73 loss: tensor(0.3915, device='cuda:0')
batch 74 loss: tensor(0.3222, device='cuda:0')
batch 75 loss: tensor(0.3545, device='cuda:0')
batch 76 loss: tensor(0.3377, device='cuda:0')
batch 77 loss: tensor(0.3494, device='cuda:0')
batch 78 loss: tensor(0.3373, device='cuda:0')
batch 79 loss: tensor(0.2906, device='cuda:0')
batch 80 loss: tensor(0.3542, device='cuda:0')
batch 81 loss: tensor(0.3742, device='cuda:0')
batch 82 loss: tensor(0.3741, device='cuda:0')
batch 83 loss: tensor(0.4182, device='cuda:0')
batch 84 loss: tensor(0.3544, device='cuda:0')
batch 85 loss: tensor(0.3748, device='cuda:0')
batch 86 loss: tensor(0.3206, device='cuda:0')
batch 87 loss: tensor(0.3591, device='cuda:0')
batch 88 loss: tensor(0.3857, device='cuda:0')
batch 89 loss: tensor(0.3385, device='cuda:0')
batch 90 loss: tensor(0.3023, device='cuda:0')
batch 91 loss: tensor(0.3461, device='cuda:0')
batch 92 loss: tensor(0.3370, device='cuda:0')
batch 93 loss: tensor(0.3587, device='cuda:0')
batch 94 loss: tensor(0.3942, device='cuda:0')
batch 95 loss: tensor(0.3611, device='cuda:0')
batch 96 loss: tensor(0.3380, device='cuda:0')
batch 97 loss: tensor(0.3365, device='cuda:0')
batch 98 loss: tensor(0.4102, device='cuda:0')
batch 99 loss: tensor(0.3845, device='cuda:0')
batch 100 loss: tensor(0.3504, device='cuda:0')
accuracy in val: 0.8377366666666667
accuracy in test: 0.8867432035166871
average epoch time: 1.74391357421875
total time: 348.78271484375
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9648, device='cuda:0')
batch 2 loss: tensor(0.8066, device='cuda:0')
batch 3 loss: tensor(0.6363, device='cuda:0')
batch 4 loss: tensor(0.6625, device='cuda:0')
batch 5 loss: tensor(0.5798, device='cuda:0')
batch 6 loss: tensor(0.5697, device='cuda:0')
batch 7 loss: tensor(0.5671, device='cuda:0')
batch 8 loss: tensor(0.4998, device='cuda:0')
batch 9 loss: tensor(0.5650, device='cuda:0')
batch 10 loss: tensor(0.4972, device='cuda:0')
batch 11 loss: tensor(0.5321, device='cuda:0')
batch 12 loss: tensor(0.5540, device='cuda:0')
batch 13 loss: tensor(0.5231, device='cuda:0')
batch 14 loss: tensor(0.4971, device='cuda:0')
batch 15 loss: tensor(0.5491, device='cuda:0')
batch 16 loss: tensor(0.5499, device='cuda:0')
batch 17 loss: tensor(0.5227, device='cuda:0')
batch 18 loss: tensor(0.5293, device='cuda:0')
batch 19 loss: tensor(0.4792, device='cuda:0')
batch 20 loss: tensor(0.5131, device='cuda:0')
batch 21 loss: tensor(0.4853, device='cuda:0')
batch 22 loss: tensor(0.4481, device='cuda:0')
batch 23 loss: tensor(0.5215, device='cuda:0')
batch 24 loss: tensor(0.4663, device='cuda:0')
batch 25 loss: tensor(0.4947, device='cuda:0')
batch 26 loss: tensor(0.4841, device='cuda:0')
batch 27 loss: tensor(0.5000, device='cuda:0')
batch 28 loss: tensor(0.5196, device='cuda:0')
batch 29 loss: tensor(0.4509, device='cuda:0')
batch 30 loss: tensor(0.4780, device='cuda:0')
batch 31 loss: tensor(0.4627, device='cuda:0')
batch 32 loss: tensor(0.4658, device='cuda:0')
batch 33 loss: tensor(0.5126, device='cuda:0')
batch 34 loss: tensor(0.4739, device='cuda:0')
batch 35 loss: tensor(0.5173, device='cuda:0')
batch 36 loss: tensor(0.4503, device='cuda:0')
batch 37 loss: tensor(0.4742, device='cuda:0')
batch 38 loss: tensor(0.4481, device='cuda:0')
batch 39 loss: tensor(0.4449, device='cuda:0')
batch 40 loss: tensor(0.4677, device='cuda:0')
batch 41 loss: tensor(0.4492, device='cuda:0')
batch 42 loss: tensor(0.5054, device='cuda:0')
batch 43 loss: tensor(0.4551, device='cuda:0')
batch 44 loss: tensor(0.4920, device='cuda:0')
batch 45 loss: tensor(0.4359, device='cuda:0')
batch 46 loss: tensor(0.4932, device='cuda:0')
batch 47 loss: tensor(0.5214, device='cuda:0')
batch 48 loss: tensor(0.4646, device='cuda:0')
batch 49 loss: tensor(0.4941, device='cuda:0')
batch 50 loss: tensor(0.4849, device='cuda:0')
batch 51 loss: tensor(0.4940, device='cuda:0')
batch 52 loss: tensor(0.4711, device='cuda:0')
batch 53 loss: tensor(0.4569, device='cuda:0')
batch 54 loss: tensor(0.4512, device='cuda:0')
batch 55 loss: tensor(0.4861, device='cuda:0')
batch 56 loss: tensor(0.4869, device='cuda:0')
batch 57 loss: tensor(0.4441, device='cuda:0')
batch 58 loss: tensor(0.5065, device='cuda:0')
batch 59 loss: tensor(0.4230, device='cuda:0')
batch 60 loss: tensor(0.4372, device='cuda:0')
batch 61 loss: tensor(0.4832, device='cuda:0')
batch 62 loss: tensor(0.5104, device='cuda:0')
batch 63 loss: tensor(0.4122, device='cuda:0')
batch 64 loss: tensor(0.4970, device='cuda:0')
batch 65 loss: tensor(0.4601, device='cuda:0')
batch 66 loss: tensor(0.4561, device='cuda:0')
batch 67 loss: tensor(0.4803, device='cuda:0')
batch 68 loss: tensor(0.4545, device='cuda:0')
batch 69 loss: tensor(0.4611, device='cuda:0')
batch 70 loss: tensor(0.4666, device='cuda:0')
batch 71 loss: tensor(0.4213, device='cuda:0')
batch 72 loss: tensor(0.4287, device='cuda:0')
batch 73 loss: tensor(0.3929, device='cuda:0')
batch 74 loss: tensor(0.4687, device='cuda:0')
batch 75 loss: tensor(0.4375, device='cuda:0')
batch 76 loss: tensor(0.4196, device='cuda:0')
batch 77 loss: tensor(0.4262, device='cuda:0')
batch 78 loss: tensor(0.4422, device='cuda:0')
batch 79 loss: tensor(0.4647, device='cuda:0')
batch 80 loss: tensor(0.5087, device='cuda:0')
batch 81 loss: tensor(0.4446, device='cuda:0')
batch 82 loss: tensor(0.4674, device='cuda:0')
batch 83 loss: tensor(0.4259, device='cuda:0')
batch 84 loss: tensor(0.4430, device='cuda:0')
batch 85 loss: tensor(0.4429, device='cuda:0')
batch 86 loss: tensor(0.5081, device='cuda:0')
batch 87 loss: tensor(0.4915, device='cuda:0')
batch 88 loss: tensor(0.4616, device='cuda:0')
batch 89 loss: tensor(0.3922, device='cuda:0')
batch 90 loss: tensor(0.4037, device='cuda:0')
batch 91 loss: tensor(0.4541, device='cuda:0')
batch 92 loss: tensor(0.4828, device='cuda:0')
batch 93 loss: tensor(0.4649, device='cuda:0')
batch 94 loss: tensor(0.4343, device='cuda:0')
batch 95 loss: tensor(0.4843, device='cuda:0')
batch 96 loss: tensor(0.4409, device='cuda:0')
batch 97 loss: tensor(0.4072, device='cuda:0')
batch 98 loss: tensor(0.4009, device='cuda:0')
batch 99 loss: tensor(0.4235, device='cuda:0')
batch 100 loss: tensor(0.4143, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5226, device='cuda:0')
batch 2 loss: tensor(0.5196, device='cuda:0')
batch 3 loss: tensor(0.4315, device='cuda:0')
batch 4 loss: tensor(0.3850, device='cuda:0')
batch 5 loss: tensor(0.3368, device='cuda:0')
batch 6 loss: tensor(0.3722, device='cuda:0')
batch 7 loss: tensor(0.4049, device='cuda:0')
batch 8 loss: tensor(0.3968, device='cuda:0')
batch 9 loss: tensor(0.3808, device='cuda:0')
batch 10 loss: tensor(0.4967, device='cuda:0')
batch 11 loss: tensor(0.4126, device='cuda:0')
batch 12 loss: tensor(0.4549, device='cuda:0')
batch 13 loss: tensor(0.3782, device='cuda:0')
batch 14 loss: tensor(0.4132, device='cuda:0')
batch 15 loss: tensor(0.4073, device='cuda:0')
batch 16 loss: tensor(0.3592, device='cuda:0')
batch 17 loss: tensor(0.3820, device='cuda:0')
batch 18 loss: tensor(0.3961, device='cuda:0')
batch 19 loss: tensor(0.4081, device='cuda:0')
batch 20 loss: tensor(0.3102, device='cuda:0')
batch 21 loss: tensor(0.3605, device='cuda:0')
batch 22 loss: tensor(0.3596, device='cuda:0')
batch 23 loss: tensor(0.3935, device='cuda:0')
batch 24 loss: tensor(0.3885, device='cuda:0')
batch 25 loss: tensor(0.3769, device='cuda:0')
batch 26 loss: tensor(0.4157, device='cuda:0')
batch 27 loss: tensor(0.3490, device='cuda:0')
batch 28 loss: tensor(0.3951, device='cuda:0')
batch 29 loss: tensor(0.3882, device='cuda:0')
batch 30 loss: tensor(0.3474, device='cuda:0')
batch 31 loss: tensor(0.4442, device='cuda:0')
batch 32 loss: tensor(0.4248, device='cuda:0')
batch 33 loss: tensor(0.3816, device='cuda:0')
batch 34 loss: tensor(0.4159, device='cuda:0')
batch 35 loss: tensor(0.4347, device='cuda:0')
batch 36 loss: tensor(0.4139, device='cuda:0')
batch 37 loss: tensor(0.3221, device='cuda:0')
batch 38 loss: tensor(0.3485, device='cuda:0')
batch 39 loss: tensor(0.3745, device='cuda:0')
batch 40 loss: tensor(0.3442, device='cuda:0')
batch 41 loss: tensor(0.3606, device='cuda:0')
batch 42 loss: tensor(0.3905, device='cuda:0')
batch 43 loss: tensor(0.3952, device='cuda:0')
batch 44 loss: tensor(0.3241, device='cuda:0')
batch 45 loss: tensor(0.3580, device='cuda:0')
batch 46 loss: tensor(0.3778, device='cuda:0')
batch 47 loss: tensor(0.3722, device='cuda:0')
batch 48 loss: tensor(0.3579, device='cuda:0')
batch 49 loss: tensor(0.3150, device='cuda:0')
batch 50 loss: tensor(0.3634, device='cuda:0')
batch 51 loss: tensor(0.3776, device='cuda:0')
batch 52 loss: tensor(0.3635, device='cuda:0')
batch 53 loss: tensor(0.3772, device='cuda:0')
batch 54 loss: tensor(0.3322, device='cuda:0')
batch 55 loss: tensor(0.3508, device='cuda:0')
batch 56 loss: tensor(0.3564, device='cuda:0')
batch 57 loss: tensor(0.4152, device='cuda:0')
batch 58 loss: tensor(0.3427, device='cuda:0')
batch 59 loss: tensor(0.3819, device='cuda:0')
batch 60 loss: tensor(0.3646, device='cuda:0')
batch 61 loss: tensor(0.3208, device='cuda:0')
batch 62 loss: tensor(0.3378, device='cuda:0')
batch 63 loss: tensor(0.3399, device='cuda:0')
batch 64 loss: tensor(0.3486, device='cuda:0')
batch 65 loss: tensor(0.3999, device='cuda:0')
batch 66 loss: tensor(0.3763, device='cuda:0')
batch 67 loss: tensor(0.3442, device='cuda:0')
batch 68 loss: tensor(0.3526, device='cuda:0')
batch 69 loss: tensor(0.3095, device='cuda:0')
batch 70 loss: tensor(0.3564, device='cuda:0')
batch 71 loss: tensor(0.3104, device='cuda:0')
batch 72 loss: tensor(0.3620, device='cuda:0')
batch 73 loss: tensor(0.3949, device='cuda:0')
batch 74 loss: tensor(0.3340, device='cuda:0')
batch 75 loss: tensor(0.4220, device='cuda:0')
batch 76 loss: tensor(0.3481, device='cuda:0')
batch 77 loss: tensor(0.3314, device='cuda:0')
batch 78 loss: tensor(0.3911, device='cuda:0')
batch 79 loss: tensor(0.3234, device='cuda:0')
batch 80 loss: tensor(0.3414, device='cuda:0')
batch 81 loss: tensor(0.3707, device='cuda:0')
batch 82 loss: tensor(0.3678, device='cuda:0')
batch 83 loss: tensor(0.3819, device='cuda:0')
batch 84 loss: tensor(0.3572, device='cuda:0')
batch 85 loss: tensor(0.3589, device='cuda:0')
batch 86 loss: tensor(0.3537, device='cuda:0')
batch 87 loss: tensor(0.3613, device='cuda:0')
batch 88 loss: tensor(0.3536, device='cuda:0')
batch 89 loss: tensor(0.3412, device='cuda:0')
batch 90 loss: tensor(0.3332, device='cuda:0')
batch 91 loss: tensor(0.3711, device='cuda:0')
batch 92 loss: tensor(0.3260, device='cuda:0')
batch 93 loss: tensor(0.3371, device='cuda:0')
batch 94 loss: tensor(0.3781, device='cuda:0')
batch 95 loss: tensor(0.3315, device='cuda:0')
batch 96 loss: tensor(0.3607, device='cuda:0')
batch 97 loss: tensor(0.3336, device='cuda:0')
batch 98 loss: tensor(0.4044, device='cuda:0')
batch 99 loss: tensor(0.3927, device='cuda:0')
batch 100 loss: tensor(0.3689, device='cuda:0')
accuracy in val: 0.8378166666666667
accuracy in test: 0.88604687077719
average epoch time: 1.747635029554367
total time: 349.5270059108734
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9502, device='cuda:0')
batch 2 loss: tensor(0.7399, device='cuda:0')
batch 3 loss: tensor(0.7171, device='cuda:0')
batch 4 loss: tensor(0.6365, device='cuda:0')
batch 5 loss: tensor(0.6206, device='cuda:0')
batch 6 loss: tensor(0.7218, device='cuda:0')
batch 7 loss: tensor(0.6163, device='cuda:0')
batch 8 loss: tensor(0.6279, device='cuda:0')
batch 9 loss: tensor(0.5212, device='cuda:0')
batch 10 loss: tensor(0.5644, device='cuda:0')
batch 11 loss: tensor(0.5590, device='cuda:0')
batch 12 loss: tensor(0.5504, device='cuda:0')
batch 13 loss: tensor(0.5312, device='cuda:0')
batch 14 loss: tensor(0.5192, device='cuda:0')
batch 15 loss: tensor(0.4969, device='cuda:0')
batch 16 loss: tensor(0.5189, device='cuda:0')
batch 17 loss: tensor(0.4819, device='cuda:0')
batch 18 loss: tensor(0.4549, device='cuda:0')
batch 19 loss: tensor(0.4784, device='cuda:0')
batch 20 loss: tensor(0.4966, device='cuda:0')
batch 21 loss: tensor(0.4761, device='cuda:0')
batch 22 loss: tensor(0.4719, device='cuda:0')
batch 23 loss: tensor(0.5242, device='cuda:0')
batch 24 loss: tensor(0.5462, device='cuda:0')
batch 25 loss: tensor(0.4842, device='cuda:0')
batch 26 loss: tensor(0.4389, device='cuda:0')
batch 27 loss: tensor(0.4766, device='cuda:0')
batch 28 loss: tensor(0.5083, device='cuda:0')
batch 29 loss: tensor(0.4310, device='cuda:0')
batch 30 loss: tensor(0.4697, device='cuda:0')
batch 31 loss: tensor(0.5392, device='cuda:0')
batch 32 loss: tensor(0.4775, device='cuda:0')
batch 33 loss: tensor(0.4981, device='cuda:0')
batch 34 loss: tensor(0.4805, device='cuda:0')
batch 35 loss: tensor(0.4493, device='cuda:0')
batch 36 loss: tensor(0.4344, device='cuda:0')
batch 37 loss: tensor(0.5198, device='cuda:0')
batch 38 loss: tensor(0.4413, device='cuda:0')
batch 39 loss: tensor(0.4661, device='cuda:0')
batch 40 loss: tensor(0.4256, device='cuda:0')
batch 41 loss: tensor(0.5066, device='cuda:0')
batch 42 loss: tensor(0.5247, device='cuda:0')
batch 43 loss: tensor(0.4308, device='cuda:0')
batch 44 loss: tensor(0.5208, device='cuda:0')
batch 45 loss: tensor(0.4634, device='cuda:0')
batch 46 loss: tensor(0.4454, device='cuda:0')
batch 47 loss: tensor(0.4152, device='cuda:0')
batch 48 loss: tensor(0.5001, device='cuda:0')
batch 49 loss: tensor(0.4574, device='cuda:0')
batch 50 loss: tensor(0.4134, device='cuda:0')
batch 51 loss: tensor(0.4407, device='cuda:0')
batch 52 loss: tensor(0.4161, device='cuda:0')
batch 53 loss: tensor(0.4819, device='cuda:0')
batch 54 loss: tensor(0.4534, device='cuda:0')
batch 55 loss: tensor(0.4908, device='cuda:0')
batch 56 loss: tensor(0.5052, device='cuda:0')
batch 57 loss: tensor(0.4486, device='cuda:0')
batch 58 loss: tensor(0.4476, device='cuda:0')
batch 59 loss: tensor(0.4607, device='cuda:0')
batch 60 loss: tensor(0.4364, device='cuda:0')
batch 61 loss: tensor(0.4573, device='cuda:0')
batch 62 loss: tensor(0.4493, device='cuda:0')
batch 63 loss: tensor(0.4526, device='cuda:0')
batch 64 loss: tensor(0.4761, device='cuda:0')
batch 65 loss: tensor(0.4520, device='cuda:0')
batch 66 loss: tensor(0.4619, device='cuda:0')
batch 67 loss: tensor(0.4883, device='cuda:0')
batch 68 loss: tensor(0.4588, device='cuda:0')
batch 69 loss: tensor(0.4237, device='cuda:0')
batch 70 loss: tensor(0.4715, device='cuda:0')
batch 71 loss: tensor(0.4764, device='cuda:0')
batch 72 loss: tensor(0.4612, device='cuda:0')
batch 73 loss: tensor(0.4600, device='cuda:0')
batch 74 loss: tensor(0.4435, device='cuda:0')
batch 75 loss: tensor(0.4763, device='cuda:0')
batch 76 loss: tensor(0.4257, device='cuda:0')
batch 77 loss: tensor(0.5150, device='cuda:0')
batch 78 loss: tensor(0.4536, device='cuda:0')
batch 79 loss: tensor(0.4643, device='cuda:0')
batch 80 loss: tensor(0.4774, device='cuda:0')
batch 81 loss: tensor(0.4699, device='cuda:0')
batch 82 loss: tensor(0.4974, device='cuda:0')
batch 83 loss: tensor(0.4166, device='cuda:0')
batch 84 loss: tensor(0.4989, device='cuda:0')
batch 85 loss: tensor(0.4427, device='cuda:0')
batch 86 loss: tensor(0.4260, device='cuda:0')
batch 87 loss: tensor(0.4176, device='cuda:0')
batch 88 loss: tensor(0.4360, device='cuda:0')
batch 89 loss: tensor(0.4459, device='cuda:0')
batch 90 loss: tensor(0.4816, device='cuda:0')
batch 91 loss: tensor(0.4541, device='cuda:0')
batch 92 loss: tensor(0.5051, device='cuda:0')
batch 93 loss: tensor(0.4417, device='cuda:0')
batch 94 loss: tensor(0.4555, device='cuda:0')
batch 95 loss: tensor(0.4523, device='cuda:0')
batch 96 loss: tensor(0.4475, device='cuda:0')
batch 97 loss: tensor(0.4661, device='cuda:0')
batch 98 loss: tensor(0.4750, device='cuda:0')
batch 99 loss: tensor(0.3914, device='cuda:0')
batch 100 loss: tensor(0.4584, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5257, device='cuda:0')
batch 2 loss: tensor(0.4303, device='cuda:0')
batch 3 loss: tensor(0.4478, device='cuda:0')
batch 4 loss: tensor(0.3745, device='cuda:0')
batch 5 loss: tensor(0.4028, device='cuda:0')
batch 6 loss: tensor(0.3715, device='cuda:0')
batch 7 loss: tensor(0.4345, device='cuda:0')
batch 8 loss: tensor(0.3873, device='cuda:0')
batch 9 loss: tensor(0.4285, device='cuda:0')
batch 10 loss: tensor(0.4430, device='cuda:0')
batch 11 loss: tensor(0.4319, device='cuda:0')
batch 12 loss: tensor(0.3751, device='cuda:0')
batch 13 loss: tensor(0.3159, device='cuda:0')
batch 14 loss: tensor(0.4059, device='cuda:0')
batch 15 loss: tensor(0.3989, device='cuda:0')
batch 16 loss: tensor(0.4430, device='cuda:0')
batch 17 loss: tensor(0.4110, device='cuda:0')
batch 18 loss: tensor(0.3736, device='cuda:0')
batch 19 loss: tensor(0.3495, device='cuda:0')
batch 20 loss: tensor(0.3730, device='cuda:0')
batch 21 loss: tensor(0.3130, device='cuda:0')
batch 22 loss: tensor(0.3744, device='cuda:0')
batch 23 loss: tensor(0.3710, device='cuda:0')
batch 24 loss: tensor(0.4770, device='cuda:0')
batch 25 loss: tensor(0.4017, device='cuda:0')
batch 26 loss: tensor(0.3933, device='cuda:0')
batch 27 loss: tensor(0.3589, device='cuda:0')
batch 28 loss: tensor(0.4308, device='cuda:0')
batch 29 loss: tensor(0.3707, device='cuda:0')
batch 30 loss: tensor(0.3183, device='cuda:0')
batch 31 loss: tensor(0.3296, device='cuda:0')
batch 32 loss: tensor(0.4101, device='cuda:0')
batch 33 loss: tensor(0.2972, device='cuda:0')
batch 34 loss: tensor(0.4131, device='cuda:0')
batch 35 loss: tensor(0.3617, device='cuda:0')
batch 36 loss: tensor(0.3982, device='cuda:0')
batch 37 loss: tensor(0.4320, device='cuda:0')
batch 38 loss: tensor(0.4298, device='cuda:0')
batch 39 loss: tensor(0.4238, device='cuda:0')
batch 40 loss: tensor(0.3426, device='cuda:0')
batch 41 loss: tensor(0.4109, device='cuda:0')
batch 42 loss: tensor(0.4152, device='cuda:0')
batch 43 loss: tensor(0.4195, device='cuda:0')
batch 44 loss: tensor(0.4108, device='cuda:0')
batch 45 loss: tensor(0.3557, device='cuda:0')
batch 46 loss: tensor(0.4216, device='cuda:0')
batch 47 loss: tensor(0.3528, device='cuda:0')
batch 48 loss: tensor(0.3709, device='cuda:0')
batch 49 loss: tensor(0.3903, device='cuda:0')
batch 50 loss: tensor(0.3848, device='cuda:0')
batch 51 loss: tensor(0.3173, device='cuda:0')
batch 52 loss: tensor(0.3499, device='cuda:0')
batch 53 loss: tensor(0.3477, device='cuda:0')
batch 54 loss: tensor(0.3829, device='cuda:0')
batch 55 loss: tensor(0.4209, device='cuda:0')
batch 56 loss: tensor(0.3795, device='cuda:0')
batch 57 loss: tensor(0.3905, device='cuda:0')
batch 58 loss: tensor(0.3514, device='cuda:0')
batch 59 loss: tensor(0.3951, device='cuda:0')
batch 60 loss: tensor(0.3040, device='cuda:0')
batch 61 loss: tensor(0.4089, device='cuda:0')
batch 62 loss: tensor(0.3637, device='cuda:0')
batch 63 loss: tensor(0.3510, device='cuda:0')
batch 64 loss: tensor(0.4273, device='cuda:0')
batch 65 loss: tensor(0.3931, device='cuda:0')
batch 66 loss: tensor(0.3946, device='cuda:0')
batch 67 loss: tensor(0.3325, device='cuda:0')
batch 68 loss: tensor(0.3628, device='cuda:0')
batch 69 loss: tensor(0.3379, device='cuda:0')
batch 70 loss: tensor(0.3662, device='cuda:0')
batch 71 loss: tensor(0.3364, device='cuda:0')
batch 72 loss: tensor(0.3767, device='cuda:0')
batch 73 loss: tensor(0.3265, device='cuda:0')
batch 74 loss: tensor(0.3867, device='cuda:0')
batch 75 loss: tensor(0.3837, device='cuda:0')
batch 76 loss: tensor(0.3492, device='cuda:0')
batch 77 loss: tensor(0.3530, device='cuda:0')
batch 78 loss: tensor(0.3446, device='cuda:0')
batch 79 loss: tensor(0.3263, device='cuda:0')
batch 80 loss: tensor(0.4142, device='cuda:0')
batch 81 loss: tensor(0.3152, device='cuda:0')
batch 82 loss: tensor(0.3639, device='cuda:0')
batch 83 loss: tensor(0.3829, device='cuda:0')
batch 84 loss: tensor(0.3846, device='cuda:0')
batch 85 loss: tensor(0.3394, device='cuda:0')
batch 86 loss: tensor(0.3575, device='cuda:0')
batch 87 loss: tensor(0.3508, device='cuda:0')
batch 88 loss: tensor(0.4054, device='cuda:0')
batch 89 loss: tensor(0.3891, device='cuda:0')
batch 90 loss: tensor(0.2966, device='cuda:0')
batch 91 loss: tensor(0.3458, device='cuda:0')
batch 92 loss: tensor(0.3393, device='cuda:0')
batch 93 loss: tensor(0.3437, device='cuda:0')
batch 94 loss: tensor(0.4061, device='cuda:0')
batch 95 loss: tensor(0.4435, device='cuda:0')
batch 96 loss: tensor(0.3379, device='cuda:0')
batch 97 loss: tensor(0.3956, device='cuda:0')
batch 98 loss: tensor(0.3389, device='cuda:0')
batch 99 loss: tensor(0.3613, device='cuda:0')
batch 100 loss: tensor(0.3751, device='cuda:0')
accuracy in val: 0.8374533333333333
accuracy in test: 0.8864301985030916
average epoch time: 1.7518918061256408
total time: 350.3783612251282
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9489, device='cuda:0')
batch 2 loss: tensor(0.7448, device='cuda:0')
batch 3 loss: tensor(0.7290, device='cuda:0')
batch 4 loss: tensor(0.6912, device='cuda:0')
batch 5 loss: tensor(0.6524, device='cuda:0')
batch 6 loss: tensor(0.5840, device='cuda:0')
batch 7 loss: tensor(0.5508, device='cuda:0')
batch 8 loss: tensor(0.5633, device='cuda:0')
batch 9 loss: tensor(0.5799, device='cuda:0')
batch 10 loss: tensor(0.5322, device='cuda:0')
batch 11 loss: tensor(0.6165, device='cuda:0')
batch 12 loss: tensor(0.5459, device='cuda:0')
batch 13 loss: tensor(0.5506, device='cuda:0')
batch 14 loss: tensor(0.5370, device='cuda:0')
batch 15 loss: tensor(0.5179, device='cuda:0')
batch 16 loss: tensor(0.5152, device='cuda:0')
batch 17 loss: tensor(0.5945, device='cuda:0')
batch 18 loss: tensor(0.5756, device='cuda:0')
batch 19 loss: tensor(0.5081, device='cuda:0')
batch 20 loss: tensor(0.4917, device='cuda:0')
batch 21 loss: tensor(0.5455, device='cuda:0')
batch 22 loss: tensor(0.5007, device='cuda:0')
batch 23 loss: tensor(0.5106, device='cuda:0')
batch 24 loss: tensor(0.4713, device='cuda:0')
batch 25 loss: tensor(0.4749, device='cuda:0')
batch 26 loss: tensor(0.5131, device='cuda:0')
batch 27 loss: tensor(0.5143, device='cuda:0')
batch 28 loss: tensor(0.5004, device='cuda:0')
batch 29 loss: tensor(0.4494, device='cuda:0')
batch 30 loss: tensor(0.5068, device='cuda:0')
batch 31 loss: tensor(0.5276, device='cuda:0')
batch 32 loss: tensor(0.4523, device='cuda:0')
batch 33 loss: tensor(0.4770, device='cuda:0')
batch 34 loss: tensor(0.4917, device='cuda:0')
batch 35 loss: tensor(0.4127, device='cuda:0')
batch 36 loss: tensor(0.4542, device='cuda:0')
batch 37 loss: tensor(0.4959, device='cuda:0')
batch 38 loss: tensor(0.4311, device='cuda:0')
batch 39 loss: tensor(0.4833, device='cuda:0')
batch 40 loss: tensor(0.5215, device='cuda:0')
batch 41 loss: tensor(0.4547, device='cuda:0')
batch 42 loss: tensor(0.4321, device='cuda:0')
batch 43 loss: tensor(0.4693, device='cuda:0')
batch 44 loss: tensor(0.4801, device='cuda:0')
batch 45 loss: tensor(0.4452, device='cuda:0')
batch 46 loss: tensor(0.4139, device='cuda:0')
batch 47 loss: tensor(0.4407, device='cuda:0')
batch 48 loss: tensor(0.4590, device='cuda:0')
batch 49 loss: tensor(0.4249, device='cuda:0')
batch 50 loss: tensor(0.4290, device='cuda:0')
batch 51 loss: tensor(0.4703, device='cuda:0')
batch 52 loss: tensor(0.4908, device='cuda:0')
batch 53 loss: tensor(0.4618, device='cuda:0')
batch 54 loss: tensor(0.4472, device='cuda:0')
batch 55 loss: tensor(0.4711, device='cuda:0')
batch 56 loss: tensor(0.4204, device='cuda:0')
batch 57 loss: tensor(0.4782, device='cuda:0')
batch 58 loss: tensor(0.4288, device='cuda:0')
batch 59 loss: tensor(0.5024, device='cuda:0')
batch 60 loss: tensor(0.4986, device='cuda:0')
batch 61 loss: tensor(0.4887, device='cuda:0')
batch 62 loss: tensor(0.4465, device='cuda:0')
batch 63 loss: tensor(0.5411, device='cuda:0')
batch 64 loss: tensor(0.4873, device='cuda:0')
batch 65 loss: tensor(0.4636, device='cuda:0')
batch 66 loss: tensor(0.4348, device='cuda:0')
batch 67 loss: tensor(0.5003, device='cuda:0')
batch 68 loss: tensor(0.4377, device='cuda:0')
batch 69 loss: tensor(0.4320, device='cuda:0')
batch 70 loss: tensor(0.4809, device='cuda:0')
batch 71 loss: tensor(0.4806, device='cuda:0')
batch 72 loss: tensor(0.4545, device='cuda:0')
batch 73 loss: tensor(0.5124, device='cuda:0')
batch 74 loss: tensor(0.4939, device='cuda:0')
batch 75 loss: tensor(0.4329, device='cuda:0')
batch 76 loss: tensor(0.5114, device='cuda:0')
batch 77 loss: tensor(0.4290, device='cuda:0')
batch 78 loss: tensor(0.4173, device='cuda:0')
batch 79 loss: tensor(0.4143, device='cuda:0')
batch 80 loss: tensor(0.4259, device='cuda:0')
batch 81 loss: tensor(0.4800, device='cuda:0')
batch 82 loss: tensor(0.4718, device='cuda:0')
batch 83 loss: tensor(0.4505, device='cuda:0')
batch 84 loss: tensor(0.4683, device='cuda:0')
batch 85 loss: tensor(0.4276, device='cuda:0')
batch 86 loss: tensor(0.4616, device='cuda:0')
batch 87 loss: tensor(0.4695, device='cuda:0')
batch 88 loss: tensor(0.4583, device='cuda:0')
batch 89 loss: tensor(0.4603, device='cuda:0')
batch 90 loss: tensor(0.4092, device='cuda:0')
batch 91 loss: tensor(0.4923, device='cuda:0')
batch 92 loss: tensor(0.4127, device='cuda:0')
batch 93 loss: tensor(0.4442, device='cuda:0')
batch 94 loss: tensor(0.4748, device='cuda:0')
batch 95 loss: tensor(0.3905, device='cuda:0')
batch 96 loss: tensor(0.4171, device='cuda:0')
batch 97 loss: tensor(0.4943, device='cuda:0')
batch 98 loss: tensor(0.4954, device='cuda:0')
batch 99 loss: tensor(0.4910, device='cuda:0')
batch 100 loss: tensor(0.4804, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5605, device='cuda:0')
batch 2 loss: tensor(0.4005, device='cuda:0')
batch 3 loss: tensor(0.4528, device='cuda:0')
batch 4 loss: tensor(0.4222, device='cuda:0')
batch 5 loss: tensor(0.4111, device='cuda:0')
batch 6 loss: tensor(0.4430, device='cuda:0')
batch 7 loss: tensor(0.3906, device='cuda:0')
batch 8 loss: tensor(0.4549, device='cuda:0')
batch 9 loss: tensor(0.3907, device='cuda:0')
batch 10 loss: tensor(0.3246, device='cuda:0')
batch 11 loss: tensor(0.4090, device='cuda:0')
batch 12 loss: tensor(0.3928, device='cuda:0')
batch 13 loss: tensor(0.3726, device='cuda:0')
batch 14 loss: tensor(0.4006, device='cuda:0')
batch 15 loss: tensor(0.3850, device='cuda:0')
batch 16 loss: tensor(0.3854, device='cuda:0')
batch 17 loss: tensor(0.4239, device='cuda:0')
batch 18 loss: tensor(0.3876, device='cuda:0')
batch 19 loss: tensor(0.3608, device='cuda:0')
batch 20 loss: tensor(0.4016, device='cuda:0')
batch 21 loss: tensor(0.4013, device='cuda:0')
batch 22 loss: tensor(0.3765, device='cuda:0')
batch 23 loss: tensor(0.3166, device='cuda:0')
batch 24 loss: tensor(0.4174, device='cuda:0')
batch 25 loss: tensor(0.3774, device='cuda:0')
batch 26 loss: tensor(0.3681, device='cuda:0')
batch 27 loss: tensor(0.4235, device='cuda:0')
batch 28 loss: tensor(0.3462, device='cuda:0')
batch 29 loss: tensor(0.3411, device='cuda:0')
batch 30 loss: tensor(0.3922, device='cuda:0')
batch 31 loss: tensor(0.4499, device='cuda:0')
batch 32 loss: tensor(0.3700, device='cuda:0')
batch 33 loss: tensor(0.3692, device='cuda:0')
batch 34 loss: tensor(0.4007, device='cuda:0')
batch 35 loss: tensor(0.3818, device='cuda:0')
batch 36 loss: tensor(0.3964, device='cuda:0')
batch 37 loss: tensor(0.4108, device='cuda:0')
batch 38 loss: tensor(0.3782, device='cuda:0')
batch 39 loss: tensor(0.3645, device='cuda:0')
batch 40 loss: tensor(0.3829, device='cuda:0')
batch 41 loss: tensor(0.3685, device='cuda:0')
batch 42 loss: tensor(0.3904, device='cuda:0')
batch 43 loss: tensor(0.3511, device='cuda:0')
batch 44 loss: tensor(0.3555, device='cuda:0')
batch 45 loss: tensor(0.3399, device='cuda:0')
batch 46 loss: tensor(0.3996, device='cuda:0')
batch 47 loss: tensor(0.3243, device='cuda:0')
batch 48 loss: tensor(0.3245, device='cuda:0')
batch 49 loss: tensor(0.3763, device='cuda:0')
batch 50 loss: tensor(0.3965, device='cuda:0')
batch 51 loss: tensor(0.3314, device='cuda:0')
batch 52 loss: tensor(0.3696, device='cuda:0')
batch 53 loss: tensor(0.3224, device='cuda:0')
batch 54 loss: tensor(0.3621, device='cuda:0')
batch 55 loss: tensor(0.3398, device='cuda:0')
batch 56 loss: tensor(0.3808, device='cuda:0')
batch 57 loss: tensor(0.3957, device='cuda:0')
batch 58 loss: tensor(0.3407, device='cuda:0')
batch 59 loss: tensor(0.3349, device='cuda:0')
batch 60 loss: tensor(0.3688, device='cuda:0')
batch 61 loss: tensor(0.3695, device='cuda:0')
batch 62 loss: tensor(0.3967, device='cuda:0')
batch 63 loss: tensor(0.3195, device='cuda:0')
batch 64 loss: tensor(0.3509, device='cuda:0')
batch 65 loss: tensor(0.3751, device='cuda:0')
batch 66 loss: tensor(0.3695, device='cuda:0')
batch 67 loss: tensor(0.3855, device='cuda:0')
batch 68 loss: tensor(0.3735, device='cuda:0')
batch 69 loss: tensor(0.3294, device='cuda:0')
batch 70 loss: tensor(0.3353, device='cuda:0')
batch 71 loss: tensor(0.3612, device='cuda:0')
batch 72 loss: tensor(0.3513, device='cuda:0')
batch 73 loss: tensor(0.3385, device='cuda:0')
batch 74 loss: tensor(0.3130, device='cuda:0')
batch 75 loss: tensor(0.3464, device='cuda:0')
batch 76 loss: tensor(0.3800, device='cuda:0')
batch 77 loss: tensor(0.3588, device='cuda:0')
batch 78 loss: tensor(0.3034, device='cuda:0')
batch 79 loss: tensor(0.3453, device='cuda:0')
batch 80 loss: tensor(0.3352, device='cuda:0')
batch 81 loss: tensor(0.3864, device='cuda:0')
batch 82 loss: tensor(0.3407, device='cuda:0')
batch 83 loss: tensor(0.3934, device='cuda:0')
batch 84 loss: tensor(0.3606, device='cuda:0')
batch 85 loss: tensor(0.3436, device='cuda:0')
batch 86 loss: tensor(0.3912, device='cuda:0')
batch 87 loss: tensor(0.3075, device='cuda:0')
batch 88 loss: tensor(0.3605, device='cuda:0')
batch 89 loss: tensor(0.4134, device='cuda:0')
batch 90 loss: tensor(0.3889, device='cuda:0')
batch 91 loss: tensor(0.3659, device='cuda:0')
batch 92 loss: tensor(0.3472, device='cuda:0')
batch 93 loss: tensor(0.3734, device='cuda:0')
batch 94 loss: tensor(0.3457, device='cuda:0')
batch 95 loss: tensor(0.3684, device='cuda:0')
batch 96 loss: tensor(0.3820, device='cuda:0')
batch 97 loss: tensor(0.3433, device='cuda:0')
batch 98 loss: tensor(0.3410, device='cuda:0')
batch 99 loss: tensor(0.3313, device='cuda:0')
batch 100 loss: tensor(0.3796, device='cuda:0')
accuracy in val: 0.8394766666666666
accuracy in test: 0.8867652655440772
average epoch time: 1.748948804140091
total time: 349.7897608280182
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9847, device='cuda:0')
batch 2 loss: tensor(0.7527, device='cuda:0')
batch 3 loss: tensor(0.6302, device='cuda:0')
batch 4 loss: tensor(0.5770, device='cuda:0')
batch 5 loss: tensor(0.5894, device='cuda:0')
batch 6 loss: tensor(0.5563, device='cuda:0')
batch 7 loss: tensor(0.5397, device='cuda:0')
batch 8 loss: tensor(0.5863, device='cuda:0')
batch 9 loss: tensor(0.5688, device='cuda:0')
batch 10 loss: tensor(0.5451, device='cuda:0')
batch 11 loss: tensor(0.5800, device='cuda:0')
batch 12 loss: tensor(0.5012, device='cuda:0')
batch 13 loss: tensor(0.5037, device='cuda:0')
batch 14 loss: tensor(0.5265, device='cuda:0')
batch 15 loss: tensor(0.5708, device='cuda:0')
batch 16 loss: tensor(0.5490, device='cuda:0')
batch 17 loss: tensor(0.5587, device='cuda:0')
batch 18 loss: tensor(0.4716, device='cuda:0')
batch 19 loss: tensor(0.5326, device='cuda:0')
batch 20 loss: tensor(0.5445, device='cuda:0')
batch 21 loss: tensor(0.4736, device='cuda:0')
batch 22 loss: tensor(0.4381, device='cuda:0')
batch 23 loss: tensor(0.4979, device='cuda:0')
batch 24 loss: tensor(0.4748, device='cuda:0')
batch 25 loss: tensor(0.4614, device='cuda:0')
batch 26 loss: tensor(0.4603, device='cuda:0')
batch 27 loss: tensor(0.5272, device='cuda:0')
batch 28 loss: tensor(0.4826, device='cuda:0')
batch 29 loss: tensor(0.4573, device='cuda:0')
batch 30 loss: tensor(0.4944, device='cuda:0')
batch 31 loss: tensor(0.4636, device='cuda:0')
batch 32 loss: tensor(0.4540, device='cuda:0')
batch 33 loss: tensor(0.4362, device='cuda:0')
batch 34 loss: tensor(0.5765, device='cuda:0')
batch 35 loss: tensor(0.4551, device='cuda:0')
batch 36 loss: tensor(0.4749, device='cuda:0')
batch 37 loss: tensor(0.4954, device='cuda:0')
batch 38 loss: tensor(0.4632, device='cuda:0')
batch 39 loss: tensor(0.5722, device='cuda:0')
batch 40 loss: tensor(0.4364, device='cuda:0')
batch 41 loss: tensor(0.4636, device='cuda:0')
batch 42 loss: tensor(0.4631, device='cuda:0')
batch 43 loss: tensor(0.4207, device='cuda:0')
batch 44 loss: tensor(0.5562, device='cuda:0')
batch 45 loss: tensor(0.4397, device='cuda:0')
batch 46 loss: tensor(0.4203, device='cuda:0')
batch 47 loss: tensor(0.4486, device='cuda:0')
batch 48 loss: tensor(0.4930, device='cuda:0')
batch 49 loss: tensor(0.4248, device='cuda:0')
batch 50 loss: tensor(0.3671, device='cuda:0')
batch 51 loss: tensor(0.4801, device='cuda:0')
batch 52 loss: tensor(0.4059, device='cuda:0')
batch 53 loss: tensor(0.4623, device='cuda:0')
batch 54 loss: tensor(0.4242, device='cuda:0')
batch 55 loss: tensor(0.4323, device='cuda:0')
batch 56 loss: tensor(0.4416, device='cuda:0')
batch 57 loss: tensor(0.4565, device='cuda:0')
batch 58 loss: tensor(0.4785, device='cuda:0')
batch 59 loss: tensor(0.4431, device='cuda:0')
batch 60 loss: tensor(0.5186, device='cuda:0')
batch 61 loss: tensor(0.4131, device='cuda:0')
batch 62 loss: tensor(0.4385, device='cuda:0')
batch 63 loss: tensor(0.4923, device='cuda:0')
batch 64 loss: tensor(0.4376, device='cuda:0')
batch 65 loss: tensor(0.4342, device='cuda:0')
batch 66 loss: tensor(0.4889, device='cuda:0')
batch 67 loss: tensor(0.4521, device='cuda:0')
batch 68 loss: tensor(0.4854, device='cuda:0')
batch 69 loss: tensor(0.4392, device='cuda:0')
batch 70 loss: tensor(0.4795, device='cuda:0')
batch 71 loss: tensor(0.4251, device='cuda:0')
batch 72 loss: tensor(0.4718, device='cuda:0')
batch 73 loss: tensor(0.3847, device='cuda:0')
batch 74 loss: tensor(0.4377, device='cuda:0')
batch 75 loss: tensor(0.4475, device='cuda:0')
batch 76 loss: tensor(0.4597, device='cuda:0')
batch 77 loss: tensor(0.4767, device='cuda:0')
batch 78 loss: tensor(0.4692, device='cuda:0')
batch 79 loss: tensor(0.4600, device='cuda:0')
batch 80 loss: tensor(0.4785, device='cuda:0')
batch 81 loss: tensor(0.4476, device='cuda:0')
batch 82 loss: tensor(0.4003, device='cuda:0')
batch 83 loss: tensor(0.4641, device='cuda:0')
batch 84 loss: tensor(0.4116, device='cuda:0')
batch 85 loss: tensor(0.5211, device='cuda:0')
batch 86 loss: tensor(0.4661, device='cuda:0')
batch 87 loss: tensor(0.4280, device='cuda:0')
batch 88 loss: tensor(0.4518, device='cuda:0')
batch 89 loss: tensor(0.4743, device='cuda:0')
batch 90 loss: tensor(0.4359, device='cuda:0')
batch 91 loss: tensor(0.4233, device='cuda:0')
batch 92 loss: tensor(0.4259, device='cuda:0')
batch 93 loss: tensor(0.4612, device='cuda:0')
batch 94 loss: tensor(0.4442, device='cuda:0')
batch 95 loss: tensor(0.4424, device='cuda:0')
batch 96 loss: tensor(0.4881, device='cuda:0')
batch 97 loss: tensor(0.4360, device='cuda:0')
batch 98 loss: tensor(0.3924, device='cuda:0')
batch 99 loss: tensor(0.4872, device='cuda:0')
batch 100 loss: tensor(0.4770, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.4697, device='cuda:0')
batch 2 loss: tensor(0.4505, device='cuda:0')
batch 3 loss: tensor(0.4395, device='cuda:0')
batch 4 loss: tensor(0.4156, device='cuda:0')
batch 5 loss: tensor(0.4389, device='cuda:0')
batch 6 loss: tensor(0.4347, device='cuda:0')
batch 7 loss: tensor(0.3990, device='cuda:0')
batch 8 loss: tensor(0.3895, device='cuda:0')
batch 9 loss: tensor(0.3732, device='cuda:0')
batch 10 loss: tensor(0.3762, device='cuda:0')
batch 11 loss: tensor(0.4129, device='cuda:0')
batch 12 loss: tensor(0.3769, device='cuda:0')
batch 13 loss: tensor(0.4187, device='cuda:0')
batch 14 loss: tensor(0.3788, device='cuda:0')
batch 15 loss: tensor(0.3963, device='cuda:0')
batch 16 loss: tensor(0.4404, device='cuda:0')
batch 17 loss: tensor(0.3588, device='cuda:0')
batch 18 loss: tensor(0.3442, device='cuda:0')
batch 19 loss: tensor(0.3636, device='cuda:0')
batch 20 loss: tensor(0.3573, device='cuda:0')
batch 21 loss: tensor(0.4086, device='cuda:0')
batch 22 loss: tensor(0.4094, device='cuda:0')
batch 23 loss: tensor(0.3392, device='cuda:0')
batch 24 loss: tensor(0.3764, device='cuda:0')
batch 25 loss: tensor(0.3891, device='cuda:0')
batch 26 loss: tensor(0.3688, device='cuda:0')
batch 27 loss: tensor(0.3502, device='cuda:0')
batch 28 loss: tensor(0.4104, device='cuda:0')
batch 29 loss: tensor(0.3931, device='cuda:0')
batch 30 loss: tensor(0.4016, device='cuda:0')
batch 31 loss: tensor(0.3997, device='cuda:0')
batch 32 loss: tensor(0.4052, device='cuda:0')
batch 33 loss: tensor(0.4025, device='cuda:0')
batch 34 loss: tensor(0.3536, device='cuda:0')
batch 35 loss: tensor(0.3749, device='cuda:0')
batch 36 loss: tensor(0.3449, device='cuda:0')
batch 37 loss: tensor(0.3748, device='cuda:0')
batch 38 loss: tensor(0.3588, device='cuda:0')
batch 39 loss: tensor(0.2916, device='cuda:0')
batch 40 loss: tensor(0.3565, device='cuda:0')
batch 41 loss: tensor(0.3139, device='cuda:0')
batch 42 loss: tensor(0.3432, device='cuda:0')
batch 43 loss: tensor(0.3892, device='cuda:0')
batch 44 loss: tensor(0.3674, device='cuda:0')
batch 45 loss: tensor(0.3309, device='cuda:0')
batch 46 loss: tensor(0.3397, device='cuda:0')
batch 47 loss: tensor(0.3643, device='cuda:0')
batch 48 loss: tensor(0.3707, device='cuda:0')
batch 49 loss: tensor(0.3285, device='cuda:0')
batch 50 loss: tensor(0.3285, device='cuda:0')
batch 51 loss: tensor(0.3646, device='cuda:0')
batch 52 loss: tensor(0.3944, device='cuda:0')
batch 53 loss: tensor(0.3883, device='cuda:0')
batch 54 loss: tensor(0.4593, device='cuda:0')
batch 55 loss: tensor(0.3815, device='cuda:0')
batch 56 loss: tensor(0.3386, device='cuda:0')
batch 57 loss: tensor(0.3773, device='cuda:0')
batch 58 loss: tensor(0.3488, device='cuda:0')
batch 59 loss: tensor(0.4414, device='cuda:0')
batch 60 loss: tensor(0.3836, device='cuda:0')
batch 61 loss: tensor(0.3556, device='cuda:0')
batch 62 loss: tensor(0.3791, device='cuda:0')
batch 63 loss: tensor(0.3585, device='cuda:0')
batch 64 loss: tensor(0.2950, device='cuda:0')
batch 65 loss: tensor(0.3919, device='cuda:0')
batch 66 loss: tensor(0.4184, device='cuda:0')
batch 67 loss: tensor(0.3206, device='cuda:0')
batch 68 loss: tensor(0.3590, device='cuda:0')
batch 69 loss: tensor(0.3654, device='cuda:0')
batch 70 loss: tensor(0.4346, device='cuda:0')
batch 71 loss: tensor(0.3496, device='cuda:0')
batch 72 loss: tensor(0.3787, device='cuda:0')
batch 73 loss: tensor(0.3642, device='cuda:0')
batch 74 loss: tensor(0.3945, device='cuda:0')
batch 75 loss: tensor(0.3968, device='cuda:0')
batch 76 loss: tensor(0.3820, device='cuda:0')
batch 77 loss: tensor(0.3713, device='cuda:0')
batch 78 loss: tensor(0.4021, device='cuda:0')
batch 79 loss: tensor(0.3214, device='cuda:0')
batch 80 loss: tensor(0.3503, device='cuda:0')
batch 81 loss: tensor(0.3706, device='cuda:0')
batch 82 loss: tensor(0.3911, device='cuda:0')
batch 83 loss: tensor(0.3312, device='cuda:0')
batch 84 loss: tensor(0.3783, device='cuda:0')
batch 85 loss: tensor(0.3255, device='cuda:0')
batch 86 loss: tensor(0.3588, device='cuda:0')
batch 87 loss: tensor(0.3259, device='cuda:0')
batch 88 loss: tensor(0.3601, device='cuda:0')
batch 89 loss: tensor(0.3841, device='cuda:0')
batch 90 loss: tensor(0.4012, device='cuda:0')
batch 91 loss: tensor(0.3430, device='cuda:0')
batch 92 loss: tensor(0.3979, device='cuda:0')
batch 93 loss: tensor(0.4412, device='cuda:0')
batch 94 loss: tensor(0.3833, device='cuda:0')
batch 95 loss: tensor(0.3898, device='cuda:0')
batch 96 loss: tensor(0.3809, device='cuda:0')
batch 97 loss: tensor(0.3499, device='cuda:0')
batch 98 loss: tensor(0.3962, device='cuda:0')
batch 99 loss: tensor(0.3052, device='cuda:0')
batch 100 loss: tensor(0.3205, device='cuda:0')
accuracy in val: 0.8368
accuracy in test: 0.8866742596810934
average epoch time: 1.7498505413532257
total time: 349.97010827064514
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 2, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [100, 100], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9367, device='cuda:0')
batch 2 loss: tensor(0.7052, device='cuda:0')
batch 3 loss: tensor(0.7515, device='cuda:0')
batch 4 loss: tensor(0.5812, device='cuda:0')
batch 5 loss: tensor(0.5438, device='cuda:0')
batch 6 loss: tensor(0.5347, device='cuda:0')
batch 7 loss: tensor(0.5412, device='cuda:0')
batch 8 loss: tensor(0.5972, device='cuda:0')
batch 9 loss: tensor(0.6158, device='cuda:0')
batch 10 loss: tensor(0.5547, device='cuda:0')
batch 11 loss: tensor(0.5529, device='cuda:0')
batch 12 loss: tensor(0.5680, device='cuda:0')
batch 13 loss: tensor(0.5509, device='cuda:0')
batch 14 loss: tensor(0.5407, device='cuda:0')
batch 15 loss: tensor(0.5333, device='cuda:0')
batch 16 loss: tensor(0.5574, device='cuda:0')
batch 17 loss: tensor(0.5654, device='cuda:0')
batch 18 loss: tensor(0.4598, device='cuda:0')
batch 19 loss: tensor(0.5011, device='cuda:0')
batch 20 loss: tensor(0.5379, device='cuda:0')
batch 21 loss: tensor(0.4742, device='cuda:0')
batch 22 loss: tensor(0.5100, device='cuda:0')
batch 23 loss: tensor(0.4780, device='cuda:0')
batch 24 loss: tensor(0.4487, device='cuda:0')
batch 25 loss: tensor(0.5060, device='cuda:0')
batch 26 loss: tensor(0.5204, device='cuda:0')
batch 27 loss: tensor(0.4827, device='cuda:0')
batch 28 loss: tensor(0.4797, device='cuda:0')
batch 29 loss: tensor(0.4738, device='cuda:0')
batch 30 loss: tensor(0.5104, device='cuda:0')
batch 31 loss: tensor(0.4788, device='cuda:0')
batch 32 loss: tensor(0.4900, device='cuda:0')
batch 33 loss: tensor(0.4388, device='cuda:0')
batch 34 loss: tensor(0.4508, device='cuda:0')
batch 35 loss: tensor(0.4347, device='cuda:0')
batch 36 loss: tensor(0.4802, device='cuda:0')
batch 37 loss: tensor(0.5125, device='cuda:0')
batch 38 loss: tensor(0.4616, device='cuda:0')
batch 39 loss: tensor(0.5394, device='cuda:0')
batch 40 loss: tensor(0.4410, device='cuda:0')
batch 41 loss: tensor(0.4343, device='cuda:0')
batch 42 loss: tensor(0.5310, device='cuda:0')
batch 43 loss: tensor(0.4978, device='cuda:0')
batch 44 loss: tensor(0.4494, device='cuda:0')
batch 45 loss: tensor(0.4893, device='cuda:0')
batch 46 loss: tensor(0.4219, device='cuda:0')
batch 47 loss: tensor(0.4990, device='cuda:0')
batch 48 loss: tensor(0.5371, device='cuda:0')
batch 49 loss: tensor(0.4723, device='cuda:0')
batch 50 loss: tensor(0.4421, device='cuda:0')
batch 51 loss: tensor(0.4433, device='cuda:0')
batch 52 loss: tensor(0.4919, device='cuda:0')
batch 53 loss: tensor(0.4996, device='cuda:0')
batch 54 loss: tensor(0.4839, device='cuda:0')
batch 55 loss: tensor(0.4645, device='cuda:0')
batch 56 loss: tensor(0.4285, device='cuda:0')
batch 57 loss: tensor(0.4118, device='cuda:0')
batch 58 loss: tensor(0.4731, device='cuda:0')
batch 59 loss: tensor(0.4379, device='cuda:0')
batch 60 loss: tensor(0.5114, device='cuda:0')
batch 61 loss: tensor(0.4866, device='cuda:0')
batch 62 loss: tensor(0.4473, device='cuda:0')
batch 63 loss: tensor(0.4506, device='cuda:0')
batch 64 loss: tensor(0.4453, device='cuda:0')
batch 65 loss: tensor(0.4154, device='cuda:0')
batch 66 loss: tensor(0.4738, device='cuda:0')
batch 67 loss: tensor(0.5047, device='cuda:0')
batch 68 loss: tensor(0.4634, device='cuda:0')
batch 69 loss: tensor(0.4198, device='cuda:0')
batch 70 loss: tensor(0.4836, device='cuda:0')
batch 71 loss: tensor(0.4538, device='cuda:0')
batch 72 loss: tensor(0.5243, device='cuda:0')
batch 73 loss: tensor(0.4588, device='cuda:0')
batch 74 loss: tensor(0.4490, device='cuda:0')
batch 75 loss: tensor(0.3953, device='cuda:0')
batch 76 loss: tensor(0.4519, device='cuda:0')
batch 77 loss: tensor(0.4390, device='cuda:0')
batch 78 loss: tensor(0.4398, device='cuda:0')
batch 79 loss: tensor(0.4528, device='cuda:0')
batch 80 loss: tensor(0.4362, device='cuda:0')
batch 81 loss: tensor(0.4079, device='cuda:0')
batch 82 loss: tensor(0.5348, device='cuda:0')
batch 83 loss: tensor(0.3936, device='cuda:0')
batch 84 loss: tensor(0.3953, device='cuda:0')
batch 85 loss: tensor(0.4469, device='cuda:0')
batch 86 loss: tensor(0.4611, device='cuda:0')
batch 87 loss: tensor(0.4499, device='cuda:0')
batch 88 loss: tensor(0.4453, device='cuda:0')
batch 89 loss: tensor(0.5060, device='cuda:0')
batch 90 loss: tensor(0.4283, device='cuda:0')
batch 91 loss: tensor(0.4313, device='cuda:0')
batch 92 loss: tensor(0.4708, device='cuda:0')
batch 93 loss: tensor(0.4361, device='cuda:0')
batch 94 loss: tensor(0.4353, device='cuda:0')
batch 95 loss: tensor(0.4256, device='cuda:0')
batch 96 loss: tensor(0.4726, device='cuda:0')
batch 97 loss: tensor(0.4189, device='cuda:0')
batch 98 loss: tensor(0.4757, device='cuda:0')
batch 99 loss: tensor(0.4942, device='cuda:0')
batch 100 loss: tensor(0.3670, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.4889, device='cuda:0')
batch 2 loss: tensor(0.4937, device='cuda:0')
batch 3 loss: tensor(0.4048, device='cuda:0')
batch 4 loss: tensor(0.4309, device='cuda:0')
batch 5 loss: tensor(0.3895, device='cuda:0')
batch 6 loss: tensor(0.4083, device='cuda:0')
batch 7 loss: tensor(0.4037, device='cuda:0')
batch 8 loss: tensor(0.4398, device='cuda:0')
batch 9 loss: tensor(0.4191, device='cuda:0')
batch 10 loss: tensor(0.3938, device='cuda:0')
batch 11 loss: tensor(0.3689, device='cuda:0')
batch 12 loss: tensor(0.3699, device='cuda:0')
batch 13 loss: tensor(0.3470, device='cuda:0')
batch 14 loss: tensor(0.3248, device='cuda:0')
batch 15 loss: tensor(0.4533, device='cuda:0')
batch 16 loss: tensor(0.3696, device='cuda:0')
batch 17 loss: tensor(0.3920, device='cuda:0')
batch 18 loss: tensor(0.3766, device='cuda:0')
batch 19 loss: tensor(0.3970, device='cuda:0')
batch 20 loss: tensor(0.3726, device='cuda:0')
batch 21 loss: tensor(0.4157, device='cuda:0')
batch 22 loss: tensor(0.3794, device='cuda:0')
batch 23 loss: tensor(0.3515, device='cuda:0')
batch 24 loss: tensor(0.4118, device='cuda:0')
batch 25 loss: tensor(0.3604, device='cuda:0')
batch 26 loss: tensor(0.3414, device='cuda:0')
batch 27 loss: tensor(0.3941, device='cuda:0')
batch 28 loss: tensor(0.4344, device='cuda:0')
batch 29 loss: tensor(0.4159, device='cuda:0')
batch 30 loss: tensor(0.3828, device='cuda:0')
batch 31 loss: tensor(0.3918, device='cuda:0')
batch 32 loss: tensor(0.3994, device='cuda:0')
batch 33 loss: tensor(0.3433, device='cuda:0')
batch 34 loss: tensor(0.3862, device='cuda:0')
batch 35 loss: tensor(0.3713, device='cuda:0')
batch 36 loss: tensor(0.3602, device='cuda:0')
batch 37 loss: tensor(0.3472, device='cuda:0')
batch 38 loss: tensor(0.4075, device='cuda:0')
batch 39 loss: tensor(0.3602, device='cuda:0')
batch 40 loss: tensor(0.4424, device='cuda:0')
batch 41 loss: tensor(0.4212, device='cuda:0')
batch 42 loss: tensor(0.3765, device='cuda:0')
batch 43 loss: tensor(0.3863, device='cuda:0')
batch 44 loss: tensor(0.3757, device='cuda:0')
batch 45 loss: tensor(0.3958, device='cuda:0')
batch 46 loss: tensor(0.4115, device='cuda:0')
batch 47 loss: tensor(0.3826, device='cuda:0')
batch 48 loss: tensor(0.3852, device='cuda:0')
batch 49 loss: tensor(0.3568, device='cuda:0')
batch 50 loss: tensor(0.4211, device='cuda:0')
batch 51 loss: tensor(0.3145, device='cuda:0')
batch 52 loss: tensor(0.3596, device='cuda:0')
batch 53 loss: tensor(0.3496, device='cuda:0')
batch 54 loss: tensor(0.3402, device='cuda:0')
batch 55 loss: tensor(0.4002, device='cuda:0')
batch 56 loss: tensor(0.3969, device='cuda:0')
batch 57 loss: tensor(0.3399, device='cuda:0')
batch 58 loss: tensor(0.3775, device='cuda:0')
batch 59 loss: tensor(0.3527, device='cuda:0')
batch 60 loss: tensor(0.3771, device='cuda:0')
batch 61 loss: tensor(0.3805, device='cuda:0')
batch 62 loss: tensor(0.3609, device='cuda:0')
batch 63 loss: tensor(0.3888, device='cuda:0')
batch 64 loss: tensor(0.3488, device='cuda:0')
batch 65 loss: tensor(0.3276, device='cuda:0')
batch 66 loss: tensor(0.3158, device='cuda:0')
batch 67 loss: tensor(0.3532, device='cuda:0')
batch 68 loss: tensor(0.3710, device='cuda:0')
batch 69 loss: tensor(0.3795, device='cuda:0')
batch 70 loss: tensor(0.3508, device='cuda:0')
batch 71 loss: tensor(0.3573, device='cuda:0')
batch 72 loss: tensor(0.3440, device='cuda:0')
batch 73 loss: tensor(0.3883, device='cuda:0')
batch 74 loss: tensor(0.3583, device='cuda:0')
batch 75 loss: tensor(0.4025, device='cuda:0')
batch 76 loss: tensor(0.3731, device='cuda:0')
batch 77 loss: tensor(0.3976, device='cuda:0')
batch 78 loss: tensor(0.3318, device='cuda:0')
batch 79 loss: tensor(0.3518, device='cuda:0')
batch 80 loss: tensor(0.4100, device='cuda:0')
batch 81 loss: tensor(0.3416, device='cuda:0')
batch 82 loss: tensor(0.3343, device='cuda:0')
batch 83 loss: tensor(0.3815, device='cuda:0')
batch 84 loss: tensor(0.3880, device='cuda:0')
batch 85 loss: tensor(0.3345, device='cuda:0')
batch 86 loss: tensor(0.3708, device='cuda:0')
batch 87 loss: tensor(0.3588, device='cuda:0')
batch 88 loss: tensor(0.4022, device='cuda:0')
batch 89 loss: tensor(0.4060, device='cuda:0')
batch 90 loss: tensor(0.3725, device='cuda:0')
batch 91 loss: tensor(0.3059, device='cuda:0')
batch 92 loss: tensor(0.3889, device='cuda:0')
batch 93 loss: tensor(0.3230, device='cuda:0')
batch 94 loss: tensor(0.3457, device='cuda:0')
batch 95 loss: tensor(0.3857, device='cuda:0')
batch 96 loss: tensor(0.3572, device='cuda:0')
batch 97 loss: tensor(0.3265, device='cuda:0')
batch 98 loss: tensor(0.3649, device='cuda:0')
batch 99 loss: tensor(0.3551, device='cuda:0')
batch 100 loss: tensor(0.4122, device='cuda:0')
accuracy in val: 0.8384800000000001
accuracy in test: 0.8864536394071932
average epoch time: 1.81016432762146
total time: 362.032865524292

0.8864794244017054 351.8996026754379
0.00025624044767057544 3.9810535984031823
Fri Nov 22 04:06:30 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |      8%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     40803      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 04:42:43 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     40803      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 05:18:08 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |     14%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     40803      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 05:53:23 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |      2%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   38C    P8    32W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     40803      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 06:28:18 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |      9%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     40803      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 07:03:32 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |      7%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     40803      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 07:38:45 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     40803      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 08:14:41 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |      2%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     40803      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 08:50:57 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |     14%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     40803      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 09:26:16 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   34C    P0    56W / 149W |    335MiB / 12206MiB |      3%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     40803      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
{'dataset': 'amazon_3m', 'config_file': 'amazon_3m.yaml', 'layer_num': 3, 'epoch_num': [80, 80, 80]}
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 3, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9764, device='cuda:0')
batch 2 loss: tensor(0.7395, device='cuda:0')
batch 3 loss: tensor(0.6930, device='cuda:0')
batch 4 loss: tensor(0.6138, device='cuda:0')
batch 5 loss: tensor(0.5991, device='cuda:0')
batch 6 loss: tensor(0.5893, device='cuda:0')
batch 7 loss: tensor(0.5589, device='cuda:0')
batch 8 loss: tensor(0.5113, device='cuda:0')
batch 9 loss: tensor(0.5271, device='cuda:0')
batch 10 loss: tensor(0.5305, device='cuda:0')
batch 11 loss: tensor(0.5208, device='cuda:0')
batch 12 loss: tensor(0.5681, device='cuda:0')
batch 13 loss: tensor(0.6023, device='cuda:0')
batch 14 loss: tensor(0.4993, device='cuda:0')
batch 15 loss: tensor(0.4846, device='cuda:0')
batch 16 loss: tensor(0.5123, device='cuda:0')
batch 17 loss: tensor(0.5109, device='cuda:0')
batch 18 loss: tensor(0.5673, device='cuda:0')
batch 19 loss: tensor(0.5046, device='cuda:0')
batch 20 loss: tensor(0.4743, device='cuda:0')
batch 21 loss: tensor(0.4687, device='cuda:0')
batch 22 loss: tensor(0.5191, device='cuda:0')
batch 23 loss: tensor(0.4662, device='cuda:0')
batch 24 loss: tensor(0.4599, device='cuda:0')
batch 25 loss: tensor(0.4397, device='cuda:0')
batch 26 loss: tensor(0.4791, device='cuda:0')
batch 27 loss: tensor(0.4793, device='cuda:0')
batch 28 loss: tensor(0.5402, device='cuda:0')
batch 29 loss: tensor(0.4825, device='cuda:0')
batch 30 loss: tensor(0.4894, device='cuda:0')
batch 31 loss: tensor(0.5067, device='cuda:0')
batch 32 loss: tensor(0.4265, device='cuda:0')
batch 33 loss: tensor(0.4909, device='cuda:0')
batch 34 loss: tensor(0.5024, device='cuda:0')
batch 35 loss: tensor(0.4950, device='cuda:0')
batch 36 loss: tensor(0.4738, device='cuda:0')
batch 37 loss: tensor(0.4805, device='cuda:0')
batch 38 loss: tensor(0.4646, device='cuda:0')
batch 39 loss: tensor(0.4989, device='cuda:0')
batch 40 loss: tensor(0.4377, device='cuda:0')
batch 41 loss: tensor(0.5093, device='cuda:0')
batch 42 loss: tensor(0.4737, device='cuda:0')
batch 43 loss: tensor(0.4623, device='cuda:0')
batch 44 loss: tensor(0.4827, device='cuda:0')
batch 45 loss: tensor(0.5477, device='cuda:0')
batch 46 loss: tensor(0.4478, device='cuda:0')
batch 47 loss: tensor(0.4435, device='cuda:0')
batch 48 loss: tensor(0.4481, device='cuda:0')
batch 49 loss: tensor(0.4859, device='cuda:0')
batch 50 loss: tensor(0.5402, device='cuda:0')
batch 51 loss: tensor(0.4408, device='cuda:0')
batch 52 loss: tensor(0.4893, device='cuda:0')
batch 53 loss: tensor(0.4903, device='cuda:0')
batch 54 loss: tensor(0.4516, device='cuda:0')
batch 55 loss: tensor(0.4759, device='cuda:0')
batch 56 loss: tensor(0.4653, device='cuda:0')
batch 57 loss: tensor(0.4659, device='cuda:0')
batch 58 loss: tensor(0.4520, device='cuda:0')
batch 59 loss: tensor(0.3997, device='cuda:0')
batch 60 loss: tensor(0.4419, device='cuda:0')
batch 61 loss: tensor(0.4645, device='cuda:0')
batch 62 loss: tensor(0.4500, device='cuda:0')
batch 63 loss: tensor(0.5010, device='cuda:0')
batch 64 loss: tensor(0.4458, device='cuda:0')
batch 65 loss: tensor(0.4356, device='cuda:0')
batch 66 loss: tensor(0.4904, device='cuda:0')
batch 67 loss: tensor(0.4814, device='cuda:0')
batch 68 loss: tensor(0.4828, device='cuda:0')
batch 69 loss: tensor(0.3852, device='cuda:0')
batch 70 loss: tensor(0.4861, device='cuda:0')
batch 71 loss: tensor(0.4186, device='cuda:0')
batch 72 loss: tensor(0.4464, device='cuda:0')
batch 73 loss: tensor(0.4615, device='cuda:0')
batch 74 loss: tensor(0.4414, device='cuda:0')
batch 75 loss: tensor(0.4251, device='cuda:0')
batch 76 loss: tensor(0.4648, device='cuda:0')
batch 77 loss: tensor(0.4273, device='cuda:0')
batch 78 loss: tensor(0.5225, device='cuda:0')
batch 79 loss: tensor(0.4843, device='cuda:0')
batch 80 loss: tensor(0.4532, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5580, device='cuda:0')
batch 2 loss: tensor(0.4245, device='cuda:0')
batch 3 loss: tensor(0.3891, device='cuda:0')
batch 4 loss: tensor(0.4564, device='cuda:0')
batch 5 loss: tensor(0.3806, device='cuda:0')
batch 6 loss: tensor(0.4503, device='cuda:0')
batch 7 loss: tensor(0.4656, device='cuda:0')
batch 8 loss: tensor(0.4220, device='cuda:0')
batch 9 loss: tensor(0.4030, device='cuda:0')
batch 10 loss: tensor(0.4251, device='cuda:0')
batch 11 loss: tensor(0.3903, device='cuda:0')
batch 12 loss: tensor(0.3702, device='cuda:0')
batch 13 loss: tensor(0.3844, device='cuda:0')
batch 14 loss: tensor(0.4032, device='cuda:0')
batch 15 loss: tensor(0.4395, device='cuda:0')
batch 16 loss: tensor(0.3952, device='cuda:0')
batch 17 loss: tensor(0.3411, device='cuda:0')
batch 18 loss: tensor(0.4258, device='cuda:0')
batch 19 loss: tensor(0.3899, device='cuda:0')
batch 20 loss: tensor(0.3671, device='cuda:0')
batch 21 loss: tensor(0.3595, device='cuda:0')
batch 22 loss: tensor(0.4067, device='cuda:0')
batch 23 loss: tensor(0.3348, device='cuda:0')
batch 24 loss: tensor(0.4478, device='cuda:0')
batch 25 loss: tensor(0.3344, device='cuda:0')
batch 26 loss: tensor(0.3434, device='cuda:0')
batch 27 loss: tensor(0.3932, device='cuda:0')
batch 28 loss: tensor(0.4043, device='cuda:0')
batch 29 loss: tensor(0.3250, device='cuda:0')
batch 30 loss: tensor(0.3204, device='cuda:0')
batch 31 loss: tensor(0.3478, device='cuda:0')
batch 32 loss: tensor(0.3420, device='cuda:0')
batch 33 loss: tensor(0.4103, device='cuda:0')
batch 34 loss: tensor(0.3552, device='cuda:0')
batch 35 loss: tensor(0.3214, device='cuda:0')
batch 36 loss: tensor(0.3353, device='cuda:0')
batch 37 loss: tensor(0.4241, device='cuda:0')
batch 38 loss: tensor(0.3202, device='cuda:0')
batch 39 loss: tensor(0.4220, device='cuda:0')
batch 40 loss: tensor(0.3727, device='cuda:0')
batch 41 loss: tensor(0.3349, device='cuda:0')
batch 42 loss: tensor(0.3738, device='cuda:0')
batch 43 loss: tensor(0.3116, device='cuda:0')
batch 44 loss: tensor(0.3743, device='cuda:0')
batch 45 loss: tensor(0.3598, device='cuda:0')
batch 46 loss: tensor(0.3844, device='cuda:0')
batch 47 loss: tensor(0.4152, device='cuda:0')
batch 48 loss: tensor(0.3438, device='cuda:0')
batch 49 loss: tensor(0.3956, device='cuda:0')
batch 50 loss: tensor(0.3737, device='cuda:0')
batch 51 loss: tensor(0.3972, device='cuda:0')
batch 52 loss: tensor(0.3541, device='cuda:0')
batch 53 loss: tensor(0.3375, device='cuda:0')
batch 54 loss: tensor(0.3705, device='cuda:0')
batch 55 loss: tensor(0.4225, device='cuda:0')
batch 56 loss: tensor(0.3484, device='cuda:0')
batch 57 loss: tensor(0.3730, device='cuda:0')
batch 58 loss: tensor(0.3599, device='cuda:0')
batch 59 loss: tensor(0.3784, device='cuda:0')
batch 60 loss: tensor(0.3830, device='cuda:0')
batch 61 loss: tensor(0.3435, device='cuda:0')
batch 62 loss: tensor(0.3960, device='cuda:0')
batch 63 loss: tensor(0.3370, device='cuda:0')
batch 64 loss: tensor(0.3367, device='cuda:0')
batch 65 loss: tensor(0.3399, device='cuda:0')
batch 66 loss: tensor(0.3591, device='cuda:0')
batch 67 loss: tensor(0.3354, device='cuda:0')
batch 68 loss: tensor(0.3702, device='cuda:0')
batch 69 loss: tensor(0.3944, device='cuda:0')
batch 70 loss: tensor(0.3522, device='cuda:0')
batch 71 loss: tensor(0.3280, device='cuda:0')
batch 72 loss: tensor(0.3429, device='cuda:0')
batch 73 loss: tensor(0.3563, device='cuda:0')
batch 74 loss: tensor(0.3390, device='cuda:0')
batch 75 loss: tensor(0.3385, device='cuda:0')
batch 76 loss: tensor(0.3642, device='cuda:0')
batch 77 loss: tensor(0.3481, device='cuda:0')
batch 78 loss: tensor(0.3869, device='cuda:0')
batch 79 loss: tensor(0.3554, device='cuda:0')
batch 80 loss: tensor(0.3417, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.4547, device='cuda:0')
batch 2 loss: tensor(0.4269, device='cuda:0')
batch 3 loss: tensor(0.3603, device='cuda:0')
batch 4 loss: tensor(0.4172, device='cuda:0')
batch 5 loss: tensor(0.3596, device='cuda:0')
batch 6 loss: tensor(0.3904, device='cuda:0')
batch 7 loss: tensor(0.4150, device='cuda:0')
batch 8 loss: tensor(0.3163, device='cuda:0')
batch 9 loss: tensor(0.3963, device='cuda:0')
batch 10 loss: tensor(0.3501, device='cuda:0')
batch 11 loss: tensor(0.3308, device='cuda:0')
batch 12 loss: tensor(0.3643, device='cuda:0')
batch 13 loss: tensor(0.3861, device='cuda:0')
batch 14 loss: tensor(0.3592, device='cuda:0')
batch 15 loss: tensor(0.3374, device='cuda:0')
batch 16 loss: tensor(0.3256, device='cuda:0')
batch 17 loss: tensor(0.3864, device='cuda:0')
batch 18 loss: tensor(0.3101, device='cuda:0')
batch 19 loss: tensor(0.3473, device='cuda:0')
batch 20 loss: tensor(0.3649, device='cuda:0')
batch 21 loss: tensor(0.3543, device='cuda:0')
batch 22 loss: tensor(0.3674, device='cuda:0')
batch 23 loss: tensor(0.4142, device='cuda:0')
batch 24 loss: tensor(0.3332, device='cuda:0')
batch 25 loss: tensor(0.3707, device='cuda:0')
batch 26 loss: tensor(0.3602, device='cuda:0')
batch 27 loss: tensor(0.3423, device='cuda:0')
batch 28 loss: tensor(0.3794, device='cuda:0')
batch 29 loss: tensor(0.2842, device='cuda:0')
batch 30 loss: tensor(0.3784, device='cuda:0')
batch 31 loss: tensor(0.3483, device='cuda:0')
batch 32 loss: tensor(0.3374, device='cuda:0')
batch 33 loss: tensor(0.3551, device='cuda:0')
batch 34 loss: tensor(0.3395, device='cuda:0')
batch 35 loss: tensor(0.4101, device='cuda:0')
batch 36 loss: tensor(0.3409, device='cuda:0')
batch 37 loss: tensor(0.3806, device='cuda:0')
batch 38 loss: tensor(0.3405, device='cuda:0')
batch 39 loss: tensor(0.3823, device='cuda:0')
batch 40 loss: tensor(0.3300, device='cuda:0')
batch 41 loss: tensor(0.3108, device='cuda:0')
batch 42 loss: tensor(0.3484, device='cuda:0')
batch 43 loss: tensor(0.3453, device='cuda:0')
batch 44 loss: tensor(0.4162, device='cuda:0')
batch 45 loss: tensor(0.3342, device='cuda:0')
batch 46 loss: tensor(0.3346, device='cuda:0')
batch 47 loss: tensor(0.3720, device='cuda:0')
batch 48 loss: tensor(0.3185, device='cuda:0')
batch 49 loss: tensor(0.3974, device='cuda:0')
batch 50 loss: tensor(0.3348, device='cuda:0')
batch 51 loss: tensor(0.3011, device='cuda:0')
batch 52 loss: tensor(0.3287, device='cuda:0')
batch 53 loss: tensor(0.3486, device='cuda:0')
batch 54 loss: tensor(0.3370, device='cuda:0')
batch 55 loss: tensor(0.2895, device='cuda:0')
batch 56 loss: tensor(0.2897, device='cuda:0')
batch 57 loss: tensor(0.3278, device='cuda:0')
batch 58 loss: tensor(0.3393, device='cuda:0')
batch 59 loss: tensor(0.3400, device='cuda:0')
batch 60 loss: tensor(0.3384, device='cuda:0')
batch 61 loss: tensor(0.3442, device='cuda:0')
batch 62 loss: tensor(0.4179, device='cuda:0')
batch 63 loss: tensor(0.3135, device='cuda:0')
batch 64 loss: tensor(0.3074, device='cuda:0')
batch 65 loss: tensor(0.3624, device='cuda:0')
batch 66 loss: tensor(0.3392, device='cuda:0')
batch 67 loss: tensor(0.3232, device='cuda:0')
batch 68 loss: tensor(0.3218, device='cuda:0')
batch 69 loss: tensor(0.3140, device='cuda:0')
batch 70 loss: tensor(0.3657, device='cuda:0')
batch 71 loss: tensor(0.3042, device='cuda:0')
batch 72 loss: tensor(0.3699, device='cuda:0')
batch 73 loss: tensor(0.2958, device='cuda:0')
batch 74 loss: tensor(0.3490, device='cuda:0')
batch 75 loss: tensor(0.3079, device='cuda:0')
batch 76 loss: tensor(0.3292, device='cuda:0')
batch 77 loss: tensor(0.3027, device='cuda:0')
batch 78 loss: tensor(0.2864, device='cuda:0')
batch 79 loss: tensor(0.3362, device='cuda:0')
batch 80 loss: tensor(0.3337, device='cuda:0')
accuracy in val: 0.84471
accuracy in test: 0.8921277170765608
average epoch time: 1.8346872061491013
total time: 440.3249294757843
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 3, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9016, device='cuda:0')
batch 2 loss: tensor(0.7840, device='cuda:0')
batch 3 loss: tensor(0.6918, device='cuda:0')
batch 4 loss: tensor(0.6328, device='cuda:0')
batch 5 loss: tensor(0.5977, device='cuda:0')
batch 6 loss: tensor(0.5532, device='cuda:0')
batch 7 loss: tensor(0.6048, device='cuda:0')
batch 8 loss: tensor(0.5021, device='cuda:0')
batch 9 loss: tensor(0.5910, device='cuda:0')
batch 10 loss: tensor(0.5759, device='cuda:0')
batch 11 loss: tensor(0.5304, device='cuda:0')
batch 12 loss: tensor(0.5483, device='cuda:0')
batch 13 loss: tensor(0.5562, device='cuda:0')
batch 14 loss: tensor(0.5181, device='cuda:0')
batch 15 loss: tensor(0.5114, device='cuda:0')
batch 16 loss: tensor(0.4628, device='cuda:0')
batch 17 loss: tensor(0.5466, device='cuda:0')
batch 18 loss: tensor(0.4818, device='cuda:0')
batch 19 loss: tensor(0.5102, device='cuda:0')
batch 20 loss: tensor(0.4754, device='cuda:0')
batch 21 loss: tensor(0.4797, device='cuda:0')
batch 22 loss: tensor(0.5220, device='cuda:0')
batch 23 loss: tensor(0.5131, device='cuda:0')
batch 24 loss: tensor(0.4867, device='cuda:0')
batch 25 loss: tensor(0.5364, device='cuda:0')
batch 26 loss: tensor(0.5178, device='cuda:0')
batch 27 loss: tensor(0.4441, device='cuda:0')
batch 28 loss: tensor(0.4714, device='cuda:0')
batch 29 loss: tensor(0.5055, device='cuda:0')
batch 30 loss: tensor(0.4760, device='cuda:0')
batch 31 loss: tensor(0.5477, device='cuda:0')
batch 32 loss: tensor(0.4712, device='cuda:0')
batch 33 loss: tensor(0.4663, device='cuda:0')
batch 34 loss: tensor(0.4706, device='cuda:0')
batch 35 loss: tensor(0.4530, device='cuda:0')
batch 36 loss: tensor(0.5343, device='cuda:0')
batch 37 loss: tensor(0.4498, device='cuda:0')
batch 38 loss: tensor(0.4495, device='cuda:0')
batch 39 loss: tensor(0.4898, device='cuda:0')
batch 40 loss: tensor(0.4558, device='cuda:0')
batch 41 loss: tensor(0.5516, device='cuda:0')
batch 42 loss: tensor(0.4683, device='cuda:0')
batch 43 loss: tensor(0.4721, device='cuda:0')
batch 44 loss: tensor(0.4632, device='cuda:0')
batch 45 loss: tensor(0.4228, device='cuda:0')
batch 46 loss: tensor(0.5241, device='cuda:0')
batch 47 loss: tensor(0.4823, device='cuda:0')
batch 48 loss: tensor(0.4500, device='cuda:0')
batch 49 loss: tensor(0.4192, device='cuda:0')
batch 50 loss: tensor(0.4530, device='cuda:0')
batch 51 loss: tensor(0.4503, device='cuda:0')
batch 52 loss: tensor(0.4298, device='cuda:0')
batch 53 loss: tensor(0.4347, device='cuda:0')
batch 54 loss: tensor(0.4076, device='cuda:0')
batch 55 loss: tensor(0.4791, device='cuda:0')
batch 56 loss: tensor(0.4981, device='cuda:0')
batch 57 loss: tensor(0.4834, device='cuda:0')
batch 58 loss: tensor(0.4368, device='cuda:0')
batch 59 loss: tensor(0.3938, device='cuda:0')
batch 60 loss: tensor(0.3999, device='cuda:0')
batch 61 loss: tensor(0.4955, device='cuda:0')
batch 62 loss: tensor(0.5081, device='cuda:0')
batch 63 loss: tensor(0.4254, device='cuda:0')
batch 64 loss: tensor(0.4522, device='cuda:0')
batch 65 loss: tensor(0.4985, device='cuda:0')
batch 66 loss: tensor(0.4705, device='cuda:0')
batch 67 loss: tensor(0.4763, device='cuda:0')
batch 68 loss: tensor(0.4742, device='cuda:0')
batch 69 loss: tensor(0.4840, device='cuda:0')
batch 70 loss: tensor(0.4158, device='cuda:0')
batch 71 loss: tensor(0.4405, device='cuda:0')
batch 72 loss: tensor(0.5239, device='cuda:0')
batch 73 loss: tensor(0.4668, device='cuda:0')
batch 74 loss: tensor(0.4061, device='cuda:0')
batch 75 loss: tensor(0.4990, device='cuda:0')
batch 76 loss: tensor(0.4092, device='cuda:0')
batch 77 loss: tensor(0.4098, device='cuda:0')
batch 78 loss: tensor(0.4437, device='cuda:0')
batch 79 loss: tensor(0.4247, device='cuda:0')
batch 80 loss: tensor(0.4277, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5123, device='cuda:0')
batch 2 loss: tensor(0.4503, device='cuda:0')
batch 3 loss: tensor(0.4348, device='cuda:0')
batch 4 loss: tensor(0.4407, device='cuda:0')
batch 5 loss: tensor(0.3835, device='cuda:0')
batch 6 loss: tensor(0.4750, device='cuda:0')
batch 7 loss: tensor(0.4224, device='cuda:0')
batch 8 loss: tensor(0.4526, device='cuda:0')
batch 9 loss: tensor(0.4124, device='cuda:0')
batch 10 loss: tensor(0.3560, device='cuda:0')
batch 11 loss: tensor(0.3579, device='cuda:0')
batch 12 loss: tensor(0.4086, device='cuda:0')
batch 13 loss: tensor(0.4145, device='cuda:0')
batch 14 loss: tensor(0.4383, device='cuda:0')
batch 15 loss: tensor(0.4352, device='cuda:0')
batch 16 loss: tensor(0.3349, device='cuda:0')
batch 17 loss: tensor(0.3795, device='cuda:0')
batch 18 loss: tensor(0.3512, device='cuda:0')
batch 19 loss: tensor(0.3299, device='cuda:0')
batch 20 loss: tensor(0.3590, device='cuda:0')
batch 21 loss: tensor(0.4175, device='cuda:0')
batch 22 loss: tensor(0.3499, device='cuda:0')
batch 23 loss: tensor(0.3904, device='cuda:0')
batch 24 loss: tensor(0.4180, device='cuda:0')
batch 25 loss: tensor(0.3428, device='cuda:0')
batch 26 loss: tensor(0.3769, device='cuda:0')
batch 27 loss: tensor(0.3901, device='cuda:0')
batch 28 loss: tensor(0.3905, device='cuda:0')
batch 29 loss: tensor(0.3758, device='cuda:0')
batch 30 loss: tensor(0.3955, device='cuda:0')
batch 31 loss: tensor(0.3564, device='cuda:0')
batch 32 loss: tensor(0.4058, device='cuda:0')
batch 33 loss: tensor(0.3649, device='cuda:0')
batch 34 loss: tensor(0.3962, device='cuda:0')
batch 35 loss: tensor(0.3482, device='cuda:0')
batch 36 loss: tensor(0.3450, device='cuda:0')
batch 37 loss: tensor(0.3807, device='cuda:0')
batch 38 loss: tensor(0.3839, device='cuda:0')
batch 39 loss: tensor(0.3844, device='cuda:0')
batch 40 loss: tensor(0.4096, device='cuda:0')
batch 41 loss: tensor(0.3747, device='cuda:0')
batch 42 loss: tensor(0.3273, device='cuda:0')
batch 43 loss: tensor(0.3971, device='cuda:0')
batch 44 loss: tensor(0.3532, device='cuda:0')
batch 45 loss: tensor(0.3869, device='cuda:0')
batch 46 loss: tensor(0.4219, device='cuda:0')
batch 47 loss: tensor(0.3639, device='cuda:0')
batch 48 loss: tensor(0.4044, device='cuda:0')
batch 49 loss: tensor(0.3943, device='cuda:0')
batch 50 loss: tensor(0.3496, device='cuda:0')
batch 51 loss: tensor(0.3552, device='cuda:0')
batch 52 loss: tensor(0.3919, device='cuda:0')
batch 53 loss: tensor(0.3739, device='cuda:0')
batch 54 loss: tensor(0.3637, device='cuda:0')
batch 55 loss: tensor(0.3709, device='cuda:0')
batch 56 loss: tensor(0.4015, device='cuda:0')
batch 57 loss: tensor(0.3551, device='cuda:0')
batch 58 loss: tensor(0.3568, device='cuda:0')
batch 59 loss: tensor(0.3557, device='cuda:0')
batch 60 loss: tensor(0.3680, device='cuda:0')
batch 61 loss: tensor(0.3377, device='cuda:0')
batch 62 loss: tensor(0.3589, device='cuda:0')
batch 63 loss: tensor(0.3493, device='cuda:0')
batch 64 loss: tensor(0.3851, device='cuda:0')
batch 65 loss: tensor(0.3939, device='cuda:0')
batch 66 loss: tensor(0.3479, device='cuda:0')
batch 67 loss: tensor(0.3743, device='cuda:0')
batch 68 loss: tensor(0.4194, device='cuda:0')
batch 69 loss: tensor(0.4119, device='cuda:0')
batch 70 loss: tensor(0.3412, device='cuda:0')
batch 71 loss: tensor(0.3766, device='cuda:0')
batch 72 loss: tensor(0.3436, device='cuda:0')
batch 73 loss: tensor(0.3629, device='cuda:0')
batch 74 loss: tensor(0.3673, device='cuda:0')
batch 75 loss: tensor(0.3309, device='cuda:0')
batch 76 loss: tensor(0.3421, device='cuda:0')
batch 77 loss: tensor(0.3737, device='cuda:0')
batch 78 loss: tensor(0.3783, device='cuda:0')
batch 79 loss: tensor(0.3529, device='cuda:0')
batch 80 loss: tensor(0.3827, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.4328, device='cuda:0')
batch 2 loss: tensor(0.3716, device='cuda:0')
batch 3 loss: tensor(0.3870, device='cuda:0')
batch 4 loss: tensor(0.3925, device='cuda:0')
batch 5 loss: tensor(0.3280, device='cuda:0')
batch 6 loss: tensor(0.3351, device='cuda:0')
batch 7 loss: tensor(0.3629, device='cuda:0')
batch 8 loss: tensor(0.3483, device='cuda:0')
batch 9 loss: tensor(0.3699, device='cuda:0')
batch 10 loss: tensor(0.3639, device='cuda:0')
batch 11 loss: tensor(0.3247, device='cuda:0')
batch 12 loss: tensor(0.3577, device='cuda:0')
batch 13 loss: tensor(0.3768, device='cuda:0')
batch 14 loss: tensor(0.3894, device='cuda:0')
batch 15 loss: tensor(0.3648, device='cuda:0')
batch 16 loss: tensor(0.3337, device='cuda:0')
batch 17 loss: tensor(0.3643, device='cuda:0')
batch 18 loss: tensor(0.3892, device='cuda:0')
batch 19 loss: tensor(0.3118, device='cuda:0')
batch 20 loss: tensor(0.3769, device='cuda:0')
batch 21 loss: tensor(0.3792, device='cuda:0')
batch 22 loss: tensor(0.3925, device='cuda:0')
batch 23 loss: tensor(0.3255, device='cuda:0')
batch 24 loss: tensor(0.3130, device='cuda:0')
batch 25 loss: tensor(0.3605, device='cuda:0')
batch 26 loss: tensor(0.3647, device='cuda:0')
batch 27 loss: tensor(0.3349, device='cuda:0')
batch 28 loss: tensor(0.3847, device='cuda:0')
batch 29 loss: tensor(0.3532, device='cuda:0')
batch 30 loss: tensor(0.4056, device='cuda:0')
batch 31 loss: tensor(0.3238, device='cuda:0')
batch 32 loss: tensor(0.3688, device='cuda:0')
batch 33 loss: tensor(0.3042, device='cuda:0')
batch 34 loss: tensor(0.3821, device='cuda:0')
batch 35 loss: tensor(0.3179, device='cuda:0')
batch 36 loss: tensor(0.3375, device='cuda:0')
batch 37 loss: tensor(0.3481, device='cuda:0')
batch 38 loss: tensor(0.3767, device='cuda:0')
batch 39 loss: tensor(0.3305, device='cuda:0')
batch 40 loss: tensor(0.3296, device='cuda:0')
batch 41 loss: tensor(0.3192, device='cuda:0')
batch 42 loss: tensor(0.3872, device='cuda:0')
batch 43 loss: tensor(0.3745, device='cuda:0')
batch 44 loss: tensor(0.3048, device='cuda:0')
batch 45 loss: tensor(0.3781, device='cuda:0')
batch 46 loss: tensor(0.3559, device='cuda:0')
batch 47 loss: tensor(0.3614, device='cuda:0')
batch 48 loss: tensor(0.3438, device='cuda:0')
batch 49 loss: tensor(0.3795, device='cuda:0')
batch 50 loss: tensor(0.3342, device='cuda:0')
batch 51 loss: tensor(0.3792, device='cuda:0')
batch 52 loss: tensor(0.3692, device='cuda:0')
batch 53 loss: tensor(0.2827, device='cuda:0')
batch 54 loss: tensor(0.3550, device='cuda:0')
batch 55 loss: tensor(0.3416, device='cuda:0')
batch 56 loss: tensor(0.3456, device='cuda:0')
batch 57 loss: tensor(0.3705, device='cuda:0')
batch 58 loss: tensor(0.3095, device='cuda:0')
batch 59 loss: tensor(0.3502, device='cuda:0')
batch 60 loss: tensor(0.3449, device='cuda:0')
batch 61 loss: tensor(0.3728, device='cuda:0')
batch 62 loss: tensor(0.3391, device='cuda:0')
batch 63 loss: tensor(0.3180, device='cuda:0')
batch 64 loss: tensor(0.3314, device='cuda:0')
batch 65 loss: tensor(0.2918, device='cuda:0')
batch 66 loss: tensor(0.3562, device='cuda:0')
batch 67 loss: tensor(0.3757, device='cuda:0')
batch 68 loss: tensor(0.3786, device='cuda:0')
batch 69 loss: tensor(0.3115, device='cuda:0')
batch 70 loss: tensor(0.2997, device='cuda:0')
batch 71 loss: tensor(0.3263, device='cuda:0')
batch 72 loss: tensor(0.3278, device='cuda:0')
batch 73 loss: tensor(0.3803, device='cuda:0')
batch 74 loss: tensor(0.3458, device='cuda:0')
batch 75 loss: tensor(0.3619, device='cuda:0')
batch 76 loss: tensor(0.3393, device='cuda:0')
batch 77 loss: tensor(0.4194, device='cuda:0')
batch 78 loss: tensor(0.3502, device='cuda:0')
batch 79 loss: tensor(0.3659, device='cuda:0')
batch 80 loss: tensor(0.3331, device='cuda:0')
accuracy in val: 0.8453466666666667
accuracy in test: 0.8920904874053401
average epoch time: 2.003794794281324
total time: 480.9107506275177
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 3, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9820, device='cuda:0')
batch 2 loss: tensor(0.7791, device='cuda:0')
batch 3 loss: tensor(0.6211, device='cuda:0')
batch 4 loss: tensor(0.6235, device='cuda:0')
batch 5 loss: tensor(0.6101, device='cuda:0')
batch 6 loss: tensor(0.5715, device='cuda:0')
batch 7 loss: tensor(0.5701, device='cuda:0')
batch 8 loss: tensor(0.6222, device='cuda:0')
batch 9 loss: tensor(0.5219, device='cuda:0')
batch 10 loss: tensor(0.5377, device='cuda:0')
batch 11 loss: tensor(0.5683, device='cuda:0')
batch 12 loss: tensor(0.5231, device='cuda:0')
batch 13 loss: tensor(0.5313, device='cuda:0')
batch 14 loss: tensor(0.5200, device='cuda:0')
batch 15 loss: tensor(0.5309, device='cuda:0')
batch 16 loss: tensor(0.5084, device='cuda:0')
batch 17 loss: tensor(0.5690, device='cuda:0')
batch 18 loss: tensor(0.4931, device='cuda:0')
batch 19 loss: tensor(0.5292, device='cuda:0')
batch 20 loss: tensor(0.4519, device='cuda:0')
batch 21 loss: tensor(0.5049, device='cuda:0')
batch 22 loss: tensor(0.5050, device='cuda:0')
batch 23 loss: tensor(0.4786, device='cuda:0')
batch 24 loss: tensor(0.4644, device='cuda:0')
batch 25 loss: tensor(0.5571, device='cuda:0')
batch 26 loss: tensor(0.4259, device='cuda:0')
batch 27 loss: tensor(0.5067, device='cuda:0')
batch 28 loss: tensor(0.5295, device='cuda:0')
batch 29 loss: tensor(0.4688, device='cuda:0')
batch 30 loss: tensor(0.4420, device='cuda:0')
batch 31 loss: tensor(0.4514, device='cuda:0')
batch 32 loss: tensor(0.4827, device='cuda:0')
batch 33 loss: tensor(0.4312, device='cuda:0')
batch 34 loss: tensor(0.5058, device='cuda:0')
batch 35 loss: tensor(0.4614, device='cuda:0')
batch 36 loss: tensor(0.4742, device='cuda:0')
batch 37 loss: tensor(0.4377, device='cuda:0')
batch 38 loss: tensor(0.5049, device='cuda:0')
batch 39 loss: tensor(0.4666, device='cuda:0')
batch 40 loss: tensor(0.4126, device='cuda:0')
batch 41 loss: tensor(0.4338, device='cuda:0')
batch 42 loss: tensor(0.4954, device='cuda:0')
batch 43 loss: tensor(0.4229, device='cuda:0')
batch 44 loss: tensor(0.4938, device='cuda:0')
batch 45 loss: tensor(0.5287, device='cuda:0')
batch 46 loss: tensor(0.4538, device='cuda:0')
batch 47 loss: tensor(0.4802, device='cuda:0')
batch 48 loss: tensor(0.4699, device='cuda:0')
batch 49 loss: tensor(0.4657, device='cuda:0')
batch 50 loss: tensor(0.4609, device='cuda:0')
batch 51 loss: tensor(0.4768, device='cuda:0')
batch 52 loss: tensor(0.4704, device='cuda:0')
batch 53 loss: tensor(0.4587, device='cuda:0')
batch 54 loss: tensor(0.4741, device='cuda:0')
batch 55 loss: tensor(0.4635, device='cuda:0')
batch 56 loss: tensor(0.5147, device='cuda:0')
batch 57 loss: tensor(0.3989, device='cuda:0')
batch 58 loss: tensor(0.4180, device='cuda:0')
batch 59 loss: tensor(0.4330, device='cuda:0')
batch 60 loss: tensor(0.4625, device='cuda:0')
batch 61 loss: tensor(0.4605, device='cuda:0')
batch 62 loss: tensor(0.4471, device='cuda:0')
batch 63 loss: tensor(0.4184, device='cuda:0')
batch 64 loss: tensor(0.4952, device='cuda:0')
batch 65 loss: tensor(0.4892, device='cuda:0')
batch 66 loss: tensor(0.4395, device='cuda:0')
batch 67 loss: tensor(0.4661, device='cuda:0')
batch 68 loss: tensor(0.4520, device='cuda:0')
batch 69 loss: tensor(0.4405, device='cuda:0')
batch 70 loss: tensor(0.4892, device='cuda:0')
batch 71 loss: tensor(0.4443, device='cuda:0')
batch 72 loss: tensor(0.4495, device='cuda:0')
batch 73 loss: tensor(0.4267, device='cuda:0')
batch 74 loss: tensor(0.4347, device='cuda:0')
batch 75 loss: tensor(0.4368, device='cuda:0')
batch 76 loss: tensor(0.4680, device='cuda:0')
batch 77 loss: tensor(0.4494, device='cuda:0')
batch 78 loss: tensor(0.4437, device='cuda:0')
batch 79 loss: tensor(0.4005, device='cuda:0')
batch 80 loss: tensor(0.4948, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.4760, device='cuda:0')
batch 2 loss: tensor(0.4716, device='cuda:0')
batch 3 loss: tensor(0.4376, device='cuda:0')
batch 4 loss: tensor(0.4377, device='cuda:0')
batch 5 loss: tensor(0.4675, device='cuda:0')
batch 6 loss: tensor(0.4435, device='cuda:0')
batch 7 loss: tensor(0.3998, device='cuda:0')
batch 8 loss: tensor(0.4026, device='cuda:0')
batch 9 loss: tensor(0.3759, device='cuda:0')
batch 10 loss: tensor(0.4093, device='cuda:0')
batch 11 loss: tensor(0.3433, device='cuda:0')
batch 12 loss: tensor(0.4170, device='cuda:0')
batch 13 loss: tensor(0.4321, device='cuda:0')
batch 14 loss: tensor(0.4968, device='cuda:0')
batch 15 loss: tensor(0.4008, device='cuda:0')
batch 16 loss: tensor(0.3543, device='cuda:0')
batch 17 loss: tensor(0.4426, device='cuda:0')
batch 18 loss: tensor(0.4337, device='cuda:0')
batch 19 loss: tensor(0.4359, device='cuda:0')
batch 20 loss: tensor(0.3816, device='cuda:0')
batch 21 loss: tensor(0.3785, device='cuda:0')
batch 22 loss: tensor(0.3344, device='cuda:0')
batch 23 loss: tensor(0.4057, device='cuda:0')
batch 24 loss: tensor(0.3228, device='cuda:0')
batch 25 loss: tensor(0.3531, device='cuda:0')
batch 26 loss: tensor(0.3502, device='cuda:0')
batch 27 loss: tensor(0.3967, device='cuda:0')
batch 28 loss: tensor(0.3968, device='cuda:0')
batch 29 loss: tensor(0.4048, device='cuda:0')
batch 30 loss: tensor(0.4259, device='cuda:0')
batch 31 loss: tensor(0.3755, device='cuda:0')
batch 32 loss: tensor(0.4207, device='cuda:0')
batch 33 loss: tensor(0.3738, device='cuda:0')
batch 34 loss: tensor(0.3989, device='cuda:0')
batch 35 loss: tensor(0.3318, device='cuda:0')
batch 36 loss: tensor(0.3871, device='cuda:0')
batch 37 loss: tensor(0.3614, device='cuda:0')
batch 38 loss: tensor(0.3413, device='cuda:0')
batch 39 loss: tensor(0.3484, device='cuda:0')
batch 40 loss: tensor(0.3528, device='cuda:0')
batch 41 loss: tensor(0.3717, device='cuda:0')
batch 42 loss: tensor(0.3790, device='cuda:0')
batch 43 loss: tensor(0.4072, device='cuda:0')
batch 44 loss: tensor(0.3863, device='cuda:0')
batch 45 loss: tensor(0.3602, device='cuda:0')
batch 46 loss: tensor(0.4059, device='cuda:0')
batch 47 loss: tensor(0.3615, device='cuda:0')
batch 48 loss: tensor(0.3986, device='cuda:0')
batch 49 loss: tensor(0.3707, device='cuda:0')
batch 50 loss: tensor(0.3475, device='cuda:0')
batch 51 loss: tensor(0.3359, device='cuda:0')
batch 52 loss: tensor(0.3036, device='cuda:0')
batch 53 loss: tensor(0.3741, device='cuda:0')
batch 54 loss: tensor(0.3710, device='cuda:0')
batch 55 loss: tensor(0.3706, device='cuda:0')
batch 56 loss: tensor(0.3695, device='cuda:0')
batch 57 loss: tensor(0.3801, device='cuda:0')
batch 58 loss: tensor(0.3846, device='cuda:0')
batch 59 loss: tensor(0.4086, device='cuda:0')
batch 60 loss: tensor(0.3464, device='cuda:0')
batch 61 loss: tensor(0.3297, device='cuda:0')
batch 62 loss: tensor(0.3768, device='cuda:0')
batch 63 loss: tensor(0.4446, device='cuda:0')
batch 64 loss: tensor(0.3605, device='cuda:0')
batch 65 loss: tensor(0.3583, device='cuda:0')
batch 66 loss: tensor(0.3585, device='cuda:0')
batch 67 loss: tensor(0.2974, device='cuda:0')
batch 68 loss: tensor(0.3816, device='cuda:0')
batch 69 loss: tensor(0.3649, device='cuda:0')
batch 70 loss: tensor(0.4178, device='cuda:0')
batch 71 loss: tensor(0.3893, device='cuda:0')
batch 72 loss: tensor(0.3197, device='cuda:0')
batch 73 loss: tensor(0.3616, device='cuda:0')
batch 74 loss: tensor(0.3973, device='cuda:0')
batch 75 loss: tensor(0.2931, device='cuda:0')
batch 76 loss: tensor(0.3993, device='cuda:0')
batch 77 loss: tensor(0.3884, device='cuda:0')
batch 78 loss: tensor(0.3830, device='cuda:0')
batch 79 loss: tensor(0.3252, device='cuda:0')
batch 80 loss: tensor(0.4124, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.5044, device='cuda:0')
batch 2 loss: tensor(0.3752, device='cuda:0')
batch 3 loss: tensor(0.3283, device='cuda:0')
batch 4 loss: tensor(0.4122, device='cuda:0')
batch 5 loss: tensor(0.3098, device='cuda:0')
batch 6 loss: tensor(0.3866, device='cuda:0')
batch 7 loss: tensor(0.3466, device='cuda:0')
batch 8 loss: tensor(0.3921, device='cuda:0')
batch 9 loss: tensor(0.3430, device='cuda:0')
batch 10 loss: tensor(0.3611, device='cuda:0')
batch 11 loss: tensor(0.3377, device='cuda:0')
batch 12 loss: tensor(0.3676, device='cuda:0')
batch 13 loss: tensor(0.3437, device='cuda:0')
batch 14 loss: tensor(0.3143, device='cuda:0')
batch 15 loss: tensor(0.3841, device='cuda:0')
batch 16 loss: tensor(0.2990, device='cuda:0')
batch 17 loss: tensor(0.3366, device='cuda:0')
batch 18 loss: tensor(0.2893, device='cuda:0')
batch 19 loss: tensor(0.3046, device='cuda:0')
batch 20 loss: tensor(0.2972, device='cuda:0')
batch 21 loss: tensor(0.3499, device='cuda:0')
batch 22 loss: tensor(0.3948, device='cuda:0')
batch 23 loss: tensor(0.3717, device='cuda:0')
batch 24 loss: tensor(0.3092, device='cuda:0')
batch 25 loss: tensor(0.2920, device='cuda:0')
batch 26 loss: tensor(0.3523, device='cuda:0')
batch 27 loss: tensor(0.3332, device='cuda:0')
batch 28 loss: tensor(0.3575, device='cuda:0')
batch 29 loss: tensor(0.3057, device='cuda:0')
batch 30 loss: tensor(0.3591, device='cuda:0')
batch 31 loss: tensor(0.3044, device='cuda:0')
batch 32 loss: tensor(0.3079, device='cuda:0')
batch 33 loss: tensor(0.3467, device='cuda:0')
batch 34 loss: tensor(0.3313, device='cuda:0')
batch 35 loss: tensor(0.3758, device='cuda:0')
batch 36 loss: tensor(0.3176, device='cuda:0')
batch 37 loss: tensor(0.3260, device='cuda:0')
batch 38 loss: tensor(0.3726, device='cuda:0')
batch 39 loss: tensor(0.3525, device='cuda:0')
batch 40 loss: tensor(0.3410, device='cuda:0')
batch 41 loss: tensor(0.3271, device='cuda:0')
batch 42 loss: tensor(0.3567, device='cuda:0')
batch 43 loss: tensor(0.3889, device='cuda:0')
batch 44 loss: tensor(0.3770, device='cuda:0')
batch 45 loss: tensor(0.3256, device='cuda:0')
batch 46 loss: tensor(0.2982, device='cuda:0')
batch 47 loss: tensor(0.2733, device='cuda:0')
batch 48 loss: tensor(0.3795, device='cuda:0')
batch 49 loss: tensor(0.3639, device='cuda:0')
batch 50 loss: tensor(0.3731, device='cuda:0')
batch 51 loss: tensor(0.3469, device='cuda:0')
batch 52 loss: tensor(0.3727, device='cuda:0')
batch 53 loss: tensor(0.3816, device='cuda:0')
batch 54 loss: tensor(0.3448, device='cuda:0')
batch 55 loss: tensor(0.3124, device='cuda:0')
batch 56 loss: tensor(0.3064, device='cuda:0')
batch 57 loss: tensor(0.4073, device='cuda:0')
batch 58 loss: tensor(0.3583, device='cuda:0')
batch 59 loss: tensor(0.2811, device='cuda:0')
batch 60 loss: tensor(0.3421, device='cuda:0')
batch 61 loss: tensor(0.3555, device='cuda:0')
batch 62 loss: tensor(0.3234, device='cuda:0')
batch 63 loss: tensor(0.3252, device='cuda:0')
batch 64 loss: tensor(0.3351, device='cuda:0')
batch 65 loss: tensor(0.3236, device='cuda:0')
batch 66 loss: tensor(0.3662, device='cuda:0')
batch 67 loss: tensor(0.3243, device='cuda:0')
batch 68 loss: tensor(0.3530, device='cuda:0')
batch 69 loss: tensor(0.3555, device='cuda:0')
batch 70 loss: tensor(0.3319, device='cuda:0')
batch 71 loss: tensor(0.3172, device='cuda:0')
batch 72 loss: tensor(0.3244, device='cuda:0')
batch 73 loss: tensor(0.2966, device='cuda:0')
batch 74 loss: tensor(0.3152, device='cuda:0')
batch 75 loss: tensor(0.3370, device='cuda:0')
batch 76 loss: tensor(0.3813, device='cuda:0')
batch 77 loss: tensor(0.3562, device='cuda:0')
batch 78 loss: tensor(0.2898, device='cuda:0')
batch 79 loss: tensor(0.3984, device='cuda:0')
batch 80 loss: tensor(0.2673, device='cuda:0')
accuracy in val: 0.8442366666666666
accuracy in test: 0.8920822141450688
average epoch time: 1.8790266871452332
total time: 450.96640491485596
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 3, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0179, device='cuda:0')
batch 2 loss: tensor(0.7484, device='cuda:0')
batch 3 loss: tensor(0.6996, device='cuda:0')
batch 4 loss: tensor(0.6517, device='cuda:0')
batch 5 loss: tensor(0.6798, device='cuda:0')
batch 6 loss: tensor(0.6361, device='cuda:0')
batch 7 loss: tensor(0.5651, device='cuda:0')
batch 8 loss: tensor(0.4912, device='cuda:0')
batch 9 loss: tensor(0.5858, device='cuda:0')
batch 10 loss: tensor(0.5166, device='cuda:0')
batch 11 loss: tensor(0.5500, device='cuda:0')
batch 12 loss: tensor(0.5218, device='cuda:0')
batch 13 loss: tensor(0.4546, device='cuda:0')
batch 14 loss: tensor(0.4742, device='cuda:0')
batch 15 loss: tensor(0.5771, device='cuda:0')
batch 16 loss: tensor(0.5427, device='cuda:0')
batch 17 loss: tensor(0.5523, device='cuda:0')
batch 18 loss: tensor(0.4613, device='cuda:0')
batch 19 loss: tensor(0.4795, device='cuda:0')
batch 20 loss: tensor(0.5339, device='cuda:0')
batch 21 loss: tensor(0.4874, device='cuda:0')
batch 22 loss: tensor(0.4787, device='cuda:0')
batch 23 loss: tensor(0.4687, device='cuda:0')
batch 24 loss: tensor(0.5192, device='cuda:0')
batch 25 loss: tensor(0.4668, device='cuda:0')
batch 26 loss: tensor(0.4798, device='cuda:0')
batch 27 loss: tensor(0.4415, device='cuda:0')
batch 28 loss: tensor(0.4333, device='cuda:0')
batch 29 loss: tensor(0.4897, device='cuda:0')
batch 30 loss: tensor(0.5153, device='cuda:0')
batch 31 loss: tensor(0.4833, device='cuda:0')
batch 32 loss: tensor(0.5159, device='cuda:0')
batch 33 loss: tensor(0.5291, device='cuda:0')
batch 34 loss: tensor(0.4281, device='cuda:0')
batch 35 loss: tensor(0.4991, device='cuda:0')
batch 36 loss: tensor(0.4749, device='cuda:0')
batch 37 loss: tensor(0.4247, device='cuda:0')
batch 38 loss: tensor(0.4681, device='cuda:0')
batch 39 loss: tensor(0.4168, device='cuda:0')
batch 40 loss: tensor(0.4942, device='cuda:0')
batch 41 loss: tensor(0.5530, device='cuda:0')
batch 42 loss: tensor(0.5007, device='cuda:0')
batch 43 loss: tensor(0.5076, device='cuda:0')
batch 44 loss: tensor(0.4242, device='cuda:0')
batch 45 loss: tensor(0.4478, device='cuda:0')
batch 46 loss: tensor(0.4899, device='cuda:0')
batch 47 loss: tensor(0.4623, device='cuda:0')
batch 48 loss: tensor(0.4525, device='cuda:0')
batch 49 loss: tensor(0.4763, device='cuda:0')
batch 50 loss: tensor(0.4384, device='cuda:0')
batch 51 loss: tensor(0.4622, device='cuda:0')
batch 52 loss: tensor(0.4396, device='cuda:0')
batch 53 loss: tensor(0.4850, device='cuda:0')
batch 54 loss: tensor(0.4519, device='cuda:0')
batch 55 loss: tensor(0.4362, device='cuda:0')
batch 56 loss: tensor(0.4402, device='cuda:0')
batch 57 loss: tensor(0.4740, device='cuda:0')
batch 58 loss: tensor(0.4626, device='cuda:0')
batch 59 loss: tensor(0.4491, device='cuda:0')
batch 60 loss: tensor(0.4410, device='cuda:0')
batch 61 loss: tensor(0.4529, device='cuda:0')
batch 62 loss: tensor(0.3835, device='cuda:0')
batch 63 loss: tensor(0.4168, device='cuda:0')
batch 64 loss: tensor(0.4334, device='cuda:0')
batch 65 loss: tensor(0.5255, device='cuda:0')
batch 66 loss: tensor(0.4852, device='cuda:0')
batch 67 loss: tensor(0.4477, device='cuda:0')
batch 68 loss: tensor(0.4381, device='cuda:0')
batch 69 loss: tensor(0.4084, device='cuda:0')
batch 70 loss: tensor(0.4917, device='cuda:0')
batch 71 loss: tensor(0.4589, device='cuda:0')
batch 72 loss: tensor(0.4491, device='cuda:0')
batch 73 loss: tensor(0.4346, device='cuda:0')
batch 74 loss: tensor(0.4394, device='cuda:0')
batch 75 loss: tensor(0.3936, device='cuda:0')
batch 76 loss: tensor(0.4374, device='cuda:0')
batch 77 loss: tensor(0.4028, device='cuda:0')
batch 78 loss: tensor(0.4421, device='cuda:0')
batch 79 loss: tensor(0.4048, device='cuda:0')
batch 80 loss: tensor(0.4789, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5563, device='cuda:0')
batch 2 loss: tensor(0.5453, device='cuda:0')
batch 3 loss: tensor(0.4610, device='cuda:0')
batch 4 loss: tensor(0.4664, device='cuda:0')
batch 5 loss: tensor(0.4096, device='cuda:0')
batch 6 loss: tensor(0.3838, device='cuda:0')
batch 7 loss: tensor(0.4174, device='cuda:0')
batch 8 loss: tensor(0.4045, device='cuda:0')
batch 9 loss: tensor(0.3889, device='cuda:0')
batch 10 loss: tensor(0.3652, device='cuda:0')
batch 11 loss: tensor(0.4072, device='cuda:0')
batch 12 loss: tensor(0.3427, device='cuda:0')
batch 13 loss: tensor(0.3316, device='cuda:0')
batch 14 loss: tensor(0.3786, device='cuda:0')
batch 15 loss: tensor(0.4149, device='cuda:0')
batch 16 loss: tensor(0.3367, device='cuda:0')
batch 17 loss: tensor(0.4009, device='cuda:0')
batch 18 loss: tensor(0.4143, device='cuda:0')
batch 19 loss: tensor(0.3932, device='cuda:0')
batch 20 loss: tensor(0.3804, device='cuda:0')
batch 21 loss: tensor(0.4200, device='cuda:0')
batch 22 loss: tensor(0.3740, device='cuda:0')
batch 23 loss: tensor(0.3616, device='cuda:0')
batch 24 loss: tensor(0.3890, device='cuda:0')
batch 25 loss: tensor(0.4516, device='cuda:0')
batch 26 loss: tensor(0.3693, device='cuda:0')
batch 27 loss: tensor(0.3238, device='cuda:0')
batch 28 loss: tensor(0.4177, device='cuda:0')
batch 29 loss: tensor(0.3637, device='cuda:0')
batch 30 loss: tensor(0.3805, device='cuda:0')
batch 31 loss: tensor(0.3914, device='cuda:0')
batch 32 loss: tensor(0.3964, device='cuda:0')
batch 33 loss: tensor(0.3151, device='cuda:0')
batch 34 loss: tensor(0.4046, device='cuda:0')
batch 35 loss: tensor(0.3929, device='cuda:0')
batch 36 loss: tensor(0.3652, device='cuda:0')
batch 37 loss: tensor(0.3643, device='cuda:0')
batch 38 loss: tensor(0.4263, device='cuda:0')
batch 39 loss: tensor(0.3648, device='cuda:0')
batch 40 loss: tensor(0.4045, device='cuda:0')
batch 41 loss: tensor(0.4151, device='cuda:0')
batch 42 loss: tensor(0.3641, device='cuda:0')
batch 43 loss: tensor(0.3434, device='cuda:0')
batch 44 loss: tensor(0.4507, device='cuda:0')
batch 45 loss: tensor(0.3293, device='cuda:0')
batch 46 loss: tensor(0.4063, device='cuda:0')
batch 47 loss: tensor(0.3368, device='cuda:0')
batch 48 loss: tensor(0.3487, device='cuda:0')
batch 49 loss: tensor(0.3396, device='cuda:0')
batch 50 loss: tensor(0.3546, device='cuda:0')
batch 51 loss: tensor(0.3571, device='cuda:0')
batch 52 loss: tensor(0.3964, device='cuda:0')
batch 53 loss: tensor(0.3471, device='cuda:0')
batch 54 loss: tensor(0.3979, device='cuda:0')
batch 55 loss: tensor(0.4058, device='cuda:0')
batch 56 loss: tensor(0.3135, device='cuda:0')
batch 57 loss: tensor(0.3416, device='cuda:0')
batch 58 loss: tensor(0.3751, device='cuda:0')
batch 59 loss: tensor(0.3774, device='cuda:0')
batch 60 loss: tensor(0.3697, device='cuda:0')
batch 61 loss: tensor(0.3463, device='cuda:0')
batch 62 loss: tensor(0.3876, device='cuda:0')
batch 63 loss: tensor(0.3488, device='cuda:0')
batch 64 loss: tensor(0.3651, device='cuda:0')
batch 65 loss: tensor(0.3896, device='cuda:0')
batch 66 loss: tensor(0.3862, device='cuda:0')
batch 67 loss: tensor(0.3433, device='cuda:0')
batch 68 loss: tensor(0.3770, device='cuda:0')
batch 69 loss: tensor(0.3920, device='cuda:0')
batch 70 loss: tensor(0.3690, device='cuda:0')
batch 71 loss: tensor(0.3785, device='cuda:0')
batch 72 loss: tensor(0.3986, device='cuda:0')
batch 73 loss: tensor(0.3403, device='cuda:0')
batch 74 loss: tensor(0.3579, device='cuda:0')
batch 75 loss: tensor(0.3984, device='cuda:0')
batch 76 loss: tensor(0.3901, device='cuda:0')
batch 77 loss: tensor(0.3866, device='cuda:0')
batch 78 loss: tensor(0.3350, device='cuda:0')
batch 79 loss: tensor(0.3672, device='cuda:0')
batch 80 loss: tensor(0.3289, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.4522, device='cuda:0')
batch 2 loss: tensor(0.4357, device='cuda:0')
batch 3 loss: tensor(0.3311, device='cuda:0')
batch 4 loss: tensor(0.3628, device='cuda:0')
batch 5 loss: tensor(0.3556, device='cuda:0')
batch 6 loss: tensor(0.3919, device='cuda:0')
batch 7 loss: tensor(0.3608, device='cuda:0')
batch 8 loss: tensor(0.3572, device='cuda:0')
batch 9 loss: tensor(0.3673, device='cuda:0')
batch 10 loss: tensor(0.3571, device='cuda:0')
batch 11 loss: tensor(0.3402, device='cuda:0')
batch 12 loss: tensor(0.3532, device='cuda:0')
batch 13 loss: tensor(0.3428, device='cuda:0')
batch 14 loss: tensor(0.3629, device='cuda:0')
batch 15 loss: tensor(0.3611, device='cuda:0')
batch 16 loss: tensor(0.3747, device='cuda:0')
batch 17 loss: tensor(0.3329, device='cuda:0')
batch 18 loss: tensor(0.3723, device='cuda:0')
batch 19 loss: tensor(0.3759, device='cuda:0')
batch 20 loss: tensor(0.3689, device='cuda:0')
batch 21 loss: tensor(0.3220, device='cuda:0')
batch 22 loss: tensor(0.3584, device='cuda:0')
batch 23 loss: tensor(0.3638, device='cuda:0')
batch 24 loss: tensor(0.3475, device='cuda:0')
batch 25 loss: tensor(0.3478, device='cuda:0')
batch 26 loss: tensor(0.3133, device='cuda:0')
batch 27 loss: tensor(0.3540, device='cuda:0')
batch 28 loss: tensor(0.3739, device='cuda:0')
batch 29 loss: tensor(0.3185, device='cuda:0')
batch 30 loss: tensor(0.3509, device='cuda:0')
batch 31 loss: tensor(0.3706, device='cuda:0')
batch 32 loss: tensor(0.3302, device='cuda:0')
batch 33 loss: tensor(0.3364, device='cuda:0')
batch 34 loss: tensor(0.3636, device='cuda:0')
batch 35 loss: tensor(0.3554, device='cuda:0')
batch 36 loss: tensor(0.2990, device='cuda:0')
batch 37 loss: tensor(0.3245, device='cuda:0')
batch 38 loss: tensor(0.3305, device='cuda:0')
batch 39 loss: tensor(0.3593, device='cuda:0')
batch 40 loss: tensor(0.3402, device='cuda:0')
batch 41 loss: tensor(0.3021, device='cuda:0')
batch 42 loss: tensor(0.3807, device='cuda:0')
batch 43 loss: tensor(0.3385, device='cuda:0')
batch 44 loss: tensor(0.3137, device='cuda:0')
batch 45 loss: tensor(0.3506, device='cuda:0')
batch 46 loss: tensor(0.3453, device='cuda:0')
batch 47 loss: tensor(0.3603, device='cuda:0')
batch 48 loss: tensor(0.3526, device='cuda:0')
batch 49 loss: tensor(0.3405, device='cuda:0')
batch 50 loss: tensor(0.4256, device='cuda:0')
batch 51 loss: tensor(0.3260, device='cuda:0')
batch 52 loss: tensor(0.3489, device='cuda:0')
batch 53 loss: tensor(0.3232, device='cuda:0')
batch 54 loss: tensor(0.2977, device='cuda:0')
batch 55 loss: tensor(0.3196, device='cuda:0')
batch 56 loss: tensor(0.3219, device='cuda:0')
batch 57 loss: tensor(0.3105, device='cuda:0')
batch 58 loss: tensor(0.3554, device='cuda:0')
batch 59 loss: tensor(0.3103, device='cuda:0')
batch 60 loss: tensor(0.2964, device='cuda:0')
batch 61 loss: tensor(0.4067, device='cuda:0')
batch 62 loss: tensor(0.3569, device='cuda:0')
batch 63 loss: tensor(0.3021, device='cuda:0')
batch 64 loss: tensor(0.3361, device='cuda:0')
batch 65 loss: tensor(0.3378, device='cuda:0')
batch 66 loss: tensor(0.3139, device='cuda:0')
batch 67 loss: tensor(0.3010, device='cuda:0')
batch 68 loss: tensor(0.3646, device='cuda:0')
batch 69 loss: tensor(0.3071, device='cuda:0')
batch 70 loss: tensor(0.3595, device='cuda:0')
batch 71 loss: tensor(0.3179, device='cuda:0')
batch 72 loss: tensor(0.3342, device='cuda:0')
batch 73 loss: tensor(0.3117, device='cuda:0')
batch 74 loss: tensor(0.3144, device='cuda:0')
batch 75 loss: tensor(0.3718, device='cuda:0')
batch 76 loss: tensor(0.3381, device='cuda:0')
batch 77 loss: tensor(0.3697, device='cuda:0')
batch 78 loss: tensor(0.3592, device='cuda:0')
batch 79 loss: tensor(0.2749, device='cuda:0')
batch 80 loss: tensor(0.3247, device='cuda:0')
accuracy in val: 0.84531
accuracy in test: 0.8922545737340533
average epoch time: 1.8772731473048527
total time: 450.5455553531647
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 3, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0144, device='cuda:0')
batch 2 loss: tensor(0.7542, device='cuda:0')
batch 3 loss: tensor(0.6208, device='cuda:0')
batch 4 loss: tensor(0.6724, device='cuda:0')
batch 5 loss: tensor(0.5675, device='cuda:0')
batch 6 loss: tensor(0.6071, device='cuda:0')
batch 7 loss: tensor(0.6192, device='cuda:0')
batch 8 loss: tensor(0.5707, device='cuda:0')
batch 9 loss: tensor(0.5186, device='cuda:0')
batch 10 loss: tensor(0.5276, device='cuda:0')
batch 11 loss: tensor(0.5107, device='cuda:0')
batch 12 loss: tensor(0.5322, device='cuda:0')
batch 13 loss: tensor(0.5477, device='cuda:0')
batch 14 loss: tensor(0.4973, device='cuda:0')
batch 15 loss: tensor(0.5501, device='cuda:0')
batch 16 loss: tensor(0.4502, device='cuda:0')
batch 17 loss: tensor(0.6044, device='cuda:0')
batch 18 loss: tensor(0.5140, device='cuda:0')
batch 19 loss: tensor(0.4702, device='cuda:0')
batch 20 loss: tensor(0.4559, device='cuda:0')
batch 21 loss: tensor(0.4918, device='cuda:0')
batch 22 loss: tensor(0.5492, device='cuda:0')
batch 23 loss: tensor(0.5170, device='cuda:0')
batch 24 loss: tensor(0.5090, device='cuda:0')
batch 25 loss: tensor(0.4896, device='cuda:0')
batch 26 loss: tensor(0.4557, device='cuda:0')
batch 27 loss: tensor(0.4654, device='cuda:0')
batch 28 loss: tensor(0.4897, device='cuda:0')
batch 29 loss: tensor(0.4639, device='cuda:0')
batch 30 loss: tensor(0.5021, device='cuda:0')
batch 31 loss: tensor(0.4835, device='cuda:0')
batch 32 loss: tensor(0.4862, device='cuda:0')
batch 33 loss: tensor(0.4627, device='cuda:0')
batch 34 loss: tensor(0.5310, device='cuda:0')
batch 35 loss: tensor(0.4459, device='cuda:0')
batch 36 loss: tensor(0.5048, device='cuda:0')
batch 37 loss: tensor(0.5559, device='cuda:0')
batch 38 loss: tensor(0.4637, device='cuda:0')
batch 39 loss: tensor(0.5170, device='cuda:0')
batch 40 loss: tensor(0.4767, device='cuda:0')
batch 41 loss: tensor(0.4415, device='cuda:0')
batch 42 loss: tensor(0.4331, device='cuda:0')
batch 43 loss: tensor(0.4926, device='cuda:0')
batch 44 loss: tensor(0.4770, device='cuda:0')
batch 45 loss: tensor(0.5678, device='cuda:0')
batch 46 loss: tensor(0.5180, device='cuda:0')
batch 47 loss: tensor(0.4613, device='cuda:0')
batch 48 loss: tensor(0.4898, device='cuda:0')
batch 49 loss: tensor(0.5063, device='cuda:0')
batch 50 loss: tensor(0.5098, device='cuda:0')
batch 51 loss: tensor(0.4390, device='cuda:0')
batch 52 loss: tensor(0.4662, device='cuda:0')
batch 53 loss: tensor(0.4723, device='cuda:0')
batch 54 loss: tensor(0.5199, device='cuda:0')
batch 55 loss: tensor(0.4957, device='cuda:0')
batch 56 loss: tensor(0.5198, device='cuda:0')
batch 57 loss: tensor(0.4260, device='cuda:0')
batch 58 loss: tensor(0.4604, device='cuda:0')
batch 59 loss: tensor(0.4704, device='cuda:0')
batch 60 loss: tensor(0.4295, device='cuda:0')
batch 61 loss: tensor(0.4710, device='cuda:0')
batch 62 loss: tensor(0.5107, device='cuda:0')
batch 63 loss: tensor(0.4915, device='cuda:0')
batch 64 loss: tensor(0.4135, device='cuda:0')
batch 65 loss: tensor(0.4940, device='cuda:0')
batch 66 loss: tensor(0.4232, device='cuda:0')
batch 67 loss: tensor(0.4891, device='cuda:0')
batch 68 loss: tensor(0.4236, device='cuda:0')
batch 69 loss: tensor(0.4245, device='cuda:0')
batch 70 loss: tensor(0.4300, device='cuda:0')
batch 71 loss: tensor(0.4603, device='cuda:0')
batch 72 loss: tensor(0.4259, device='cuda:0')
batch 73 loss: tensor(0.4804, device='cuda:0')
batch 74 loss: tensor(0.4624, device='cuda:0')
batch 75 loss: tensor(0.3981, device='cuda:0')
batch 76 loss: tensor(0.3932, device='cuda:0')
batch 77 loss: tensor(0.4139, device='cuda:0')
batch 78 loss: tensor(0.4932, device='cuda:0')
batch 79 loss: tensor(0.3723, device='cuda:0')
batch 80 loss: tensor(0.4738, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5216, device='cuda:0')
batch 2 loss: tensor(0.4796, device='cuda:0')
batch 3 loss: tensor(0.3833, device='cuda:0')
batch 4 loss: tensor(0.3762, device='cuda:0')
batch 5 loss: tensor(0.3794, device='cuda:0')
batch 6 loss: tensor(0.4355, device='cuda:0')
batch 7 loss: tensor(0.3604, device='cuda:0')
batch 8 loss: tensor(0.3922, device='cuda:0')
batch 9 loss: tensor(0.3704, device='cuda:0')
batch 10 loss: tensor(0.3822, device='cuda:0')
batch 11 loss: tensor(0.3613, device='cuda:0')
batch 12 loss: tensor(0.3646, device='cuda:0')
batch 13 loss: tensor(0.3937, device='cuda:0')
batch 14 loss: tensor(0.3935, device='cuda:0')
batch 15 loss: tensor(0.4030, device='cuda:0')
batch 16 loss: tensor(0.3640, device='cuda:0')
batch 17 loss: tensor(0.4798, device='cuda:0')
batch 18 loss: tensor(0.4122, device='cuda:0')
batch 19 loss: tensor(0.4184, device='cuda:0')
batch 20 loss: tensor(0.3736, device='cuda:0')
batch 21 loss: tensor(0.3640, device='cuda:0')
batch 22 loss: tensor(0.4402, device='cuda:0')
batch 23 loss: tensor(0.4174, device='cuda:0')
batch 24 loss: tensor(0.3593, device='cuda:0')
batch 25 loss: tensor(0.3816, device='cuda:0')
batch 26 loss: tensor(0.3975, device='cuda:0')
batch 27 loss: tensor(0.4048, device='cuda:0')
batch 28 loss: tensor(0.4133, device='cuda:0')
batch 29 loss: tensor(0.3745, device='cuda:0')
batch 30 loss: tensor(0.3226, device='cuda:0')
batch 31 loss: tensor(0.3523, device='cuda:0')
batch 32 loss: tensor(0.3639, device='cuda:0')
batch 33 loss: tensor(0.3724, device='cuda:0')
batch 34 loss: tensor(0.3892, device='cuda:0')
batch 35 loss: tensor(0.4562, device='cuda:0')
batch 36 loss: tensor(0.3753, device='cuda:0')
batch 37 loss: tensor(0.3759, device='cuda:0')
batch 38 loss: tensor(0.3804, device='cuda:0')
batch 39 loss: tensor(0.3993, device='cuda:0')
batch 40 loss: tensor(0.3883, device='cuda:0')
batch 41 loss: tensor(0.3740, device='cuda:0')
batch 42 loss: tensor(0.3457, device='cuda:0')
batch 43 loss: tensor(0.3876, device='cuda:0')
batch 44 loss: tensor(0.3557, device='cuda:0')
batch 45 loss: tensor(0.3392, device='cuda:0')
batch 46 loss: tensor(0.3389, device='cuda:0')
batch 47 loss: tensor(0.3421, device='cuda:0')
batch 48 loss: tensor(0.3864, device='cuda:0')
batch 49 loss: tensor(0.3134, device='cuda:0')
batch 50 loss: tensor(0.3259, device='cuda:0')
batch 51 loss: tensor(0.3852, device='cuda:0')
batch 52 loss: tensor(0.4278, device='cuda:0')
batch 53 loss: tensor(0.3769, device='cuda:0')
batch 54 loss: tensor(0.3645, device='cuda:0')
batch 55 loss: tensor(0.3221, device='cuda:0')
batch 56 loss: tensor(0.3580, device='cuda:0')
batch 57 loss: tensor(0.3581, device='cuda:0')
batch 58 loss: tensor(0.3440, device='cuda:0')
batch 59 loss: tensor(0.4595, device='cuda:0')
batch 60 loss: tensor(0.4076, device='cuda:0')
batch 61 loss: tensor(0.3918, device='cuda:0')
batch 62 loss: tensor(0.3411, device='cuda:0')
batch 63 loss: tensor(0.3048, device='cuda:0')
batch 64 loss: tensor(0.3713, device='cuda:0')
batch 65 loss: tensor(0.3376, device='cuda:0')
batch 66 loss: tensor(0.3777, device='cuda:0')
batch 67 loss: tensor(0.3656, device='cuda:0')
batch 68 loss: tensor(0.3145, device='cuda:0')
batch 69 loss: tensor(0.3392, device='cuda:0')
batch 70 loss: tensor(0.4044, device='cuda:0')
batch 71 loss: tensor(0.3751, device='cuda:0')
batch 72 loss: tensor(0.3386, device='cuda:0')
batch 73 loss: tensor(0.3329, device='cuda:0')
batch 74 loss: tensor(0.3787, device='cuda:0')
batch 75 loss: tensor(0.3311, device='cuda:0')
batch 76 loss: tensor(0.3842, device='cuda:0')
batch 77 loss: tensor(0.3612, device='cuda:0')
batch 78 loss: tensor(0.3588, device='cuda:0')
batch 79 loss: tensor(0.4058, device='cuda:0')
batch 80 loss: tensor(0.3585, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.5242, device='cuda:0')
batch 2 loss: tensor(0.4278, device='cuda:0')
batch 3 loss: tensor(0.3879, device='cuda:0')
batch 4 loss: tensor(0.3496, device='cuda:0')
batch 5 loss: tensor(0.4337, device='cuda:0')
batch 6 loss: tensor(0.3360, device='cuda:0')
batch 7 loss: tensor(0.3776, device='cuda:0')
batch 8 loss: tensor(0.3383, device='cuda:0')
batch 9 loss: tensor(0.3765, device='cuda:0')
batch 10 loss: tensor(0.4016, device='cuda:0')
batch 11 loss: tensor(0.3221, device='cuda:0')
batch 12 loss: tensor(0.3522, device='cuda:0')
batch 13 loss: tensor(0.3506, device='cuda:0')
batch 14 loss: tensor(0.3478, device='cuda:0')
batch 15 loss: tensor(0.3125, device='cuda:0')
batch 16 loss: tensor(0.3601, device='cuda:0')
batch 17 loss: tensor(0.2961, device='cuda:0')
batch 18 loss: tensor(0.3883, device='cuda:0')
batch 19 loss: tensor(0.2938, device='cuda:0')
batch 20 loss: tensor(0.3377, device='cuda:0')
batch 21 loss: tensor(0.3529, device='cuda:0')
batch 22 loss: tensor(0.3901, device='cuda:0')
batch 23 loss: tensor(0.3265, device='cuda:0')
batch 24 loss: tensor(0.4101, device='cuda:0')
batch 25 loss: tensor(0.3907, device='cuda:0')
batch 26 loss: tensor(0.2977, device='cuda:0')
batch 27 loss: tensor(0.3758, device='cuda:0')
batch 28 loss: tensor(0.3708, device='cuda:0')
batch 29 loss: tensor(0.3310, device='cuda:0')
batch 30 loss: tensor(0.3194, device='cuda:0')
batch 31 loss: tensor(0.3933, device='cuda:0')
batch 32 loss: tensor(0.3937, device='cuda:0')
batch 33 loss: tensor(0.3667, device='cuda:0')
batch 34 loss: tensor(0.3675, device='cuda:0')
batch 35 loss: tensor(0.3883, device='cuda:0')
batch 36 loss: tensor(0.3481, device='cuda:0')
batch 37 loss: tensor(0.3634, device='cuda:0')
batch 38 loss: tensor(0.4060, device='cuda:0')
batch 39 loss: tensor(0.2937, device='cuda:0')
batch 40 loss: tensor(0.3074, device='cuda:0')
batch 41 loss: tensor(0.3258, device='cuda:0')
batch 42 loss: tensor(0.3063, device='cuda:0')
batch 43 loss: tensor(0.4084, device='cuda:0')
batch 44 loss: tensor(0.3517, device='cuda:0')
batch 45 loss: tensor(0.3234, device='cuda:0')
batch 46 loss: tensor(0.3360, device='cuda:0')
batch 47 loss: tensor(0.4580, device='cuda:0')
batch 48 loss: tensor(0.3488, device='cuda:0')
batch 49 loss: tensor(0.2966, device='cuda:0')
batch 50 loss: tensor(0.3291, device='cuda:0')
batch 51 loss: tensor(0.3536, device='cuda:0')
batch 52 loss: tensor(0.3386, device='cuda:0')
batch 53 loss: tensor(0.3353, device='cuda:0')
batch 54 loss: tensor(0.3416, device='cuda:0')
batch 55 loss: tensor(0.3665, device='cuda:0')
batch 56 loss: tensor(0.3346, device='cuda:0')
batch 57 loss: tensor(0.3581, device='cuda:0')
batch 58 loss: tensor(0.3279, device='cuda:0')
batch 59 loss: tensor(0.2974, device='cuda:0')
batch 60 loss: tensor(0.3084, device='cuda:0')
batch 61 loss: tensor(0.3968, device='cuda:0')
batch 62 loss: tensor(0.3666, device='cuda:0')
batch 63 loss: tensor(0.3218, device='cuda:0')
batch 64 loss: tensor(0.3341, device='cuda:0')
batch 65 loss: tensor(0.3058, device='cuda:0')
batch 66 loss: tensor(0.3662, device='cuda:0')
batch 67 loss: tensor(0.3158, device='cuda:0')
batch 68 loss: tensor(0.3167, device='cuda:0')
batch 69 loss: tensor(0.3530, device='cuda:0')
batch 70 loss: tensor(0.3345, device='cuda:0')
batch 71 loss: tensor(0.3456, device='cuda:0')
batch 72 loss: tensor(0.2996, device='cuda:0')
batch 73 loss: tensor(0.3554, device='cuda:0')
batch 74 loss: tensor(0.3157, device='cuda:0')
batch 75 loss: tensor(0.3327, device='cuda:0')
batch 76 loss: tensor(0.3255, device='cuda:0')
batch 77 loss: tensor(0.3295, device='cuda:0')
batch 78 loss: tensor(0.3608, device='cuda:0')
batch 79 loss: tensor(0.3601, device='cuda:0')
batch 80 loss: tensor(0.3637, device='cuda:0')
accuracy in val: 0.8443633333333334
accuracy in test: 0.892666857870904
average epoch time: 1.8610834101835887
total time: 446.6600184440613
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 3, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9347, device='cuda:0')
batch 2 loss: tensor(0.6916, device='cuda:0')
batch 3 loss: tensor(0.7074, device='cuda:0')
batch 4 loss: tensor(0.6270, device='cuda:0')
batch 5 loss: tensor(0.6362, device='cuda:0')
batch 6 loss: tensor(0.6062, device='cuda:0')
batch 7 loss: tensor(0.7175, device='cuda:0')
batch 8 loss: tensor(0.5705, device='cuda:0')
batch 9 loss: tensor(0.5317, device='cuda:0')
batch 10 loss: tensor(0.4710, device='cuda:0')
batch 11 loss: tensor(0.5235, device='cuda:0')
batch 12 loss: tensor(0.5376, device='cuda:0')
batch 13 loss: tensor(0.5422, device='cuda:0')
batch 14 loss: tensor(0.5055, device='cuda:0')
batch 15 loss: tensor(0.5036, device='cuda:0')
batch 16 loss: tensor(0.5060, device='cuda:0')
batch 17 loss: tensor(0.5298, device='cuda:0')
batch 18 loss: tensor(0.4649, device='cuda:0')
batch 19 loss: tensor(0.5434, device='cuda:0')
batch 20 loss: tensor(0.5152, device='cuda:0')
batch 21 loss: tensor(0.5344, device='cuda:0')
batch 22 loss: tensor(0.5615, device='cuda:0')
batch 23 loss: tensor(0.5250, device='cuda:0')
batch 24 loss: tensor(0.4851, device='cuda:0')
batch 25 loss: tensor(0.5909, device='cuda:0')
batch 26 loss: tensor(0.4961, device='cuda:0')
batch 27 loss: tensor(0.5497, device='cuda:0')
batch 28 loss: tensor(0.4646, device='cuda:0')
batch 29 loss: tensor(0.4865, device='cuda:0')
batch 30 loss: tensor(0.4652, device='cuda:0')
batch 31 loss: tensor(0.4869, device='cuda:0')
batch 32 loss: tensor(0.5277, device='cuda:0')
batch 33 loss: tensor(0.4963, device='cuda:0')
batch 34 loss: tensor(0.4598, device='cuda:0')
batch 35 loss: tensor(0.4940, device='cuda:0')
batch 36 loss: tensor(0.5034, device='cuda:0')
batch 37 loss: tensor(0.4512, device='cuda:0')
batch 38 loss: tensor(0.4725, device='cuda:0')
batch 39 loss: tensor(0.5045, device='cuda:0')
batch 40 loss: tensor(0.4463, device='cuda:0')
batch 41 loss: tensor(0.4471, device='cuda:0')
batch 42 loss: tensor(0.5071, device='cuda:0')
batch 43 loss: tensor(0.4473, device='cuda:0')
batch 44 loss: tensor(0.5204, device='cuda:0')
batch 45 loss: tensor(0.4330, device='cuda:0')
batch 46 loss: tensor(0.4621, device='cuda:0')
batch 47 loss: tensor(0.5108, device='cuda:0')
batch 48 loss: tensor(0.4310, device='cuda:0')
batch 49 loss: tensor(0.4654, device='cuda:0')
batch 50 loss: tensor(0.4599, device='cuda:0')
batch 51 loss: tensor(0.4709, device='cuda:0')
batch 52 loss: tensor(0.4089, device='cuda:0')
batch 53 loss: tensor(0.4368, device='cuda:0')
batch 54 loss: tensor(0.4459, device='cuda:0')
batch 55 loss: tensor(0.4060, device='cuda:0')
batch 56 loss: tensor(0.4369, device='cuda:0')
batch 57 loss: tensor(0.4535, device='cuda:0')
batch 58 loss: tensor(0.4687, device='cuda:0')
batch 59 loss: tensor(0.4260, device='cuda:0')
batch 60 loss: tensor(0.4923, device='cuda:0')
batch 61 loss: tensor(0.4118, device='cuda:0')
batch 62 loss: tensor(0.4955, device='cuda:0')
batch 63 loss: tensor(0.4108, device='cuda:0')
batch 64 loss: tensor(0.4327, device='cuda:0')
batch 65 loss: tensor(0.3940, device='cuda:0')
batch 66 loss: tensor(0.4675, device='cuda:0')
batch 67 loss: tensor(0.4761, device='cuda:0')
batch 68 loss: tensor(0.4948, device='cuda:0')
batch 69 loss: tensor(0.4300, device='cuda:0')
batch 70 loss: tensor(0.4270, device='cuda:0')
batch 71 loss: tensor(0.3899, device='cuda:0')
batch 72 loss: tensor(0.4186, device='cuda:0')
batch 73 loss: tensor(0.4382, device='cuda:0')
batch 74 loss: tensor(0.4435, device='cuda:0')
batch 75 loss: tensor(0.4226, device='cuda:0')
batch 76 loss: tensor(0.4806, device='cuda:0')
batch 77 loss: tensor(0.4740, device='cuda:0')
batch 78 loss: tensor(0.4157, device='cuda:0')
batch 79 loss: tensor(0.4551, device='cuda:0')
batch 80 loss: tensor(0.4313, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.4938, device='cuda:0')
batch 2 loss: tensor(0.4621, device='cuda:0')
batch 3 loss: tensor(0.4993, device='cuda:0')
batch 4 loss: tensor(0.4033, device='cuda:0')
batch 5 loss: tensor(0.4502, device='cuda:0')
batch 6 loss: tensor(0.4231, device='cuda:0')
batch 7 loss: tensor(0.4243, device='cuda:0')
batch 8 loss: tensor(0.3770, device='cuda:0')
batch 9 loss: tensor(0.3749, device='cuda:0')
batch 10 loss: tensor(0.4270, device='cuda:0')
batch 11 loss: tensor(0.3723, device='cuda:0')
batch 12 loss: tensor(0.3934, device='cuda:0')
batch 13 loss: tensor(0.3833, device='cuda:0')
batch 14 loss: tensor(0.3725, device='cuda:0')
batch 15 loss: tensor(0.4692, device='cuda:0')
batch 16 loss: tensor(0.4005, device='cuda:0')
batch 17 loss: tensor(0.3825, device='cuda:0')
batch 18 loss: tensor(0.3685, device='cuda:0')
batch 19 loss: tensor(0.3539, device='cuda:0')
batch 20 loss: tensor(0.3705, device='cuda:0')
batch 21 loss: tensor(0.3541, device='cuda:0')
batch 22 loss: tensor(0.3992, device='cuda:0')
batch 23 loss: tensor(0.3281, device='cuda:0')
batch 24 loss: tensor(0.3962, device='cuda:0')
batch 25 loss: tensor(0.3788, device='cuda:0')
batch 26 loss: tensor(0.3930, device='cuda:0')
batch 27 loss: tensor(0.4277, device='cuda:0')
batch 28 loss: tensor(0.4347, device='cuda:0')
batch 29 loss: tensor(0.3751, device='cuda:0')
batch 30 loss: tensor(0.4137, device='cuda:0')
batch 31 loss: tensor(0.3810, device='cuda:0')
batch 32 loss: tensor(0.4217, device='cuda:0')
batch 33 loss: tensor(0.4016, device='cuda:0')
batch 34 loss: tensor(0.3563, device='cuda:0')
batch 35 loss: tensor(0.3639, device='cuda:0')
batch 36 loss: tensor(0.3956, device='cuda:0')
batch 37 loss: tensor(0.3931, device='cuda:0')
batch 38 loss: tensor(0.3359, device='cuda:0')
batch 39 loss: tensor(0.3885, device='cuda:0')
batch 40 loss: tensor(0.3701, device='cuda:0')
batch 41 loss: tensor(0.3988, device='cuda:0')
batch 42 loss: tensor(0.3527, device='cuda:0')
batch 43 loss: tensor(0.3809, device='cuda:0')
batch 44 loss: tensor(0.4026, device='cuda:0')
batch 45 loss: tensor(0.3427, device='cuda:0')
batch 46 loss: tensor(0.3836, device='cuda:0')
batch 47 loss: tensor(0.4205, device='cuda:0')
batch 48 loss: tensor(0.4454, device='cuda:0')
batch 49 loss: tensor(0.3454, device='cuda:0')
batch 50 loss: tensor(0.3295, device='cuda:0')
batch 51 loss: tensor(0.3959, device='cuda:0')
batch 52 loss: tensor(0.3437, device='cuda:0')
batch 53 loss: tensor(0.3928, device='cuda:0')
batch 54 loss: tensor(0.3959, device='cuda:0')
batch 55 loss: tensor(0.3176, device='cuda:0')
batch 56 loss: tensor(0.3910, device='cuda:0')
batch 57 loss: tensor(0.2978, device='cuda:0')
batch 58 loss: tensor(0.3991, device='cuda:0')
batch 59 loss: tensor(0.3725, device='cuda:0')
batch 60 loss: tensor(0.3159, device='cuda:0')
batch 61 loss: tensor(0.3805, device='cuda:0')
batch 62 loss: tensor(0.3229, device='cuda:0')
batch 63 loss: tensor(0.3666, device='cuda:0')
batch 64 loss: tensor(0.3484, device='cuda:0')
batch 65 loss: tensor(0.3500, device='cuda:0')
batch 66 loss: tensor(0.4552, device='cuda:0')
batch 67 loss: tensor(0.3497, device='cuda:0')
batch 68 loss: tensor(0.3719, device='cuda:0')
batch 69 loss: tensor(0.3484, device='cuda:0')
batch 70 loss: tensor(0.3989, device='cuda:0')
batch 71 loss: tensor(0.3948, device='cuda:0')
batch 72 loss: tensor(0.3602, device='cuda:0')
batch 73 loss: tensor(0.2845, device='cuda:0')
batch 74 loss: tensor(0.4194, device='cuda:0')
batch 75 loss: tensor(0.3777, device='cuda:0')
batch 76 loss: tensor(0.3696, device='cuda:0')
batch 77 loss: tensor(0.3744, device='cuda:0')
batch 78 loss: tensor(0.3776, device='cuda:0')
batch 79 loss: tensor(0.3491, device='cuda:0')
batch 80 loss: tensor(0.4341, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.4912, device='cuda:0')
batch 2 loss: tensor(0.3880, device='cuda:0')
batch 3 loss: tensor(0.4196, device='cuda:0')
batch 4 loss: tensor(0.3711, device='cuda:0')
batch 5 loss: tensor(0.3763, device='cuda:0')
batch 6 loss: tensor(0.3506, device='cuda:0')
batch 7 loss: tensor(0.3725, device='cuda:0')
batch 8 loss: tensor(0.4140, device='cuda:0')
batch 9 loss: tensor(0.3800, device='cuda:0')
batch 10 loss: tensor(0.3514, device='cuda:0')
batch 11 loss: tensor(0.3364, device='cuda:0')
batch 12 loss: tensor(0.3388, device='cuda:0')
batch 13 loss: tensor(0.3680, device='cuda:0')
batch 14 loss: tensor(0.3472, device='cuda:0')
batch 15 loss: tensor(0.3691, device='cuda:0')
batch 16 loss: tensor(0.3434, device='cuda:0')
batch 17 loss: tensor(0.3207, device='cuda:0')
batch 18 loss: tensor(0.3320, device='cuda:0')
batch 19 loss: tensor(0.3518, device='cuda:0')
batch 20 loss: tensor(0.3457, device='cuda:0')
batch 21 loss: tensor(0.3118, device='cuda:0')
batch 22 loss: tensor(0.3278, device='cuda:0')
batch 23 loss: tensor(0.3438, device='cuda:0')
batch 24 loss: tensor(0.3553, device='cuda:0')
batch 25 loss: tensor(0.3472, device='cuda:0')
batch 26 loss: tensor(0.3187, device='cuda:0')
batch 27 loss: tensor(0.3201, device='cuda:0')
batch 28 loss: tensor(0.3847, device='cuda:0')
batch 29 loss: tensor(0.3418, device='cuda:0')
batch 30 loss: tensor(0.2923, device='cuda:0')
batch 31 loss: tensor(0.3191, device='cuda:0')
batch 32 loss: tensor(0.3226, device='cuda:0')
batch 33 loss: tensor(0.3397, device='cuda:0')
batch 34 loss: tensor(0.3308, device='cuda:0')
batch 35 loss: tensor(0.3718, device='cuda:0')
batch 36 loss: tensor(0.3104, device='cuda:0')
batch 37 loss: tensor(0.3776, device='cuda:0')
batch 38 loss: tensor(0.3228, device='cuda:0')
batch 39 loss: tensor(0.3535, device='cuda:0')
batch 40 loss: tensor(0.3580, device='cuda:0')
batch 41 loss: tensor(0.4295, device='cuda:0')
batch 42 loss: tensor(0.3116, device='cuda:0')
batch 43 loss: tensor(0.3449, device='cuda:0')
batch 44 loss: tensor(0.3684, device='cuda:0')
batch 45 loss: tensor(0.3750, device='cuda:0')
batch 46 loss: tensor(0.3708, device='cuda:0')
batch 47 loss: tensor(0.3005, device='cuda:0')
batch 48 loss: tensor(0.3360, device='cuda:0')
batch 49 loss: tensor(0.3325, device='cuda:0')
batch 50 loss: tensor(0.3113, device='cuda:0')
batch 51 loss: tensor(0.3634, device='cuda:0')
batch 52 loss: tensor(0.3158, device='cuda:0')
batch 53 loss: tensor(0.3877, device='cuda:0')
batch 54 loss: tensor(0.3351, device='cuda:0')
batch 55 loss: tensor(0.3083, device='cuda:0')
batch 56 loss: tensor(0.3804, device='cuda:0')
batch 57 loss: tensor(0.3548, device='cuda:0')
batch 58 loss: tensor(0.3557, device='cuda:0')
batch 59 loss: tensor(0.3329, device='cuda:0')
batch 60 loss: tensor(0.3249, device='cuda:0')
batch 61 loss: tensor(0.3546, device='cuda:0')
batch 62 loss: tensor(0.3835, device='cuda:0')
batch 63 loss: tensor(0.3641, device='cuda:0')
batch 64 loss: tensor(0.3857, device='cuda:0')
batch 65 loss: tensor(0.3688, device='cuda:0')
batch 66 loss: tensor(0.3137, device='cuda:0')
batch 67 loss: tensor(0.3597, device='cuda:0')
batch 68 loss: tensor(0.2961, device='cuda:0')
batch 69 loss: tensor(0.2575, device='cuda:0')
batch 70 loss: tensor(0.3487, device='cuda:0')
batch 71 loss: tensor(0.3885, device='cuda:0')
batch 72 loss: tensor(0.3148, device='cuda:0')
batch 73 loss: tensor(0.3344, device='cuda:0')
batch 74 loss: tensor(0.3252, device='cuda:0')
batch 75 loss: tensor(0.3476, device='cuda:0')
batch 76 loss: tensor(0.3445, device='cuda:0')
batch 77 loss: tensor(0.3377, device='cuda:0')
batch 78 loss: tensor(0.3042, device='cuda:0')
batch 79 loss: tensor(0.2910, device='cuda:0')
batch 80 loss: tensor(0.3076, device='cuda:0')
accuracy in val: 0.84537
accuracy in test: 0.892080835268357
average epoch time: 1.869245320558548
total time: 448.6188769340515
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 3, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9561, device='cuda:0')
batch 2 loss: tensor(0.7491, device='cuda:0')
batch 3 loss: tensor(0.6426, device='cuda:0')
batch 4 loss: tensor(0.6602, device='cuda:0')
batch 5 loss: tensor(0.5774, device='cuda:0')
batch 6 loss: tensor(0.6201, device='cuda:0')
batch 7 loss: tensor(0.6276, device='cuda:0')
batch 8 loss: tensor(0.5476, device='cuda:0')
batch 9 loss: tensor(0.5086, device='cuda:0')
batch 10 loss: tensor(0.5154, device='cuda:0')
batch 11 loss: tensor(0.5445, device='cuda:0')
batch 12 loss: tensor(0.5918, device='cuda:0')
batch 13 loss: tensor(0.4315, device='cuda:0')
batch 14 loss: tensor(0.5414, device='cuda:0')
batch 15 loss: tensor(0.5348, device='cuda:0')
batch 16 loss: tensor(0.5175, device='cuda:0')
batch 17 loss: tensor(0.5161, device='cuda:0')
batch 18 loss: tensor(0.5537, device='cuda:0')
batch 19 loss: tensor(0.5260, device='cuda:0')
batch 20 loss: tensor(0.5255, device='cuda:0')
batch 21 loss: tensor(0.4658, device='cuda:0')
batch 22 loss: tensor(0.4962, device='cuda:0')
batch 23 loss: tensor(0.4589, device='cuda:0')
batch 24 loss: tensor(0.4801, device='cuda:0')
batch 25 loss: tensor(0.4702, device='cuda:0')
batch 26 loss: tensor(0.5294, device='cuda:0')
batch 27 loss: tensor(0.5072, device='cuda:0')
batch 28 loss: tensor(0.5242, device='cuda:0')
batch 29 loss: tensor(0.5320, device='cuda:0')
batch 30 loss: tensor(0.4821, device='cuda:0')
batch 31 loss: tensor(0.4426, device='cuda:0')
batch 32 loss: tensor(0.4955, device='cuda:0')
batch 33 loss: tensor(0.4558, device='cuda:0')
batch 34 loss: tensor(0.4866, device='cuda:0')
batch 35 loss: tensor(0.4594, device='cuda:0')
batch 36 loss: tensor(0.4298, device='cuda:0')
batch 37 loss: tensor(0.4733, device='cuda:0')
batch 38 loss: tensor(0.4693, device='cuda:0')
batch 39 loss: tensor(0.4964, device='cuda:0')
batch 40 loss: tensor(0.4535, device='cuda:0')
batch 41 loss: tensor(0.4210, device='cuda:0')
batch 42 loss: tensor(0.4056, device='cuda:0')
batch 43 loss: tensor(0.4972, device='cuda:0')
batch 44 loss: tensor(0.5041, device='cuda:0')
batch 45 loss: tensor(0.4663, device='cuda:0')
batch 46 loss: tensor(0.4859, device='cuda:0')
batch 47 loss: tensor(0.4815, device='cuda:0')
batch 48 loss: tensor(0.4539, device='cuda:0')
batch 49 loss: tensor(0.4862, device='cuda:0')
batch 50 loss: tensor(0.4546, device='cuda:0')
batch 51 loss: tensor(0.4272, device='cuda:0')
batch 52 loss: tensor(0.4915, device='cuda:0')
batch 53 loss: tensor(0.4823, device='cuda:0')
batch 54 loss: tensor(0.5245, device='cuda:0')
batch 55 loss: tensor(0.4494, device='cuda:0')
batch 56 loss: tensor(0.4210, device='cuda:0')
batch 57 loss: tensor(0.4314, device='cuda:0')
batch 58 loss: tensor(0.4685, device='cuda:0')
batch 59 loss: tensor(0.4652, device='cuda:0')
batch 60 loss: tensor(0.4173, device='cuda:0')
batch 61 loss: tensor(0.4597, device='cuda:0')
batch 62 loss: tensor(0.4730, device='cuda:0')
batch 63 loss: tensor(0.4319, device='cuda:0')
batch 64 loss: tensor(0.3980, device='cuda:0')
batch 65 loss: tensor(0.4217, device='cuda:0')
batch 66 loss: tensor(0.4165, device='cuda:0')
batch 67 loss: tensor(0.4968, device='cuda:0')
batch 68 loss: tensor(0.4483, device='cuda:0')
batch 69 loss: tensor(0.4234, device='cuda:0')
batch 70 loss: tensor(0.4600, device='cuda:0')
batch 71 loss: tensor(0.4387, device='cuda:0')
batch 72 loss: tensor(0.4806, device='cuda:0')
batch 73 loss: tensor(0.4404, device='cuda:0')
batch 74 loss: tensor(0.5058, device='cuda:0')
batch 75 loss: tensor(0.4960, device='cuda:0')
batch 76 loss: tensor(0.4476, device='cuda:0')
batch 77 loss: tensor(0.4304, device='cuda:0')
batch 78 loss: tensor(0.4514, device='cuda:0')
batch 79 loss: tensor(0.4613, device='cuda:0')
batch 80 loss: tensor(0.4694, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5595, device='cuda:0')
batch 2 loss: tensor(0.4627, device='cuda:0')
batch 3 loss: tensor(0.4072, device='cuda:0')
batch 4 loss: tensor(0.4337, device='cuda:0')
batch 5 loss: tensor(0.4543, device='cuda:0')
batch 6 loss: tensor(0.4282, device='cuda:0')
batch 7 loss: tensor(0.4117, device='cuda:0')
batch 8 loss: tensor(0.4210, device='cuda:0')
batch 9 loss: tensor(0.3240, device='cuda:0')
batch 10 loss: tensor(0.3521, device='cuda:0')
batch 11 loss: tensor(0.4075, device='cuda:0')
batch 12 loss: tensor(0.3998, device='cuda:0')
batch 13 loss: tensor(0.3940, device='cuda:0')
batch 14 loss: tensor(0.3690, device='cuda:0')
batch 15 loss: tensor(0.3852, device='cuda:0')
batch 16 loss: tensor(0.4033, device='cuda:0')
batch 17 loss: tensor(0.3902, device='cuda:0')
batch 18 loss: tensor(0.4122, device='cuda:0')
batch 19 loss: tensor(0.4329, device='cuda:0')
batch 20 loss: tensor(0.3427, device='cuda:0')
batch 21 loss: tensor(0.3921, device='cuda:0')
batch 22 loss: tensor(0.3886, device='cuda:0')
batch 23 loss: tensor(0.3612, device='cuda:0')
batch 24 loss: tensor(0.4102, device='cuda:0')
batch 25 loss: tensor(0.3671, device='cuda:0')
batch 26 loss: tensor(0.4075, device='cuda:0')
batch 27 loss: tensor(0.3743, device='cuda:0')
batch 28 loss: tensor(0.3756, device='cuda:0')
batch 29 loss: tensor(0.4047, device='cuda:0')
batch 30 loss: tensor(0.4087, device='cuda:0')
batch 31 loss: tensor(0.3929, device='cuda:0')
batch 32 loss: tensor(0.3977, device='cuda:0')
batch 33 loss: tensor(0.3658, device='cuda:0')
batch 34 loss: tensor(0.4129, device='cuda:0')
batch 35 loss: tensor(0.3156, device='cuda:0')
batch 36 loss: tensor(0.3729, device='cuda:0')
batch 37 loss: tensor(0.3715, device='cuda:0')
batch 38 loss: tensor(0.4126, device='cuda:0')
batch 39 loss: tensor(0.4132, device='cuda:0')
batch 40 loss: tensor(0.4054, device='cuda:0')
batch 41 loss: tensor(0.3554, device='cuda:0')
batch 42 loss: tensor(0.3657, device='cuda:0')
batch 43 loss: tensor(0.4167, device='cuda:0')
batch 44 loss: tensor(0.3978, device='cuda:0')
batch 45 loss: tensor(0.3601, device='cuda:0')
batch 46 loss: tensor(0.3782, device='cuda:0')
batch 47 loss: tensor(0.3437, device='cuda:0')
batch 48 loss: tensor(0.3262, device='cuda:0')
batch 49 loss: tensor(0.3646, device='cuda:0')
batch 50 loss: tensor(0.4473, device='cuda:0')
batch 51 loss: tensor(0.3692, device='cuda:0')
batch 52 loss: tensor(0.3643, device='cuda:0')
batch 53 loss: tensor(0.3495, device='cuda:0')
batch 54 loss: tensor(0.3210, device='cuda:0')
batch 55 loss: tensor(0.3331, device='cuda:0')
batch 56 loss: tensor(0.4184, device='cuda:0')
batch 57 loss: tensor(0.3667, device='cuda:0')
batch 58 loss: tensor(0.3613, device='cuda:0')
batch 59 loss: tensor(0.3679, device='cuda:0')
batch 60 loss: tensor(0.3833, device='cuda:0')
batch 61 loss: tensor(0.3348, device='cuda:0')
batch 62 loss: tensor(0.4066, device='cuda:0')
batch 63 loss: tensor(0.3531, device='cuda:0')
batch 64 loss: tensor(0.3265, device='cuda:0')
batch 65 loss: tensor(0.3364, device='cuda:0')
batch 66 loss: tensor(0.3103, device='cuda:0')
batch 67 loss: tensor(0.3628, device='cuda:0')
batch 68 loss: tensor(0.4196, device='cuda:0')
batch 69 loss: tensor(0.3742, device='cuda:0')
batch 70 loss: tensor(0.3954, device='cuda:0')
batch 71 loss: tensor(0.3612, device='cuda:0')
batch 72 loss: tensor(0.3918, device='cuda:0')
batch 73 loss: tensor(0.3479, device='cuda:0')
batch 74 loss: tensor(0.3445, device='cuda:0')
batch 75 loss: tensor(0.3597, device='cuda:0')
batch 76 loss: tensor(0.3797, device='cuda:0')
batch 77 loss: tensor(0.3908, device='cuda:0')
batch 78 loss: tensor(0.3531, device='cuda:0')
batch 79 loss: tensor(0.3377, device='cuda:0')
batch 80 loss: tensor(0.3341, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.5142, device='cuda:0')
batch 2 loss: tensor(0.4702, device='cuda:0')
batch 3 loss: tensor(0.3740, device='cuda:0')
batch 4 loss: tensor(0.3870, device='cuda:0')
batch 5 loss: tensor(0.4058, device='cuda:0')
batch 6 loss: tensor(0.3493, device='cuda:0')
batch 7 loss: tensor(0.3585, device='cuda:0')
batch 8 loss: tensor(0.3533, device='cuda:0')
batch 9 loss: tensor(0.4263, device='cuda:0')
batch 10 loss: tensor(0.3085, device='cuda:0')
batch 11 loss: tensor(0.4440, device='cuda:0')
batch 12 loss: tensor(0.3221, device='cuda:0')
batch 13 loss: tensor(0.3350, device='cuda:0')
batch 14 loss: tensor(0.3085, device='cuda:0')
batch 15 loss: tensor(0.3162, device='cuda:0')
batch 16 loss: tensor(0.3855, device='cuda:0')
batch 17 loss: tensor(0.3551, device='cuda:0')
batch 18 loss: tensor(0.3197, device='cuda:0')
batch 19 loss: tensor(0.3220, device='cuda:0')
batch 20 loss: tensor(0.3518, device='cuda:0')
batch 21 loss: tensor(0.3492, device='cuda:0')
batch 22 loss: tensor(0.4419, device='cuda:0')
batch 23 loss: tensor(0.3329, device='cuda:0')
batch 24 loss: tensor(0.3733, device='cuda:0')
batch 25 loss: tensor(0.3321, device='cuda:0')
batch 26 loss: tensor(0.3131, device='cuda:0')
batch 27 loss: tensor(0.3157, device='cuda:0')
batch 28 loss: tensor(0.4128, device='cuda:0')
batch 29 loss: tensor(0.2943, device='cuda:0')
batch 30 loss: tensor(0.2671, device='cuda:0')
batch 31 loss: tensor(0.3421, device='cuda:0')
batch 32 loss: tensor(0.3526, device='cuda:0')
batch 33 loss: tensor(0.3686, device='cuda:0')
batch 34 loss: tensor(0.3223, device='cuda:0')
batch 35 loss: tensor(0.3272, device='cuda:0')
batch 36 loss: tensor(0.4010, device='cuda:0')
batch 37 loss: tensor(0.3435, device='cuda:0')
batch 38 loss: tensor(0.3452, device='cuda:0')
batch 39 loss: tensor(0.3877, device='cuda:0')
batch 40 loss: tensor(0.3211, device='cuda:0')
batch 41 loss: tensor(0.3449, device='cuda:0')
batch 42 loss: tensor(0.4101, device='cuda:0')
batch 43 loss: tensor(0.3282, device='cuda:0')
batch 44 loss: tensor(0.3495, device='cuda:0')
batch 45 loss: tensor(0.3582, device='cuda:0')
batch 46 loss: tensor(0.3289, device='cuda:0')
batch 47 loss: tensor(0.3668, device='cuda:0')
batch 48 loss: tensor(0.3558, device='cuda:0')
batch 49 loss: tensor(0.3421, device='cuda:0')
batch 50 loss: tensor(0.4039, device='cuda:0')
batch 51 loss: tensor(0.3536, device='cuda:0')
batch 52 loss: tensor(0.3173, device='cuda:0')
batch 53 loss: tensor(0.4089, device='cuda:0')
batch 54 loss: tensor(0.3180, device='cuda:0')
batch 55 loss: tensor(0.3050, device='cuda:0')
batch 56 loss: tensor(0.3517, device='cuda:0')
batch 57 loss: tensor(0.3099, device='cuda:0')
batch 58 loss: tensor(0.2904, device='cuda:0')
batch 59 loss: tensor(0.3164, device='cuda:0')
batch 60 loss: tensor(0.3328, device='cuda:0')
batch 61 loss: tensor(0.3921, device='cuda:0')
batch 62 loss: tensor(0.2928, device='cuda:0')
batch 63 loss: tensor(0.3431, device='cuda:0')
batch 64 loss: tensor(0.3245, device='cuda:0')
batch 65 loss: tensor(0.3425, device='cuda:0')
batch 66 loss: tensor(0.3475, device='cuda:0')
batch 67 loss: tensor(0.3130, device='cuda:0')
batch 68 loss: tensor(0.3660, device='cuda:0')
batch 69 loss: tensor(0.3220, device='cuda:0')
batch 70 loss: tensor(0.3176, device='cuda:0')
batch 71 loss: tensor(0.2933, device='cuda:0')
batch 72 loss: tensor(0.3385, device='cuda:0')
batch 73 loss: tensor(0.3991, device='cuda:0')
batch 74 loss: tensor(0.3639, device='cuda:0')
batch 75 loss: tensor(0.3297, device='cuda:0')
batch 76 loss: tensor(0.3212, device='cuda:0')
batch 77 loss: tensor(0.3381, device='cuda:0')
batch 78 loss: tensor(0.3008, device='cuda:0')
batch 79 loss: tensor(0.3163, device='cuda:0')
batch 80 loss: tensor(0.3210, device='cuda:0')
accuracy in val: 0.8441033333333333
accuracy in test: 0.8919195066930674
average epoch time: 1.8786657005548477
total time: 450.87976813316345
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 3, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9692, device='cuda:0')
batch 2 loss: tensor(0.8027, device='cuda:0')
batch 3 loss: tensor(0.7123, device='cuda:0')
batch 4 loss: tensor(0.6133, device='cuda:0')
batch 5 loss: tensor(0.6567, device='cuda:0')
batch 6 loss: tensor(0.5352, device='cuda:0')
batch 7 loss: tensor(0.6178, device='cuda:0')
batch 8 loss: tensor(0.5519, device='cuda:0')
batch 9 loss: tensor(0.5883, device='cuda:0')
batch 10 loss: tensor(0.5422, device='cuda:0')
batch 11 loss: tensor(0.5462, device='cuda:0')
batch 12 loss: tensor(0.5228, device='cuda:0')
batch 13 loss: tensor(0.5059, device='cuda:0')
batch 14 loss: tensor(0.5091, device='cuda:0')
batch 15 loss: tensor(0.4711, device='cuda:0')
batch 16 loss: tensor(0.5016, device='cuda:0')
batch 17 loss: tensor(0.4829, device='cuda:0')
batch 18 loss: tensor(0.5047, device='cuda:0')
batch 19 loss: tensor(0.5180, device='cuda:0')
batch 20 loss: tensor(0.5085, device='cuda:0')
batch 21 loss: tensor(0.4573, device='cuda:0')
batch 22 loss: tensor(0.5043, device='cuda:0')
batch 23 loss: tensor(0.4989, device='cuda:0')
batch 24 loss: tensor(0.5416, device='cuda:0')
batch 25 loss: tensor(0.4761, device='cuda:0')
batch 26 loss: tensor(0.5084, device='cuda:0')
batch 27 loss: tensor(0.4725, device='cuda:0')
batch 28 loss: tensor(0.4266, device='cuda:0')
batch 29 loss: tensor(0.5319, device='cuda:0')
batch 30 loss: tensor(0.5627, device='cuda:0')
batch 31 loss: tensor(0.4774, device='cuda:0')
batch 32 loss: tensor(0.5272, device='cuda:0')
batch 33 loss: tensor(0.4888, device='cuda:0')
batch 34 loss: tensor(0.4097, device='cuda:0')
batch 35 loss: tensor(0.5055, device='cuda:0')
batch 36 loss: tensor(0.5388, device='cuda:0')
batch 37 loss: tensor(0.4896, device='cuda:0')
batch 38 loss: tensor(0.5130, device='cuda:0')
batch 39 loss: tensor(0.4140, device='cuda:0')
batch 40 loss: tensor(0.5095, device='cuda:0')
batch 41 loss: tensor(0.4594, device='cuda:0')
batch 42 loss: tensor(0.4543, device='cuda:0')
batch 43 loss: tensor(0.4709, device='cuda:0')
batch 44 loss: tensor(0.5018, device='cuda:0')
batch 45 loss: tensor(0.4810, device='cuda:0')
batch 46 loss: tensor(0.5218, device='cuda:0')
batch 47 loss: tensor(0.5072, device='cuda:0')
batch 48 loss: tensor(0.4290, device='cuda:0')
batch 49 loss: tensor(0.4751, device='cuda:0')
batch 50 loss: tensor(0.5194, device='cuda:0')
batch 51 loss: tensor(0.4998, device='cuda:0')
batch 52 loss: tensor(0.4245, device='cuda:0')
batch 53 loss: tensor(0.4630, device='cuda:0')
batch 54 loss: tensor(0.4510, device='cuda:0')
batch 55 loss: tensor(0.4444, device='cuda:0')
batch 56 loss: tensor(0.4002, device='cuda:0')
batch 57 loss: tensor(0.4668, device='cuda:0')
batch 58 loss: tensor(0.4182, device='cuda:0')
batch 59 loss: tensor(0.4603, device='cuda:0')
batch 60 loss: tensor(0.4267, device='cuda:0')
batch 61 loss: tensor(0.4582, device='cuda:0')
batch 62 loss: tensor(0.5965, device='cuda:0')
batch 63 loss: tensor(0.4084, device='cuda:0')
batch 64 loss: tensor(0.4846, device='cuda:0')
batch 65 loss: tensor(0.4240, device='cuda:0')
batch 66 loss: tensor(0.4999, device='cuda:0')
batch 67 loss: tensor(0.4103, device='cuda:0')
batch 68 loss: tensor(0.4868, device='cuda:0')
batch 69 loss: tensor(0.4284, device='cuda:0')
batch 70 loss: tensor(0.4245, device='cuda:0')
batch 71 loss: tensor(0.4796, device='cuda:0')
batch 72 loss: tensor(0.4226, device='cuda:0')
batch 73 loss: tensor(0.4605, device='cuda:0')
batch 74 loss: tensor(0.4756, device='cuda:0')
batch 75 loss: tensor(0.4658, device='cuda:0')
batch 76 loss: tensor(0.4568, device='cuda:0')
batch 77 loss: tensor(0.3869, device='cuda:0')
batch 78 loss: tensor(0.4396, device='cuda:0')
batch 79 loss: tensor(0.4509, device='cuda:0')
batch 80 loss: tensor(0.4844, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5190, device='cuda:0')
batch 2 loss: tensor(0.4574, device='cuda:0')
batch 3 loss: tensor(0.3927, device='cuda:0')
batch 4 loss: tensor(0.3630, device='cuda:0')
batch 5 loss: tensor(0.4409, device='cuda:0')
batch 6 loss: tensor(0.4240, device='cuda:0')
batch 7 loss: tensor(0.4507, device='cuda:0')
batch 8 loss: tensor(0.3567, device='cuda:0')
batch 9 loss: tensor(0.4213, device='cuda:0')
batch 10 loss: tensor(0.3765, device='cuda:0')
batch 11 loss: tensor(0.4359, device='cuda:0')
batch 12 loss: tensor(0.4084, device='cuda:0')
batch 13 loss: tensor(0.4411, device='cuda:0')
batch 14 loss: tensor(0.3809, device='cuda:0')
batch 15 loss: tensor(0.4140, device='cuda:0')
batch 16 loss: tensor(0.3753, device='cuda:0')
batch 17 loss: tensor(0.4297, device='cuda:0')
batch 18 loss: tensor(0.4010, device='cuda:0')
batch 19 loss: tensor(0.3793, device='cuda:0')
batch 20 loss: tensor(0.4272, device='cuda:0')
batch 21 loss: tensor(0.3488, device='cuda:0')
batch 22 loss: tensor(0.3649, device='cuda:0')
batch 23 loss: tensor(0.3835, device='cuda:0')
batch 24 loss: tensor(0.3667, device='cuda:0')
batch 25 loss: tensor(0.4242, device='cuda:0')
batch 26 loss: tensor(0.3974, device='cuda:0')
batch 27 loss: tensor(0.3653, device='cuda:0')
batch 28 loss: tensor(0.4163, device='cuda:0')
batch 29 loss: tensor(0.3940, device='cuda:0')
batch 30 loss: tensor(0.4590, device='cuda:0')
batch 31 loss: tensor(0.3838, device='cuda:0')
batch 32 loss: tensor(0.3889, device='cuda:0')
batch 33 loss: tensor(0.3573, device='cuda:0')
batch 34 loss: tensor(0.3597, device='cuda:0')
batch 35 loss: tensor(0.3912, device='cuda:0')
batch 36 loss: tensor(0.3419, device='cuda:0')
batch 37 loss: tensor(0.3348, device='cuda:0')
batch 38 loss: tensor(0.3688, device='cuda:0')
batch 39 loss: tensor(0.3875, device='cuda:0')
batch 40 loss: tensor(0.3928, device='cuda:0')
batch 41 loss: tensor(0.3817, device='cuda:0')
batch 42 loss: tensor(0.4305, device='cuda:0')
batch 43 loss: tensor(0.3667, device='cuda:0')
batch 44 loss: tensor(0.3912, device='cuda:0')
batch 45 loss: tensor(0.3646, device='cuda:0')
batch 46 loss: tensor(0.3432, device='cuda:0')
batch 47 loss: tensor(0.3809, device='cuda:0')
batch 48 loss: tensor(0.4170, device='cuda:0')
batch 49 loss: tensor(0.3117, device='cuda:0')
batch 50 loss: tensor(0.4066, device='cuda:0')
batch 51 loss: tensor(0.3433, device='cuda:0')
batch 52 loss: tensor(0.4172, device='cuda:0')
batch 53 loss: tensor(0.3813, device='cuda:0')
batch 54 loss: tensor(0.3351, device='cuda:0')
batch 55 loss: tensor(0.4143, device='cuda:0')
batch 56 loss: tensor(0.3605, device='cuda:0')
batch 57 loss: tensor(0.3482, device='cuda:0')
batch 58 loss: tensor(0.3349, device='cuda:0')
batch 59 loss: tensor(0.3603, device='cuda:0')
batch 60 loss: tensor(0.3826, device='cuda:0')
batch 61 loss: tensor(0.3708, device='cuda:0')
batch 62 loss: tensor(0.3697, device='cuda:0')
batch 63 loss: tensor(0.3663, device='cuda:0')
batch 64 loss: tensor(0.3360, device='cuda:0')
batch 65 loss: tensor(0.3384, device='cuda:0')
batch 66 loss: tensor(0.3671, device='cuda:0')
batch 67 loss: tensor(0.3705, device='cuda:0')
batch 68 loss: tensor(0.3524, device='cuda:0')
batch 69 loss: tensor(0.3292, device='cuda:0')
batch 70 loss: tensor(0.3320, device='cuda:0')
batch 71 loss: tensor(0.3763, device='cuda:0')
batch 72 loss: tensor(0.3767, device='cuda:0')
batch 73 loss: tensor(0.3462, device='cuda:0')
batch 74 loss: tensor(0.3771, device='cuda:0')
batch 75 loss: tensor(0.3639, device='cuda:0')
batch 76 loss: tensor(0.3303, device='cuda:0')
batch 77 loss: tensor(0.3980, device='cuda:0')
batch 78 loss: tensor(0.3761, device='cuda:0')
batch 79 loss: tensor(0.3593, device='cuda:0')
batch 80 loss: tensor(0.3205, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.4857, device='cuda:0')
batch 2 loss: tensor(0.3342, device='cuda:0')
batch 3 loss: tensor(0.3911, device='cuda:0')
batch 4 loss: tensor(0.3405, device='cuda:0')
batch 5 loss: tensor(0.3701, device='cuda:0')
batch 6 loss: tensor(0.3664, device='cuda:0')
batch 7 loss: tensor(0.3124, device='cuda:0')
batch 8 loss: tensor(0.3511, device='cuda:0')
batch 9 loss: tensor(0.3452, device='cuda:0')
batch 10 loss: tensor(0.3280, device='cuda:0')
batch 11 loss: tensor(0.3636, device='cuda:0')
batch 12 loss: tensor(0.3359, device='cuda:0')
batch 13 loss: tensor(0.3271, device='cuda:0')
batch 14 loss: tensor(0.3752, device='cuda:0')
batch 15 loss: tensor(0.3309, device='cuda:0')
batch 16 loss: tensor(0.3661, device='cuda:0')
batch 17 loss: tensor(0.3471, device='cuda:0')
batch 18 loss: tensor(0.3959, device='cuda:0')
batch 19 loss: tensor(0.3444, device='cuda:0')
batch 20 loss: tensor(0.3743, device='cuda:0')
batch 21 loss: tensor(0.3402, device='cuda:0')
batch 22 loss: tensor(0.3450, device='cuda:0')
batch 23 loss: tensor(0.3291, device='cuda:0')
batch 24 loss: tensor(0.3555, device='cuda:0')
batch 25 loss: tensor(0.3980, device='cuda:0')
batch 26 loss: tensor(0.3109, device='cuda:0')
batch 27 loss: tensor(0.3483, device='cuda:0')
batch 28 loss: tensor(0.3463, device='cuda:0')
batch 29 loss: tensor(0.3296, device='cuda:0')
batch 30 loss: tensor(0.3227, device='cuda:0')
batch 31 loss: tensor(0.3486, device='cuda:0')
batch 32 loss: tensor(0.3556, device='cuda:0')
batch 33 loss: tensor(0.3206, device='cuda:0')
batch 34 loss: tensor(0.3621, device='cuda:0')
batch 35 loss: tensor(0.3150, device='cuda:0')
batch 36 loss: tensor(0.3648, device='cuda:0')
batch 37 loss: tensor(0.3579, device='cuda:0')
batch 38 loss: tensor(0.3835, device='cuda:0')
batch 39 loss: tensor(0.3066, device='cuda:0')
batch 40 loss: tensor(0.3235, device='cuda:0')
batch 41 loss: tensor(0.3532, device='cuda:0')
batch 42 loss: tensor(0.3428, device='cuda:0')
batch 43 loss: tensor(0.3194, device='cuda:0')
batch 44 loss: tensor(0.3772, device='cuda:0')
batch 45 loss: tensor(0.3968, device='cuda:0')
batch 46 loss: tensor(0.3391, device='cuda:0')
batch 47 loss: tensor(0.2944, device='cuda:0')
batch 48 loss: tensor(0.3827, device='cuda:0')
batch 49 loss: tensor(0.3143, device='cuda:0')
batch 50 loss: tensor(0.3538, device='cuda:0')
batch 51 loss: tensor(0.3221, device='cuda:0')
batch 52 loss: tensor(0.3506, device='cuda:0')
batch 53 loss: tensor(0.3447, device='cuda:0')
batch 54 loss: tensor(0.3468, device='cuda:0')
batch 55 loss: tensor(0.3139, device='cuda:0')
batch 56 loss: tensor(0.2891, device='cuda:0')
batch 57 loss: tensor(0.4026, device='cuda:0')
batch 58 loss: tensor(0.3479, device='cuda:0')
batch 59 loss: tensor(0.4001, device='cuda:0')
batch 60 loss: tensor(0.3067, device='cuda:0')
batch 61 loss: tensor(0.3122, device='cuda:0')
batch 62 loss: tensor(0.3057, device='cuda:0')
batch 63 loss: tensor(0.2870, device='cuda:0')
batch 64 loss: tensor(0.3625, device='cuda:0')
batch 65 loss: tensor(0.3793, device='cuda:0')
batch 66 loss: tensor(0.3482, device='cuda:0')
batch 67 loss: tensor(0.3960, device='cuda:0')
batch 68 loss: tensor(0.4189, device='cuda:0')
batch 69 loss: tensor(0.3157, device='cuda:0')
batch 70 loss: tensor(0.2839, device='cuda:0')
batch 71 loss: tensor(0.3575, device='cuda:0')
batch 72 loss: tensor(0.3148, device='cuda:0')
batch 73 loss: tensor(0.3358, device='cuda:0')
batch 74 loss: tensor(0.3359, device='cuda:0')
batch 75 loss: tensor(0.3347, device='cuda:0')
batch 76 loss: tensor(0.3485, device='cuda:0')
batch 77 loss: tensor(0.3319, device='cuda:0')
batch 78 loss: tensor(0.3274, device='cuda:0')
batch 79 loss: tensor(0.3458, device='cuda:0')
batch 80 loss: tensor(0.3459, device='cuda:0')
accuracy in val: 0.84443
accuracy in test: 0.8923083499258164
average epoch time: 1.9284217615922292
total time: 462.821222782135
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 3, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9639, device='cuda:0')
batch 2 loss: tensor(0.6638, device='cuda:0')
batch 3 loss: tensor(0.6757, device='cuda:0')
batch 4 loss: tensor(0.6438, device='cuda:0')
batch 5 loss: tensor(0.5511, device='cuda:0')
batch 6 loss: tensor(0.5583, device='cuda:0')
batch 7 loss: tensor(0.5664, device='cuda:0')
batch 8 loss: tensor(0.5121, device='cuda:0')
batch 9 loss: tensor(0.6112, device='cuda:0')
batch 10 loss: tensor(0.5924, device='cuda:0')
batch 11 loss: tensor(0.5278, device='cuda:0')
batch 12 loss: tensor(0.5261, device='cuda:0')
batch 13 loss: tensor(0.4826, device='cuda:0')
batch 14 loss: tensor(0.4919, device='cuda:0')
batch 15 loss: tensor(0.5972, device='cuda:0')
batch 16 loss: tensor(0.4724, device='cuda:0')
batch 17 loss: tensor(0.4452, device='cuda:0')
batch 18 loss: tensor(0.4919, device='cuda:0')
batch 19 loss: tensor(0.4980, device='cuda:0')
batch 20 loss: tensor(0.5229, device='cuda:0')
batch 21 loss: tensor(0.4496, device='cuda:0')
batch 22 loss: tensor(0.4873, device='cuda:0')
batch 23 loss: tensor(0.4604, device='cuda:0')
batch 24 loss: tensor(0.4993, device='cuda:0')
batch 25 loss: tensor(0.4287, device='cuda:0')
batch 26 loss: tensor(0.4684, device='cuda:0')
batch 27 loss: tensor(0.5517, device='cuda:0')
batch 28 loss: tensor(0.4738, device='cuda:0')
batch 29 loss: tensor(0.4544, device='cuda:0')
batch 30 loss: tensor(0.5278, device='cuda:0')
batch 31 loss: tensor(0.5032, device='cuda:0')
batch 32 loss: tensor(0.4631, device='cuda:0')
batch 33 loss: tensor(0.4460, device='cuda:0')
batch 34 loss: tensor(0.4885, device='cuda:0')
batch 35 loss: tensor(0.5078, device='cuda:0')
batch 36 loss: tensor(0.4881, device='cuda:0')
batch 37 loss: tensor(0.4706, device='cuda:0')
batch 38 loss: tensor(0.4299, device='cuda:0')
batch 39 loss: tensor(0.4392, device='cuda:0')
batch 40 loss: tensor(0.4947, device='cuda:0')
batch 41 loss: tensor(0.4693, device='cuda:0')
batch 42 loss: tensor(0.4606, device='cuda:0')
batch 43 loss: tensor(0.4531, device='cuda:0')
batch 44 loss: tensor(0.5280, device='cuda:0')
batch 45 loss: tensor(0.5122, device='cuda:0')
batch 46 loss: tensor(0.4819, device='cuda:0')
batch 47 loss: tensor(0.5478, device='cuda:0')
batch 48 loss: tensor(0.4816, device='cuda:0')
batch 49 loss: tensor(0.4811, device='cuda:0')
batch 50 loss: tensor(0.4519, device='cuda:0')
batch 51 loss: tensor(0.5094, device='cuda:0')
batch 52 loss: tensor(0.4866, device='cuda:0')
batch 53 loss: tensor(0.4883, device='cuda:0')
batch 54 loss: tensor(0.4869, device='cuda:0')
batch 55 loss: tensor(0.4596, device='cuda:0')
batch 56 loss: tensor(0.4268, device='cuda:0')
batch 57 loss: tensor(0.4339, device='cuda:0')
batch 58 loss: tensor(0.4478, device='cuda:0')
batch 59 loss: tensor(0.4873, device='cuda:0')
batch 60 loss: tensor(0.4605, device='cuda:0')
batch 61 loss: tensor(0.4739, device='cuda:0')
batch 62 loss: tensor(0.4937, device='cuda:0')
batch 63 loss: tensor(0.4124, device='cuda:0')
batch 64 loss: tensor(0.5004, device='cuda:0')
batch 65 loss: tensor(0.4584, device='cuda:0')
batch 66 loss: tensor(0.4541, device='cuda:0')
batch 67 loss: tensor(0.4258, device='cuda:0')
batch 68 loss: tensor(0.4438, device='cuda:0')
batch 69 loss: tensor(0.4331, device='cuda:0')
batch 70 loss: tensor(0.4829, device='cuda:0')
batch 71 loss: tensor(0.3816, device='cuda:0')
batch 72 loss: tensor(0.4157, device='cuda:0')
batch 73 loss: tensor(0.4532, device='cuda:0')
batch 74 loss: tensor(0.4422, device='cuda:0')
batch 75 loss: tensor(0.4245, device='cuda:0')
batch 76 loss: tensor(0.4680, device='cuda:0')
batch 77 loss: tensor(0.4762, device='cuda:0')
batch 78 loss: tensor(0.4082, device='cuda:0')
batch 79 loss: tensor(0.4484, device='cuda:0')
batch 80 loss: tensor(0.5052, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5608, device='cuda:0')
batch 2 loss: tensor(0.4348, device='cuda:0')
batch 3 loss: tensor(0.4180, device='cuda:0')
batch 4 loss: tensor(0.4572, device='cuda:0')
batch 5 loss: tensor(0.3965, device='cuda:0')
batch 6 loss: tensor(0.4085, device='cuda:0')
batch 7 loss: tensor(0.4153, device='cuda:0')
batch 8 loss: tensor(0.4013, device='cuda:0')
batch 9 loss: tensor(0.3903, device='cuda:0')
batch 10 loss: tensor(0.3671, device='cuda:0')
batch 11 loss: tensor(0.4006, device='cuda:0')
batch 12 loss: tensor(0.3826, device='cuda:0')
batch 13 loss: tensor(0.4588, device='cuda:0')
batch 14 loss: tensor(0.3707, device='cuda:0')
batch 15 loss: tensor(0.3888, device='cuda:0')
batch 16 loss: tensor(0.3966, device='cuda:0')
batch 17 loss: tensor(0.3800, device='cuda:0')
batch 18 loss: tensor(0.4026, device='cuda:0')
batch 19 loss: tensor(0.4592, device='cuda:0')
batch 20 loss: tensor(0.3769, device='cuda:0')
batch 21 loss: tensor(0.4017, device='cuda:0')
batch 22 loss: tensor(0.3925, device='cuda:0')
batch 23 loss: tensor(0.3809, device='cuda:0')
batch 24 loss: tensor(0.4000, device='cuda:0')
batch 25 loss: tensor(0.4047, device='cuda:0')
batch 26 loss: tensor(0.3869, device='cuda:0')
batch 27 loss: tensor(0.4139, device='cuda:0')
batch 28 loss: tensor(0.3636, device='cuda:0')
batch 29 loss: tensor(0.3893, device='cuda:0')
batch 30 loss: tensor(0.4250, device='cuda:0')
batch 31 loss: tensor(0.3647, device='cuda:0')
batch 32 loss: tensor(0.3363, device='cuda:0')
batch 33 loss: tensor(0.4067, device='cuda:0')
batch 34 loss: tensor(0.3327, device='cuda:0')
batch 35 loss: tensor(0.4088, device='cuda:0')
batch 36 loss: tensor(0.3611, device='cuda:0')
batch 37 loss: tensor(0.3390, device='cuda:0')
batch 38 loss: tensor(0.3564, device='cuda:0')
batch 39 loss: tensor(0.3373, device='cuda:0')
batch 40 loss: tensor(0.4050, device='cuda:0')
batch 41 loss: tensor(0.3628, device='cuda:0')
batch 42 loss: tensor(0.3851, device='cuda:0')
batch 43 loss: tensor(0.3556, device='cuda:0')
batch 44 loss: tensor(0.3571, device='cuda:0')
batch 45 loss: tensor(0.3463, device='cuda:0')
batch 46 loss: tensor(0.3279, device='cuda:0')
batch 47 loss: tensor(0.3803, device='cuda:0')
batch 48 loss: tensor(0.4196, device='cuda:0')
batch 49 loss: tensor(0.3905, device='cuda:0')
batch 50 loss: tensor(0.3841, device='cuda:0')
batch 51 loss: tensor(0.3347, device='cuda:0')
batch 52 loss: tensor(0.2951, device='cuda:0')
batch 53 loss: tensor(0.4072, device='cuda:0')
batch 54 loss: tensor(0.3844, device='cuda:0')
batch 55 loss: tensor(0.3395, device='cuda:0')
batch 56 loss: tensor(0.3918, device='cuda:0')
batch 57 loss: tensor(0.3590, device='cuda:0')
batch 58 loss: tensor(0.3540, device='cuda:0')
batch 59 loss: tensor(0.3223, device='cuda:0')
batch 60 loss: tensor(0.3472, device='cuda:0')
batch 61 loss: tensor(0.3811, device='cuda:0')
batch 62 loss: tensor(0.3270, device='cuda:0')
batch 63 loss: tensor(0.3674, device='cuda:0')
batch 64 loss: tensor(0.3861, device='cuda:0')
batch 65 loss: tensor(0.3897, device='cuda:0')
batch 66 loss: tensor(0.3567, device='cuda:0')
batch 67 loss: tensor(0.3642, device='cuda:0')
batch 68 loss: tensor(0.3460, device='cuda:0')
batch 69 loss: tensor(0.3474, device='cuda:0')
batch 70 loss: tensor(0.3375, device='cuda:0')
batch 71 loss: tensor(0.3660, device='cuda:0')
batch 72 loss: tensor(0.3964, device='cuda:0')
batch 73 loss: tensor(0.3835, device='cuda:0')
batch 74 loss: tensor(0.3610, device='cuda:0')
batch 75 loss: tensor(0.4248, device='cuda:0')
batch 76 loss: tensor(0.4013, device='cuda:0')
batch 77 loss: tensor(0.3654, device='cuda:0')
batch 78 loss: tensor(0.4080, device='cuda:0')
batch 79 loss: tensor(0.3505, device='cuda:0')
batch 80 loss: tensor(0.3358, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.4861, device='cuda:0')
batch 2 loss: tensor(0.4099, device='cuda:0')
batch 3 loss: tensor(0.3912, device='cuda:0')
batch 4 loss: tensor(0.3436, device='cuda:0')
batch 5 loss: tensor(0.3066, device='cuda:0')
batch 6 loss: tensor(0.3503, device='cuda:0')
batch 7 loss: tensor(0.3876, device='cuda:0')
batch 8 loss: tensor(0.3532, device='cuda:0')
batch 9 loss: tensor(0.3419, device='cuda:0')
batch 10 loss: tensor(0.3232, device='cuda:0')
batch 11 loss: tensor(0.3944, device='cuda:0')
batch 12 loss: tensor(0.3794, device='cuda:0')
batch 13 loss: tensor(0.3715, device='cuda:0')
batch 14 loss: tensor(0.3283, device='cuda:0')
batch 15 loss: tensor(0.3853, device='cuda:0')
batch 16 loss: tensor(0.3479, device='cuda:0')
batch 17 loss: tensor(0.3438, device='cuda:0')
batch 18 loss: tensor(0.3860, device='cuda:0')
batch 19 loss: tensor(0.3104, device='cuda:0')
batch 20 loss: tensor(0.3921, device='cuda:0')
batch 21 loss: tensor(0.3205, device='cuda:0')
batch 22 loss: tensor(0.3559, device='cuda:0')
batch 23 loss: tensor(0.3578, device='cuda:0')
batch 24 loss: tensor(0.3303, device='cuda:0')
batch 25 loss: tensor(0.3836, device='cuda:0')
batch 26 loss: tensor(0.3835, device='cuda:0')
batch 27 loss: tensor(0.3641, device='cuda:0')
batch 28 loss: tensor(0.3433, device='cuda:0')
batch 29 loss: tensor(0.2969, device='cuda:0')
batch 30 loss: tensor(0.3264, device='cuda:0')
batch 31 loss: tensor(0.3805, device='cuda:0')
batch 32 loss: tensor(0.3663, device='cuda:0')
batch 33 loss: tensor(0.3781, device='cuda:0')
batch 34 loss: tensor(0.3354, device='cuda:0')
batch 35 loss: tensor(0.3928, device='cuda:0')
batch 36 loss: tensor(0.3240, device='cuda:0')
batch 37 loss: tensor(0.3470, device='cuda:0')
batch 38 loss: tensor(0.3708, device='cuda:0')
batch 39 loss: tensor(0.3162, device='cuda:0')
batch 40 loss: tensor(0.2821, device='cuda:0')
batch 41 loss: tensor(0.3646, device='cuda:0')
batch 42 loss: tensor(0.3079, device='cuda:0')
batch 43 loss: tensor(0.3557, device='cuda:0')
batch 44 loss: tensor(0.3600, device='cuda:0')
batch 45 loss: tensor(0.3276, device='cuda:0')
batch 46 loss: tensor(0.3538, device='cuda:0')
batch 47 loss: tensor(0.3423, device='cuda:0')
batch 48 loss: tensor(0.3722, device='cuda:0')
batch 49 loss: tensor(0.3106, device='cuda:0')
batch 50 loss: tensor(0.3587, device='cuda:0')
batch 51 loss: tensor(0.3503, device='cuda:0')
batch 52 loss: tensor(0.3480, device='cuda:0')
batch 53 loss: tensor(0.3647, device='cuda:0')
batch 54 loss: tensor(0.2945, device='cuda:0')
batch 55 loss: tensor(0.3119, device='cuda:0')
batch 56 loss: tensor(0.3520, device='cuda:0')
batch 57 loss: tensor(0.3604, device='cuda:0')
batch 58 loss: tensor(0.2951, device='cuda:0')
batch 59 loss: tensor(0.3221, device='cuda:0')
batch 60 loss: tensor(0.3202, device='cuda:0')
batch 61 loss: tensor(0.3217, device='cuda:0')
batch 62 loss: tensor(0.3638, device='cuda:0')
batch 63 loss: tensor(0.3369, device='cuda:0')
batch 64 loss: tensor(0.3560, device='cuda:0')
batch 65 loss: tensor(0.3399, device='cuda:0')
batch 66 loss: tensor(0.3572, device='cuda:0')
batch 67 loss: tensor(0.2941, device='cuda:0')
batch 68 loss: tensor(0.2830, device='cuda:0')
batch 69 loss: tensor(0.3215, device='cuda:0')
batch 70 loss: tensor(0.3107, device='cuda:0')
batch 71 loss: tensor(0.3557, device='cuda:0')
batch 72 loss: tensor(0.2997, device='cuda:0')
batch 73 loss: tensor(0.3273, device='cuda:0')
batch 74 loss: tensor(0.3922, device='cuda:0')
batch 75 loss: tensor(0.3242, device='cuda:0')
batch 76 loss: tensor(0.3525, device='cuda:0')
batch 77 loss: tensor(0.3576, device='cuda:0')
batch 78 loss: tensor(0.3592, device='cuda:0')
batch 79 loss: tensor(0.3503, device='cuda:0')
batch 80 loss: tensor(0.3650, device='cuda:0')
accuracy in val: 0.8452166666666666
accuracy in test: 0.8921787355149001
average epoch time: 2.035500892996788
total time: 488.5202143192291
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 3, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9501, device='cuda:0')
batch 2 loss: tensor(0.8213, device='cuda:0')
batch 3 loss: tensor(0.7341, device='cuda:0')
batch 4 loss: tensor(0.5419, device='cuda:0')
batch 5 loss: tensor(0.6136, device='cuda:0')
batch 6 loss: tensor(0.5279, device='cuda:0')
batch 7 loss: tensor(0.5556, device='cuda:0')
batch 8 loss: tensor(0.5800, device='cuda:0')
batch 9 loss: tensor(0.5993, device='cuda:0')
batch 10 loss: tensor(0.5496, device='cuda:0')
batch 11 loss: tensor(0.5637, device='cuda:0')
batch 12 loss: tensor(0.5388, device='cuda:0')
batch 13 loss: tensor(0.5079, device='cuda:0')
batch 14 loss: tensor(0.4975, device='cuda:0')
batch 15 loss: tensor(0.5486, device='cuda:0')
batch 16 loss: tensor(0.4792, device='cuda:0')
batch 17 loss: tensor(0.5179, device='cuda:0')
batch 18 loss: tensor(0.4989, device='cuda:0')
batch 19 loss: tensor(0.5048, device='cuda:0')
batch 20 loss: tensor(0.5394, device='cuda:0')
batch 21 loss: tensor(0.4706, device='cuda:0')
batch 22 loss: tensor(0.5046, device='cuda:0')
batch 23 loss: tensor(0.4693, device='cuda:0')
batch 24 loss: tensor(0.5771, device='cuda:0')
batch 25 loss: tensor(0.5064, device='cuda:0')
batch 26 loss: tensor(0.5461, device='cuda:0')
batch 27 loss: tensor(0.4594, device='cuda:0')
batch 28 loss: tensor(0.4691, device='cuda:0')
batch 29 loss: tensor(0.4419, device='cuda:0')
batch 30 loss: tensor(0.5313, device='cuda:0')
batch 31 loss: tensor(0.4469, device='cuda:0')
batch 32 loss: tensor(0.4845, device='cuda:0')
batch 33 loss: tensor(0.4999, device='cuda:0')
batch 34 loss: tensor(0.4718, device='cuda:0')
batch 35 loss: tensor(0.5306, device='cuda:0')
batch 36 loss: tensor(0.5197, device='cuda:0')
batch 37 loss: tensor(0.4783, device='cuda:0')
batch 38 loss: tensor(0.4477, device='cuda:0')
batch 39 loss: tensor(0.4665, device='cuda:0')
batch 40 loss: tensor(0.5117, device='cuda:0')
batch 41 loss: tensor(0.4918, device='cuda:0')
batch 42 loss: tensor(0.4305, device='cuda:0')
batch 43 loss: tensor(0.4916, device='cuda:0')
batch 44 loss: tensor(0.4298, device='cuda:0')
batch 45 loss: tensor(0.4916, device='cuda:0')
batch 46 loss: tensor(0.5230, device='cuda:0')
batch 47 loss: tensor(0.4506, device='cuda:0')
batch 48 loss: tensor(0.4725, device='cuda:0')
batch 49 loss: tensor(0.4682, device='cuda:0')
batch 50 loss: tensor(0.4504, device='cuda:0')
batch 51 loss: tensor(0.4818, device='cuda:0')
batch 52 loss: tensor(0.4640, device='cuda:0')
batch 53 loss: tensor(0.4654, device='cuda:0')
batch 54 loss: tensor(0.4288, device='cuda:0')
batch 55 loss: tensor(0.4536, device='cuda:0')
batch 56 loss: tensor(0.4682, device='cuda:0')
batch 57 loss: tensor(0.4476, device='cuda:0')
batch 58 loss: tensor(0.4493, device='cuda:0')
batch 59 loss: tensor(0.4437, device='cuda:0')
batch 60 loss: tensor(0.4300, device='cuda:0')
batch 61 loss: tensor(0.4859, device='cuda:0')
batch 62 loss: tensor(0.4009, device='cuda:0')
batch 63 loss: tensor(0.4239, device='cuda:0')
batch 64 loss: tensor(0.4146, device='cuda:0')
batch 65 loss: tensor(0.4825, device='cuda:0')
batch 66 loss: tensor(0.4465, device='cuda:0')
batch 67 loss: tensor(0.4549, device='cuda:0')
batch 68 loss: tensor(0.4456, device='cuda:0')
batch 69 loss: tensor(0.4559, device='cuda:0')
batch 70 loss: tensor(0.3900, device='cuda:0')
batch 71 loss: tensor(0.4426, device='cuda:0')
batch 72 loss: tensor(0.4546, device='cuda:0')
batch 73 loss: tensor(0.4342, device='cuda:0')
batch 74 loss: tensor(0.4140, device='cuda:0')
batch 75 loss: tensor(0.4081, device='cuda:0')
batch 76 loss: tensor(0.4418, device='cuda:0')
batch 77 loss: tensor(0.4823, device='cuda:0')
batch 78 loss: tensor(0.4922, device='cuda:0')
batch 79 loss: tensor(0.4197, device='cuda:0')
batch 80 loss: tensor(0.4784, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.4835, device='cuda:0')
batch 2 loss: tensor(0.4907, device='cuda:0')
batch 3 loss: tensor(0.4442, device='cuda:0')
batch 4 loss: tensor(0.3845, device='cuda:0')
batch 5 loss: tensor(0.3973, device='cuda:0')
batch 6 loss: tensor(0.4441, device='cuda:0')
batch 7 loss: tensor(0.3450, device='cuda:0')
batch 8 loss: tensor(0.4113, device='cuda:0')
batch 9 loss: tensor(0.4118, device='cuda:0')
batch 10 loss: tensor(0.4070, device='cuda:0')
batch 11 loss: tensor(0.3928, device='cuda:0')
batch 12 loss: tensor(0.3914, device='cuda:0')
batch 13 loss: tensor(0.3484, device='cuda:0')
batch 14 loss: tensor(0.3623, device='cuda:0')
batch 15 loss: tensor(0.3898, device='cuda:0')
batch 16 loss: tensor(0.3684, device='cuda:0')
batch 17 loss: tensor(0.4017, device='cuda:0')
batch 18 loss: tensor(0.3469, device='cuda:0')
batch 19 loss: tensor(0.3655, device='cuda:0')
batch 20 loss: tensor(0.3666, device='cuda:0')
batch 21 loss: tensor(0.3513, device='cuda:0')
batch 22 loss: tensor(0.3556, device='cuda:0')
batch 23 loss: tensor(0.3850, device='cuda:0')
batch 24 loss: tensor(0.3709, device='cuda:0')
batch 25 loss: tensor(0.4089, device='cuda:0')
batch 26 loss: tensor(0.3887, device='cuda:0')
batch 27 loss: tensor(0.3934, device='cuda:0')
batch 28 loss: tensor(0.3700, device='cuda:0')
batch 29 loss: tensor(0.3610, device='cuda:0')
batch 30 loss: tensor(0.3763, device='cuda:0')
batch 31 loss: tensor(0.3524, device='cuda:0')
batch 32 loss: tensor(0.3715, device='cuda:0')
batch 33 loss: tensor(0.3506, device='cuda:0')
batch 34 loss: tensor(0.3774, device='cuda:0')
batch 35 loss: tensor(0.3851, device='cuda:0')
batch 36 loss: tensor(0.3425, device='cuda:0')
batch 37 loss: tensor(0.3963, device='cuda:0')
batch 38 loss: tensor(0.3812, device='cuda:0')
batch 39 loss: tensor(0.3354, device='cuda:0')
batch 40 loss: tensor(0.4283, device='cuda:0')
batch 41 loss: tensor(0.4409, device='cuda:0')
batch 42 loss: tensor(0.3954, device='cuda:0')
batch 43 loss: tensor(0.3453, device='cuda:0')
batch 44 loss: tensor(0.3809, device='cuda:0')
batch 45 loss: tensor(0.3836, device='cuda:0')
batch 46 loss: tensor(0.4164, device='cuda:0')
batch 47 loss: tensor(0.3529, device='cuda:0')
batch 48 loss: tensor(0.3330, device='cuda:0')
batch 49 loss: tensor(0.3858, device='cuda:0')
batch 50 loss: tensor(0.3492, device='cuda:0')
batch 51 loss: tensor(0.3972, device='cuda:0')
batch 52 loss: tensor(0.3674, device='cuda:0')
batch 53 loss: tensor(0.3988, device='cuda:0')
batch 54 loss: tensor(0.4032, device='cuda:0')
batch 55 loss: tensor(0.3046, device='cuda:0')
batch 56 loss: tensor(0.3809, device='cuda:0')
batch 57 loss: tensor(0.4007, device='cuda:0')
batch 58 loss: tensor(0.3570, device='cuda:0')
batch 59 loss: tensor(0.3442, device='cuda:0')
batch 60 loss: tensor(0.4017, device='cuda:0')
batch 61 loss: tensor(0.3690, device='cuda:0')
batch 62 loss: tensor(0.3540, device='cuda:0')
batch 63 loss: tensor(0.3197, device='cuda:0')
batch 64 loss: tensor(0.3824, device='cuda:0')
batch 65 loss: tensor(0.3195, device='cuda:0')
batch 66 loss: tensor(0.3971, device='cuda:0')
batch 67 loss: tensor(0.3411, device='cuda:0')
batch 68 loss: tensor(0.4086, device='cuda:0')
batch 69 loss: tensor(0.4135, device='cuda:0')
batch 70 loss: tensor(0.3624, device='cuda:0')
batch 71 loss: tensor(0.2908, device='cuda:0')
batch 72 loss: tensor(0.3179, device='cuda:0')
batch 73 loss: tensor(0.3294, device='cuda:0')
batch 74 loss: tensor(0.3206, device='cuda:0')
batch 75 loss: tensor(0.3460, device='cuda:0')
batch 76 loss: tensor(0.3273, device='cuda:0')
batch 77 loss: tensor(0.3121, device='cuda:0')
batch 78 loss: tensor(0.3999, device='cuda:0')
batch 79 loss: tensor(0.3678, device='cuda:0')
batch 80 loss: tensor(0.3686, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.4032, device='cuda:0')
batch 2 loss: tensor(0.3539, device='cuda:0')
batch 3 loss: tensor(0.3869, device='cuda:0')
batch 4 loss: tensor(0.3818, device='cuda:0')
batch 5 loss: tensor(0.3402, device='cuda:0')
batch 6 loss: tensor(0.3462, device='cuda:0')
batch 7 loss: tensor(0.3565, device='cuda:0')
batch 8 loss: tensor(0.3417, device='cuda:0')
batch 9 loss: tensor(0.3633, device='cuda:0')
batch 10 loss: tensor(0.2987, device='cuda:0')
batch 11 loss: tensor(0.3476, device='cuda:0')
batch 12 loss: tensor(0.3559, device='cuda:0')
batch 13 loss: tensor(0.4230, device='cuda:0')
batch 14 loss: tensor(0.3189, device='cuda:0')
batch 15 loss: tensor(0.3848, device='cuda:0')
batch 16 loss: tensor(0.3809, device='cuda:0')
batch 17 loss: tensor(0.3678, device='cuda:0')
batch 18 loss: tensor(0.3923, device='cuda:0')
batch 19 loss: tensor(0.3503, device='cuda:0')
batch 20 loss: tensor(0.3269, device='cuda:0')
batch 21 loss: tensor(0.3641, device='cuda:0')
batch 22 loss: tensor(0.3666, device='cuda:0')
batch 23 loss: tensor(0.4255, device='cuda:0')
batch 24 loss: tensor(0.3232, device='cuda:0')
batch 25 loss: tensor(0.3473, device='cuda:0')
batch 26 loss: tensor(0.3834, device='cuda:0')
batch 27 loss: tensor(0.3609, device='cuda:0')
batch 28 loss: tensor(0.3596, device='cuda:0')
batch 29 loss: tensor(0.3578, device='cuda:0')
batch 30 loss: tensor(0.3598, device='cuda:0')
batch 31 loss: tensor(0.2838, device='cuda:0')
batch 32 loss: tensor(0.2953, device='cuda:0')
batch 33 loss: tensor(0.3675, device='cuda:0')
batch 34 loss: tensor(0.3513, device='cuda:0')
batch 35 loss: tensor(0.3057, device='cuda:0')
batch 36 loss: tensor(0.3358, device='cuda:0')
batch 37 loss: tensor(0.3352, device='cuda:0')
batch 38 loss: tensor(0.3728, device='cuda:0')
batch 39 loss: tensor(0.3004, device='cuda:0')
batch 40 loss: tensor(0.3754, device='cuda:0')
batch 41 loss: tensor(0.2860, device='cuda:0')
batch 42 loss: tensor(0.3779, device='cuda:0')
batch 43 loss: tensor(0.3974, device='cuda:0')
batch 44 loss: tensor(0.3330, device='cuda:0')
batch 45 loss: tensor(0.2686, device='cuda:0')
batch 46 loss: tensor(0.3282, device='cuda:0')
batch 47 loss: tensor(0.3199, device='cuda:0')
batch 48 loss: tensor(0.3615, device='cuda:0')
batch 49 loss: tensor(0.3165, device='cuda:0')
batch 50 loss: tensor(0.2811, device='cuda:0')
batch 51 loss: tensor(0.3702, device='cuda:0')
batch 52 loss: tensor(0.3833, device='cuda:0')
batch 53 loss: tensor(0.3603, device='cuda:0')
batch 54 loss: tensor(0.3283, device='cuda:0')
batch 55 loss: tensor(0.3287, device='cuda:0')
batch 56 loss: tensor(0.3642, device='cuda:0')
batch 57 loss: tensor(0.3293, device='cuda:0')
batch 58 loss: tensor(0.3722, device='cuda:0')
batch 59 loss: tensor(0.3549, device='cuda:0')
batch 60 loss: tensor(0.3311, device='cuda:0')
batch 61 loss: tensor(0.3314, device='cuda:0')
batch 62 loss: tensor(0.2718, device='cuda:0')
batch 63 loss: tensor(0.3596, device='cuda:0')
batch 64 loss: tensor(0.3188, device='cuda:0')
batch 65 loss: tensor(0.3593, device='cuda:0')
batch 66 loss: tensor(0.3494, device='cuda:0')
batch 67 loss: tensor(0.3325, device='cuda:0')
batch 68 loss: tensor(0.2419, device='cuda:0')
batch 69 loss: tensor(0.3206, device='cuda:0')
batch 70 loss: tensor(0.3202, device='cuda:0')
batch 71 loss: tensor(0.3542, device='cuda:0')
batch 72 loss: tensor(0.3200, device='cuda:0')
batch 73 loss: tensor(0.3286, device='cuda:0')
batch 74 loss: tensor(0.3473, device='cuda:0')
batch 75 loss: tensor(0.3718, device='cuda:0')
batch 76 loss: tensor(0.3421, device='cuda:0')
batch 77 loss: tensor(0.2955, device='cuda:0')
batch 78 loss: tensor(0.2917, device='cuda:0')
batch 79 loss: tensor(0.3392, device='cuda:0')
batch 80 loss: tensor(0.3710, device='cuda:0')
accuracy in val: 0.8435833333333334
accuracy in test: 0.8908701815153303
average epoch time: 1.8729805916547775
total time: 449.5153419971466

0.8920579459149398 456.97630829811095
0.0004386021073483931 14.91940620902416
Fri Nov 22 10:14:24 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |      9%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     30381      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 11:02:24 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |      4%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     30381      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 11:49:39 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |     14%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     30381      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 12:37:01 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |     14%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     30381      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 13:24:29 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |      9%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     30381      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 14:12:08 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    57W / 149W |    335MiB / 12206MiB |     13%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     30381      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 15:00:04 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |      7%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     30381      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 15:47:17 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |     14%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     30381      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 16:34:46 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |      9%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     30381      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
Fri Nov 22 17:22:11 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:83:00.0 Off |                  Off |
| N/A   35C    P0    56W / 149W |    335MiB / 12206MiB |     11%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:84:00.0 Off |                  Off |
| N/A   39C    P8    31W / 160W |     14MiB / 12206MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     14758      G   /usr/bin/X                                    20MiB |
|    0     30381      C   python                                       303MiB |
|    1     14758      G   /usr/bin/X                                    12MiB |
+-----------------------------------------------------------------------------+
{'dataset': 'amazon_3m', 'config_file': 'amazon_3m.yaml', 'layer_num': 4, 'epoch_num': [80, 80, 80, 80]}
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 4, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(1.0537, device='cuda:0')
batch 2 loss: tensor(0.7570, device='cuda:0')
batch 3 loss: tensor(0.7233, device='cuda:0')
batch 4 loss: tensor(0.6621, device='cuda:0')
batch 5 loss: tensor(0.7341, device='cuda:0')
batch 6 loss: tensor(0.5537, device='cuda:0')
batch 7 loss: tensor(0.6353, device='cuda:0')
batch 8 loss: tensor(0.5329, device='cuda:0')
batch 9 loss: tensor(0.4803, device='cuda:0')
batch 10 loss: tensor(0.4771, device='cuda:0')
batch 11 loss: tensor(0.5238, device='cuda:0')
batch 12 loss: tensor(0.5479, device='cuda:0')
batch 13 loss: tensor(0.4792, device='cuda:0')
batch 14 loss: tensor(0.5051, device='cuda:0')
batch 15 loss: tensor(0.5836, device='cuda:0')
batch 16 loss: tensor(0.4910, device='cuda:0')
batch 17 loss: tensor(0.4848, device='cuda:0')
batch 18 loss: tensor(0.4799, device='cuda:0')
batch 19 loss: tensor(0.5207, device='cuda:0')
batch 20 loss: tensor(0.5026, device='cuda:0')
batch 21 loss: tensor(0.5052, device='cuda:0')
batch 22 loss: tensor(0.5311, device='cuda:0')
batch 23 loss: tensor(0.5273, device='cuda:0')
batch 24 loss: tensor(0.5137, device='cuda:0')
batch 25 loss: tensor(0.4710, device='cuda:0')
batch 26 loss: tensor(0.5167, device='cuda:0')
batch 27 loss: tensor(0.4962, device='cuda:0')
batch 28 loss: tensor(0.4456, device='cuda:0')
batch 29 loss: tensor(0.4998, device='cuda:0')
batch 30 loss: tensor(0.5908, device='cuda:0')
batch 31 loss: tensor(0.5071, device='cuda:0')
batch 32 loss: tensor(0.5220, device='cuda:0')
batch 33 loss: tensor(0.4707, device='cuda:0')
batch 34 loss: tensor(0.5495, device='cuda:0')
batch 35 loss: tensor(0.4768, device='cuda:0')
batch 36 loss: tensor(0.4653, device='cuda:0')
batch 37 loss: tensor(0.4662, device='cuda:0')
batch 38 loss: tensor(0.5427, device='cuda:0')
batch 39 loss: tensor(0.4846, device='cuda:0')
batch 40 loss: tensor(0.4811, device='cuda:0')
batch 41 loss: tensor(0.4362, device='cuda:0')
batch 42 loss: tensor(0.4599, device='cuda:0')
batch 43 loss: tensor(0.4831, device='cuda:0')
batch 44 loss: tensor(0.4936, device='cuda:0')
batch 45 loss: tensor(0.4675, device='cuda:0')
batch 46 loss: tensor(0.4481, device='cuda:0')
batch 47 loss: tensor(0.5174, device='cuda:0')
batch 48 loss: tensor(0.4606, device='cuda:0')
batch 49 loss: tensor(0.4422, device='cuda:0')
batch 50 loss: tensor(0.4847, device='cuda:0')
batch 51 loss: tensor(0.4765, device='cuda:0')
batch 52 loss: tensor(0.4624, device='cuda:0')
batch 53 loss: tensor(0.5079, device='cuda:0')
batch 54 loss: tensor(0.4003, device='cuda:0')
batch 55 loss: tensor(0.4610, device='cuda:0')
batch 56 loss: tensor(0.4656, device='cuda:0')
batch 57 loss: tensor(0.4408, device='cuda:0')
batch 58 loss: tensor(0.4881, device='cuda:0')
batch 59 loss: tensor(0.4289, device='cuda:0')
batch 60 loss: tensor(0.4575, device='cuda:0')
batch 61 loss: tensor(0.4603, device='cuda:0')
batch 62 loss: tensor(0.4889, device='cuda:0')
batch 63 loss: tensor(0.4856, device='cuda:0')
batch 64 loss: tensor(0.4531, device='cuda:0')
batch 65 loss: tensor(0.4664, device='cuda:0')
batch 66 loss: tensor(0.4698, device='cuda:0')
batch 67 loss: tensor(0.5078, device='cuda:0')
batch 68 loss: tensor(0.4263, device='cuda:0')
batch 69 loss: tensor(0.4159, device='cuda:0')
batch 70 loss: tensor(0.4757, device='cuda:0')
batch 71 loss: tensor(0.4679, device='cuda:0')
batch 72 loss: tensor(0.5131, device='cuda:0')
batch 73 loss: tensor(0.4679, device='cuda:0')
batch 74 loss: tensor(0.4683, device='cuda:0')
batch 75 loss: tensor(0.5002, device='cuda:0')
batch 76 loss: tensor(0.4383, device='cuda:0')
batch 77 loss: tensor(0.4826, device='cuda:0')
batch 78 loss: tensor(0.4417, device='cuda:0')
batch 79 loss: tensor(0.4519, device='cuda:0')
batch 80 loss: tensor(0.3791, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.4562, device='cuda:0')
batch 2 loss: tensor(0.5107, device='cuda:0')
batch 3 loss: tensor(0.3722, device='cuda:0')
batch 4 loss: tensor(0.4535, device='cuda:0')
batch 5 loss: tensor(0.3657, device='cuda:0')
batch 6 loss: tensor(0.3766, device='cuda:0')
batch 7 loss: tensor(0.3673, device='cuda:0')
batch 8 loss: tensor(0.3864, device='cuda:0')
batch 9 loss: tensor(0.4084, device='cuda:0')
batch 10 loss: tensor(0.4790, device='cuda:0')
batch 11 loss: tensor(0.4400, device='cuda:0')
batch 12 loss: tensor(0.4162, device='cuda:0')
batch 13 loss: tensor(0.3905, device='cuda:0')
batch 14 loss: tensor(0.3786, device='cuda:0')
batch 15 loss: tensor(0.4191, device='cuda:0')
batch 16 loss: tensor(0.3840, device='cuda:0')
batch 17 loss: tensor(0.4274, device='cuda:0')
batch 18 loss: tensor(0.3752, device='cuda:0')
batch 19 loss: tensor(0.3969, device='cuda:0')
batch 20 loss: tensor(0.3259, device='cuda:0')
batch 21 loss: tensor(0.3592, device='cuda:0')
batch 22 loss: tensor(0.3603, device='cuda:0')
batch 23 loss: tensor(0.3650, device='cuda:0')
batch 24 loss: tensor(0.3509, device='cuda:0')
batch 25 loss: tensor(0.3686, device='cuda:0')
batch 26 loss: tensor(0.3905, device='cuda:0')
batch 27 loss: tensor(0.3516, device='cuda:0')
batch 28 loss: tensor(0.3367, device='cuda:0')
batch 29 loss: tensor(0.3735, device='cuda:0')
batch 30 loss: tensor(0.3906, device='cuda:0')
batch 31 loss: tensor(0.4357, device='cuda:0')
batch 32 loss: tensor(0.3494, device='cuda:0')
batch 33 loss: tensor(0.3826, device='cuda:0')
batch 34 loss: tensor(0.3512, device='cuda:0')
batch 35 loss: tensor(0.3924, device='cuda:0')
batch 36 loss: tensor(0.3825, device='cuda:0')
batch 37 loss: tensor(0.4144, device='cuda:0')
batch 38 loss: tensor(0.3651, device='cuda:0')
batch 39 loss: tensor(0.3461, device='cuda:0')
batch 40 loss: tensor(0.3877, device='cuda:0')
batch 41 loss: tensor(0.3285, device='cuda:0')
batch 42 loss: tensor(0.3906, device='cuda:0')
batch 43 loss: tensor(0.4281, device='cuda:0')
batch 44 loss: tensor(0.3057, device='cuda:0')
batch 45 loss: tensor(0.3920, device='cuda:0')
batch 46 loss: tensor(0.3419, device='cuda:0')
batch 47 loss: tensor(0.3790, device='cuda:0')
batch 48 loss: tensor(0.4074, device='cuda:0')
batch 49 loss: tensor(0.3767, device='cuda:0')
batch 50 loss: tensor(0.3780, device='cuda:0')
batch 51 loss: tensor(0.3976, device='cuda:0')
batch 52 loss: tensor(0.4153, device='cuda:0')
batch 53 loss: tensor(0.3811, device='cuda:0')
batch 54 loss: tensor(0.3635, device='cuda:0')
batch 55 loss: tensor(0.3856, device='cuda:0')
batch 56 loss: tensor(0.3332, device='cuda:0')
batch 57 loss: tensor(0.3752, device='cuda:0')
batch 58 loss: tensor(0.3112, device='cuda:0')
batch 59 loss: tensor(0.3521, device='cuda:0')
batch 60 loss: tensor(0.4195, device='cuda:0')
batch 61 loss: tensor(0.4073, device='cuda:0')
batch 62 loss: tensor(0.2789, device='cuda:0')
batch 63 loss: tensor(0.3406, device='cuda:0')
batch 64 loss: tensor(0.3360, device='cuda:0')
batch 65 loss: tensor(0.3809, device='cuda:0')
batch 66 loss: tensor(0.3746, device='cuda:0')
batch 67 loss: tensor(0.3596, device='cuda:0')
batch 68 loss: tensor(0.3561, device='cuda:0')
batch 69 loss: tensor(0.3549, device='cuda:0')
batch 70 loss: tensor(0.4477, device='cuda:0')
batch 71 loss: tensor(0.3669, device='cuda:0')
batch 72 loss: tensor(0.3470, device='cuda:0')
batch 73 loss: tensor(0.3458, device='cuda:0')
batch 74 loss: tensor(0.3622, device='cuda:0')
batch 75 loss: tensor(0.3449, device='cuda:0')
batch 76 loss: tensor(0.4600, device='cuda:0')
batch 77 loss: tensor(0.3926, device='cuda:0')
batch 78 loss: tensor(0.3952, device='cuda:0')
batch 79 loss: tensor(0.3520, device='cuda:0')
batch 80 loss: tensor(0.2944, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.4897, device='cuda:0')
batch 2 loss: tensor(0.4293, device='cuda:0')
batch 3 loss: tensor(0.4137, device='cuda:0')
batch 4 loss: tensor(0.4223, device='cuda:0')
batch 5 loss: tensor(0.3872, device='cuda:0')
batch 6 loss: tensor(0.4923, device='cuda:0')
batch 7 loss: tensor(0.3222, device='cuda:0')
batch 8 loss: tensor(0.3888, device='cuda:0')
batch 9 loss: tensor(0.3585, device='cuda:0')
batch 10 loss: tensor(0.3715, device='cuda:0')
batch 11 loss: tensor(0.3548, device='cuda:0')
batch 12 loss: tensor(0.3905, device='cuda:0')
batch 13 loss: tensor(0.3853, device='cuda:0')
batch 14 loss: tensor(0.3192, device='cuda:0')
batch 15 loss: tensor(0.3698, device='cuda:0')
batch 16 loss: tensor(0.3467, device='cuda:0')
batch 17 loss: tensor(0.3700, device='cuda:0')
batch 18 loss: tensor(0.3196, device='cuda:0')
batch 19 loss: tensor(0.4003, device='cuda:0')
batch 20 loss: tensor(0.3774, device='cuda:0')
batch 21 loss: tensor(0.3752, device='cuda:0')
batch 22 loss: tensor(0.3315, device='cuda:0')
batch 23 loss: tensor(0.3388, device='cuda:0')
batch 24 loss: tensor(0.3506, device='cuda:0')
batch 25 loss: tensor(0.3934, device='cuda:0')
batch 26 loss: tensor(0.3614, device='cuda:0')
batch 27 loss: tensor(0.3433, device='cuda:0')
batch 28 loss: tensor(0.3852, device='cuda:0')
batch 29 loss: tensor(0.3660, device='cuda:0')
batch 30 loss: tensor(0.3657, device='cuda:0')
batch 31 loss: tensor(0.2848, device='cuda:0')
batch 32 loss: tensor(0.3816, device='cuda:0')
batch 33 loss: tensor(0.3051, device='cuda:0')
batch 34 loss: tensor(0.3326, device='cuda:0')
batch 35 loss: tensor(0.3785, device='cuda:0')
batch 36 loss: tensor(0.3870, device='cuda:0')
batch 37 loss: tensor(0.3769, device='cuda:0')
batch 38 loss: tensor(0.3311, device='cuda:0')
batch 39 loss: tensor(0.3779, device='cuda:0')
batch 40 loss: tensor(0.3383, device='cuda:0')
batch 41 loss: tensor(0.3233, device='cuda:0')
batch 42 loss: tensor(0.3420, device='cuda:0')
batch 43 loss: tensor(0.3575, device='cuda:0')
batch 44 loss: tensor(0.3563, device='cuda:0')
batch 45 loss: tensor(0.3189, device='cuda:0')
batch 46 loss: tensor(0.3627, device='cuda:0')
batch 47 loss: tensor(0.3689, device='cuda:0')
batch 48 loss: tensor(0.3258, device='cuda:0')
batch 49 loss: tensor(0.2851, device='cuda:0')
batch 50 loss: tensor(0.3134, device='cuda:0')
batch 51 loss: tensor(0.3203, device='cuda:0')
batch 52 loss: tensor(0.3237, device='cuda:0')
batch 53 loss: tensor(0.4047, device='cuda:0')
batch 54 loss: tensor(0.3147, device='cuda:0')
batch 55 loss: tensor(0.3402, device='cuda:0')
batch 56 loss: tensor(0.3071, device='cuda:0')
batch 57 loss: tensor(0.3187, device='cuda:0')
batch 58 loss: tensor(0.3662, device='cuda:0')
batch 59 loss: tensor(0.3498, device='cuda:0')
batch 60 loss: tensor(0.3585, device='cuda:0')
batch 61 loss: tensor(0.3504, device='cuda:0')
batch 62 loss: tensor(0.4101, device='cuda:0')
batch 63 loss: tensor(0.3390, device='cuda:0')
batch 64 loss: tensor(0.3619, device='cuda:0')
batch 65 loss: tensor(0.2947, device='cuda:0')
batch 66 loss: tensor(0.3429, device='cuda:0')
batch 67 loss: tensor(0.3906, device='cuda:0')
batch 68 loss: tensor(0.2984, device='cuda:0')
batch 69 loss: tensor(0.3281, device='cuda:0')
batch 70 loss: tensor(0.2872, device='cuda:0')
batch 71 loss: tensor(0.3345, device='cuda:0')
batch 72 loss: tensor(0.3215, device='cuda:0')
batch 73 loss: tensor(0.3438, device='cuda:0')
batch 74 loss: tensor(0.3451, device='cuda:0')
batch 75 loss: tensor(0.3499, device='cuda:0')
batch 76 loss: tensor(0.2630, device='cuda:0')
batch 77 loss: tensor(0.3444, device='cuda:0')
batch 78 loss: tensor(0.3189, device='cuda:0')
batch 79 loss: tensor(0.3144, device='cuda:0')
batch 80 loss: tensor(0.3153, device='cuda:0')
layer 4 training:
batch 1 loss: tensor(0.4502, device='cuda:0')
batch 2 loss: tensor(0.3755, device='cuda:0')
batch 3 loss: tensor(0.4119, device='cuda:0')
batch 4 loss: tensor(0.4375, device='cuda:0')
batch 5 loss: tensor(0.3643, device='cuda:0')
batch 6 loss: tensor(0.3901, device='cuda:0')
batch 7 loss: tensor(0.3845, device='cuda:0')
batch 8 loss: tensor(0.4146, device='cuda:0')
batch 9 loss: tensor(0.3215, device='cuda:0')
batch 10 loss: tensor(0.3541, device='cuda:0')
batch 11 loss: tensor(0.3711, device='cuda:0')
batch 12 loss: tensor(0.3476, device='cuda:0')
batch 13 loss: tensor(0.3357, device='cuda:0')
batch 14 loss: tensor(0.3335, device='cuda:0')
batch 15 loss: tensor(0.3442, device='cuda:0')
batch 16 loss: tensor(0.3421, device='cuda:0')
batch 17 loss: tensor(0.3903, device='cuda:0')
batch 18 loss: tensor(0.3364, device='cuda:0')
batch 19 loss: tensor(0.3331, device='cuda:0')
batch 20 loss: tensor(0.3548, device='cuda:0')
batch 21 loss: tensor(0.3222, device='cuda:0')
batch 22 loss: tensor(0.3254, device='cuda:0')
batch 23 loss: tensor(0.2994, device='cuda:0')
batch 24 loss: tensor(0.2937, device='cuda:0')
batch 25 loss: tensor(0.3066, device='cuda:0')
batch 26 loss: tensor(0.3541, device='cuda:0')
batch 27 loss: tensor(0.3548, device='cuda:0')
batch 28 loss: tensor(0.3434, device='cuda:0')
batch 29 loss: tensor(0.3298, device='cuda:0')
batch 30 loss: tensor(0.3331, device='cuda:0')
batch 31 loss: tensor(0.3326, device='cuda:0')
batch 32 loss: tensor(0.2961, device='cuda:0')
batch 33 loss: tensor(0.3548, device='cuda:0')
batch 34 loss: tensor(0.3120, device='cuda:0')
batch 35 loss: tensor(0.3436, device='cuda:0')
batch 36 loss: tensor(0.3287, device='cuda:0')
batch 37 loss: tensor(0.3373, device='cuda:0')
batch 38 loss: tensor(0.3388, device='cuda:0')
batch 39 loss: tensor(0.3291, device='cuda:0')
batch 40 loss: tensor(0.3350, device='cuda:0')
batch 41 loss: tensor(0.3701, device='cuda:0')
batch 42 loss: tensor(0.3802, device='cuda:0')
batch 43 loss: tensor(0.3357, device='cuda:0')
batch 44 loss: tensor(0.3235, device='cuda:0')
batch 45 loss: tensor(0.3458, device='cuda:0')
batch 46 loss: tensor(0.3360, device='cuda:0')
batch 47 loss: tensor(0.3021, device='cuda:0')
batch 48 loss: tensor(0.3262, device='cuda:0')
batch 49 loss: tensor(0.3358, device='cuda:0')
batch 50 loss: tensor(0.3661, device='cuda:0')
batch 51 loss: tensor(0.3042, device='cuda:0')
batch 52 loss: tensor(0.3248, device='cuda:0')
batch 53 loss: tensor(0.3052, device='cuda:0')
batch 54 loss: tensor(0.3181, device='cuda:0')
batch 55 loss: tensor(0.3600, device='cuda:0')
batch 56 loss: tensor(0.2776, device='cuda:0')
batch 57 loss: tensor(0.2988, device='cuda:0')
batch 58 loss: tensor(0.3462, device='cuda:0')
batch 59 loss: tensor(0.2938, device='cuda:0')
batch 60 loss: tensor(0.2997, device='cuda:0')
batch 61 loss: tensor(0.3867, device='cuda:0')
batch 62 loss: tensor(0.3517, device='cuda:0')
batch 63 loss: tensor(0.3636, device='cuda:0')
batch 64 loss: tensor(0.3111, device='cuda:0')
batch 65 loss: tensor(0.3449, device='cuda:0')
batch 66 loss: tensor(0.3858, device='cuda:0')
batch 67 loss: tensor(0.2897, device='cuda:0')
batch 68 loss: tensor(0.2860, device='cuda:0')
batch 69 loss: tensor(0.3687, device='cuda:0')
batch 70 loss: tensor(0.3876, device='cuda:0')
batch 71 loss: tensor(0.3442, device='cuda:0')
batch 72 loss: tensor(0.3520, device='cuda:0')
batch 73 loss: tensor(0.3428, device='cuda:0')
batch 74 loss: tensor(0.2758, device='cuda:0')
batch 75 loss: tensor(0.3056, device='cuda:0')
batch 76 loss: tensor(0.3536, device='cuda:0')
batch 77 loss: tensor(0.3194, device='cuda:0')
batch 78 loss: tensor(0.3316, device='cuda:0')
batch 79 loss: tensor(0.3815, device='cuda:0')
batch 80 loss: tensor(0.3524, device='cuda:0')
accuracy in val: 0.8424366666666666
accuracy in test: 0.8905254623373615
average epoch time: 2.0038481310009955
total time: 641.2314019203186
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 4, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.8957, device='cuda:0')
batch 2 loss: tensor(0.7876, device='cuda:0')
batch 3 loss: tensor(0.6409, device='cuda:0')
batch 4 loss: tensor(0.6393, device='cuda:0')
batch 5 loss: tensor(0.6927, device='cuda:0')
batch 6 loss: tensor(0.6504, device='cuda:0')
batch 7 loss: tensor(0.5453, device='cuda:0')
batch 8 loss: tensor(0.5403, device='cuda:0')
batch 9 loss: tensor(0.5661, device='cuda:0')
batch 10 loss: tensor(0.6000, device='cuda:0')
batch 11 loss: tensor(0.5268, device='cuda:0')
batch 12 loss: tensor(0.4993, device='cuda:0')
batch 13 loss: tensor(0.4935, device='cuda:0')
batch 14 loss: tensor(0.5687, device='cuda:0')
batch 15 loss: tensor(0.4957, device='cuda:0')
batch 16 loss: tensor(0.4908, device='cuda:0')
batch 17 loss: tensor(0.5349, device='cuda:0')
batch 18 loss: tensor(0.5412, device='cuda:0')
batch 19 loss: tensor(0.5017, device='cuda:0')
batch 20 loss: tensor(0.5207, device='cuda:0')
batch 21 loss: tensor(0.4889, device='cuda:0')
batch 22 loss: tensor(0.5679, device='cuda:0')
batch 23 loss: tensor(0.4561, device='cuda:0')
batch 24 loss: tensor(0.5098, device='cuda:0')
batch 25 loss: tensor(0.4285, device='cuda:0')
batch 26 loss: tensor(0.4771, device='cuda:0')
batch 27 loss: tensor(0.4447, device='cuda:0')
batch 28 loss: tensor(0.4441, device='cuda:0')
batch 29 loss: tensor(0.4907, device='cuda:0')
batch 30 loss: tensor(0.4642, device='cuda:0')
batch 31 loss: tensor(0.4997, device='cuda:0')
batch 32 loss: tensor(0.4520, device='cuda:0')
batch 33 loss: tensor(0.4491, device='cuda:0')
batch 34 loss: tensor(0.4729, device='cuda:0')
batch 35 loss: tensor(0.4883, device='cuda:0')
batch 36 loss: tensor(0.4672, device='cuda:0')
batch 37 loss: tensor(0.4818, device='cuda:0')
batch 38 loss: tensor(0.4728, device='cuda:0')
batch 39 loss: tensor(0.4447, device='cuda:0')
batch 40 loss: tensor(0.4482, device='cuda:0')
batch 41 loss: tensor(0.5678, device='cuda:0')
batch 42 loss: tensor(0.3990, device='cuda:0')
batch 43 loss: tensor(0.4568, device='cuda:0')
batch 44 loss: tensor(0.4560, device='cuda:0')
batch 45 loss: tensor(0.5188, device='cuda:0')
batch 46 loss: tensor(0.4205, device='cuda:0')
batch 47 loss: tensor(0.4664, device='cuda:0')
batch 48 loss: tensor(0.4698, device='cuda:0')
batch 49 loss: tensor(0.5559, device='cuda:0')
batch 50 loss: tensor(0.5012, device='cuda:0')
batch 51 loss: tensor(0.4255, device='cuda:0')
batch 52 loss: tensor(0.5012, device='cuda:0')
batch 53 loss: tensor(0.4773, device='cuda:0')
batch 54 loss: tensor(0.4884, device='cuda:0')
batch 55 loss: tensor(0.4495, device='cuda:0')
batch 56 loss: tensor(0.4871, device='cuda:0')
batch 57 loss: tensor(0.4705, device='cuda:0')
batch 58 loss: tensor(0.4060, device='cuda:0')
batch 59 loss: tensor(0.4941, device='cuda:0')
batch 60 loss: tensor(0.4390, device='cuda:0')
batch 61 loss: tensor(0.4415, device='cuda:0')
batch 62 loss: tensor(0.4401, device='cuda:0')
batch 63 loss: tensor(0.4987, device='cuda:0')
batch 64 loss: tensor(0.5000, device='cuda:0')
batch 65 loss: tensor(0.4466, device='cuda:0')
batch 66 loss: tensor(0.4752, device='cuda:0')
batch 67 loss: tensor(0.4763, device='cuda:0')
batch 68 loss: tensor(0.4280, device='cuda:0')
batch 69 loss: tensor(0.4187, device='cuda:0')
batch 70 loss: tensor(0.4588, device='cuda:0')
batch 71 loss: tensor(0.4715, device='cuda:0')
batch 72 loss: tensor(0.4477, device='cuda:0')
batch 73 loss: tensor(0.4071, device='cuda:0')
batch 74 loss: tensor(0.4631, device='cuda:0')
batch 75 loss: tensor(0.4360, device='cuda:0')
batch 76 loss: tensor(0.4400, device='cuda:0')
batch 77 loss: tensor(0.5129, device='cuda:0')
batch 78 loss: tensor(0.4760, device='cuda:0')
batch 79 loss: tensor(0.4502, device='cuda:0')
batch 80 loss: tensor(0.5109, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5099, device='cuda:0')
batch 2 loss: tensor(0.4333, device='cuda:0')
batch 3 loss: tensor(0.4196, device='cuda:0')
batch 4 loss: tensor(0.4809, device='cuda:0')
batch 5 loss: tensor(0.3884, device='cuda:0')
batch 6 loss: tensor(0.3906, device='cuda:0')
batch 7 loss: tensor(0.4175, device='cuda:0')
batch 8 loss: tensor(0.4057, device='cuda:0')
batch 9 loss: tensor(0.4009, device='cuda:0')
batch 10 loss: tensor(0.3762, device='cuda:0')
batch 11 loss: tensor(0.3772, device='cuda:0')
batch 12 loss: tensor(0.4033, device='cuda:0')
batch 13 loss: tensor(0.3866, device='cuda:0')
batch 14 loss: tensor(0.4380, device='cuda:0')
batch 15 loss: tensor(0.4446, device='cuda:0')
batch 16 loss: tensor(0.3789, device='cuda:0')
batch 17 loss: tensor(0.3680, device='cuda:0')
batch 18 loss: tensor(0.4436, device='cuda:0')
batch 19 loss: tensor(0.4333, device='cuda:0')
batch 20 loss: tensor(0.4127, device='cuda:0')
batch 21 loss: tensor(0.4025, device='cuda:0')
batch 22 loss: tensor(0.3510, device='cuda:0')
batch 23 loss: tensor(0.4067, device='cuda:0')
batch 24 loss: tensor(0.3591, device='cuda:0')
batch 25 loss: tensor(0.3693, device='cuda:0')
batch 26 loss: tensor(0.3532, device='cuda:0')
batch 27 loss: tensor(0.3600, device='cuda:0')
batch 28 loss: tensor(0.3234, device='cuda:0')
batch 29 loss: tensor(0.4064, device='cuda:0')
batch 30 loss: tensor(0.3934, device='cuda:0')
batch 31 loss: tensor(0.3494, device='cuda:0')
batch 32 loss: tensor(0.3893, device='cuda:0')
batch 33 loss: tensor(0.3769, device='cuda:0')
batch 34 loss: tensor(0.3762, device='cuda:0')
batch 35 loss: tensor(0.3847, device='cuda:0')
batch 36 loss: tensor(0.3640, device='cuda:0')
batch 37 loss: tensor(0.4086, device='cuda:0')
batch 38 loss: tensor(0.4364, device='cuda:0')
batch 39 loss: tensor(0.4078, device='cuda:0')
batch 40 loss: tensor(0.3477, device='cuda:0')
batch 41 loss: tensor(0.3287, device='cuda:0')
batch 42 loss: tensor(0.3905, device='cuda:0')
batch 43 loss: tensor(0.4023, device='cuda:0')
batch 44 loss: tensor(0.2926, device='cuda:0')
batch 45 loss: tensor(0.3208, device='cuda:0')
batch 46 loss: tensor(0.3822, device='cuda:0')
batch 47 loss: tensor(0.4034, device='cuda:0')
batch 48 loss: tensor(0.3793, device='cuda:0')
batch 49 loss: tensor(0.3527, device='cuda:0')
batch 50 loss: tensor(0.3649, device='cuda:0')
batch 51 loss: tensor(0.3729, device='cuda:0')
batch 52 loss: tensor(0.3909, device='cuda:0')
batch 53 loss: tensor(0.3722, device='cuda:0')
batch 54 loss: tensor(0.3852, device='cuda:0')
batch 55 loss: tensor(0.3387, device='cuda:0')
batch 56 loss: tensor(0.3452, device='cuda:0')
batch 57 loss: tensor(0.4195, device='cuda:0')
batch 58 loss: tensor(0.4110, device='cuda:0')
batch 59 loss: tensor(0.3837, device='cuda:0')
batch 60 loss: tensor(0.3926, device='cuda:0')
batch 61 loss: tensor(0.3819, device='cuda:0')
batch 62 loss: tensor(0.3465, device='cuda:0')
batch 63 loss: tensor(0.3587, device='cuda:0')
batch 64 loss: tensor(0.3446, device='cuda:0')
batch 65 loss: tensor(0.3656, device='cuda:0')
batch 66 loss: tensor(0.3531, device='cuda:0')
batch 67 loss: tensor(0.3333, device='cuda:0')
batch 68 loss: tensor(0.3847, device='cuda:0')
batch 69 loss: tensor(0.3780, device='cuda:0')
batch 70 loss: tensor(0.4264, device='cuda:0')
batch 71 loss: tensor(0.3882, device='cuda:0')
batch 72 loss: tensor(0.3872, device='cuda:0')
batch 73 loss: tensor(0.3577, device='cuda:0')
batch 74 loss: tensor(0.3402, device='cuda:0')
batch 75 loss: tensor(0.3712, device='cuda:0')
batch 76 loss: tensor(0.3630, device='cuda:0')
batch 77 loss: tensor(0.3546, device='cuda:0')
batch 78 loss: tensor(0.3566, device='cuda:0')
batch 79 loss: tensor(0.3426, device='cuda:0')
batch 80 loss: tensor(0.3831, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.4506, device='cuda:0')
batch 2 loss: tensor(0.3976, device='cuda:0')
batch 3 loss: tensor(0.3898, device='cuda:0')
batch 4 loss: tensor(0.3623, device='cuda:0')
batch 5 loss: tensor(0.3706, device='cuda:0')
batch 6 loss: tensor(0.4280, device='cuda:0')
batch 7 loss: tensor(0.3531, device='cuda:0')
batch 8 loss: tensor(0.3794, device='cuda:0')
batch 9 loss: tensor(0.3471, device='cuda:0')
batch 10 loss: tensor(0.4454, device='cuda:0')
batch 11 loss: tensor(0.3919, device='cuda:0')
batch 12 loss: tensor(0.4214, device='cuda:0')
batch 13 loss: tensor(0.3603, device='cuda:0')
batch 14 loss: tensor(0.3956, device='cuda:0')
batch 15 loss: tensor(0.3317, device='cuda:0')
batch 16 loss: tensor(0.3699, device='cuda:0')
batch 17 loss: tensor(0.3825, device='cuda:0')
batch 18 loss: tensor(0.3403, device='cuda:0')
batch 19 loss: tensor(0.3565, device='cuda:0')
batch 20 loss: tensor(0.4170, device='cuda:0')
batch 21 loss: tensor(0.2907, device='cuda:0')
batch 22 loss: tensor(0.3751, device='cuda:0')
batch 23 loss: tensor(0.3285, device='cuda:0')
batch 24 loss: tensor(0.3946, device='cuda:0')
batch 25 loss: tensor(0.3696, device='cuda:0')
batch 26 loss: tensor(0.3154, device='cuda:0')
batch 27 loss: tensor(0.2977, device='cuda:0')
batch 28 loss: tensor(0.3695, device='cuda:0')
batch 29 loss: tensor(0.3943, device='cuda:0')
batch 30 loss: tensor(0.3272, device='cuda:0')
batch 31 loss: tensor(0.3416, device='cuda:0')
batch 32 loss: tensor(0.3433, device='cuda:0')
batch 33 loss: tensor(0.3438, device='cuda:0')
batch 34 loss: tensor(0.2988, device='cuda:0')
batch 35 loss: tensor(0.3731, device='cuda:0')
batch 36 loss: tensor(0.3557, device='cuda:0')
batch 37 loss: tensor(0.3681, device='cuda:0')
batch 38 loss: tensor(0.3485, device='cuda:0')
batch 39 loss: tensor(0.3506, device='cuda:0')
batch 40 loss: tensor(0.3134, device='cuda:0')
batch 41 loss: tensor(0.3651, device='cuda:0')
batch 42 loss: tensor(0.3185, device='cuda:0')
batch 43 loss: tensor(0.3764, device='cuda:0')
batch 44 loss: tensor(0.3526, device='cuda:0')
batch 45 loss: tensor(0.3224, device='cuda:0')
batch 46 loss: tensor(0.3628, device='cuda:0')
batch 47 loss: tensor(0.3743, device='cuda:0')
batch 48 loss: tensor(0.3496, device='cuda:0')
batch 49 loss: tensor(0.3355, device='cuda:0')
batch 50 loss: tensor(0.3656, device='cuda:0')
batch 51 loss: tensor(0.3180, device='cuda:0')
batch 52 loss: tensor(0.2879, device='cuda:0')
batch 53 loss: tensor(0.4080, device='cuda:0')
batch 54 loss: tensor(0.3469, device='cuda:0')
batch 55 loss: tensor(0.4191, device='cuda:0')
batch 56 loss: tensor(0.3877, device='cuda:0')
batch 57 loss: tensor(0.3038, device='cuda:0')
batch 58 loss: tensor(0.3273, device='cuda:0')
batch 59 loss: tensor(0.3332, device='cuda:0')
batch 60 loss: tensor(0.3222, device='cuda:0')
batch 61 loss: tensor(0.3764, device='cuda:0')
batch 62 loss: tensor(0.3260, device='cuda:0')
batch 63 loss: tensor(0.3519, device='cuda:0')
batch 64 loss: tensor(0.3332, device='cuda:0')
batch 65 loss: tensor(0.3261, device='cuda:0')
batch 66 loss: tensor(0.3593, device='cuda:0')
batch 67 loss: tensor(0.3861, device='cuda:0')
batch 68 loss: tensor(0.3992, device='cuda:0')
batch 69 loss: tensor(0.3746, device='cuda:0')
batch 70 loss: tensor(0.2693, device='cuda:0')
batch 71 loss: tensor(0.3183, device='cuda:0')
batch 72 loss: tensor(0.3544, device='cuda:0')
batch 73 loss: tensor(0.3454, device='cuda:0')
batch 74 loss: tensor(0.2828, device='cuda:0')
batch 75 loss: tensor(0.3334, device='cuda:0')
batch 76 loss: tensor(0.3116, device='cuda:0')
batch 77 loss: tensor(0.2964, device='cuda:0')
batch 78 loss: tensor(0.2951, device='cuda:0')
batch 79 loss: tensor(0.3284, device='cuda:0')
batch 80 loss: tensor(0.3704, device='cuda:0')
layer 4 training:
batch 1 loss: tensor(0.4881, device='cuda:0')
batch 2 loss: tensor(0.4178, device='cuda:0')
batch 3 loss: tensor(0.4564, device='cuda:0')
batch 4 loss: tensor(0.3890, device='cuda:0')
batch 5 loss: tensor(0.3702, device='cuda:0')
batch 6 loss: tensor(0.3417, device='cuda:0')
batch 7 loss: tensor(0.3250, device='cuda:0')
batch 8 loss: tensor(0.3616, device='cuda:0')
batch 9 loss: tensor(0.3783, device='cuda:0')
batch 10 loss: tensor(0.3607, device='cuda:0')
batch 11 loss: tensor(0.3619, device='cuda:0')
batch 12 loss: tensor(0.3276, device='cuda:0')
batch 13 loss: tensor(0.3411, device='cuda:0')
batch 14 loss: tensor(0.3540, device='cuda:0')
batch 15 loss: tensor(0.3563, device='cuda:0')
batch 16 loss: tensor(0.3738, device='cuda:0')
batch 17 loss: tensor(0.2903, device='cuda:0')
batch 18 loss: tensor(0.3452, device='cuda:0')
batch 19 loss: tensor(0.3326, device='cuda:0')
batch 20 loss: tensor(0.3491, device='cuda:0')
batch 21 loss: tensor(0.3491, device='cuda:0')
batch 22 loss: tensor(0.3649, device='cuda:0')
batch 23 loss: tensor(0.3823, device='cuda:0')
batch 24 loss: tensor(0.3765, device='cuda:0')
batch 25 loss: tensor(0.4067, device='cuda:0')
batch 26 loss: tensor(0.3363, device='cuda:0')
batch 27 loss: tensor(0.2725, device='cuda:0')
batch 28 loss: tensor(0.3467, device='cuda:0')
batch 29 loss: tensor(0.4075, device='cuda:0')
batch 30 loss: tensor(0.3165, device='cuda:0')
batch 31 loss: tensor(0.3314, device='cuda:0')
batch 32 loss: tensor(0.3628, device='cuda:0')
batch 33 loss: tensor(0.3411, device='cuda:0')
batch 34 loss: tensor(0.3134, device='cuda:0')
batch 35 loss: tensor(0.3483, device='cuda:0')
batch 36 loss: tensor(0.3066, device='cuda:0')
batch 37 loss: tensor(0.3006, device='cuda:0')
batch 38 loss: tensor(0.3372, device='cuda:0')
batch 39 loss: tensor(0.3675, device='cuda:0')
batch 40 loss: tensor(0.3526, device='cuda:0')
batch 41 loss: tensor(0.3693, device='cuda:0')
batch 42 loss: tensor(0.3247, device='cuda:0')
batch 43 loss: tensor(0.2730, device='cuda:0')
batch 44 loss: tensor(0.3277, device='cuda:0')
batch 45 loss: tensor(0.3515, device='cuda:0')
batch 46 loss: tensor(0.3638, device='cuda:0')
batch 47 loss: tensor(0.3091, device='cuda:0')
batch 48 loss: tensor(0.3430, device='cuda:0')
batch 49 loss: tensor(0.3695, device='cuda:0')
batch 50 loss: tensor(0.3236, device='cuda:0')
batch 51 loss: tensor(0.3717, device='cuda:0')
batch 52 loss: tensor(0.3255, device='cuda:0')
batch 53 loss: tensor(0.3714, device='cuda:0')
batch 54 loss: tensor(0.3410, device='cuda:0')
batch 55 loss: tensor(0.3300, device='cuda:0')
batch 56 loss: tensor(0.3064, device='cuda:0')
batch 57 loss: tensor(0.2686, device='cuda:0')
batch 58 loss: tensor(0.3392, device='cuda:0')
batch 59 loss: tensor(0.3324, device='cuda:0')
batch 60 loss: tensor(0.3610, device='cuda:0')
batch 61 loss: tensor(0.3125, device='cuda:0')
batch 62 loss: tensor(0.3749, device='cuda:0')
batch 63 loss: tensor(0.3926, device='cuda:0')
batch 64 loss: tensor(0.3087, device='cuda:0')
batch 65 loss: tensor(0.3724, device='cuda:0')
batch 66 loss: tensor(0.3318, device='cuda:0')
batch 67 loss: tensor(0.3131, device='cuda:0')
batch 68 loss: tensor(0.3041, device='cuda:0')
batch 69 loss: tensor(0.3332, device='cuda:0')
batch 70 loss: tensor(0.4052, device='cuda:0')
batch 71 loss: tensor(0.3280, device='cuda:0')
batch 72 loss: tensor(0.3052, device='cuda:0')
batch 73 loss: tensor(0.3410, device='cuda:0')
batch 74 loss: tensor(0.3144, device='cuda:0')
batch 75 loss: tensor(0.3085, device='cuda:0')
batch 76 loss: tensor(0.2795, device='cuda:0')
batch 77 loss: tensor(0.3295, device='cuda:0')
batch 78 loss: tensor(0.3284, device='cuda:0')
batch 79 loss: tensor(0.3661, device='cuda:0')
batch 80 loss: tensor(0.3622, device='cuda:0')
accuracy in val: 0.8465900000000001
accuracy in test: 0.8933962836514862
average epoch time: 2.094754859805107
total time: 670.3215551376343
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 4, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9179, device='cuda:0')
batch 2 loss: tensor(0.7515, device='cuda:0')
batch 3 loss: tensor(0.6448, device='cuda:0')
batch 4 loss: tensor(0.5868, device='cuda:0')
batch 5 loss: tensor(0.6176, device='cuda:0')
batch 6 loss: tensor(0.5868, device='cuda:0')
batch 7 loss: tensor(0.5141, device='cuda:0')
batch 8 loss: tensor(0.6382, device='cuda:0')
batch 9 loss: tensor(0.5728, device='cuda:0')
batch 10 loss: tensor(0.4764, device='cuda:0')
batch 11 loss: tensor(0.5031, device='cuda:0')
batch 12 loss: tensor(0.5948, device='cuda:0')
batch 13 loss: tensor(0.5054, device='cuda:0')
batch 14 loss: tensor(0.6157, device='cuda:0')
batch 15 loss: tensor(0.5348, device='cuda:0')
batch 16 loss: tensor(0.5012, device='cuda:0')
batch 17 loss: tensor(0.4650, device='cuda:0')
batch 18 loss: tensor(0.5417, device='cuda:0')
batch 19 loss: tensor(0.5213, device='cuda:0')
batch 20 loss: tensor(0.5417, device='cuda:0')
batch 21 loss: tensor(0.4411, device='cuda:0')
batch 22 loss: tensor(0.4819, device='cuda:0')
batch 23 loss: tensor(0.5009, device='cuda:0')
batch 24 loss: tensor(0.4272, device='cuda:0')
batch 25 loss: tensor(0.4906, device='cuda:0')
batch 26 loss: tensor(0.4365, device='cuda:0')
batch 27 loss: tensor(0.4568, device='cuda:0')
batch 28 loss: tensor(0.4986, device='cuda:0')
batch 29 loss: tensor(0.5296, device='cuda:0')
batch 30 loss: tensor(0.5355, device='cuda:0')
batch 31 loss: tensor(0.5062, device='cuda:0')
batch 32 loss: tensor(0.4744, device='cuda:0')
batch 33 loss: tensor(0.5139, device='cuda:0')
batch 34 loss: tensor(0.4759, device='cuda:0')
batch 35 loss: tensor(0.5028, device='cuda:0')
batch 36 loss: tensor(0.4974, device='cuda:0')
batch 37 loss: tensor(0.5169, device='cuda:0')
batch 38 loss: tensor(0.5243, device='cuda:0')
batch 39 loss: tensor(0.4544, device='cuda:0')
batch 40 loss: tensor(0.4595, device='cuda:0')
batch 41 loss: tensor(0.4809, device='cuda:0')
batch 42 loss: tensor(0.4820, device='cuda:0')
batch 43 loss: tensor(0.4677, device='cuda:0')
batch 44 loss: tensor(0.5157, device='cuda:0')
batch 45 loss: tensor(0.4847, device='cuda:0')
batch 46 loss: tensor(0.4606, device='cuda:0')
batch 47 loss: tensor(0.4394, device='cuda:0')
batch 48 loss: tensor(0.4980, device='cuda:0')
batch 49 loss: tensor(0.5475, device='cuda:0')
batch 50 loss: tensor(0.5065, device='cuda:0')
batch 51 loss: tensor(0.4711, device='cuda:0')
batch 52 loss: tensor(0.4455, device='cuda:0')
batch 53 loss: tensor(0.4327, device='cuda:0')
batch 54 loss: tensor(0.5469, device='cuda:0')
batch 55 loss: tensor(0.4998, device='cuda:0')
batch 56 loss: tensor(0.3966, device='cuda:0')
batch 57 loss: tensor(0.4230, device='cuda:0')
batch 58 loss: tensor(0.5040, device='cuda:0')
batch 59 loss: tensor(0.4701, device='cuda:0')
batch 60 loss: tensor(0.4224, device='cuda:0')
batch 61 loss: tensor(0.4443, device='cuda:0')
batch 62 loss: tensor(0.4385, device='cuda:0')
batch 63 loss: tensor(0.4198, device='cuda:0')
batch 64 loss: tensor(0.4424, device='cuda:0')
batch 65 loss: tensor(0.4833, device='cuda:0')
batch 66 loss: tensor(0.4471, device='cuda:0')
batch 67 loss: tensor(0.4533, device='cuda:0')
batch 68 loss: tensor(0.4613, device='cuda:0')
batch 69 loss: tensor(0.4646, device='cuda:0')
batch 70 loss: tensor(0.4367, device='cuda:0')
batch 71 loss: tensor(0.4986, device='cuda:0')
batch 72 loss: tensor(0.4328, device='cuda:0')
batch 73 loss: tensor(0.4928, device='cuda:0')
batch 74 loss: tensor(0.4780, device='cuda:0')
batch 75 loss: tensor(0.4935, device='cuda:0')
batch 76 loss: tensor(0.4767, device='cuda:0')
batch 77 loss: tensor(0.4794, device='cuda:0')
batch 78 loss: tensor(0.4723, device='cuda:0')
batch 79 loss: tensor(0.4516, device='cuda:0')
batch 80 loss: tensor(0.4465, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.4708, device='cuda:0')
batch 2 loss: tensor(0.4543, device='cuda:0')
batch 3 loss: tensor(0.4597, device='cuda:0')
batch 4 loss: tensor(0.4233, device='cuda:0')
batch 5 loss: tensor(0.4345, device='cuda:0')
batch 6 loss: tensor(0.4387, device='cuda:0')
batch 7 loss: tensor(0.3595, device='cuda:0')
batch 8 loss: tensor(0.3662, device='cuda:0')
batch 9 loss: tensor(0.3981, device='cuda:0')
batch 10 loss: tensor(0.4507, device='cuda:0')
batch 11 loss: tensor(0.3651, device='cuda:0')
batch 12 loss: tensor(0.4338, device='cuda:0')
batch 13 loss: tensor(0.3621, device='cuda:0')
batch 14 loss: tensor(0.4182, device='cuda:0')
batch 15 loss: tensor(0.4036, device='cuda:0')
batch 16 loss: tensor(0.3849, device='cuda:0')
batch 17 loss: tensor(0.4314, device='cuda:0')
batch 18 loss: tensor(0.3697, device='cuda:0')
batch 19 loss: tensor(0.4095, device='cuda:0')
batch 20 loss: tensor(0.4330, device='cuda:0')
batch 21 loss: tensor(0.3435, device='cuda:0')
batch 22 loss: tensor(0.3847, device='cuda:0')
batch 23 loss: tensor(0.3790, device='cuda:0')
batch 24 loss: tensor(0.3845, device='cuda:0')
batch 25 loss: tensor(0.3937, device='cuda:0')
batch 26 loss: tensor(0.4097, device='cuda:0')
batch 27 loss: tensor(0.4437, device='cuda:0')
batch 28 loss: tensor(0.3573, device='cuda:0')
batch 29 loss: tensor(0.3891, device='cuda:0')
batch 30 loss: tensor(0.3855, device='cuda:0')
batch 31 loss: tensor(0.3816, device='cuda:0')
batch 32 loss: tensor(0.4133, device='cuda:0')
batch 33 loss: tensor(0.3658, device='cuda:0')
batch 34 loss: tensor(0.3640, device='cuda:0')
batch 35 loss: tensor(0.3635, device='cuda:0')
batch 36 loss: tensor(0.3600, device='cuda:0')
batch 37 loss: tensor(0.3971, device='cuda:0')
batch 38 loss: tensor(0.3866, device='cuda:0')
batch 39 loss: tensor(0.3730, device='cuda:0')
batch 40 loss: tensor(0.4354, device='cuda:0')
batch 41 loss: tensor(0.3186, device='cuda:0')
batch 42 loss: tensor(0.3700, device='cuda:0')
batch 43 loss: tensor(0.3466, device='cuda:0')
batch 44 loss: tensor(0.3858, device='cuda:0')
batch 45 loss: tensor(0.3996, device='cuda:0')
batch 46 loss: tensor(0.3448, device='cuda:0')
batch 47 loss: tensor(0.4038, device='cuda:0')
batch 48 loss: tensor(0.3648, device='cuda:0')
batch 49 loss: tensor(0.3532, device='cuda:0')
batch 50 loss: tensor(0.3727, device='cuda:0')
batch 51 loss: tensor(0.3604, device='cuda:0')
batch 52 loss: tensor(0.4017, device='cuda:0')
batch 53 loss: tensor(0.3784, device='cuda:0')
batch 54 loss: tensor(0.4434, device='cuda:0')
batch 55 loss: tensor(0.4320, device='cuda:0')
batch 56 loss: tensor(0.3146, device='cuda:0')
batch 57 loss: tensor(0.3733, device='cuda:0')
batch 58 loss: tensor(0.4004, device='cuda:0')
batch 59 loss: tensor(0.3573, device='cuda:0')
batch 60 loss: tensor(0.3128, device='cuda:0')
batch 61 loss: tensor(0.3969, device='cuda:0')
batch 62 loss: tensor(0.3769, device='cuda:0')
batch 63 loss: tensor(0.4729, device='cuda:0')
batch 64 loss: tensor(0.4182, device='cuda:0')
batch 65 loss: tensor(0.3512, device='cuda:0')
batch 66 loss: tensor(0.3554, device='cuda:0')
batch 67 loss: tensor(0.3669, device='cuda:0')
batch 68 loss: tensor(0.3665, device='cuda:0')
batch 69 loss: tensor(0.3315, device='cuda:0')
batch 70 loss: tensor(0.3804, device='cuda:0')
batch 71 loss: tensor(0.3477, device='cuda:0')
batch 72 loss: tensor(0.4005, device='cuda:0')
batch 73 loss: tensor(0.3697, device='cuda:0')
batch 74 loss: tensor(0.3963, device='cuda:0')
batch 75 loss: tensor(0.3189, device='cuda:0')
batch 76 loss: tensor(0.3282, device='cuda:0')
batch 77 loss: tensor(0.3718, device='cuda:0')
batch 78 loss: tensor(0.3543, device='cuda:0')
batch 79 loss: tensor(0.4173, device='cuda:0')
batch 80 loss: tensor(0.3698, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.4137, device='cuda:0')
batch 2 loss: tensor(0.4204, device='cuda:0')
batch 3 loss: tensor(0.4147, device='cuda:0')
batch 4 loss: tensor(0.3702, device='cuda:0')
batch 5 loss: tensor(0.3234, device='cuda:0')
batch 6 loss: tensor(0.3435, device='cuda:0')
batch 7 loss: tensor(0.3704, device='cuda:0')
batch 8 loss: tensor(0.3756, device='cuda:0')
batch 9 loss: tensor(0.3975, device='cuda:0')
batch 10 loss: tensor(0.3886, device='cuda:0')
batch 11 loss: tensor(0.3711, device='cuda:0')
batch 12 loss: tensor(0.3663, device='cuda:0')
batch 13 loss: tensor(0.3431, device='cuda:0')
batch 14 loss: tensor(0.3778, device='cuda:0')
batch 15 loss: tensor(0.3433, device='cuda:0')
batch 16 loss: tensor(0.4036, device='cuda:0')
batch 17 loss: tensor(0.3626, device='cuda:0')
batch 18 loss: tensor(0.2516, device='cuda:0')
batch 19 loss: tensor(0.3821, device='cuda:0')
batch 20 loss: tensor(0.3797, device='cuda:0')
batch 21 loss: tensor(0.3236, device='cuda:0')
batch 22 loss: tensor(0.2882, device='cuda:0')
batch 23 loss: tensor(0.3927, device='cuda:0')
batch 24 loss: tensor(0.3458, device='cuda:0')
batch 25 loss: tensor(0.3077, device='cuda:0')
batch 26 loss: tensor(0.3271, device='cuda:0')
batch 27 loss: tensor(0.3330, device='cuda:0')
batch 28 loss: tensor(0.3666, device='cuda:0')
batch 29 loss: tensor(0.3065, device='cuda:0')
batch 30 loss: tensor(0.3678, device='cuda:0')
batch 31 loss: tensor(0.3323, device='cuda:0')
batch 32 loss: tensor(0.3343, device='cuda:0')
batch 33 loss: tensor(0.3554, device='cuda:0')
batch 34 loss: tensor(0.3299, device='cuda:0')
batch 35 loss: tensor(0.3320, device='cuda:0')
batch 36 loss: tensor(0.3776, device='cuda:0')
batch 37 loss: tensor(0.3522, device='cuda:0')
batch 38 loss: tensor(0.4038, device='cuda:0')
batch 39 loss: tensor(0.3317, device='cuda:0')
batch 40 loss: tensor(0.2902, device='cuda:0')
batch 41 loss: tensor(0.3937, device='cuda:0')
batch 42 loss: tensor(0.3680, device='cuda:0')
batch 43 loss: tensor(0.3359, device='cuda:0')
batch 44 loss: tensor(0.3106, device='cuda:0')
batch 45 loss: tensor(0.3836, device='cuda:0')
batch 46 loss: tensor(0.3035, device='cuda:0')
batch 47 loss: tensor(0.3370, device='cuda:0')
batch 48 loss: tensor(0.3885, device='cuda:0')
batch 49 loss: tensor(0.2844, device='cuda:0')
batch 50 loss: tensor(0.3442, device='cuda:0')
batch 51 loss: tensor(0.3426, device='cuda:0')
batch 52 loss: tensor(0.4118, device='cuda:0')
batch 53 loss: tensor(0.3349, device='cuda:0')
batch 54 loss: tensor(0.3698, device='cuda:0')
batch 55 loss: tensor(0.3173, device='cuda:0')
batch 56 loss: tensor(0.3763, device='cuda:0')
batch 57 loss: tensor(0.3161, device='cuda:0')
batch 58 loss: tensor(0.3083, device='cuda:0')
batch 59 loss: tensor(0.3441, device='cuda:0')
batch 60 loss: tensor(0.3268, device='cuda:0')
batch 61 loss: tensor(0.3563, device='cuda:0')
batch 62 loss: tensor(0.3410, device='cuda:0')
batch 63 loss: tensor(0.3459, device='cuda:0')
batch 64 loss: tensor(0.3214, device='cuda:0')
batch 65 loss: tensor(0.3697, device='cuda:0')
batch 66 loss: tensor(0.3207, device='cuda:0')
batch 67 loss: tensor(0.3625, device='cuda:0')
batch 68 loss: tensor(0.3353, device='cuda:0')
batch 69 loss: tensor(0.3078, device='cuda:0')
batch 70 loss: tensor(0.3534, device='cuda:0')
batch 71 loss: tensor(0.3407, device='cuda:0')
batch 72 loss: tensor(0.3329, device='cuda:0')
batch 73 loss: tensor(0.3313, device='cuda:0')
batch 74 loss: tensor(0.3321, device='cuda:0')
batch 75 loss: tensor(0.3586, device='cuda:0')
batch 76 loss: tensor(0.3962, device='cuda:0')
batch 77 loss: tensor(0.2954, device='cuda:0')
batch 78 loss: tensor(0.2979, device='cuda:0')
batch 79 loss: tensor(0.3319, device='cuda:0')
batch 80 loss: tensor(0.3310, device='cuda:0')
layer 4 training:
batch 1 loss: tensor(0.4403, device='cuda:0')
batch 2 loss: tensor(0.4105, device='cuda:0')
batch 3 loss: tensor(0.3962, device='cuda:0')
batch 4 loss: tensor(0.3216, device='cuda:0')
batch 5 loss: tensor(0.3567, device='cuda:0')
batch 6 loss: tensor(0.3803, device='cuda:0')
batch 7 loss: tensor(0.3896, device='cuda:0')
batch 8 loss: tensor(0.3436, device='cuda:0')
batch 9 loss: tensor(0.3130, device='cuda:0')
batch 10 loss: tensor(0.3068, device='cuda:0')
batch 11 loss: tensor(0.3266, device='cuda:0')
batch 12 loss: tensor(0.3260, device='cuda:0')
batch 13 loss: tensor(0.3739, device='cuda:0')
batch 14 loss: tensor(0.3241, device='cuda:0')
batch 15 loss: tensor(0.3503, device='cuda:0')
batch 16 loss: tensor(0.4008, device='cuda:0')
batch 17 loss: tensor(0.3742, device='cuda:0')
batch 18 loss: tensor(0.3524, device='cuda:0')
batch 19 loss: tensor(0.3072, device='cuda:0')
batch 20 loss: tensor(0.3162, device='cuda:0')
batch 21 loss: tensor(0.3228, device='cuda:0')
batch 22 loss: tensor(0.3699, device='cuda:0')
batch 23 loss: tensor(0.3046, device='cuda:0')
batch 24 loss: tensor(0.3605, device='cuda:0')
batch 25 loss: tensor(0.3247, device='cuda:0')
batch 26 loss: tensor(0.3578, device='cuda:0')
batch 27 loss: tensor(0.3141, device='cuda:0')
batch 28 loss: tensor(0.3958, device='cuda:0')
batch 29 loss: tensor(0.3664, device='cuda:0')
batch 30 loss: tensor(0.3030, device='cuda:0')
batch 31 loss: tensor(0.3480, device='cuda:0')
batch 32 loss: tensor(0.3607, device='cuda:0')
batch 33 loss: tensor(0.3414, device='cuda:0')
batch 34 loss: tensor(0.3639, device='cuda:0')
batch 35 loss: tensor(0.3681, device='cuda:0')
batch 36 loss: tensor(0.3337, device='cuda:0')
batch 37 loss: tensor(0.3627, device='cuda:0')
batch 38 loss: tensor(0.3302, device='cuda:0')
batch 39 loss: tensor(0.3685, device='cuda:0')
batch 40 loss: tensor(0.3649, device='cuda:0')
batch 41 loss: tensor(0.3229, device='cuda:0')
batch 42 loss: tensor(0.3742, device='cuda:0')
batch 43 loss: tensor(0.4161, device='cuda:0')
batch 44 loss: tensor(0.3109, device='cuda:0')
batch 45 loss: tensor(0.3147, device='cuda:0')
batch 46 loss: tensor(0.2970, device='cuda:0')
batch 47 loss: tensor(0.3261, device='cuda:0')
batch 48 loss: tensor(0.3624, device='cuda:0')
batch 49 loss: tensor(0.3642, device='cuda:0')
batch 50 loss: tensor(0.3009, device='cuda:0')
batch 51 loss: tensor(0.3135, device='cuda:0')
batch 52 loss: tensor(0.3364, device='cuda:0')
batch 53 loss: tensor(0.3480, device='cuda:0')
batch 54 loss: tensor(0.3671, device='cuda:0')
batch 55 loss: tensor(0.2901, device='cuda:0')
batch 56 loss: tensor(0.3250, device='cuda:0')
batch 57 loss: tensor(0.3012, device='cuda:0')
batch 58 loss: tensor(0.3549, device='cuda:0')
batch 59 loss: tensor(0.3539, device='cuda:0')
batch 60 loss: tensor(0.3792, device='cuda:0')
batch 61 loss: tensor(0.3538, device='cuda:0')
batch 62 loss: tensor(0.3358, device='cuda:0')
batch 63 loss: tensor(0.3259, device='cuda:0')
batch 64 loss: tensor(0.3276, device='cuda:0')
batch 65 loss: tensor(0.3342, device='cuda:0')
batch 66 loss: tensor(0.3026, device='cuda:0')
batch 67 loss: tensor(0.3535, device='cuda:0')
batch 68 loss: tensor(0.3400, device='cuda:0')
batch 69 loss: tensor(0.3660, device='cuda:0')
batch 70 loss: tensor(0.2551, device='cuda:0')
batch 71 loss: tensor(0.3647, device='cuda:0')
batch 72 loss: tensor(0.3485, device='cuda:0')
batch 73 loss: tensor(0.3692, device='cuda:0')
batch 74 loss: tensor(0.3349, device='cuda:0')
batch 75 loss: tensor(0.3310, device='cuda:0')
batch 76 loss: tensor(0.3246, device='cuda:0')
batch 77 loss: tensor(0.3055, device='cuda:0')
batch 78 loss: tensor(0.3471, device='cuda:0')
batch 79 loss: tensor(0.3191, device='cuda:0')
batch 80 loss: tensor(0.3513, device='cuda:0')
accuracy in val: 0.8372766666666667
accuracy in test: 0.8879676460368325
average epoch time: 1.9994431495666505
total time: 639.8218078613281
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 4, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.8548, device='cuda:0')
batch 2 loss: tensor(0.7147, device='cuda:0')
batch 3 loss: tensor(0.6389, device='cuda:0')
batch 4 loss: tensor(0.6782, device='cuda:0')
batch 5 loss: tensor(0.4947, device='cuda:0')
batch 6 loss: tensor(0.5385, device='cuda:0')
batch 7 loss: tensor(0.5809, device='cuda:0')
batch 8 loss: tensor(0.5810, device='cuda:0')
batch 9 loss: tensor(0.5975, device='cuda:0')
batch 10 loss: tensor(0.5700, device='cuda:0')
batch 11 loss: tensor(0.5237, device='cuda:0')
batch 12 loss: tensor(0.4858, device='cuda:0')
batch 13 loss: tensor(0.4798, device='cuda:0')
batch 14 loss: tensor(0.4930, device='cuda:0')
batch 15 loss: tensor(0.5323, device='cuda:0')
batch 16 loss: tensor(0.4760, device='cuda:0')
batch 17 loss: tensor(0.4117, device='cuda:0')
batch 18 loss: tensor(0.5190, device='cuda:0')
batch 19 loss: tensor(0.4693, device='cuda:0')
batch 20 loss: tensor(0.5750, device='cuda:0')
batch 21 loss: tensor(0.4656, device='cuda:0')
batch 22 loss: tensor(0.5038, device='cuda:0')
batch 23 loss: tensor(0.4516, device='cuda:0')
batch 24 loss: tensor(0.4855, device='cuda:0')
batch 25 loss: tensor(0.5271, device='cuda:0')
batch 26 loss: tensor(0.5130, device='cuda:0')
batch 27 loss: tensor(0.5190, device='cuda:0')
batch 28 loss: tensor(0.5233, device='cuda:0')
batch 29 loss: tensor(0.4907, device='cuda:0')
batch 30 loss: tensor(0.5353, device='cuda:0')
batch 31 loss: tensor(0.4206, device='cuda:0')
batch 32 loss: tensor(0.5408, device='cuda:0')
batch 33 loss: tensor(0.4664, device='cuda:0')
batch 34 loss: tensor(0.5132, device='cuda:0')
batch 35 loss: tensor(0.5058, device='cuda:0')
batch 36 loss: tensor(0.4422, device='cuda:0')
batch 37 loss: tensor(0.5095, device='cuda:0')
batch 38 loss: tensor(0.4374, device='cuda:0')
batch 39 loss: tensor(0.4436, device='cuda:0')
batch 40 loss: tensor(0.4580, device='cuda:0')
batch 41 loss: tensor(0.4894, device='cuda:0')
batch 42 loss: tensor(0.4945, device='cuda:0')
batch 43 loss: tensor(0.5161, device='cuda:0')
batch 44 loss: tensor(0.4538, device='cuda:0')
batch 45 loss: tensor(0.4780, device='cuda:0')
batch 46 loss: tensor(0.4843, device='cuda:0')
batch 47 loss: tensor(0.4853, device='cuda:0')
batch 48 loss: tensor(0.5419, device='cuda:0')
batch 49 loss: tensor(0.5027, device='cuda:0')
batch 50 loss: tensor(0.4173, device='cuda:0')
batch 51 loss: tensor(0.4093, device='cuda:0')
batch 52 loss: tensor(0.4099, device='cuda:0')
batch 53 loss: tensor(0.4639, device='cuda:0')
batch 54 loss: tensor(0.3897, device='cuda:0')
batch 55 loss: tensor(0.5020, device='cuda:0')
batch 56 loss: tensor(0.4610, device='cuda:0')
batch 57 loss: tensor(0.4386, device='cuda:0')
batch 58 loss: tensor(0.4670, device='cuda:0')
batch 59 loss: tensor(0.4226, device='cuda:0')
batch 60 loss: tensor(0.4339, device='cuda:0')
batch 61 loss: tensor(0.4325, device='cuda:0')
batch 62 loss: tensor(0.4860, device='cuda:0')
batch 63 loss: tensor(0.5033, device='cuda:0')
batch 64 loss: tensor(0.4508, device='cuda:0')
batch 65 loss: tensor(0.5290, device='cuda:0')
batch 66 loss: tensor(0.4710, device='cuda:0')
batch 67 loss: tensor(0.4359, device='cuda:0')
batch 68 loss: tensor(0.4414, device='cuda:0')
batch 69 loss: tensor(0.4094, device='cuda:0')
batch 70 loss: tensor(0.4359, device='cuda:0')
batch 71 loss: tensor(0.4526, device='cuda:0')
batch 72 loss: tensor(0.4365, device='cuda:0')
batch 73 loss: tensor(0.4304, device='cuda:0')
batch 74 loss: tensor(0.4928, device='cuda:0')
batch 75 loss: tensor(0.4680, device='cuda:0')
batch 76 loss: tensor(0.4300, device='cuda:0')
batch 77 loss: tensor(0.5176, device='cuda:0')
batch 78 loss: tensor(0.4428, device='cuda:0')
batch 79 loss: tensor(0.4147, device='cuda:0')
batch 80 loss: tensor(0.4671, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5180, device='cuda:0')
batch 2 loss: tensor(0.4538, device='cuda:0')
batch 3 loss: tensor(0.4057, device='cuda:0')
batch 4 loss: tensor(0.3693, device='cuda:0')
batch 5 loss: tensor(0.4199, device='cuda:0')
batch 6 loss: tensor(0.4014, device='cuda:0')
batch 7 loss: tensor(0.4385, device='cuda:0')
batch 8 loss: tensor(0.3911, device='cuda:0')
batch 9 loss: tensor(0.3468, device='cuda:0')
batch 10 loss: tensor(0.3518, device='cuda:0')
batch 11 loss: tensor(0.4153, device='cuda:0')
batch 12 loss: tensor(0.4030, device='cuda:0')
batch 13 loss: tensor(0.4211, device='cuda:0')
batch 14 loss: tensor(0.3823, device='cuda:0')
batch 15 loss: tensor(0.3866, device='cuda:0')
batch 16 loss: tensor(0.3358, device='cuda:0')
batch 17 loss: tensor(0.3840, device='cuda:0')
batch 18 loss: tensor(0.3661, device='cuda:0')
batch 19 loss: tensor(0.3855, device='cuda:0')
batch 20 loss: tensor(0.4017, device='cuda:0')
batch 21 loss: tensor(0.3509, device='cuda:0')
batch 22 loss: tensor(0.3662, device='cuda:0')
batch 23 loss: tensor(0.4064, device='cuda:0')
batch 24 loss: tensor(0.3672, device='cuda:0')
batch 25 loss: tensor(0.3899, device='cuda:0')
batch 26 loss: tensor(0.4220, device='cuda:0')
batch 27 loss: tensor(0.4069, device='cuda:0')
batch 28 loss: tensor(0.3205, device='cuda:0')
batch 29 loss: tensor(0.3686, device='cuda:0')
batch 30 loss: tensor(0.3185, device='cuda:0')
batch 31 loss: tensor(0.4063, device='cuda:0')
batch 32 loss: tensor(0.4075, device='cuda:0')
batch 33 loss: tensor(0.3868, device='cuda:0')
batch 34 loss: tensor(0.3435, device='cuda:0')
batch 35 loss: tensor(0.3333, device='cuda:0')
batch 36 loss: tensor(0.3228, device='cuda:0')
batch 37 loss: tensor(0.3482, device='cuda:0')
batch 38 loss: tensor(0.3816, device='cuda:0')
batch 39 loss: tensor(0.3859, device='cuda:0')
batch 40 loss: tensor(0.3733, device='cuda:0')
batch 41 loss: tensor(0.3964, device='cuda:0')
batch 42 loss: tensor(0.4214, device='cuda:0')
batch 43 loss: tensor(0.3627, device='cuda:0')
batch 44 loss: tensor(0.3239, device='cuda:0')
batch 45 loss: tensor(0.3804, device='cuda:0')
batch 46 loss: tensor(0.3209, device='cuda:0')
batch 47 loss: tensor(0.3923, device='cuda:0')
batch 48 loss: tensor(0.4300, device='cuda:0')
batch 49 loss: tensor(0.3908, device='cuda:0')
batch 50 loss: tensor(0.3945, device='cuda:0')
batch 51 loss: tensor(0.4063, device='cuda:0')
batch 52 loss: tensor(0.4072, device='cuda:0')
batch 53 loss: tensor(0.3685, device='cuda:0')
batch 54 loss: tensor(0.3956, device='cuda:0')
batch 55 loss: tensor(0.3788, device='cuda:0')
batch 56 loss: tensor(0.4018, device='cuda:0')
batch 57 loss: tensor(0.4659, device='cuda:0')
batch 58 loss: tensor(0.3735, device='cuda:0')
batch 59 loss: tensor(0.3393, device='cuda:0')
batch 60 loss: tensor(0.3682, device='cuda:0')
batch 61 loss: tensor(0.3582, device='cuda:0')
batch 62 loss: tensor(0.3906, device='cuda:0')
batch 63 loss: tensor(0.3830, device='cuda:0')
batch 64 loss: tensor(0.3669, device='cuda:0')
batch 65 loss: tensor(0.3863, device='cuda:0')
batch 66 loss: tensor(0.3931, device='cuda:0')
batch 67 loss: tensor(0.3988, device='cuda:0')
batch 68 loss: tensor(0.3410, device='cuda:0')
batch 69 loss: tensor(0.3603, device='cuda:0')
batch 70 loss: tensor(0.4514, device='cuda:0')
batch 71 loss: tensor(0.3311, device='cuda:0')
batch 72 loss: tensor(0.3803, device='cuda:0')
batch 73 loss: tensor(0.3562, device='cuda:0')
batch 74 loss: tensor(0.3690, device='cuda:0')
batch 75 loss: tensor(0.3519, device='cuda:0')
batch 76 loss: tensor(0.3705, device='cuda:0')
batch 77 loss: tensor(0.3897, device='cuda:0')
batch 78 loss: tensor(0.3377, device='cuda:0')
batch 79 loss: tensor(0.4060, device='cuda:0')
batch 80 loss: tensor(0.3357, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.4229, device='cuda:0')
batch 2 loss: tensor(0.4624, device='cuda:0')
batch 3 loss: tensor(0.4063, device='cuda:0')
batch 4 loss: tensor(0.3597, device='cuda:0')
batch 5 loss: tensor(0.4044, device='cuda:0')
batch 6 loss: tensor(0.3922, device='cuda:0')
batch 7 loss: tensor(0.3560, device='cuda:0')
batch 8 loss: tensor(0.3377, device='cuda:0')
batch 9 loss: tensor(0.3389, device='cuda:0')
batch 10 loss: tensor(0.3146, device='cuda:0')
batch 11 loss: tensor(0.3575, device='cuda:0')
batch 12 loss: tensor(0.3481, device='cuda:0')
batch 13 loss: tensor(0.3369, device='cuda:0')
batch 14 loss: tensor(0.3347, device='cuda:0')
batch 15 loss: tensor(0.3843, device='cuda:0')
batch 16 loss: tensor(0.3560, device='cuda:0')
batch 17 loss: tensor(0.3466, device='cuda:0')
batch 18 loss: tensor(0.2954, device='cuda:0')
batch 19 loss: tensor(0.3515, device='cuda:0')
batch 20 loss: tensor(0.3637, device='cuda:0')
batch 21 loss: tensor(0.3529, device='cuda:0')
batch 22 loss: tensor(0.3167, device='cuda:0')
batch 23 loss: tensor(0.3373, device='cuda:0')
batch 24 loss: tensor(0.3631, device='cuda:0')
batch 25 loss: tensor(0.4063, device='cuda:0')
batch 26 loss: tensor(0.3495, device='cuda:0')
batch 27 loss: tensor(0.2852, device='cuda:0')
batch 28 loss: tensor(0.3755, device='cuda:0')
batch 29 loss: tensor(0.3293, device='cuda:0')
batch 30 loss: tensor(0.2849, device='cuda:0')
batch 31 loss: tensor(0.3570, device='cuda:0')
batch 32 loss: tensor(0.3510, device='cuda:0')
batch 33 loss: tensor(0.3362, device='cuda:0')
batch 34 loss: tensor(0.3434, device='cuda:0')
batch 35 loss: tensor(0.3186, device='cuda:0')
batch 36 loss: tensor(0.3385, device='cuda:0')
batch 37 loss: tensor(0.3117, device='cuda:0')
batch 38 loss: tensor(0.3822, device='cuda:0')
batch 39 loss: tensor(0.3690, device='cuda:0')
batch 40 loss: tensor(0.3296, device='cuda:0')
batch 41 loss: tensor(0.3422, device='cuda:0')
batch 42 loss: tensor(0.3515, device='cuda:0')
batch 43 loss: tensor(0.3649, device='cuda:0')
batch 44 loss: tensor(0.3648, device='cuda:0')
batch 45 loss: tensor(0.3743, device='cuda:0')
batch 46 loss: tensor(0.3241, device='cuda:0')
batch 47 loss: tensor(0.3073, device='cuda:0')
batch 48 loss: tensor(0.3204, device='cuda:0')
batch 49 loss: tensor(0.3219, device='cuda:0')
batch 50 loss: tensor(0.3373, device='cuda:0')
batch 51 loss: tensor(0.4117, device='cuda:0')
batch 52 loss: tensor(0.3693, device='cuda:0')
batch 53 loss: tensor(0.3368, device='cuda:0')
batch 54 loss: tensor(0.3228, device='cuda:0')
batch 55 loss: tensor(0.3765, device='cuda:0')
batch 56 loss: tensor(0.3255, device='cuda:0')
batch 57 loss: tensor(0.3386, device='cuda:0')
batch 58 loss: tensor(0.3515, device='cuda:0')
batch 59 loss: tensor(0.3108, device='cuda:0')
batch 60 loss: tensor(0.3001, device='cuda:0')
batch 61 loss: tensor(0.3391, device='cuda:0')
batch 62 loss: tensor(0.2918, device='cuda:0')
batch 63 loss: tensor(0.3779, device='cuda:0')
batch 64 loss: tensor(0.3588, device='cuda:0')
batch 65 loss: tensor(0.3012, device='cuda:0')
batch 66 loss: tensor(0.4114, device='cuda:0')
batch 67 loss: tensor(0.3198, device='cuda:0')
batch 68 loss: tensor(0.3919, device='cuda:0')
batch 69 loss: tensor(0.3795, device='cuda:0')
batch 70 loss: tensor(0.3168, device='cuda:0')
batch 71 loss: tensor(0.3043, device='cuda:0')
batch 72 loss: tensor(0.3531, device='cuda:0')
batch 73 loss: tensor(0.3784, device='cuda:0')
batch 74 loss: tensor(0.3035, device='cuda:0')
batch 75 loss: tensor(0.3325, device='cuda:0')
batch 76 loss: tensor(0.3394, device='cuda:0')
batch 77 loss: tensor(0.3254, device='cuda:0')
batch 78 loss: tensor(0.2996, device='cuda:0')
batch 79 loss: tensor(0.2812, device='cuda:0')
batch 80 loss: tensor(0.3840, device='cuda:0')
layer 4 training:
batch 1 loss: tensor(0.4679, device='cuda:0')
batch 2 loss: tensor(0.4166, device='cuda:0')
batch 3 loss: tensor(0.3579, device='cuda:0')
batch 4 loss: tensor(0.3713, device='cuda:0')
batch 5 loss: tensor(0.3713, device='cuda:0')
batch 6 loss: tensor(0.3909, device='cuda:0')
batch 7 loss: tensor(0.3176, device='cuda:0')
batch 8 loss: tensor(0.3595, device='cuda:0')
batch 9 loss: tensor(0.3607, device='cuda:0')
batch 10 loss: tensor(0.3246, device='cuda:0')
batch 11 loss: tensor(0.3399, device='cuda:0')
batch 12 loss: tensor(0.3647, device='cuda:0')
batch 13 loss: tensor(0.3731, device='cuda:0')
batch 14 loss: tensor(0.3802, device='cuda:0')
batch 15 loss: tensor(0.3390, device='cuda:0')
batch 16 loss: tensor(0.3417, device='cuda:0')
batch 17 loss: tensor(0.3474, device='cuda:0')
batch 18 loss: tensor(0.3522, device='cuda:0')
batch 19 loss: tensor(0.3262, device='cuda:0')
batch 20 loss: tensor(0.3644, device='cuda:0')
batch 21 loss: tensor(0.3199, device='cuda:0')
batch 22 loss: tensor(0.3243, device='cuda:0')
batch 23 loss: tensor(0.3200, device='cuda:0')
batch 24 loss: tensor(0.3992, device='cuda:0')
batch 25 loss: tensor(0.3247, device='cuda:0')
batch 26 loss: tensor(0.2770, device='cuda:0')
batch 27 loss: tensor(0.3538, device='cuda:0')
batch 28 loss: tensor(0.2812, device='cuda:0')
batch 29 loss: tensor(0.3993, device='cuda:0')
batch 30 loss: tensor(0.3326, device='cuda:0')
batch 31 loss: tensor(0.2925, device='cuda:0')
batch 32 loss: tensor(0.3231, device='cuda:0')
batch 33 loss: tensor(0.3118, device='cuda:0')
batch 34 loss: tensor(0.3626, device='cuda:0')
batch 35 loss: tensor(0.3500, device='cuda:0')
batch 36 loss: tensor(0.3360, device='cuda:0')
batch 37 loss: tensor(0.3315, device='cuda:0')
batch 38 loss: tensor(0.2927, device='cuda:0')
batch 39 loss: tensor(0.3208, device='cuda:0')
batch 40 loss: tensor(0.2872, device='cuda:0')
batch 41 loss: tensor(0.3077, device='cuda:0')
batch 42 loss: tensor(0.3060, device='cuda:0')
batch 43 loss: tensor(0.3467, device='cuda:0')
batch 44 loss: tensor(0.3574, device='cuda:0')
batch 45 loss: tensor(0.3579, device='cuda:0')
batch 46 loss: tensor(0.3208, device='cuda:0')
batch 47 loss: tensor(0.3547, device='cuda:0')
batch 48 loss: tensor(0.3855, device='cuda:0')
batch 49 loss: tensor(0.3088, device='cuda:0')
batch 50 loss: tensor(0.3546, device='cuda:0')
batch 51 loss: tensor(0.3261, device='cuda:0')
batch 52 loss: tensor(0.3074, device='cuda:0')
batch 53 loss: tensor(0.3706, device='cuda:0')
batch 54 loss: tensor(0.3915, device='cuda:0')
batch 55 loss: tensor(0.3350, device='cuda:0')
batch 56 loss: tensor(0.3697, device='cuda:0')
batch 57 loss: tensor(0.3675, device='cuda:0')
batch 58 loss: tensor(0.3339, device='cuda:0')
batch 59 loss: tensor(0.2766, device='cuda:0')
batch 60 loss: tensor(0.3358, device='cuda:0')
batch 61 loss: tensor(0.3170, device='cuda:0')
batch 62 loss: tensor(0.3034, device='cuda:0')
batch 63 loss: tensor(0.3264, device='cuda:0')
batch 64 loss: tensor(0.4126, device='cuda:0')
batch 65 loss: tensor(0.3334, device='cuda:0')
batch 66 loss: tensor(0.3124, device='cuda:0')
batch 67 loss: tensor(0.3652, device='cuda:0')
batch 68 loss: tensor(0.3473, device='cuda:0')
batch 69 loss: tensor(0.3719, device='cuda:0')
batch 70 loss: tensor(0.3376, device='cuda:0')
batch 71 loss: tensor(0.3472, device='cuda:0')
batch 72 loss: tensor(0.3486, device='cuda:0')
batch 73 loss: tensor(0.3324, device='cuda:0')
batch 74 loss: tensor(0.3088, device='cuda:0')
batch 75 loss: tensor(0.3066, device='cuda:0')
batch 76 loss: tensor(0.3335, device='cuda:0')
batch 77 loss: tensor(0.3189, device='cuda:0')
batch 78 loss: tensor(0.3051, device='cuda:0')
batch 79 loss: tensor(0.2664, device='cuda:0')
batch 80 loss: tensor(0.3673, device='cuda:0')
accuracy in val: 0.8459333333333332
accuracy in test: 0.8928916147749397
average epoch time: 2.000400947034359
total time: 640.1283030509949
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 4, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9936, device='cuda:0')
batch 2 loss: tensor(0.7638, device='cuda:0')
batch 3 loss: tensor(0.6324, device='cuda:0')
batch 4 loss: tensor(0.6784, device='cuda:0')
batch 5 loss: tensor(0.5844, device='cuda:0')
batch 6 loss: tensor(0.6101, device='cuda:0')
batch 7 loss: tensor(0.5062, device='cuda:0')
batch 8 loss: tensor(0.4980, device='cuda:0')
batch 9 loss: tensor(0.5747, device='cuda:0')
batch 10 loss: tensor(0.5611, device='cuda:0')
batch 11 loss: tensor(0.5469, device='cuda:0')
batch 12 loss: tensor(0.5427, device='cuda:0')
batch 13 loss: tensor(0.5200, device='cuda:0')
batch 14 loss: tensor(0.5661, device='cuda:0')
batch 15 loss: tensor(0.4871, device='cuda:0')
batch 16 loss: tensor(0.5085, device='cuda:0')
batch 17 loss: tensor(0.5041, device='cuda:0')
batch 18 loss: tensor(0.4984, device='cuda:0')
batch 19 loss: tensor(0.5382, device='cuda:0')
batch 20 loss: tensor(0.5197, device='cuda:0')
batch 21 loss: tensor(0.5749, device='cuda:0')
batch 22 loss: tensor(0.4721, device='cuda:0')
batch 23 loss: tensor(0.5055, device='cuda:0')
batch 24 loss: tensor(0.4937, device='cuda:0')
batch 25 loss: tensor(0.4978, device='cuda:0')
batch 26 loss: tensor(0.5059, device='cuda:0')
batch 27 loss: tensor(0.5060, device='cuda:0')
batch 28 loss: tensor(0.4856, device='cuda:0')
batch 29 loss: tensor(0.4861, device='cuda:0')
batch 30 loss: tensor(0.4748, device='cuda:0')
batch 31 loss: tensor(0.4974, device='cuda:0')
batch 32 loss: tensor(0.5206, device='cuda:0')
batch 33 loss: tensor(0.4259, device='cuda:0')
batch 34 loss: tensor(0.4908, device='cuda:0')
batch 35 loss: tensor(0.4517, device='cuda:0')
batch 36 loss: tensor(0.4707, device='cuda:0')
batch 37 loss: tensor(0.4209, device='cuda:0')
batch 38 loss: tensor(0.3727, device='cuda:0')
batch 39 loss: tensor(0.4994, device='cuda:0')
batch 40 loss: tensor(0.4756, device='cuda:0')
batch 41 loss: tensor(0.4481, device='cuda:0')
batch 42 loss: tensor(0.4936, device='cuda:0')
batch 43 loss: tensor(0.4244, device='cuda:0')
batch 44 loss: tensor(0.4394, device='cuda:0')
batch 45 loss: tensor(0.4480, device='cuda:0')
batch 46 loss: tensor(0.4399, device='cuda:0')
batch 47 loss: tensor(0.5121, device='cuda:0')
batch 48 loss: tensor(0.5579, device='cuda:0')
batch 49 loss: tensor(0.5249, device='cuda:0')
batch 50 loss: tensor(0.5805, device='cuda:0')
batch 51 loss: tensor(0.4871, device='cuda:0')
batch 52 loss: tensor(0.4586, device='cuda:0')
batch 53 loss: tensor(0.4503, device='cuda:0')
batch 54 loss: tensor(0.4627, device='cuda:0')
batch 55 loss: tensor(0.4326, device='cuda:0')
batch 56 loss: tensor(0.4126, device='cuda:0')
batch 57 loss: tensor(0.4962, device='cuda:0')
batch 58 loss: tensor(0.4549, device='cuda:0')
batch 59 loss: tensor(0.4741, device='cuda:0')
batch 60 loss: tensor(0.4159, device='cuda:0')
batch 61 loss: tensor(0.4554, device='cuda:0')
batch 62 loss: tensor(0.4246, device='cuda:0')
batch 63 loss: tensor(0.4299, device='cuda:0')
batch 64 loss: tensor(0.4828, device='cuda:0')
batch 65 loss: tensor(0.4535, device='cuda:0')
batch 66 loss: tensor(0.4435, device='cuda:0')
batch 67 loss: tensor(0.4522, device='cuda:0')
batch 68 loss: tensor(0.4721, device='cuda:0')
batch 69 loss: tensor(0.4574, device='cuda:0')
batch 70 loss: tensor(0.5411, device='cuda:0')
batch 71 loss: tensor(0.5353, device='cuda:0')
batch 72 loss: tensor(0.5057, device='cuda:0')
batch 73 loss: tensor(0.4210, device='cuda:0')
batch 74 loss: tensor(0.4382, device='cuda:0')
batch 75 loss: tensor(0.5167, device='cuda:0')
batch 76 loss: tensor(0.5132, device='cuda:0')
batch 77 loss: tensor(0.4208, device='cuda:0')
batch 78 loss: tensor(0.4327, device='cuda:0')
batch 79 loss: tensor(0.4445, device='cuda:0')
batch 80 loss: tensor(0.4420, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5443, device='cuda:0')
batch 2 loss: tensor(0.4923, device='cuda:0')
batch 3 loss: tensor(0.3994, device='cuda:0')
batch 4 loss: tensor(0.4346, device='cuda:0')
batch 5 loss: tensor(0.3896, device='cuda:0')
batch 6 loss: tensor(0.3990, device='cuda:0')
batch 7 loss: tensor(0.4086, device='cuda:0')
batch 8 loss: tensor(0.3786, device='cuda:0')
batch 9 loss: tensor(0.3728, device='cuda:0')
batch 10 loss: tensor(0.3804, device='cuda:0')
batch 11 loss: tensor(0.4409, device='cuda:0')
batch 12 loss: tensor(0.4196, device='cuda:0')
batch 13 loss: tensor(0.4077, device='cuda:0')
batch 14 loss: tensor(0.3204, device='cuda:0')
batch 15 loss: tensor(0.3880, device='cuda:0')
batch 16 loss: tensor(0.4059, device='cuda:0')
batch 17 loss: tensor(0.4248, device='cuda:0')
batch 18 loss: tensor(0.3602, device='cuda:0')
batch 19 loss: tensor(0.4210, device='cuda:0')
batch 20 loss: tensor(0.4127, device='cuda:0')
batch 21 loss: tensor(0.3246, device='cuda:0')
batch 22 loss: tensor(0.3539, device='cuda:0')
batch 23 loss: tensor(0.3790, device='cuda:0')
batch 24 loss: tensor(0.3656, device='cuda:0')
batch 25 loss: tensor(0.3942, device='cuda:0')
batch 26 loss: tensor(0.4125, device='cuda:0')
batch 27 loss: tensor(0.3575, device='cuda:0')
batch 28 loss: tensor(0.4102, device='cuda:0')
batch 29 loss: tensor(0.3781, device='cuda:0')
batch 30 loss: tensor(0.3201, device='cuda:0')
batch 31 loss: tensor(0.3487, device='cuda:0')
batch 32 loss: tensor(0.3300, device='cuda:0')
batch 33 loss: tensor(0.3880, device='cuda:0')
batch 34 loss: tensor(0.4088, device='cuda:0')
batch 35 loss: tensor(0.3494, device='cuda:0')
batch 36 loss: tensor(0.3644, device='cuda:0')
batch 37 loss: tensor(0.3701, device='cuda:0')
batch 38 loss: tensor(0.3980, device='cuda:0')
batch 39 loss: tensor(0.3737, device='cuda:0')
batch 40 loss: tensor(0.3800, device='cuda:0')
batch 41 loss: tensor(0.3993, device='cuda:0')
batch 42 loss: tensor(0.3341, device='cuda:0')
batch 43 loss: tensor(0.3290, device='cuda:0')
batch 44 loss: tensor(0.3971, device='cuda:0')
batch 45 loss: tensor(0.3391, device='cuda:0')
batch 46 loss: tensor(0.4611, device='cuda:0')
batch 47 loss: tensor(0.3877, device='cuda:0')
batch 48 loss: tensor(0.4057, device='cuda:0')
batch 49 loss: tensor(0.3774, device='cuda:0')
batch 50 loss: tensor(0.3642, device='cuda:0')
batch 51 loss: tensor(0.3569, device='cuda:0')
batch 52 loss: tensor(0.4120, device='cuda:0')
batch 53 loss: tensor(0.4276, device='cuda:0')
batch 54 loss: tensor(0.3655, device='cuda:0')
batch 55 loss: tensor(0.3200, device='cuda:0')
batch 56 loss: tensor(0.3456, device='cuda:0')
batch 57 loss: tensor(0.4555, device='cuda:0')
batch 58 loss: tensor(0.3470, device='cuda:0')
batch 59 loss: tensor(0.3787, device='cuda:0')
batch 60 loss: tensor(0.3625, device='cuda:0')
batch 61 loss: tensor(0.3642, device='cuda:0')
batch 62 loss: tensor(0.3543, device='cuda:0')
batch 63 loss: tensor(0.3416, device='cuda:0')
batch 64 loss: tensor(0.3625, device='cuda:0')
batch 65 loss: tensor(0.3674, device='cuda:0')
batch 66 loss: tensor(0.3419, device='cuda:0')
batch 67 loss: tensor(0.3300, device='cuda:0')
batch 68 loss: tensor(0.4348, device='cuda:0')
batch 69 loss: tensor(0.3338, device='cuda:0')
batch 70 loss: tensor(0.3594, device='cuda:0')
batch 71 loss: tensor(0.3795, device='cuda:0')
batch 72 loss: tensor(0.3595, device='cuda:0')
batch 73 loss: tensor(0.4154, device='cuda:0')
batch 74 loss: tensor(0.3638, device='cuda:0')
batch 75 loss: tensor(0.3308, device='cuda:0')
batch 76 loss: tensor(0.3626, device='cuda:0')
batch 77 loss: tensor(0.4019, device='cuda:0')
batch 78 loss: tensor(0.4109, device='cuda:0')
batch 79 loss: tensor(0.4162, device='cuda:0')
batch 80 loss: tensor(0.4304, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.4720, device='cuda:0')
batch 2 loss: tensor(0.4174, device='cuda:0')
batch 3 loss: tensor(0.3689, device='cuda:0')
batch 4 loss: tensor(0.3839, device='cuda:0')
batch 5 loss: tensor(0.3607, device='cuda:0')
batch 6 loss: tensor(0.3503, device='cuda:0')
batch 7 loss: tensor(0.3600, device='cuda:0')
batch 8 loss: tensor(0.3441, device='cuda:0')
batch 9 loss: tensor(0.3456, device='cuda:0')
batch 10 loss: tensor(0.3551, device='cuda:0')
batch 11 loss: tensor(0.4167, device='cuda:0')
batch 12 loss: tensor(0.3716, device='cuda:0')
batch 13 loss: tensor(0.3576, device='cuda:0')
batch 14 loss: tensor(0.3484, device='cuda:0')
batch 15 loss: tensor(0.3433, device='cuda:0')
batch 16 loss: tensor(0.3662, device='cuda:0')
batch 17 loss: tensor(0.3631, device='cuda:0')
batch 18 loss: tensor(0.3042, device='cuda:0')
batch 19 loss: tensor(0.3632, device='cuda:0')
batch 20 loss: tensor(0.3864, device='cuda:0')
batch 21 loss: tensor(0.2877, device='cuda:0')
batch 22 loss: tensor(0.3711, device='cuda:0')
batch 23 loss: tensor(0.3194, device='cuda:0')
batch 24 loss: tensor(0.3464, device='cuda:0')
batch 25 loss: tensor(0.3612, device='cuda:0')
batch 26 loss: tensor(0.4108, device='cuda:0')
batch 27 loss: tensor(0.3968, device='cuda:0')
batch 28 loss: tensor(0.2997, device='cuda:0')
batch 29 loss: tensor(0.3514, device='cuda:0')
batch 30 loss: tensor(0.3062, device='cuda:0')
batch 31 loss: tensor(0.3475, device='cuda:0')
batch 32 loss: tensor(0.3268, device='cuda:0')
batch 33 loss: tensor(0.3567, device='cuda:0')
batch 34 loss: tensor(0.2989, device='cuda:0')
batch 35 loss: tensor(0.3818, device='cuda:0')
batch 36 loss: tensor(0.3531, device='cuda:0')
batch 37 loss: tensor(0.2636, device='cuda:0')
batch 38 loss: tensor(0.3979, device='cuda:0')
batch 39 loss: tensor(0.3521, device='cuda:0')
batch 40 loss: tensor(0.3231, device='cuda:0')
batch 41 loss: tensor(0.3588, device='cuda:0')
batch 42 loss: tensor(0.3556, device='cuda:0')
batch 43 loss: tensor(0.3668, device='cuda:0')
batch 44 loss: tensor(0.3421, device='cuda:0')
batch 45 loss: tensor(0.3588, device='cuda:0')
batch 46 loss: tensor(0.3676, device='cuda:0')
batch 47 loss: tensor(0.3066, device='cuda:0')
batch 48 loss: tensor(0.3164, device='cuda:0')
batch 49 loss: tensor(0.3655, device='cuda:0')
batch 50 loss: tensor(0.3306, device='cuda:0')
batch 51 loss: tensor(0.3592, device='cuda:0')
batch 52 loss: tensor(0.3762, device='cuda:0')
batch 53 loss: tensor(0.3640, device='cuda:0')
batch 54 loss: tensor(0.3324, device='cuda:0')
batch 55 loss: tensor(0.3004, device='cuda:0')
batch 56 loss: tensor(0.3607, device='cuda:0')
batch 57 loss: tensor(0.3536, device='cuda:0')
batch 58 loss: tensor(0.3688, device='cuda:0')
batch 59 loss: tensor(0.3876, device='cuda:0')
batch 60 loss: tensor(0.3884, device='cuda:0')
batch 61 loss: tensor(0.3574, device='cuda:0')
batch 62 loss: tensor(0.3489, device='cuda:0')
batch 63 loss: tensor(0.3580, device='cuda:0')
batch 64 loss: tensor(0.3307, device='cuda:0')
batch 65 loss: tensor(0.3347, device='cuda:0')
batch 66 loss: tensor(0.3216, device='cuda:0')
batch 67 loss: tensor(0.3294, device='cuda:0')
batch 68 loss: tensor(0.3575, device='cuda:0')
batch 69 loss: tensor(0.3187, device='cuda:0')
batch 70 loss: tensor(0.3248, device='cuda:0')
batch 71 loss: tensor(0.3706, device='cuda:0')
batch 72 loss: tensor(0.3683, device='cuda:0')
batch 73 loss: tensor(0.3139, device='cuda:0')
batch 74 loss: tensor(0.3469, device='cuda:0')
batch 75 loss: tensor(0.3556, device='cuda:0')
batch 76 loss: tensor(0.2612, device='cuda:0')
batch 77 loss: tensor(0.3212, device='cuda:0')
batch 78 loss: tensor(0.3544, device='cuda:0')
batch 79 loss: tensor(0.3312, device='cuda:0')
batch 80 loss: tensor(0.3294, device='cuda:0')
layer 4 training:
batch 1 loss: tensor(0.4540, device='cuda:0')
batch 2 loss: tensor(0.3169, device='cuda:0')
batch 3 loss: tensor(0.3893, device='cuda:0')
batch 4 loss: tensor(0.4239, device='cuda:0')
batch 5 loss: tensor(0.3890, device='cuda:0')
batch 6 loss: tensor(0.3738, device='cuda:0')
batch 7 loss: tensor(0.3332, device='cuda:0')
batch 8 loss: tensor(0.3001, device='cuda:0')
batch 9 loss: tensor(0.3322, device='cuda:0')
batch 10 loss: tensor(0.3684, device='cuda:0')
batch 11 loss: tensor(0.3296, device='cuda:0')
batch 12 loss: tensor(0.3828, device='cuda:0')
batch 13 loss: tensor(0.3427, device='cuda:0')
batch 14 loss: tensor(0.3448, device='cuda:0')
batch 15 loss: tensor(0.3365, device='cuda:0')
batch 16 loss: tensor(0.3382, device='cuda:0')
batch 17 loss: tensor(0.3180, device='cuda:0')
batch 18 loss: tensor(0.3412, device='cuda:0')
batch 19 loss: tensor(0.3580, device='cuda:0')
batch 20 loss: tensor(0.3492, device='cuda:0')
batch 21 loss: tensor(0.3456, device='cuda:0')
batch 22 loss: tensor(0.3586, device='cuda:0')
batch 23 loss: tensor(0.3565, device='cuda:0')
batch 24 loss: tensor(0.2845, device='cuda:0')
batch 25 loss: tensor(0.3574, device='cuda:0')
batch 26 loss: tensor(0.3693, device='cuda:0')
batch 27 loss: tensor(0.3535, device='cuda:0')
batch 28 loss: tensor(0.3266, device='cuda:0')
batch 29 loss: tensor(0.3132, device='cuda:0')
batch 30 loss: tensor(0.3221, device='cuda:0')
batch 31 loss: tensor(0.3200, device='cuda:0')
batch 32 loss: tensor(0.3666, device='cuda:0')
batch 33 loss: tensor(0.2745, device='cuda:0')
batch 34 loss: tensor(0.3552, device='cuda:0')
batch 35 loss: tensor(0.3149, device='cuda:0')
batch 36 loss: tensor(0.2782, device='cuda:0')
batch 37 loss: tensor(0.3251, device='cuda:0')
batch 38 loss: tensor(0.3815, device='cuda:0')
batch 39 loss: tensor(0.3530, device='cuda:0')
batch 40 loss: tensor(0.3191, device='cuda:0')
batch 41 loss: tensor(0.3213, device='cuda:0')
batch 42 loss: tensor(0.3575, device='cuda:0')
batch 43 loss: tensor(0.3739, device='cuda:0')
batch 44 loss: tensor(0.4010, device='cuda:0')
batch 45 loss: tensor(0.3662, device='cuda:0')
batch 46 loss: tensor(0.3178, device='cuda:0')
batch 47 loss: tensor(0.2960, device='cuda:0')
batch 48 loss: tensor(0.3358, device='cuda:0')
batch 49 loss: tensor(0.3541, device='cuda:0')
batch 50 loss: tensor(0.3824, device='cuda:0')
batch 51 loss: tensor(0.3315, device='cuda:0')
batch 52 loss: tensor(0.2933, device='cuda:0')
batch 53 loss: tensor(0.3711, device='cuda:0')
batch 54 loss: tensor(0.3141, device='cuda:0')
batch 55 loss: tensor(0.3823, device='cuda:0')
batch 56 loss: tensor(0.3050, device='cuda:0')
batch 57 loss: tensor(0.2936, device='cuda:0')
batch 58 loss: tensor(0.3280, device='cuda:0')
batch 59 loss: tensor(0.3174, device='cuda:0')
batch 60 loss: tensor(0.3332, device='cuda:0')
batch 61 loss: tensor(0.3585, device='cuda:0')
batch 62 loss: tensor(0.3178, device='cuda:0')
batch 63 loss: tensor(0.3586, device='cuda:0')
batch 64 loss: tensor(0.3086, device='cuda:0')
batch 65 loss: tensor(0.3231, device='cuda:0')
batch 66 loss: tensor(0.3897, device='cuda:0')
batch 67 loss: tensor(0.3536, device='cuda:0')
batch 68 loss: tensor(0.3747, device='cuda:0')
batch 69 loss: tensor(0.3217, device='cuda:0')
batch 70 loss: tensor(0.3663, device='cuda:0')
batch 71 loss: tensor(0.2878, device='cuda:0')
batch 72 loss: tensor(0.3133, device='cuda:0')
batch 73 loss: tensor(0.3551, device='cuda:0')
batch 74 loss: tensor(0.3119, device='cuda:0')
batch 75 loss: tensor(0.4396, device='cuda:0')
batch 76 loss: tensor(0.3507, device='cuda:0')
batch 77 loss: tensor(0.2914, device='cuda:0')
batch 78 loss: tensor(0.3455, device='cuda:0')
batch 79 loss: tensor(0.3171, device='cuda:0')
batch 80 loss: tensor(0.3845, device='cuda:0')
accuracy in val: 0.84357
accuracy in test: 0.8918188486931007
average epoch time: 1.987746074050665
total time: 636.0787436962128
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 4, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9495, device='cuda:0')
batch 2 loss: tensor(0.7481, device='cuda:0')
batch 3 loss: tensor(0.6562, device='cuda:0')
batch 4 loss: tensor(0.6381, device='cuda:0')
batch 5 loss: tensor(0.6393, device='cuda:0')
batch 6 loss: tensor(0.6230, device='cuda:0')
batch 7 loss: tensor(0.5475, device='cuda:0')
batch 8 loss: tensor(0.5533, device='cuda:0')
batch 9 loss: tensor(0.5250, device='cuda:0')
batch 10 loss: tensor(0.4753, device='cuda:0')
batch 11 loss: tensor(0.5425, device='cuda:0')
batch 12 loss: tensor(0.5933, device='cuda:0')
batch 13 loss: tensor(0.5086, device='cuda:0')
batch 14 loss: tensor(0.4643, device='cuda:0')
batch 15 loss: tensor(0.5021, device='cuda:0')
batch 16 loss: tensor(0.4885, device='cuda:0')
batch 17 loss: tensor(0.5719, device='cuda:0')
batch 18 loss: tensor(0.5015, device='cuda:0')
batch 19 loss: tensor(0.5798, device='cuda:0')
batch 20 loss: tensor(0.4745, device='cuda:0')
batch 21 loss: tensor(0.5082, device='cuda:0')
batch 22 loss: tensor(0.4627, device='cuda:0')
batch 23 loss: tensor(0.5120, device='cuda:0')
batch 24 loss: tensor(0.5243, device='cuda:0')
batch 25 loss: tensor(0.4556, device='cuda:0')
batch 26 loss: tensor(0.4643, device='cuda:0')
batch 27 loss: tensor(0.4583, device='cuda:0')
batch 28 loss: tensor(0.4998, device='cuda:0')
batch 29 loss: tensor(0.4495, device='cuda:0')
batch 30 loss: tensor(0.4831, device='cuda:0')
batch 31 loss: tensor(0.4559, device='cuda:0')
batch 32 loss: tensor(0.4165, device='cuda:0')
batch 33 loss: tensor(0.4847, device='cuda:0')
batch 34 loss: tensor(0.4253, device='cuda:0')
batch 35 loss: tensor(0.4721, device='cuda:0')
batch 36 loss: tensor(0.4874, device='cuda:0')
batch 37 loss: tensor(0.5129, device='cuda:0')
batch 38 loss: tensor(0.4723, device='cuda:0')
batch 39 loss: tensor(0.4597, device='cuda:0')
batch 40 loss: tensor(0.4761, device='cuda:0')
batch 41 loss: tensor(0.4315, device='cuda:0')
batch 42 loss: tensor(0.4523, device='cuda:0')
batch 43 loss: tensor(0.5064, device='cuda:0')
batch 44 loss: tensor(0.4382, device='cuda:0')
batch 45 loss: tensor(0.4204, device='cuda:0')
batch 46 loss: tensor(0.4872, device='cuda:0')
batch 47 loss: tensor(0.4813, device='cuda:0')
batch 48 loss: tensor(0.4739, device='cuda:0')
batch 49 loss: tensor(0.4676, device='cuda:0')
batch 50 loss: tensor(0.4850, device='cuda:0')
batch 51 loss: tensor(0.4771, device='cuda:0')
batch 52 loss: tensor(0.4265, device='cuda:0')
batch 53 loss: tensor(0.4865, device='cuda:0')
batch 54 loss: tensor(0.4663, device='cuda:0')
batch 55 loss: tensor(0.4776, device='cuda:0')
batch 56 loss: tensor(0.4121, device='cuda:0')
batch 57 loss: tensor(0.4879, device='cuda:0')
batch 58 loss: tensor(0.3876, device='cuda:0')
batch 59 loss: tensor(0.4728, device='cuda:0')
batch 60 loss: tensor(0.4616, device='cuda:0')
batch 61 loss: tensor(0.4524, device='cuda:0')
batch 62 loss: tensor(0.4629, device='cuda:0')
batch 63 loss: tensor(0.4905, device='cuda:0')
batch 64 loss: tensor(0.4371, device='cuda:0')
batch 65 loss: tensor(0.4726, device='cuda:0')
batch 66 loss: tensor(0.4263, device='cuda:0')
batch 67 loss: tensor(0.5279, device='cuda:0')
batch 68 loss: tensor(0.4445, device='cuda:0')
batch 69 loss: tensor(0.4878, device='cuda:0')
batch 70 loss: tensor(0.4417, device='cuda:0')
batch 71 loss: tensor(0.4128, device='cuda:0')
batch 72 loss: tensor(0.4861, device='cuda:0')
batch 73 loss: tensor(0.5580, device='cuda:0')
batch 74 loss: tensor(0.4547, device='cuda:0')
batch 75 loss: tensor(0.4917, device='cuda:0')
batch 76 loss: tensor(0.4590, device='cuda:0')
batch 77 loss: tensor(0.3877, device='cuda:0')
batch 78 loss: tensor(0.4448, device='cuda:0')
batch 79 loss: tensor(0.4822, device='cuda:0')
batch 80 loss: tensor(0.4224, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5104, device='cuda:0')
batch 2 loss: tensor(0.4618, device='cuda:0')
batch 3 loss: tensor(0.4529, device='cuda:0')
batch 4 loss: tensor(0.4561, device='cuda:0')
batch 5 loss: tensor(0.4644, device='cuda:0')
batch 6 loss: tensor(0.4474, device='cuda:0')
batch 7 loss: tensor(0.4146, device='cuda:0')
batch 8 loss: tensor(0.3546, device='cuda:0')
batch 9 loss: tensor(0.4092, device='cuda:0')
batch 10 loss: tensor(0.4177, device='cuda:0')
batch 11 loss: tensor(0.3617, device='cuda:0')
batch 12 loss: tensor(0.3905, device='cuda:0')
batch 13 loss: tensor(0.3984, device='cuda:0')
batch 14 loss: tensor(0.3835, device='cuda:0')
batch 15 loss: tensor(0.3702, device='cuda:0')
batch 16 loss: tensor(0.3799, device='cuda:0')
batch 17 loss: tensor(0.3948, device='cuda:0')
batch 18 loss: tensor(0.4411, device='cuda:0')
batch 19 loss: tensor(0.4037, device='cuda:0')
batch 20 loss: tensor(0.3688, device='cuda:0')
batch 21 loss: tensor(0.4523, device='cuda:0')
batch 22 loss: tensor(0.3545, device='cuda:0')
batch 23 loss: tensor(0.3497, device='cuda:0')
batch 24 loss: tensor(0.3432, device='cuda:0')
batch 25 loss: tensor(0.4801, device='cuda:0')
batch 26 loss: tensor(0.3697, device='cuda:0')
batch 27 loss: tensor(0.2904, device='cuda:0')
batch 28 loss: tensor(0.3923, device='cuda:0')
batch 29 loss: tensor(0.3718, device='cuda:0')
batch 30 loss: tensor(0.3378, device='cuda:0')
batch 31 loss: tensor(0.3719, device='cuda:0')
batch 32 loss: tensor(0.3706, device='cuda:0')
batch 33 loss: tensor(0.4357, device='cuda:0')
batch 34 loss: tensor(0.3680, device='cuda:0')
batch 35 loss: tensor(0.3879, device='cuda:0')
batch 36 loss: tensor(0.3475, device='cuda:0')
batch 37 loss: tensor(0.3785, device='cuda:0')
batch 38 loss: tensor(0.4136, device='cuda:0')
batch 39 loss: tensor(0.3324, device='cuda:0')
batch 40 loss: tensor(0.3890, device='cuda:0')
batch 41 loss: tensor(0.3773, device='cuda:0')
batch 42 loss: tensor(0.3172, device='cuda:0')
batch 43 loss: tensor(0.3481, device='cuda:0')
batch 44 loss: tensor(0.3403, device='cuda:0')
batch 45 loss: tensor(0.3327, device='cuda:0')
batch 46 loss: tensor(0.3689, device='cuda:0')
batch 47 loss: tensor(0.4541, device='cuda:0')
batch 48 loss: tensor(0.3428, device='cuda:0')
batch 49 loss: tensor(0.3715, device='cuda:0')
batch 50 loss: tensor(0.3852, device='cuda:0')
batch 51 loss: tensor(0.3264, device='cuda:0')
batch 52 loss: tensor(0.4058, device='cuda:0')
batch 53 loss: tensor(0.3080, device='cuda:0')
batch 54 loss: tensor(0.3540, device='cuda:0')
batch 55 loss: tensor(0.3802, device='cuda:0')
batch 56 loss: tensor(0.3923, device='cuda:0')
batch 57 loss: tensor(0.3791, device='cuda:0')
batch 58 loss: tensor(0.3094, device='cuda:0')
batch 59 loss: tensor(0.3706, device='cuda:0')
batch 60 loss: tensor(0.3290, device='cuda:0')
batch 61 loss: tensor(0.3602, device='cuda:0')
batch 62 loss: tensor(0.3662, device='cuda:0')
batch 63 loss: tensor(0.3570, device='cuda:0')
batch 64 loss: tensor(0.3839, device='cuda:0')
batch 65 loss: tensor(0.4029, device='cuda:0')
batch 66 loss: tensor(0.3194, device='cuda:0')
batch 67 loss: tensor(0.4130, device='cuda:0')
batch 68 loss: tensor(0.3925, device='cuda:0')
batch 69 loss: tensor(0.3836, device='cuda:0')
batch 70 loss: tensor(0.3424, device='cuda:0')
batch 71 loss: tensor(0.3480, device='cuda:0')
batch 72 loss: tensor(0.3863, device='cuda:0')
batch 73 loss: tensor(0.4022, device='cuda:0')
batch 74 loss: tensor(0.3900, device='cuda:0')
batch 75 loss: tensor(0.3384, device='cuda:0')
batch 76 loss: tensor(0.3441, device='cuda:0')
batch 77 loss: tensor(0.3894, device='cuda:0')
batch 78 loss: tensor(0.3796, device='cuda:0')
batch 79 loss: tensor(0.4336, device='cuda:0')
batch 80 loss: tensor(0.3809, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.4640, device='cuda:0')
batch 2 loss: tensor(0.4125, device='cuda:0')
batch 3 loss: tensor(0.4152, device='cuda:0')
batch 4 loss: tensor(0.3602, device='cuda:0')
batch 5 loss: tensor(0.4188, device='cuda:0')
batch 6 loss: tensor(0.4202, device='cuda:0')
batch 7 loss: tensor(0.4172, device='cuda:0')
batch 8 loss: tensor(0.4154, device='cuda:0')
batch 9 loss: tensor(0.3292, device='cuda:0')
batch 10 loss: tensor(0.3423, device='cuda:0')
batch 11 loss: tensor(0.3294, device='cuda:0')
batch 12 loss: tensor(0.3684, device='cuda:0')
batch 13 loss: tensor(0.3436, device='cuda:0')
batch 14 loss: tensor(0.3558, device='cuda:0')
batch 15 loss: tensor(0.3289, device='cuda:0')
batch 16 loss: tensor(0.3509, device='cuda:0')
batch 17 loss: tensor(0.3806, device='cuda:0')
batch 18 loss: tensor(0.3314, device='cuda:0')
batch 19 loss: tensor(0.3228, device='cuda:0')
batch 20 loss: tensor(0.3403, device='cuda:0')
batch 21 loss: tensor(0.3563, device='cuda:0')
batch 22 loss: tensor(0.3652, device='cuda:0')
batch 23 loss: tensor(0.3678, device='cuda:0')
batch 24 loss: tensor(0.3336, device='cuda:0')
batch 25 loss: tensor(0.3505, device='cuda:0')
batch 26 loss: tensor(0.3435, device='cuda:0')
batch 27 loss: tensor(0.3485, device='cuda:0')
batch 28 loss: tensor(0.3387, device='cuda:0')
batch 29 loss: tensor(0.3392, device='cuda:0')
batch 30 loss: tensor(0.3679, device='cuda:0')
batch 31 loss: tensor(0.3322, device='cuda:0')
batch 32 loss: tensor(0.3642, device='cuda:0')
batch 33 loss: tensor(0.3514, device='cuda:0')
batch 34 loss: tensor(0.3403, device='cuda:0')
batch 35 loss: tensor(0.2905, device='cuda:0')
batch 36 loss: tensor(0.3782, device='cuda:0')
batch 37 loss: tensor(0.3699, device='cuda:0')
batch 38 loss: tensor(0.3634, device='cuda:0')
batch 39 loss: tensor(0.3473, device='cuda:0')
batch 40 loss: tensor(0.3755, device='cuda:0')
batch 41 loss: tensor(0.3601, device='cuda:0')
batch 42 loss: tensor(0.4210, device='cuda:0')
batch 43 loss: tensor(0.2918, device='cuda:0')
batch 44 loss: tensor(0.3226, device='cuda:0')
batch 45 loss: tensor(0.3344, device='cuda:0')
batch 46 loss: tensor(0.3447, device='cuda:0')
batch 47 loss: tensor(0.3359, device='cuda:0')
batch 48 loss: tensor(0.3345, device='cuda:0')
batch 49 loss: tensor(0.3309, device='cuda:0')
batch 50 loss: tensor(0.3780, device='cuda:0')
batch 51 loss: tensor(0.3199, device='cuda:0')
batch 52 loss: tensor(0.3445, device='cuda:0')
batch 53 loss: tensor(0.3434, device='cuda:0')
batch 54 loss: tensor(0.3129, device='cuda:0')
batch 55 loss: tensor(0.3605, device='cuda:0')
batch 56 loss: tensor(0.3078, device='cuda:0')
batch 57 loss: tensor(0.3480, device='cuda:0')
batch 58 loss: tensor(0.3313, device='cuda:0')
batch 59 loss: tensor(0.3402, device='cuda:0')
batch 60 loss: tensor(0.3310, device='cuda:0')
batch 61 loss: tensor(0.3261, device='cuda:0')
batch 62 loss: tensor(0.3526, device='cuda:0')
batch 63 loss: tensor(0.3257, device='cuda:0')
batch 64 loss: tensor(0.3825, device='cuda:0')
batch 65 loss: tensor(0.3498, device='cuda:0')
batch 66 loss: tensor(0.3285, device='cuda:0')
batch 67 loss: tensor(0.3556, device='cuda:0')
batch 68 loss: tensor(0.3479, device='cuda:0')
batch 69 loss: tensor(0.3020, device='cuda:0')
batch 70 loss: tensor(0.3058, device='cuda:0')
batch 71 loss: tensor(0.3805, device='cuda:0')
batch 72 loss: tensor(0.4092, device='cuda:0')
batch 73 loss: tensor(0.3204, device='cuda:0')
batch 74 loss: tensor(0.2931, device='cuda:0')
batch 75 loss: tensor(0.3431, device='cuda:0')
batch 76 loss: tensor(0.3016, device='cuda:0')
batch 77 loss: tensor(0.3597, device='cuda:0')
batch 78 loss: tensor(0.3322, device='cuda:0')
batch 79 loss: tensor(0.3633, device='cuda:0')
batch 80 loss: tensor(0.3042, device='cuda:0')
layer 4 training:
batch 1 loss: tensor(0.4268, device='cuda:0')
batch 2 loss: tensor(0.4367, device='cuda:0')
batch 3 loss: tensor(0.4007, device='cuda:0')
batch 4 loss: tensor(0.4101, device='cuda:0')
batch 5 loss: tensor(0.3796, device='cuda:0')
batch 6 loss: tensor(0.2989, device='cuda:0')
batch 7 loss: tensor(0.3298, device='cuda:0')
batch 8 loss: tensor(0.3495, device='cuda:0')
batch 9 loss: tensor(0.4128, device='cuda:0')
batch 10 loss: tensor(0.3374, device='cuda:0')
batch 11 loss: tensor(0.3814, device='cuda:0')
batch 12 loss: tensor(0.3222, device='cuda:0')
batch 13 loss: tensor(0.3417, device='cuda:0')
batch 14 loss: tensor(0.3131, device='cuda:0')
batch 15 loss: tensor(0.3358, device='cuda:0')
batch 16 loss: tensor(0.3646, device='cuda:0')
batch 17 loss: tensor(0.4076, device='cuda:0')
batch 18 loss: tensor(0.3149, device='cuda:0')
batch 19 loss: tensor(0.3128, device='cuda:0')
batch 20 loss: tensor(0.3884, device='cuda:0')
batch 21 loss: tensor(0.3503, device='cuda:0')
batch 22 loss: tensor(0.3175, device='cuda:0')
batch 23 loss: tensor(0.3243, device='cuda:0')
batch 24 loss: tensor(0.3225, device='cuda:0')
batch 25 loss: tensor(0.3379, device='cuda:0')
batch 26 loss: tensor(0.3167, device='cuda:0')
batch 27 loss: tensor(0.3486, device='cuda:0')
batch 28 loss: tensor(0.3625, device='cuda:0')
batch 29 loss: tensor(0.3523, device='cuda:0')
batch 30 loss: tensor(0.3253, device='cuda:0')
batch 31 loss: tensor(0.2972, device='cuda:0')
batch 32 loss: tensor(0.3179, device='cuda:0')
batch 33 loss: tensor(0.3193, device='cuda:0')
batch 34 loss: tensor(0.3183, device='cuda:0')
batch 35 loss: tensor(0.3097, device='cuda:0')
batch 36 loss: tensor(0.3021, device='cuda:0')
batch 37 loss: tensor(0.3443, device='cuda:0')
batch 38 loss: tensor(0.3468, device='cuda:0')
batch 39 loss: tensor(0.2940, device='cuda:0')
batch 40 loss: tensor(0.3906, device='cuda:0')
batch 41 loss: tensor(0.3810, device='cuda:0')
batch 42 loss: tensor(0.4057, device='cuda:0')
batch 43 loss: tensor(0.3500, device='cuda:0')
batch 44 loss: tensor(0.2928, device='cuda:0')
batch 45 loss: tensor(0.3600, device='cuda:0')
batch 46 loss: tensor(0.3833, device='cuda:0')
batch 47 loss: tensor(0.3025, device='cuda:0')
batch 48 loss: tensor(0.3352, device='cuda:0')
batch 49 loss: tensor(0.3251, device='cuda:0')
batch 50 loss: tensor(0.3235, device='cuda:0')
batch 51 loss: tensor(0.2985, device='cuda:0')
batch 52 loss: tensor(0.3328, device='cuda:0')
batch 53 loss: tensor(0.3118, device='cuda:0')
batch 54 loss: tensor(0.2765, device='cuda:0')
batch 55 loss: tensor(0.3054, device='cuda:0')
batch 56 loss: tensor(0.3080, device='cuda:0')
batch 57 loss: tensor(0.3808, device='cuda:0')
batch 58 loss: tensor(0.2919, device='cuda:0')
batch 59 loss: tensor(0.3789, device='cuda:0')
batch 60 loss: tensor(0.3643, device='cuda:0')
batch 61 loss: tensor(0.3457, device='cuda:0')
batch 62 loss: tensor(0.3481, device='cuda:0')
batch 63 loss: tensor(0.3355, device='cuda:0')
batch 64 loss: tensor(0.3231, device='cuda:0')
batch 65 loss: tensor(0.3399, device='cuda:0')
batch 66 loss: tensor(0.3685, device='cuda:0')
batch 67 loss: tensor(0.3478, device='cuda:0')
batch 68 loss: tensor(0.3572, device='cuda:0')
batch 69 loss: tensor(0.3350, device='cuda:0')
batch 70 loss: tensor(0.2892, device='cuda:0')
batch 71 loss: tensor(0.3258, device='cuda:0')
batch 72 loss: tensor(0.3727, device='cuda:0')
batch 73 loss: tensor(0.3346, device='cuda:0')
batch 74 loss: tensor(0.3150, device='cuda:0')
batch 75 loss: tensor(0.3074, device='cuda:0')
batch 76 loss: tensor(0.3022, device='cuda:0')
batch 77 loss: tensor(0.3258, device='cuda:0')
batch 78 loss: tensor(0.3161, device='cuda:0')
batch 79 loss: tensor(0.2959, device='cuda:0')
batch 80 loss: tensor(0.3196, device='cuda:0')
accuracy in val: 0.8448766666666667
accuracy in test: 0.8918877925286945
average epoch time: 1.986161819845438
total time: 635.5717823505402
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 4, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9442, device='cuda:0')
batch 2 loss: tensor(0.7269, device='cuda:0')
batch 3 loss: tensor(0.5993, device='cuda:0')
batch 4 loss: tensor(0.6718, device='cuda:0')
batch 5 loss: tensor(0.5959, device='cuda:0')
batch 6 loss: tensor(0.5866, device='cuda:0')
batch 7 loss: tensor(0.6227, device='cuda:0')
batch 8 loss: tensor(0.5718, device='cuda:0')
batch 9 loss: tensor(0.5523, device='cuda:0')
batch 10 loss: tensor(0.5468, device='cuda:0')
batch 11 loss: tensor(0.5333, device='cuda:0')
batch 12 loss: tensor(0.5332, device='cuda:0')
batch 13 loss: tensor(0.5618, device='cuda:0')
batch 14 loss: tensor(0.5297, device='cuda:0')
batch 15 loss: tensor(0.4805, device='cuda:0')
batch 16 loss: tensor(0.5657, device='cuda:0')
batch 17 loss: tensor(0.5144, device='cuda:0')
batch 18 loss: tensor(0.4726, device='cuda:0')
batch 19 loss: tensor(0.4599, device='cuda:0')
batch 20 loss: tensor(0.4740, device='cuda:0')
batch 21 loss: tensor(0.4289, device='cuda:0')
batch 22 loss: tensor(0.4512, device='cuda:0')
batch 23 loss: tensor(0.4300, device='cuda:0')
batch 24 loss: tensor(0.4835, device='cuda:0')
batch 25 loss: tensor(0.4732, device='cuda:0')
batch 26 loss: tensor(0.5028, device='cuda:0')
batch 27 loss: tensor(0.5055, device='cuda:0')
batch 28 loss: tensor(0.4135, device='cuda:0')
batch 29 loss: tensor(0.4854, device='cuda:0')
batch 30 loss: tensor(0.5313, device='cuda:0')
batch 31 loss: tensor(0.4736, device='cuda:0')
batch 32 loss: tensor(0.4358, device='cuda:0')
batch 33 loss: tensor(0.5218, device='cuda:0')
batch 34 loss: tensor(0.4578, device='cuda:0')
batch 35 loss: tensor(0.4723, device='cuda:0')
batch 36 loss: tensor(0.4343, device='cuda:0')
batch 37 loss: tensor(0.4860, device='cuda:0')
batch 38 loss: tensor(0.4348, device='cuda:0')
batch 39 loss: tensor(0.5475, device='cuda:0')
batch 40 loss: tensor(0.4881, device='cuda:0')
batch 41 loss: tensor(0.5033, device='cuda:0')
batch 42 loss: tensor(0.4502, device='cuda:0')
batch 43 loss: tensor(0.4805, device='cuda:0')
batch 44 loss: tensor(0.4814, device='cuda:0')
batch 45 loss: tensor(0.4650, device='cuda:0')
batch 46 loss: tensor(0.4797, device='cuda:0')
batch 47 loss: tensor(0.4876, device='cuda:0')
batch 48 loss: tensor(0.4559, device='cuda:0')
batch 49 loss: tensor(0.4669, device='cuda:0')
batch 50 loss: tensor(0.4254, device='cuda:0')
batch 51 loss: tensor(0.4575, device='cuda:0')
batch 52 loss: tensor(0.4741, device='cuda:0')
batch 53 loss: tensor(0.4399, device='cuda:0')
batch 54 loss: tensor(0.4436, device='cuda:0')
batch 55 loss: tensor(0.4346, device='cuda:0')
batch 56 loss: tensor(0.4741, device='cuda:0')
batch 57 loss: tensor(0.4366, device='cuda:0')
batch 58 loss: tensor(0.4254, device='cuda:0')
batch 59 loss: tensor(0.4320, device='cuda:0')
batch 60 loss: tensor(0.4214, device='cuda:0')
batch 61 loss: tensor(0.4318, device='cuda:0')
batch 62 loss: tensor(0.4344, device='cuda:0')
batch 63 loss: tensor(0.4413, device='cuda:0')
batch 64 loss: tensor(0.4183, device='cuda:0')
batch 65 loss: tensor(0.4678, device='cuda:0')
batch 66 loss: tensor(0.4678, device='cuda:0')
batch 67 loss: tensor(0.4998, device='cuda:0')
batch 68 loss: tensor(0.4387, device='cuda:0')
batch 69 loss: tensor(0.4983, device='cuda:0')
batch 70 loss: tensor(0.4600, device='cuda:0')
batch 71 loss: tensor(0.4223, device='cuda:0')
batch 72 loss: tensor(0.3955, device='cuda:0')
batch 73 loss: tensor(0.4581, device='cuda:0')
batch 74 loss: tensor(0.4867, device='cuda:0')
batch 75 loss: tensor(0.4303, device='cuda:0')
batch 76 loss: tensor(0.4547, device='cuda:0')
batch 77 loss: tensor(0.5033, device='cuda:0')
batch 78 loss: tensor(0.4323, device='cuda:0')
batch 79 loss: tensor(0.4921, device='cuda:0')
batch 80 loss: tensor(0.4575, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5174, device='cuda:0')
batch 2 loss: tensor(0.4132, device='cuda:0')
batch 3 loss: tensor(0.4408, device='cuda:0')
batch 4 loss: tensor(0.4142, device='cuda:0')
batch 5 loss: tensor(0.4214, device='cuda:0')
batch 6 loss: tensor(0.3570, device='cuda:0')
batch 7 loss: tensor(0.4621, device='cuda:0')
batch 8 loss: tensor(0.3476, device='cuda:0')
batch 9 loss: tensor(0.4199, device='cuda:0')
batch 10 loss: tensor(0.3963, device='cuda:0')
batch 11 loss: tensor(0.3510, device='cuda:0')
batch 12 loss: tensor(0.4581, device='cuda:0')
batch 13 loss: tensor(0.4450, device='cuda:0')
batch 14 loss: tensor(0.3548, device='cuda:0')
batch 15 loss: tensor(0.4639, device='cuda:0')
batch 16 loss: tensor(0.4077, device='cuda:0')
batch 17 loss: tensor(0.3682, device='cuda:0')
batch 18 loss: tensor(0.3685, device='cuda:0')
batch 19 loss: tensor(0.3489, device='cuda:0')
batch 20 loss: tensor(0.4321, device='cuda:0')
batch 21 loss: tensor(0.3876, device='cuda:0')
batch 22 loss: tensor(0.3701, device='cuda:0')
batch 23 loss: tensor(0.3603, device='cuda:0')
batch 24 loss: tensor(0.3873, device='cuda:0')
batch 25 loss: tensor(0.3717, device='cuda:0')
batch 26 loss: tensor(0.3963, device='cuda:0')
batch 27 loss: tensor(0.4068, device='cuda:0')
batch 28 loss: tensor(0.3842, device='cuda:0')
batch 29 loss: tensor(0.3433, device='cuda:0')
batch 30 loss: tensor(0.4301, device='cuda:0')
batch 31 loss: tensor(0.3823, device='cuda:0')
batch 32 loss: tensor(0.3687, device='cuda:0')
batch 33 loss: tensor(0.3681, device='cuda:0')
batch 34 loss: tensor(0.3388, device='cuda:0')
batch 35 loss: tensor(0.3726, device='cuda:0')
batch 36 loss: tensor(0.3160, device='cuda:0')
batch 37 loss: tensor(0.3789, device='cuda:0')
batch 38 loss: tensor(0.3982, device='cuda:0')
batch 39 loss: tensor(0.4474, device='cuda:0')
batch 40 loss: tensor(0.4109, device='cuda:0')
batch 41 loss: tensor(0.3019, device='cuda:0')
batch 42 loss: tensor(0.3346, device='cuda:0')
batch 43 loss: tensor(0.4335, device='cuda:0')
batch 44 loss: tensor(0.3756, device='cuda:0')
batch 45 loss: tensor(0.4204, device='cuda:0')
batch 46 loss: tensor(0.3773, device='cuda:0')
batch 47 loss: tensor(0.3261, device='cuda:0')
batch 48 loss: tensor(0.3497, device='cuda:0')
batch 49 loss: tensor(0.4127, device='cuda:0')
batch 50 loss: tensor(0.3588, device='cuda:0')
batch 51 loss: tensor(0.4013, device='cuda:0')
batch 52 loss: tensor(0.3970, device='cuda:0')
batch 53 loss: tensor(0.3831, device='cuda:0')
batch 54 loss: tensor(0.3431, device='cuda:0')
batch 55 loss: tensor(0.3359, device='cuda:0')
batch 56 loss: tensor(0.3661, device='cuda:0')
batch 57 loss: tensor(0.4555, device='cuda:0')
batch 58 loss: tensor(0.3639, device='cuda:0')
batch 59 loss: tensor(0.3065, device='cuda:0')
batch 60 loss: tensor(0.3826, device='cuda:0')
batch 61 loss: tensor(0.3772, device='cuda:0')
batch 62 loss: tensor(0.3887, device='cuda:0')
batch 63 loss: tensor(0.4422, device='cuda:0')
batch 64 loss: tensor(0.3806, device='cuda:0')
batch 65 loss: tensor(0.3853, device='cuda:0')
batch 66 loss: tensor(0.3515, device='cuda:0')
batch 67 loss: tensor(0.3414, device='cuda:0')
batch 68 loss: tensor(0.3953, device='cuda:0')
batch 69 loss: tensor(0.3615, device='cuda:0')
batch 70 loss: tensor(0.4016, device='cuda:0')
batch 71 loss: tensor(0.4428, device='cuda:0')
batch 72 loss: tensor(0.4096, device='cuda:0')
batch 73 loss: tensor(0.4805, device='cuda:0')
batch 74 loss: tensor(0.3534, device='cuda:0')
batch 75 loss: tensor(0.4145, device='cuda:0')
batch 76 loss: tensor(0.3930, device='cuda:0')
batch 77 loss: tensor(0.3361, device='cuda:0')
batch 78 loss: tensor(0.3561, device='cuda:0')
batch 79 loss: tensor(0.3297, device='cuda:0')
batch 80 loss: tensor(0.4069, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.5059, device='cuda:0')
batch 2 loss: tensor(0.4177, device='cuda:0')
batch 3 loss: tensor(0.4271, device='cuda:0')
batch 4 loss: tensor(0.3658, device='cuda:0')
batch 5 loss: tensor(0.3932, device='cuda:0')
batch 6 loss: tensor(0.3017, device='cuda:0')
batch 7 loss: tensor(0.3944, device='cuda:0')
batch 8 loss: tensor(0.4134, device='cuda:0')
batch 9 loss: tensor(0.3715, device='cuda:0')
batch 10 loss: tensor(0.3985, device='cuda:0')
batch 11 loss: tensor(0.3360, device='cuda:0')
batch 12 loss: tensor(0.3557, device='cuda:0')
batch 13 loss: tensor(0.3875, device='cuda:0')
batch 14 loss: tensor(0.3733, device='cuda:0')
batch 15 loss: tensor(0.3621, device='cuda:0')
batch 16 loss: tensor(0.3729, device='cuda:0')
batch 17 loss: tensor(0.3759, device='cuda:0')
batch 18 loss: tensor(0.3607, device='cuda:0')
batch 19 loss: tensor(0.3978, device='cuda:0')
batch 20 loss: tensor(0.3599, device='cuda:0')
batch 21 loss: tensor(0.3319, device='cuda:0')
batch 22 loss: tensor(0.3453, device='cuda:0')
batch 23 loss: tensor(0.3134, device='cuda:0')
batch 24 loss: tensor(0.3438, device='cuda:0')
batch 25 loss: tensor(0.3828, device='cuda:0')
batch 26 loss: tensor(0.3383, device='cuda:0')
batch 27 loss: tensor(0.3662, device='cuda:0')
batch 28 loss: tensor(0.3744, device='cuda:0')
batch 29 loss: tensor(0.3532, device='cuda:0')
batch 30 loss: tensor(0.3637, device='cuda:0')
batch 31 loss: tensor(0.4022, device='cuda:0')
batch 32 loss: tensor(0.3314, device='cuda:0')
batch 33 loss: tensor(0.3735, device='cuda:0')
batch 34 loss: tensor(0.3386, device='cuda:0')
batch 35 loss: tensor(0.3711, device='cuda:0')
batch 36 loss: tensor(0.2705, device='cuda:0')
batch 37 loss: tensor(0.3316, device='cuda:0')
batch 38 loss: tensor(0.4066, device='cuda:0')
batch 39 loss: tensor(0.3072, device='cuda:0')
batch 40 loss: tensor(0.3166, device='cuda:0')
batch 41 loss: tensor(0.2971, device='cuda:0')
batch 42 loss: tensor(0.3722, device='cuda:0')
batch 43 loss: tensor(0.3655, device='cuda:0')
batch 44 loss: tensor(0.3336, device='cuda:0')
batch 45 loss: tensor(0.3599, device='cuda:0')
batch 46 loss: tensor(0.3293, device='cuda:0')
batch 47 loss: tensor(0.3029, device='cuda:0')
batch 48 loss: tensor(0.3086, device='cuda:0')
batch 49 loss: tensor(0.3023, device='cuda:0')
batch 50 loss: tensor(0.3718, device='cuda:0')
batch 51 loss: tensor(0.3387, device='cuda:0')
batch 52 loss: tensor(0.3646, device='cuda:0')
batch 53 loss: tensor(0.2860, device='cuda:0')
batch 54 loss: tensor(0.3064, device='cuda:0')
batch 55 loss: tensor(0.3822, device='cuda:0')
batch 56 loss: tensor(0.3324, device='cuda:0')
batch 57 loss: tensor(0.3809, device='cuda:0')
batch 58 loss: tensor(0.3622, device='cuda:0')
batch 59 loss: tensor(0.4121, device='cuda:0')
batch 60 loss: tensor(0.3447, device='cuda:0')
batch 61 loss: tensor(0.3308, device='cuda:0')
batch 62 loss: tensor(0.3319, device='cuda:0')
batch 63 loss: tensor(0.3913, device='cuda:0')
batch 64 loss: tensor(0.3418, device='cuda:0')
batch 65 loss: tensor(0.3632, device='cuda:0')
batch 66 loss: tensor(0.3710, device='cuda:0')
batch 67 loss: tensor(0.3481, device='cuda:0')
batch 68 loss: tensor(0.2505, device='cuda:0')
batch 69 loss: tensor(0.3510, device='cuda:0')
batch 70 loss: tensor(0.3229, device='cuda:0')
batch 71 loss: tensor(0.3473, device='cuda:0')
batch 72 loss: tensor(0.3417, device='cuda:0')
batch 73 loss: tensor(0.3274, device='cuda:0')
batch 74 loss: tensor(0.2830, device='cuda:0')
batch 75 loss: tensor(0.2806, device='cuda:0')
batch 76 loss: tensor(0.3294, device='cuda:0')
batch 77 loss: tensor(0.3457, device='cuda:0')
batch 78 loss: tensor(0.3190, device='cuda:0')
batch 79 loss: tensor(0.3708, device='cuda:0')
batch 80 loss: tensor(0.3115, device='cuda:0')
layer 4 training:
batch 1 loss: tensor(0.4856, device='cuda:0')
batch 2 loss: tensor(0.3789, device='cuda:0')
batch 3 loss: tensor(0.3674, device='cuda:0')
batch 4 loss: tensor(0.4531, device='cuda:0')
batch 5 loss: tensor(0.3505, device='cuda:0')
batch 6 loss: tensor(0.3523, device='cuda:0')
batch 7 loss: tensor(0.4443, device='cuda:0')
batch 8 loss: tensor(0.3546, device='cuda:0')
batch 9 loss: tensor(0.3814, device='cuda:0')
batch 10 loss: tensor(0.3947, device='cuda:0')
batch 11 loss: tensor(0.2892, device='cuda:0')
batch 12 loss: tensor(0.3423, device='cuda:0')
batch 13 loss: tensor(0.2974, device='cuda:0')
batch 14 loss: tensor(0.3237, device='cuda:0')
batch 15 loss: tensor(0.3055, device='cuda:0')
batch 16 loss: tensor(0.2885, device='cuda:0')
batch 17 loss: tensor(0.3299, device='cuda:0')
batch 18 loss: tensor(0.3566, device='cuda:0')
batch 19 loss: tensor(0.3756, device='cuda:0')
batch 20 loss: tensor(0.3331, device='cuda:0')
batch 21 loss: tensor(0.3089, device='cuda:0')
batch 22 loss: tensor(0.3354, device='cuda:0')
batch 23 loss: tensor(0.3101, device='cuda:0')
batch 24 loss: tensor(0.2953, device='cuda:0')
batch 25 loss: tensor(0.3211, device='cuda:0')
batch 26 loss: tensor(0.3063, device='cuda:0')
batch 27 loss: tensor(0.3377, device='cuda:0')
batch 28 loss: tensor(0.3471, device='cuda:0')
batch 29 loss: tensor(0.3295, device='cuda:0')
batch 30 loss: tensor(0.3828, device='cuda:0')
batch 31 loss: tensor(0.3647, device='cuda:0')
batch 32 loss: tensor(0.4410, device='cuda:0')
batch 33 loss: tensor(0.2995, device='cuda:0')
batch 34 loss: tensor(0.3288, device='cuda:0')
batch 35 loss: tensor(0.3699, device='cuda:0')
batch 36 loss: tensor(0.3466, device='cuda:0')
batch 37 loss: tensor(0.3369, device='cuda:0')
batch 38 loss: tensor(0.3648, device='cuda:0')
batch 39 loss: tensor(0.3775, device='cuda:0')
batch 40 loss: tensor(0.3528, device='cuda:0')
batch 41 loss: tensor(0.3930, device='cuda:0')
batch 42 loss: tensor(0.3858, device='cuda:0')
batch 43 loss: tensor(0.3686, device='cuda:0')
batch 44 loss: tensor(0.2924, device='cuda:0')
batch 45 loss: tensor(0.3379, device='cuda:0')
batch 46 loss: tensor(0.3528, device='cuda:0')
batch 47 loss: tensor(0.4153, device='cuda:0')
batch 48 loss: tensor(0.3058, device='cuda:0')
batch 49 loss: tensor(0.3491, device='cuda:0')
batch 50 loss: tensor(0.4021, device='cuda:0')
batch 51 loss: tensor(0.3300, device='cuda:0')
batch 52 loss: tensor(0.3250, device='cuda:0')
batch 53 loss: tensor(0.3600, device='cuda:0')
batch 54 loss: tensor(0.3154, device='cuda:0')
batch 55 loss: tensor(0.3515, device='cuda:0')
batch 56 loss: tensor(0.3538, device='cuda:0')
batch 57 loss: tensor(0.3404, device='cuda:0')
batch 58 loss: tensor(0.4080, device='cuda:0')
batch 59 loss: tensor(0.3428, device='cuda:0')
batch 60 loss: tensor(0.3675, device='cuda:0')
batch 61 loss: tensor(0.3550, device='cuda:0')
batch 62 loss: tensor(0.3715, device='cuda:0')
batch 63 loss: tensor(0.3222, device='cuda:0')
batch 64 loss: tensor(0.3577, device='cuda:0')
batch 65 loss: tensor(0.3229, device='cuda:0')
batch 66 loss: tensor(0.3210, device='cuda:0')
batch 67 loss: tensor(0.3437, device='cuda:0')
batch 68 loss: tensor(0.3399, device='cuda:0')
batch 69 loss: tensor(0.2862, device='cuda:0')
batch 70 loss: tensor(0.3107, device='cuda:0')
batch 71 loss: tensor(0.3375, device='cuda:0')
batch 72 loss: tensor(0.3626, device='cuda:0')
batch 73 loss: tensor(0.3441, device='cuda:0')
batch 74 loss: tensor(0.2913, device='cuda:0')
batch 75 loss: tensor(0.3219, device='cuda:0')
batch 76 loss: tensor(0.3768, device='cuda:0')
batch 77 loss: tensor(0.3031, device='cuda:0')
batch 78 loss: tensor(0.3344, device='cuda:0')
batch 79 loss: tensor(0.3330, device='cuda:0')
batch 80 loss: tensor(0.3136, device='cuda:0')
accuracy in val: 0.84564
accuracy in test: 0.8935231403089787
average epoch time: 2.0049735687673094
total time: 641.5915420055389
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 4, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9348, device='cuda:0')
batch 2 loss: tensor(0.7980, device='cuda:0')
batch 3 loss: tensor(0.6802, device='cuda:0')
batch 4 loss: tensor(0.6797, device='cuda:0')
batch 5 loss: tensor(0.5801, device='cuda:0')
batch 6 loss: tensor(0.5828, device='cuda:0')
batch 7 loss: tensor(0.5551, device='cuda:0')
batch 8 loss: tensor(0.5682, device='cuda:0')
batch 9 loss: tensor(0.5628, device='cuda:0')
batch 10 loss: tensor(0.5667, device='cuda:0')
batch 11 loss: tensor(0.5021, device='cuda:0')
batch 12 loss: tensor(0.5335, device='cuda:0')
batch 13 loss: tensor(0.6455, device='cuda:0')
batch 14 loss: tensor(0.6384, device='cuda:0')
batch 15 loss: tensor(0.5490, device='cuda:0')
batch 16 loss: tensor(0.5861, device='cuda:0')
batch 17 loss: tensor(0.4698, device='cuda:0')
batch 18 loss: tensor(0.5493, device='cuda:0')
batch 19 loss: tensor(0.4975, device='cuda:0')
batch 20 loss: tensor(0.5761, device='cuda:0')
batch 21 loss: tensor(0.5037, device='cuda:0')
batch 22 loss: tensor(0.4752, device='cuda:0')
batch 23 loss: tensor(0.5211, device='cuda:0')
batch 24 loss: tensor(0.4575, device='cuda:0')
batch 25 loss: tensor(0.4596, device='cuda:0')
batch 26 loss: tensor(0.4677, device='cuda:0')
batch 27 loss: tensor(0.4748, device='cuda:0')
batch 28 loss: tensor(0.5264, device='cuda:0')
batch 29 loss: tensor(0.4903, device='cuda:0')
batch 30 loss: tensor(0.4270, device='cuda:0')
batch 31 loss: tensor(0.4987, device='cuda:0')
batch 32 loss: tensor(0.4542, device='cuda:0')
batch 33 loss: tensor(0.4235, device='cuda:0')
batch 34 loss: tensor(0.5128, device='cuda:0')
batch 35 loss: tensor(0.3986, device='cuda:0')
batch 36 loss: tensor(0.4913, device='cuda:0')
batch 37 loss: tensor(0.4425, device='cuda:0')
batch 38 loss: tensor(0.4788, device='cuda:0')
batch 39 loss: tensor(0.4899, device='cuda:0')
batch 40 loss: tensor(0.4379, device='cuda:0')
batch 41 loss: tensor(0.4503, device='cuda:0')
batch 42 loss: tensor(0.4202, device='cuda:0')
batch 43 loss: tensor(0.3953, device='cuda:0')
batch 44 loss: tensor(0.4342, device='cuda:0')
batch 45 loss: tensor(0.4677, device='cuda:0')
batch 46 loss: tensor(0.4963, device='cuda:0')
batch 47 loss: tensor(0.4455, device='cuda:0')
batch 48 loss: tensor(0.4399, device='cuda:0')
batch 49 loss: tensor(0.4127, device='cuda:0')
batch 50 loss: tensor(0.5060, device='cuda:0')
batch 51 loss: tensor(0.4588, device='cuda:0')
batch 52 loss: tensor(0.5118, device='cuda:0')
batch 53 loss: tensor(0.4334, device='cuda:0')
batch 54 loss: tensor(0.5296, device='cuda:0')
batch 55 loss: tensor(0.4562, device='cuda:0')
batch 56 loss: tensor(0.5123, device='cuda:0')
batch 57 loss: tensor(0.4843, device='cuda:0')
batch 58 loss: tensor(0.4273, device='cuda:0')
batch 59 loss: tensor(0.4270, device='cuda:0')
batch 60 loss: tensor(0.5051, device='cuda:0')
batch 61 loss: tensor(0.4238, device='cuda:0')
batch 62 loss: tensor(0.4286, device='cuda:0')
batch 63 loss: tensor(0.4702, device='cuda:0')
batch 64 loss: tensor(0.4176, device='cuda:0')
batch 65 loss: tensor(0.4446, device='cuda:0')
batch 66 loss: tensor(0.3739, device='cuda:0')
batch 67 loss: tensor(0.4880, device='cuda:0')
batch 68 loss: tensor(0.4031, device='cuda:0')
batch 69 loss: tensor(0.4461, device='cuda:0')
batch 70 loss: tensor(0.4806, device='cuda:0')
batch 71 loss: tensor(0.4739, device='cuda:0')
batch 72 loss: tensor(0.3947, device='cuda:0')
batch 73 loss: tensor(0.4341, device='cuda:0')
batch 74 loss: tensor(0.4162, device='cuda:0')
batch 75 loss: tensor(0.4033, device='cuda:0')
batch 76 loss: tensor(0.4541, device='cuda:0')
batch 77 loss: tensor(0.4913, device='cuda:0')
batch 78 loss: tensor(0.4194, device='cuda:0')
batch 79 loss: tensor(0.4885, device='cuda:0')
batch 80 loss: tensor(0.4623, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5308, device='cuda:0')
batch 2 loss: tensor(0.5228, device='cuda:0')
batch 3 loss: tensor(0.3788, device='cuda:0')
batch 4 loss: tensor(0.4099, device='cuda:0')
batch 5 loss: tensor(0.4459, device='cuda:0')
batch 6 loss: tensor(0.4503, device='cuda:0')
batch 7 loss: tensor(0.3996, device='cuda:0')
batch 8 loss: tensor(0.4254, device='cuda:0')
batch 9 loss: tensor(0.3681, device='cuda:0')
batch 10 loss: tensor(0.3796, device='cuda:0')
batch 11 loss: tensor(0.3822, device='cuda:0')
batch 12 loss: tensor(0.4261, device='cuda:0')
batch 13 loss: tensor(0.4433, device='cuda:0')
batch 14 loss: tensor(0.3315, device='cuda:0')
batch 15 loss: tensor(0.4034, device='cuda:0')
batch 16 loss: tensor(0.3968, device='cuda:0')
batch 17 loss: tensor(0.4006, device='cuda:0')
batch 18 loss: tensor(0.3865, device='cuda:0')
batch 19 loss: tensor(0.3660, device='cuda:0')
batch 20 loss: tensor(0.3087, device='cuda:0')
batch 21 loss: tensor(0.3595, device='cuda:0')
batch 22 loss: tensor(0.3925, device='cuda:0')
batch 23 loss: tensor(0.3938, device='cuda:0')
batch 24 loss: tensor(0.3782, device='cuda:0')
batch 25 loss: tensor(0.3735, device='cuda:0')
batch 26 loss: tensor(0.4220, device='cuda:0')
batch 27 loss: tensor(0.3839, device='cuda:0')
batch 28 loss: tensor(0.4020, device='cuda:0')
batch 29 loss: tensor(0.4873, device='cuda:0')
batch 30 loss: tensor(0.3969, device='cuda:0')
batch 31 loss: tensor(0.4163, device='cuda:0')
batch 32 loss: tensor(0.4037, device='cuda:0')
batch 33 loss: tensor(0.3834, device='cuda:0')
batch 34 loss: tensor(0.4023, device='cuda:0')
batch 35 loss: tensor(0.3577, device='cuda:0')
batch 36 loss: tensor(0.3796, device='cuda:0')
batch 37 loss: tensor(0.4042, device='cuda:0')
batch 38 loss: tensor(0.2950, device='cuda:0')
batch 39 loss: tensor(0.3100, device='cuda:0')
batch 40 loss: tensor(0.4337, device='cuda:0')
batch 41 loss: tensor(0.3123, device='cuda:0')
batch 42 loss: tensor(0.3701, device='cuda:0')
batch 43 loss: tensor(0.3898, device='cuda:0')
batch 44 loss: tensor(0.4099, device='cuda:0')
batch 45 loss: tensor(0.4174, device='cuda:0')
batch 46 loss: tensor(0.3632, device='cuda:0')
batch 47 loss: tensor(0.3613, device='cuda:0')
batch 48 loss: tensor(0.3606, device='cuda:0')
batch 49 loss: tensor(0.3390, device='cuda:0')
batch 50 loss: tensor(0.3944, device='cuda:0')
batch 51 loss: tensor(0.3837, device='cuda:0')
batch 52 loss: tensor(0.4122, device='cuda:0')
batch 53 loss: tensor(0.3561, device='cuda:0')
batch 54 loss: tensor(0.4063, device='cuda:0')
batch 55 loss: tensor(0.3905, device='cuda:0')
batch 56 loss: tensor(0.3682, device='cuda:0')
batch 57 loss: tensor(0.4281, device='cuda:0')
batch 58 loss: tensor(0.3323, device='cuda:0')
batch 59 loss: tensor(0.3798, device='cuda:0')
batch 60 loss: tensor(0.3590, device='cuda:0')
batch 61 loss: tensor(0.3429, device='cuda:0')
batch 62 loss: tensor(0.3963, device='cuda:0')
batch 63 loss: tensor(0.4093, device='cuda:0')
batch 64 loss: tensor(0.3388, device='cuda:0')
batch 65 loss: tensor(0.3544, device='cuda:0')
batch 66 loss: tensor(0.3549, device='cuda:0')
batch 67 loss: tensor(0.3551, device='cuda:0')
batch 68 loss: tensor(0.3517, device='cuda:0')
batch 69 loss: tensor(0.3413, device='cuda:0')
batch 70 loss: tensor(0.3849, device='cuda:0')
batch 71 loss: tensor(0.3671, device='cuda:0')
batch 72 loss: tensor(0.4093, device='cuda:0')
batch 73 loss: tensor(0.4208, device='cuda:0')
batch 74 loss: tensor(0.4028, device='cuda:0')
batch 75 loss: tensor(0.3868, device='cuda:0')
batch 76 loss: tensor(0.3432, device='cuda:0')
batch 77 loss: tensor(0.4124, device='cuda:0')
batch 78 loss: tensor(0.3866, device='cuda:0')
batch 79 loss: tensor(0.3875, device='cuda:0')
batch 80 loss: tensor(0.3514, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.4514, device='cuda:0')
batch 2 loss: tensor(0.3868, device='cuda:0')
batch 3 loss: tensor(0.4187, device='cuda:0')
batch 4 loss: tensor(0.4295, device='cuda:0')
batch 5 loss: tensor(0.3977, device='cuda:0')
batch 6 loss: tensor(0.4254, device='cuda:0')
batch 7 loss: tensor(0.3873, device='cuda:0')
batch 8 loss: tensor(0.3606, device='cuda:0')
batch 9 loss: tensor(0.3854, device='cuda:0')
batch 10 loss: tensor(0.3802, device='cuda:0')
batch 11 loss: tensor(0.3094, device='cuda:0')
batch 12 loss: tensor(0.3417, device='cuda:0')
batch 13 loss: tensor(0.3643, device='cuda:0')
batch 14 loss: tensor(0.3291, device='cuda:0')
batch 15 loss: tensor(0.4086, device='cuda:0')
batch 16 loss: tensor(0.3441, device='cuda:0')
batch 17 loss: tensor(0.3492, device='cuda:0')
batch 18 loss: tensor(0.3723, device='cuda:0')
batch 19 loss: tensor(0.3360, device='cuda:0')
batch 20 loss: tensor(0.3378, device='cuda:0')
batch 21 loss: tensor(0.3841, device='cuda:0')
batch 22 loss: tensor(0.3377, device='cuda:0')
batch 23 loss: tensor(0.3326, device='cuda:0')
batch 24 loss: tensor(0.3458, device='cuda:0')
batch 25 loss: tensor(0.4097, device='cuda:0')
batch 26 loss: tensor(0.3682, device='cuda:0')
batch 27 loss: tensor(0.3311, device='cuda:0')
batch 28 loss: tensor(0.3400, device='cuda:0')
batch 29 loss: tensor(0.3042, device='cuda:0')
batch 30 loss: tensor(0.3417, device='cuda:0')
batch 31 loss: tensor(0.3431, device='cuda:0')
batch 32 loss: tensor(0.3267, device='cuda:0')
batch 33 loss: tensor(0.4176, device='cuda:0')
batch 34 loss: tensor(0.4019, device='cuda:0')
batch 35 loss: tensor(0.3071, device='cuda:0')
batch 36 loss: tensor(0.3035, device='cuda:0')
batch 37 loss: tensor(0.3370, device='cuda:0')
batch 38 loss: tensor(0.3611, device='cuda:0')
batch 39 loss: tensor(0.3606, device='cuda:0')
batch 40 loss: tensor(0.3234, device='cuda:0')
batch 41 loss: tensor(0.3602, device='cuda:0')
batch 42 loss: tensor(0.3323, device='cuda:0')
batch 43 loss: tensor(0.3821, device='cuda:0')
batch 44 loss: tensor(0.3434, device='cuda:0')
batch 45 loss: tensor(0.3477, device='cuda:0')
batch 46 loss: tensor(0.3341, device='cuda:0')
batch 47 loss: tensor(0.3604, device='cuda:0')
batch 48 loss: tensor(0.2984, device='cuda:0')
batch 49 loss: tensor(0.3624, device='cuda:0')
batch 50 loss: tensor(0.3331, device='cuda:0')
batch 51 loss: tensor(0.3063, device='cuda:0')
batch 52 loss: tensor(0.3021, device='cuda:0')
batch 53 loss: tensor(0.3477, device='cuda:0')
batch 54 loss: tensor(0.3765, device='cuda:0')
batch 55 loss: tensor(0.3065, device='cuda:0')
batch 56 loss: tensor(0.2696, device='cuda:0')
batch 57 loss: tensor(0.2909, device='cuda:0')
batch 58 loss: tensor(0.3585, device='cuda:0')
batch 59 loss: tensor(0.3292, device='cuda:0')
batch 60 loss: tensor(0.2851, device='cuda:0')
batch 61 loss: tensor(0.3397, device='cuda:0')
batch 62 loss: tensor(0.3794, device='cuda:0')
batch 63 loss: tensor(0.3200, device='cuda:0')
batch 64 loss: tensor(0.2932, device='cuda:0')
batch 65 loss: tensor(0.3696, device='cuda:0')
batch 66 loss: tensor(0.3632, device='cuda:0')
batch 67 loss: tensor(0.2994, device='cuda:0')
batch 68 loss: tensor(0.3301, device='cuda:0')
batch 69 loss: tensor(0.2921, device='cuda:0')
batch 70 loss: tensor(0.3232, device='cuda:0')
batch 71 loss: tensor(0.3714, device='cuda:0')
batch 72 loss: tensor(0.3907, device='cuda:0')
batch 73 loss: tensor(0.3096, device='cuda:0')
batch 74 loss: tensor(0.3193, device='cuda:0')
batch 75 loss: tensor(0.3629, device='cuda:0')
batch 76 loss: tensor(0.3416, device='cuda:0')
batch 77 loss: tensor(0.3790, device='cuda:0')
batch 78 loss: tensor(0.2379, device='cuda:0')
batch 79 loss: tensor(0.2625, device='cuda:0')
batch 80 loss: tensor(0.3323, device='cuda:0')
layer 4 training:
batch 1 loss: tensor(0.4480, device='cuda:0')
batch 2 loss: tensor(0.3498, device='cuda:0')
batch 3 loss: tensor(0.4277, device='cuda:0')
batch 4 loss: tensor(0.3837, device='cuda:0')
batch 5 loss: tensor(0.3571, device='cuda:0')
batch 6 loss: tensor(0.3174, device='cuda:0')
batch 7 loss: tensor(0.3505, device='cuda:0')
batch 8 loss: tensor(0.3744, device='cuda:0')
batch 9 loss: tensor(0.3622, device='cuda:0')
batch 10 loss: tensor(0.3928, device='cuda:0')
batch 11 loss: tensor(0.3571, device='cuda:0')
batch 12 loss: tensor(0.2748, device='cuda:0')
batch 13 loss: tensor(0.2969, device='cuda:0')
batch 14 loss: tensor(0.3843, device='cuda:0')
batch 15 loss: tensor(0.3576, device='cuda:0')
batch 16 loss: tensor(0.3155, device='cuda:0')
batch 17 loss: tensor(0.3938, device='cuda:0')
batch 18 loss: tensor(0.3204, device='cuda:0')
batch 19 loss: tensor(0.3227, device='cuda:0')
batch 20 loss: tensor(0.3628, device='cuda:0')
batch 21 loss: tensor(0.3602, device='cuda:0')
batch 22 loss: tensor(0.2989, device='cuda:0')
batch 23 loss: tensor(0.3800, device='cuda:0')
batch 24 loss: tensor(0.3257, device='cuda:0')
batch 25 loss: tensor(0.3263, device='cuda:0')
batch 26 loss: tensor(0.3675, device='cuda:0')
batch 27 loss: tensor(0.3947, device='cuda:0')
batch 28 loss: tensor(0.3370, device='cuda:0')
batch 29 loss: tensor(0.3321, device='cuda:0')
batch 30 loss: tensor(0.3739, device='cuda:0')
batch 31 loss: tensor(0.3343, device='cuda:0')
batch 32 loss: tensor(0.2747, device='cuda:0')
batch 33 loss: tensor(0.3113, device='cuda:0')
batch 34 loss: tensor(0.3317, device='cuda:0')
batch 35 loss: tensor(0.2906, device='cuda:0')
batch 36 loss: tensor(0.3415, device='cuda:0')
batch 37 loss: tensor(0.3382, device='cuda:0')
batch 38 loss: tensor(0.3623, device='cuda:0')
batch 39 loss: tensor(0.3241, device='cuda:0')
batch 40 loss: tensor(0.3373, device='cuda:0')
batch 41 loss: tensor(0.3561, device='cuda:0')
batch 42 loss: tensor(0.3354, device='cuda:0')
batch 43 loss: tensor(0.3506, device='cuda:0')
batch 44 loss: tensor(0.2853, device='cuda:0')
batch 45 loss: tensor(0.3709, device='cuda:0')
batch 46 loss: tensor(0.3114, device='cuda:0')
batch 47 loss: tensor(0.3070, device='cuda:0')
batch 48 loss: tensor(0.3521, device='cuda:0')
batch 49 loss: tensor(0.3723, device='cuda:0')
batch 50 loss: tensor(0.3733, device='cuda:0')
batch 51 loss: tensor(0.3838, device='cuda:0')
batch 52 loss: tensor(0.3554, device='cuda:0')
batch 53 loss: tensor(0.3218, device='cuda:0')
batch 54 loss: tensor(0.2896, device='cuda:0')
batch 55 loss: tensor(0.3394, device='cuda:0')
batch 56 loss: tensor(0.3417, device='cuda:0')
batch 57 loss: tensor(0.3119, device='cuda:0')
batch 58 loss: tensor(0.2930, device='cuda:0')
batch 59 loss: tensor(0.3715, device='cuda:0')
batch 60 loss: tensor(0.3196, device='cuda:0')
batch 61 loss: tensor(0.3666, device='cuda:0')
batch 62 loss: tensor(0.3591, device='cuda:0')
batch 63 loss: tensor(0.3001, device='cuda:0')
batch 64 loss: tensor(0.3138, device='cuda:0')
batch 65 loss: tensor(0.3079, device='cuda:0')
batch 66 loss: tensor(0.3450, device='cuda:0')
batch 67 loss: tensor(0.3184, device='cuda:0')
batch 68 loss: tensor(0.3310, device='cuda:0')
batch 69 loss: tensor(0.3706, device='cuda:0')
batch 70 loss: tensor(0.3182, device='cuda:0')
batch 71 loss: tensor(0.3410, device='cuda:0')
batch 72 loss: tensor(0.3422, device='cuda:0')
batch 73 loss: tensor(0.3761, device='cuda:0')
batch 74 loss: tensor(0.3104, device='cuda:0')
batch 75 loss: tensor(0.3216, device='cuda:0')
batch 76 loss: tensor(0.3382, device='cuda:0')
batch 77 loss: tensor(0.3285, device='cuda:0')
batch 78 loss: tensor(0.3764, device='cuda:0')
batch 79 loss: tensor(0.2983, device='cuda:0')
batch 80 loss: tensor(0.3093, device='cuda:0')
accuracy in val: 0.84758
accuracy in test: 0.8929633163639573
average epoch time: 1.9918233387172222
total time: 637.3834683895111
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 4, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.9745, device='cuda:0')
batch 2 loss: tensor(0.7515, device='cuda:0')
batch 3 loss: tensor(0.6191, device='cuda:0')
batch 4 loss: tensor(0.5941, device='cuda:0')
batch 5 loss: tensor(0.5777, device='cuda:0')
batch 6 loss: tensor(0.5791, device='cuda:0')
batch 7 loss: tensor(0.6486, device='cuda:0')
batch 8 loss: tensor(0.5645, device='cuda:0')
batch 9 loss: tensor(0.5828, device='cuda:0')
batch 10 loss: tensor(0.6043, device='cuda:0')
batch 11 loss: tensor(0.5769, device='cuda:0')
batch 12 loss: tensor(0.5377, device='cuda:0')
batch 13 loss: tensor(0.5271, device='cuda:0')
batch 14 loss: tensor(0.5087, device='cuda:0')
batch 15 loss: tensor(0.5377, device='cuda:0')
batch 16 loss: tensor(0.5622, device='cuda:0')
batch 17 loss: tensor(0.4857, device='cuda:0')
batch 18 loss: tensor(0.5536, device='cuda:0')
batch 19 loss: tensor(0.4452, device='cuda:0')
batch 20 loss: tensor(0.5037, device='cuda:0')
batch 21 loss: tensor(0.4664, device='cuda:0')
batch 22 loss: tensor(0.4423, device='cuda:0')
batch 23 loss: tensor(0.5133, device='cuda:0')
batch 24 loss: tensor(0.5371, device='cuda:0')
batch 25 loss: tensor(0.4799, device='cuda:0')
batch 26 loss: tensor(0.4927, device='cuda:0')
batch 27 loss: tensor(0.4996, device='cuda:0')
batch 28 loss: tensor(0.4313, device='cuda:0')
batch 29 loss: tensor(0.5200, device='cuda:0')
batch 30 loss: tensor(0.4535, device='cuda:0')
batch 31 loss: tensor(0.5099, device='cuda:0')
batch 32 loss: tensor(0.5185, device='cuda:0')
batch 33 loss: tensor(0.4667, device='cuda:0')
batch 34 loss: tensor(0.5153, device='cuda:0')
batch 35 loss: tensor(0.4781, device='cuda:0')
batch 36 loss: tensor(0.4819, device='cuda:0')
batch 37 loss: tensor(0.5038, device='cuda:0')
batch 38 loss: tensor(0.5059, device='cuda:0')
batch 39 loss: tensor(0.4655, device='cuda:0')
batch 40 loss: tensor(0.4436, device='cuda:0')
batch 41 loss: tensor(0.5028, device='cuda:0')
batch 42 loss: tensor(0.5112, device='cuda:0')
batch 43 loss: tensor(0.4566, device='cuda:0')
batch 44 loss: tensor(0.3949, device='cuda:0')
batch 45 loss: tensor(0.4785, device='cuda:0')
batch 46 loss: tensor(0.4940, device='cuda:0')
batch 47 loss: tensor(0.4774, device='cuda:0')
batch 48 loss: tensor(0.4477, device='cuda:0')
batch 49 loss: tensor(0.4442, device='cuda:0')
batch 50 loss: tensor(0.5194, device='cuda:0')
batch 51 loss: tensor(0.5116, device='cuda:0')
batch 52 loss: tensor(0.4733, device='cuda:0')
batch 53 loss: tensor(0.4031, device='cuda:0')
batch 54 loss: tensor(0.5221, device='cuda:0')
batch 55 loss: tensor(0.5028, device='cuda:0')
batch 56 loss: tensor(0.5074, device='cuda:0')
batch 57 loss: tensor(0.5158, device='cuda:0')
batch 58 loss: tensor(0.4732, device='cuda:0')
batch 59 loss: tensor(0.4627, device='cuda:0')
batch 60 loss: tensor(0.4285, device='cuda:0')
batch 61 loss: tensor(0.4915, device='cuda:0')
batch 62 loss: tensor(0.5287, device='cuda:0')
batch 63 loss: tensor(0.4616, device='cuda:0')
batch 64 loss: tensor(0.5083, device='cuda:0')
batch 65 loss: tensor(0.4148, device='cuda:0')
batch 66 loss: tensor(0.4833, device='cuda:0')
batch 67 loss: tensor(0.4702, device='cuda:0')
batch 68 loss: tensor(0.4919, device='cuda:0')
batch 69 loss: tensor(0.5065, device='cuda:0')
batch 70 loss: tensor(0.5052, device='cuda:0')
batch 71 loss: tensor(0.4390, device='cuda:0')
batch 72 loss: tensor(0.4322, device='cuda:0')
batch 73 loss: tensor(0.3950, device='cuda:0')
batch 74 loss: tensor(0.4500, device='cuda:0')
batch 75 loss: tensor(0.4039, device='cuda:0')
batch 76 loss: tensor(0.4407, device='cuda:0')
batch 77 loss: tensor(0.4419, device='cuda:0')
batch 78 loss: tensor(0.4264, device='cuda:0')
batch 79 loss: tensor(0.3734, device='cuda:0')
batch 80 loss: tensor(0.4910, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5663, device='cuda:0')
batch 2 loss: tensor(0.5287, device='cuda:0')
batch 3 loss: tensor(0.3602, device='cuda:0')
batch 4 loss: tensor(0.3918, device='cuda:0')
batch 5 loss: tensor(0.3891, device='cuda:0')
batch 6 loss: tensor(0.3847, device='cuda:0')
batch 7 loss: tensor(0.4416, device='cuda:0')
batch 8 loss: tensor(0.3834, device='cuda:0')
batch 9 loss: tensor(0.4272, device='cuda:0')
batch 10 loss: tensor(0.4380, device='cuda:0')
batch 11 loss: tensor(0.3760, device='cuda:0')
batch 12 loss: tensor(0.4156, device='cuda:0')
batch 13 loss: tensor(0.3441, device='cuda:0')
batch 14 loss: tensor(0.3404, device='cuda:0')
batch 15 loss: tensor(0.3557, device='cuda:0')
batch 16 loss: tensor(0.3348, device='cuda:0')
batch 17 loss: tensor(0.4003, device='cuda:0')
batch 18 loss: tensor(0.3217, device='cuda:0')
batch 19 loss: tensor(0.4193, device='cuda:0')
batch 20 loss: tensor(0.3628, device='cuda:0')
batch 21 loss: tensor(0.4150, device='cuda:0')
batch 22 loss: tensor(0.3702, device='cuda:0')
batch 23 loss: tensor(0.4048, device='cuda:0')
batch 24 loss: tensor(0.3880, device='cuda:0')
batch 25 loss: tensor(0.3693, device='cuda:0')
batch 26 loss: tensor(0.3591, device='cuda:0')
batch 27 loss: tensor(0.3131, device='cuda:0')
batch 28 loss: tensor(0.3756, device='cuda:0')
batch 29 loss: tensor(0.3973, device='cuda:0')
batch 30 loss: tensor(0.3873, device='cuda:0')
batch 31 loss: tensor(0.4050, device='cuda:0')
batch 32 loss: tensor(0.3520, device='cuda:0')
batch 33 loss: tensor(0.4136, device='cuda:0')
batch 34 loss: tensor(0.3549, device='cuda:0')
batch 35 loss: tensor(0.3685, device='cuda:0')
batch 36 loss: tensor(0.3437, device='cuda:0')
batch 37 loss: tensor(0.3860, device='cuda:0')
batch 38 loss: tensor(0.3329, device='cuda:0')
batch 39 loss: tensor(0.3794, device='cuda:0')
batch 40 loss: tensor(0.3712, device='cuda:0')
batch 41 loss: tensor(0.4591, device='cuda:0')
batch 42 loss: tensor(0.4043, device='cuda:0')
batch 43 loss: tensor(0.4027, device='cuda:0')
batch 44 loss: tensor(0.3923, device='cuda:0')
batch 45 loss: tensor(0.3396, device='cuda:0')
batch 46 loss: tensor(0.3757, device='cuda:0')
batch 47 loss: tensor(0.3633, device='cuda:0')
batch 48 loss: tensor(0.3591, device='cuda:0')
batch 49 loss: tensor(0.3123, device='cuda:0')
batch 50 loss: tensor(0.3793, device='cuda:0')
batch 51 loss: tensor(0.3684, device='cuda:0')
batch 52 loss: tensor(0.4145, device='cuda:0')
batch 53 loss: tensor(0.3970, device='cuda:0')
batch 54 loss: tensor(0.4126, device='cuda:0')
batch 55 loss: tensor(0.3883, device='cuda:0')
batch 56 loss: tensor(0.3631, device='cuda:0')
batch 57 loss: tensor(0.3609, device='cuda:0')
batch 58 loss: tensor(0.3426, device='cuda:0')
batch 59 loss: tensor(0.3535, device='cuda:0')
batch 60 loss: tensor(0.4039, device='cuda:0')
batch 61 loss: tensor(0.3678, device='cuda:0')
batch 62 loss: tensor(0.3916, device='cuda:0')
batch 63 loss: tensor(0.3594, device='cuda:0')
batch 64 loss: tensor(0.3695, device='cuda:0')
batch 65 loss: tensor(0.3512, device='cuda:0')
batch 66 loss: tensor(0.3974, device='cuda:0')
batch 67 loss: tensor(0.4041, device='cuda:0')
batch 68 loss: tensor(0.3799, device='cuda:0')
batch 69 loss: tensor(0.4017, device='cuda:0')
batch 70 loss: tensor(0.3643, device='cuda:0')
batch 71 loss: tensor(0.3713, device='cuda:0')
batch 72 loss: tensor(0.3206, device='cuda:0')
batch 73 loss: tensor(0.3210, device='cuda:0')
batch 74 loss: tensor(0.3955, device='cuda:0')
batch 75 loss: tensor(0.3507, device='cuda:0')
batch 76 loss: tensor(0.3178, device='cuda:0')
batch 77 loss: tensor(0.3422, device='cuda:0')
batch 78 loss: tensor(0.3663, device='cuda:0')
batch 79 loss: tensor(0.3769, device='cuda:0')
batch 80 loss: tensor(0.3787, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.4535, device='cuda:0')
batch 2 loss: tensor(0.4283, device='cuda:0')
batch 3 loss: tensor(0.3683, device='cuda:0')
batch 4 loss: tensor(0.3505, device='cuda:0')
batch 5 loss: tensor(0.3501, device='cuda:0')
batch 6 loss: tensor(0.4150, device='cuda:0')
batch 7 loss: tensor(0.2888, device='cuda:0')
batch 8 loss: tensor(0.3161, device='cuda:0')
batch 9 loss: tensor(0.3371, device='cuda:0')
batch 10 loss: tensor(0.3762, device='cuda:0')
batch 11 loss: tensor(0.3864, device='cuda:0')
batch 12 loss: tensor(0.3143, device='cuda:0')
batch 13 loss: tensor(0.3822, device='cuda:0')
batch 14 loss: tensor(0.3462, device='cuda:0')
batch 15 loss: tensor(0.3442, device='cuda:0')
batch 16 loss: tensor(0.3671, device='cuda:0')
batch 17 loss: tensor(0.3586, device='cuda:0')
batch 18 loss: tensor(0.3345, device='cuda:0')
batch 19 loss: tensor(0.3349, device='cuda:0')
batch 20 loss: tensor(0.3434, device='cuda:0')
batch 21 loss: tensor(0.3550, device='cuda:0')
batch 22 loss: tensor(0.3308, device='cuda:0')
batch 23 loss: tensor(0.3699, device='cuda:0')
batch 24 loss: tensor(0.3634, device='cuda:0')
batch 25 loss: tensor(0.3532, device='cuda:0')
batch 26 loss: tensor(0.3194, device='cuda:0')
batch 27 loss: tensor(0.3400, device='cuda:0')
batch 28 loss: tensor(0.3356, device='cuda:0')
batch 29 loss: tensor(0.3503, device='cuda:0')
batch 30 loss: tensor(0.3516, device='cuda:0')
batch 31 loss: tensor(0.2862, device='cuda:0')
batch 32 loss: tensor(0.3677, device='cuda:0')
batch 33 loss: tensor(0.3437, device='cuda:0')
batch 34 loss: tensor(0.3901, device='cuda:0')
batch 35 loss: tensor(0.3893, device='cuda:0')
batch 36 loss: tensor(0.3840, device='cuda:0')
batch 37 loss: tensor(0.3292, device='cuda:0')
batch 38 loss: tensor(0.3294, device='cuda:0')
batch 39 loss: tensor(0.3172, device='cuda:0')
batch 40 loss: tensor(0.3621, device='cuda:0')
batch 41 loss: tensor(0.3212, device='cuda:0')
batch 42 loss: tensor(0.2950, device='cuda:0')
batch 43 loss: tensor(0.3938, device='cuda:0')
batch 44 loss: tensor(0.4247, device='cuda:0')
batch 45 loss: tensor(0.3626, device='cuda:0')
batch 46 loss: tensor(0.3767, device='cuda:0')
batch 47 loss: tensor(0.2958, device='cuda:0')
batch 48 loss: tensor(0.3458, device='cuda:0')
batch 49 loss: tensor(0.3557, device='cuda:0')
batch 50 loss: tensor(0.3631, device='cuda:0')
batch 51 loss: tensor(0.3476, device='cuda:0')
batch 52 loss: tensor(0.3343, device='cuda:0')
batch 53 loss: tensor(0.3361, device='cuda:0')
batch 54 loss: tensor(0.2736, device='cuda:0')
batch 55 loss: tensor(0.3254, device='cuda:0')
batch 56 loss: tensor(0.3320, device='cuda:0')
batch 57 loss: tensor(0.3043, device='cuda:0')
batch 58 loss: tensor(0.2990, device='cuda:0')
batch 59 loss: tensor(0.3026, device='cuda:0')
batch 60 loss: tensor(0.3325, device='cuda:0')
batch 61 loss: tensor(0.3322, device='cuda:0')
batch 62 loss: tensor(0.3941, device='cuda:0')
batch 63 loss: tensor(0.3308, device='cuda:0')
batch 64 loss: tensor(0.3480, device='cuda:0')
batch 65 loss: tensor(0.3294, device='cuda:0')
batch 66 loss: tensor(0.3524, device='cuda:0')
batch 67 loss: tensor(0.3880, device='cuda:0')
batch 68 loss: tensor(0.3366, device='cuda:0')
batch 69 loss: tensor(0.3462, device='cuda:0')
batch 70 loss: tensor(0.3177, device='cuda:0')
batch 71 loss: tensor(0.2839, device='cuda:0')
batch 72 loss: tensor(0.3330, device='cuda:0')
batch 73 loss: tensor(0.3672, device='cuda:0')
batch 74 loss: tensor(0.3404, device='cuda:0')
batch 75 loss: tensor(0.2884, device='cuda:0')
batch 76 loss: tensor(0.3716, device='cuda:0')
batch 77 loss: tensor(0.3324, device='cuda:0')
batch 78 loss: tensor(0.3910, device='cuda:0')
batch 79 loss: tensor(0.3027, device='cuda:0')
batch 80 loss: tensor(0.3344, device='cuda:0')
layer 4 training:
batch 1 loss: tensor(0.4268, device='cuda:0')
batch 2 loss: tensor(0.4193, device='cuda:0')
batch 3 loss: tensor(0.4258, device='cuda:0')
batch 4 loss: tensor(0.3601, device='cuda:0')
batch 5 loss: tensor(0.3344, device='cuda:0')
batch 6 loss: tensor(0.2983, device='cuda:0')
batch 7 loss: tensor(0.3353, device='cuda:0')
batch 8 loss: tensor(0.3619, device='cuda:0')
batch 9 loss: tensor(0.3487, device='cuda:0')
batch 10 loss: tensor(0.3617, device='cuda:0')
batch 11 loss: tensor(0.3476, device='cuda:0')
batch 12 loss: tensor(0.3382, device='cuda:0')
batch 13 loss: tensor(0.3450, device='cuda:0')
batch 14 loss: tensor(0.3282, device='cuda:0')
batch 15 loss: tensor(0.3369, device='cuda:0')
batch 16 loss: tensor(0.3493, device='cuda:0')
batch 17 loss: tensor(0.3459, device='cuda:0')
batch 18 loss: tensor(0.3917, device='cuda:0')
batch 19 loss: tensor(0.3446, device='cuda:0')
batch 20 loss: tensor(0.2861, device='cuda:0')
batch 21 loss: tensor(0.2977, device='cuda:0')
batch 22 loss: tensor(0.3625, device='cuda:0')
batch 23 loss: tensor(0.2788, device='cuda:0')
batch 24 loss: tensor(0.3263, device='cuda:0')
batch 25 loss: tensor(0.3187, device='cuda:0')
batch 26 loss: tensor(0.3430, device='cuda:0')
batch 27 loss: tensor(0.2809, device='cuda:0')
batch 28 loss: tensor(0.3477, device='cuda:0')
batch 29 loss: tensor(0.3605, device='cuda:0')
batch 30 loss: tensor(0.3826, device='cuda:0')
batch 31 loss: tensor(0.3646, device='cuda:0')
batch 32 loss: tensor(0.3146, device='cuda:0')
batch 33 loss: tensor(0.3638, device='cuda:0')
batch 34 loss: tensor(0.3544, device='cuda:0')
batch 35 loss: tensor(0.3702, device='cuda:0')
batch 36 loss: tensor(0.3579, device='cuda:0')
batch 37 loss: tensor(0.4220, device='cuda:0')
batch 38 loss: tensor(0.3150, device='cuda:0')
batch 39 loss: tensor(0.3639, device='cuda:0')
batch 40 loss: tensor(0.2800, device='cuda:0')
batch 41 loss: tensor(0.3366, device='cuda:0')
batch 42 loss: tensor(0.3072, device='cuda:0')
batch 43 loss: tensor(0.3349, device='cuda:0')
batch 44 loss: tensor(0.3695, device='cuda:0')
batch 45 loss: tensor(0.3022, device='cuda:0')
batch 46 loss: tensor(0.2764, device='cuda:0')
batch 47 loss: tensor(0.3136, device='cuda:0')
batch 48 loss: tensor(0.3422, device='cuda:0')
batch 49 loss: tensor(0.3375, device='cuda:0')
batch 50 loss: tensor(0.3211, device='cuda:0')
batch 51 loss: tensor(0.3446, device='cuda:0')
batch 52 loss: tensor(0.3337, device='cuda:0')
batch 53 loss: tensor(0.3026, device='cuda:0')
batch 54 loss: tensor(0.2891, device='cuda:0')
batch 55 loss: tensor(0.3055, device='cuda:0')
batch 56 loss: tensor(0.3068, device='cuda:0')
batch 57 loss: tensor(0.3777, device='cuda:0')
batch 58 loss: tensor(0.2911, device='cuda:0')
batch 59 loss: tensor(0.3141, device='cuda:0')
batch 60 loss: tensor(0.3553, device='cuda:0')
batch 61 loss: tensor(0.3485, device='cuda:0')
batch 62 loss: tensor(0.2790, device='cuda:0')
batch 63 loss: tensor(0.2606, device='cuda:0')
batch 64 loss: tensor(0.2829, device='cuda:0')
batch 65 loss: tensor(0.3357, device='cuda:0')
batch 66 loss: tensor(0.3366, device='cuda:0')
batch 67 loss: tensor(0.3380, device='cuda:0')
batch 68 loss: tensor(0.3048, device='cuda:0')
batch 69 loss: tensor(0.3171, device='cuda:0')
batch 70 loss: tensor(0.3279, device='cuda:0')
batch 71 loss: tensor(0.3767, device='cuda:0')
batch 72 loss: tensor(0.3268, device='cuda:0')
batch 73 loss: tensor(0.2900, device='cuda:0')
batch 74 loss: tensor(0.3011, device='cuda:0')
batch 75 loss: tensor(0.3137, device='cuda:0')
batch 76 loss: tensor(0.2892, device='cuda:0')
batch 77 loss: tensor(0.3219, device='cuda:0')
batch 78 loss: tensor(0.2867, device='cuda:0')
batch 79 loss: tensor(0.3162, device='cuda:0')
batch 80 loss: tensor(0.3105, device='cuda:0')
accuracy in val: 0.8486466666666667
accuracy in test: 0.893243228336468
average epoch time: 2.0071181766688824
total time: 642.2778165340424
1678116 725228
Finished loading dataset.
{'node_num': 2460406, 'feat_dim': 100, 'class_num': 38, 'layer_num': 4, 'hidden_dim': 128, 'learning_rate': 0.0001, 'batch_size': 1024, 'epoch_num': [80, 80, 80, 80], 'l2o_learning_rate': 0.05, 'baseline_reward': 0.3, 'total_round': 200, 'sample_node_num': 1024, 'stop_prob_threshold': 0.6, 'controller_len': 20, 'init_round': 10, 'decision_step': 10, 'time_ratio': 0.0001, 'min_batch': 35, 'max_batch': 95, 'baseline_ratio': 0.9}
layer 1 training:
batch 1 loss: tensor(0.8955, device='cuda:0')
batch 2 loss: tensor(0.8235, device='cuda:0')
batch 3 loss: tensor(0.6248, device='cuda:0')
batch 4 loss: tensor(0.6566, device='cuda:0')
batch 5 loss: tensor(0.6012, device='cuda:0')
batch 6 loss: tensor(0.5808, device='cuda:0')
batch 7 loss: tensor(0.5813, device='cuda:0')
batch 8 loss: tensor(0.5820, device='cuda:0')
batch 9 loss: tensor(0.5753, device='cuda:0')
batch 10 loss: tensor(0.5224, device='cuda:0')
batch 11 loss: tensor(0.5626, device='cuda:0')
batch 12 loss: tensor(0.5236, device='cuda:0')
batch 13 loss: tensor(0.4915, device='cuda:0')
batch 14 loss: tensor(0.5533, device='cuda:0')
batch 15 loss: tensor(0.5271, device='cuda:0')
batch 16 loss: tensor(0.5070, device='cuda:0')
batch 17 loss: tensor(0.4648, device='cuda:0')
batch 18 loss: tensor(0.4222, device='cuda:0')
batch 19 loss: tensor(0.5541, device='cuda:0')
batch 20 loss: tensor(0.4867, device='cuda:0')
batch 21 loss: tensor(0.5036, device='cuda:0')
batch 22 loss: tensor(0.5313, device='cuda:0')
batch 23 loss: tensor(0.5316, device='cuda:0')
batch 24 loss: tensor(0.4416, device='cuda:0')
batch 25 loss: tensor(0.4539, device='cuda:0')
batch 26 loss: tensor(0.4502, device='cuda:0')
batch 27 loss: tensor(0.4544, device='cuda:0')
batch 28 loss: tensor(0.4785, device='cuda:0')
batch 29 loss: tensor(0.5207, device='cuda:0')
batch 30 loss: tensor(0.4591, device='cuda:0')
batch 31 loss: tensor(0.4945, device='cuda:0')
batch 32 loss: tensor(0.4765, device='cuda:0')
batch 33 loss: tensor(0.4704, device='cuda:0')
batch 34 loss: tensor(0.4257, device='cuda:0')
batch 35 loss: tensor(0.4671, device='cuda:0')
batch 36 loss: tensor(0.4211, device='cuda:0')
batch 37 loss: tensor(0.4236, device='cuda:0')
batch 38 loss: tensor(0.4801, device='cuda:0')
batch 39 loss: tensor(0.5186, device='cuda:0')
batch 40 loss: tensor(0.4868, device='cuda:0')
batch 41 loss: tensor(0.5371, device='cuda:0')
batch 42 loss: tensor(0.5463, device='cuda:0')
batch 43 loss: tensor(0.4353, device='cuda:0')
batch 44 loss: tensor(0.4540, device='cuda:0')
batch 45 loss: tensor(0.4423, device='cuda:0')
batch 46 loss: tensor(0.4515, device='cuda:0')
batch 47 loss: tensor(0.4296, device='cuda:0')
batch 48 loss: tensor(0.4647, device='cuda:0')
batch 49 loss: tensor(0.4484, device='cuda:0')
batch 50 loss: tensor(0.4501, device='cuda:0')
batch 51 loss: tensor(0.4185, device='cuda:0')
batch 52 loss: tensor(0.5220, device='cuda:0')
batch 53 loss: tensor(0.4570, device='cuda:0')
batch 54 loss: tensor(0.4721, device='cuda:0')
batch 55 loss: tensor(0.4639, device='cuda:0')
batch 56 loss: tensor(0.4273, device='cuda:0')
batch 57 loss: tensor(0.4425, device='cuda:0')
batch 58 loss: tensor(0.4708, device='cuda:0')
batch 59 loss: tensor(0.4510, device='cuda:0')
batch 60 loss: tensor(0.4637, device='cuda:0')
batch 61 loss: tensor(0.4604, device='cuda:0')
batch 62 loss: tensor(0.4973, device='cuda:0')
batch 63 loss: tensor(0.4459, device='cuda:0')
batch 64 loss: tensor(0.4102, device='cuda:0')
batch 65 loss: tensor(0.4847, device='cuda:0')
batch 66 loss: tensor(0.5220, device='cuda:0')
batch 67 loss: tensor(0.3491, device='cuda:0')
batch 68 loss: tensor(0.4751, device='cuda:0')
batch 69 loss: tensor(0.4992, device='cuda:0')
batch 70 loss: tensor(0.4796, device='cuda:0')
batch 71 loss: tensor(0.4757, device='cuda:0')
batch 72 loss: tensor(0.5403, device='cuda:0')
batch 73 loss: tensor(0.4017, device='cuda:0')
batch 74 loss: tensor(0.4190, device='cuda:0')
batch 75 loss: tensor(0.5307, device='cuda:0')
batch 76 loss: tensor(0.4571, device='cuda:0')
batch 77 loss: tensor(0.4397, device='cuda:0')
batch 78 loss: tensor(0.4248, device='cuda:0')
batch 79 loss: tensor(0.4234, device='cuda:0')
batch 80 loss: tensor(0.4786, device='cuda:0')
layer 2 training:
batch 1 loss: tensor(0.5063, device='cuda:0')
batch 2 loss: tensor(0.5324, device='cuda:0')
batch 3 loss: tensor(0.4689, device='cuda:0')
batch 4 loss: tensor(0.3594, device='cuda:0')
batch 5 loss: tensor(0.4723, device='cuda:0')
batch 6 loss: tensor(0.3956, device='cuda:0')
batch 7 loss: tensor(0.4185, device='cuda:0')
batch 8 loss: tensor(0.3971, device='cuda:0')
batch 9 loss: tensor(0.4725, device='cuda:0')
batch 10 loss: tensor(0.4238, device='cuda:0')
batch 11 loss: tensor(0.3491, device='cuda:0')
batch 12 loss: tensor(0.4386, device='cuda:0')
batch 13 loss: tensor(0.4172, device='cuda:0')
batch 14 loss: tensor(0.3794, device='cuda:0')
batch 15 loss: tensor(0.4206, device='cuda:0')
batch 16 loss: tensor(0.4262, device='cuda:0')
batch 17 loss: tensor(0.3667, device='cuda:0')
batch 18 loss: tensor(0.3877, device='cuda:0')
batch 19 loss: tensor(0.3871, device='cuda:0')
batch 20 loss: tensor(0.4492, device='cuda:0')
batch 21 loss: tensor(0.4260, device='cuda:0')
batch 22 loss: tensor(0.4297, device='cuda:0')
batch 23 loss: tensor(0.4616, device='cuda:0')
batch 24 loss: tensor(0.4403, device='cuda:0')
batch 25 loss: tensor(0.3871, device='cuda:0')
batch 26 loss: tensor(0.4100, device='cuda:0')
batch 27 loss: tensor(0.3467, device='cuda:0')
batch 28 loss: tensor(0.4353, device='cuda:0')
batch 29 loss: tensor(0.3978, device='cuda:0')
batch 30 loss: tensor(0.4245, device='cuda:0')
batch 31 loss: tensor(0.4183, device='cuda:0')
batch 32 loss: tensor(0.4152, device='cuda:0')
batch 33 loss: tensor(0.3664, device='cuda:0')
batch 34 loss: tensor(0.3793, device='cuda:0')
batch 35 loss: tensor(0.3852, device='cuda:0')
batch 36 loss: tensor(0.3668, device='cuda:0')
batch 37 loss: tensor(0.4321, device='cuda:0')
batch 38 loss: tensor(0.3898, device='cuda:0')
batch 39 loss: tensor(0.4443, device='cuda:0')
batch 40 loss: tensor(0.3520, device='cuda:0')
batch 41 loss: tensor(0.3931, device='cuda:0')
batch 42 loss: tensor(0.4116, device='cuda:0')
batch 43 loss: tensor(0.3481, device='cuda:0')
batch 44 loss: tensor(0.3422, device='cuda:0')
batch 45 loss: tensor(0.4072, device='cuda:0')
batch 46 loss: tensor(0.3619, device='cuda:0')
batch 47 loss: tensor(0.4206, device='cuda:0')
batch 48 loss: tensor(0.3868, device='cuda:0')
batch 49 loss: tensor(0.4033, device='cuda:0')
batch 50 loss: tensor(0.4034, device='cuda:0')
batch 51 loss: tensor(0.3888, device='cuda:0')
batch 52 loss: tensor(0.3050, device='cuda:0')
batch 53 loss: tensor(0.3232, device='cuda:0')
batch 54 loss: tensor(0.3782, device='cuda:0')
batch 55 loss: tensor(0.4045, device='cuda:0')
batch 56 loss: tensor(0.3727, device='cuda:0')
batch 57 loss: tensor(0.3525, device='cuda:0')
batch 58 loss: tensor(0.3509, device='cuda:0')
batch 59 loss: tensor(0.4139, device='cuda:0')
batch 60 loss: tensor(0.3594, device='cuda:0')
batch 61 loss: tensor(0.3951, device='cuda:0')
batch 62 loss: tensor(0.3566, device='cuda:0')
batch 63 loss: tensor(0.3552, device='cuda:0')
batch 64 loss: tensor(0.3703, device='cuda:0')
batch 65 loss: tensor(0.3421, device='cuda:0')
batch 66 loss: tensor(0.3839, device='cuda:0')
batch 67 loss: tensor(0.3494, device='cuda:0')
batch 68 loss: tensor(0.3948, device='cuda:0')
batch 69 loss: tensor(0.3724, device='cuda:0')
batch 70 loss: tensor(0.3758, device='cuda:0')
batch 71 loss: tensor(0.3877, device='cuda:0')
batch 72 loss: tensor(0.4694, device='cuda:0')
batch 73 loss: tensor(0.3809, device='cuda:0')
batch 74 loss: tensor(0.3456, device='cuda:0')
batch 75 loss: tensor(0.3306, device='cuda:0')
batch 76 loss: tensor(0.3609, device='cuda:0')
batch 77 loss: tensor(0.4210, device='cuda:0')
batch 78 loss: tensor(0.3980, device='cuda:0')
batch 79 loss: tensor(0.3800, device='cuda:0')
batch 80 loss: tensor(0.3787, device='cuda:0')
layer 3 training:
batch 1 loss: tensor(0.4227, device='cuda:0')
batch 2 loss: tensor(0.4009, device='cuda:0')
batch 3 loss: tensor(0.3529, device='cuda:0')
batch 4 loss: tensor(0.3681, device='cuda:0')
batch 5 loss: tensor(0.4269, device='cuda:0')
batch 6 loss: tensor(0.3322, device='cuda:0')
batch 7 loss: tensor(0.3938, device='cuda:0')
batch 8 loss: tensor(0.3501, device='cuda:0')
batch 9 loss: tensor(0.4272, device='cuda:0')
batch 10 loss: tensor(0.3664, device='cuda:0')
batch 11 loss: tensor(0.3258, device='cuda:0')
batch 12 loss: tensor(0.3383, device='cuda:0')
batch 13 loss: tensor(0.3733, device='cuda:0')
batch 14 loss: tensor(0.3649, device='cuda:0')
batch 15 loss: tensor(0.3684, device='cuda:0')
batch 16 loss: tensor(0.3362, device='cuda:0')
batch 17 loss: tensor(0.3429, device='cuda:0')
batch 18 loss: tensor(0.4210, device='cuda:0')
batch 19 loss: tensor(0.3703, device='cuda:0')
batch 20 loss: tensor(0.3369, device='cuda:0')
batch 21 loss: tensor(0.3689, device='cuda:0')
batch 22 loss: tensor(0.3670, device='cuda:0')
batch 23 loss: tensor(0.3526, device='cuda:0')
batch 24 loss: tensor(0.3575, device='cuda:0')
batch 25 loss: tensor(0.3265, device='cuda:0')
batch 26 loss: tensor(0.3953, device='cuda:0')
batch 27 loss: tensor(0.3762, device='cuda:0')
batch 28 loss: tensor(0.3427, device='cuda:0')
batch 29 loss: tensor(0.3677, device='cuda:0')
batch 30 loss: tensor(0.3577, device='cuda:0')
batch 31 loss: tensor(0.3809, device='cuda:0')
batch 32 loss: tensor(0.2956, device='cuda:0')
batch 33 loss: tensor(0.3044, device='cuda:0')
batch 34 loss: tensor(0.3464, device='cuda:0')
batch 35 loss: tensor(0.3625, device='cuda:0')
batch 36 loss: tensor(0.3221, device='cuda:0')
batch 37 loss: tensor(0.3279, device='cuda:0')
batch 38 loss: tensor(0.3572, device='cuda:0')
batch 39 loss: tensor(0.3552, device='cuda:0')
batch 40 loss: tensor(0.3352, device='cuda:0')
batch 41 loss: tensor(0.3308, device='cuda:0')
batch 42 loss: tensor(0.3031, device='cuda:0')
batch 43 loss: tensor(0.3307, device='cuda:0')
batch 44 loss: tensor(0.3578, device='cuda:0')
batch 45 loss: tensor(0.4064, device='cuda:0')
batch 46 loss: tensor(0.4041, device='cuda:0')
batch 47 loss: tensor(0.3687, device='cuda:0')
batch 48 loss: tensor(0.3120, device='cuda:0')
batch 49 loss: tensor(0.3654, device='cuda:0')
batch 50 loss: tensor(0.3776, device='cuda:0')
batch 51 loss: tensor(0.3597, device='cuda:0')
batch 52 loss: tensor(0.3152, device='cuda:0')
batch 53 loss: tensor(0.3227, device='cuda:0')
batch 54 loss: tensor(0.3021, device='cuda:0')
batch 55 loss: tensor(0.3425, device='cuda:0')
batch 56 loss: tensor(0.3341, device='cuda:0')
batch 57 loss: tensor(0.3585, device='cuda:0')
batch 58 loss: tensor(0.2882, device='cuda:0')
batch 59 loss: tensor(0.3078, device='cuda:0')
batch 60 loss: tensor(0.3160, device='cuda:0')
batch 61 loss: tensor(0.4101, device='cuda:0')
batch 62 loss: tensor(0.3561, device='cuda:0')
batch 63 loss: tensor(0.3418, device='cuda:0')
batch 64 loss: tensor(0.3534, device='cuda:0')
batch 65 loss: tensor(0.3286, device='cuda:0')
batch 66 loss: tensor(0.3334, device='cuda:0')
batch 67 loss: tensor(0.3768, device='cuda:0')
batch 68 loss: tensor(0.3365, device='cuda:0')
batch 69 loss: tensor(0.3875, device='cuda:0')
batch 70 loss: tensor(0.3302, device='cuda:0')
batch 71 loss: tensor(0.3405, device='cuda:0')
batch 72 loss: tensor(0.3399, device='cuda:0')
batch 73 loss: tensor(0.3298, device='cuda:0')
batch 74 loss: tensor(0.2896, device='cuda:0')
batch 75 loss: tensor(0.2940, device='cuda:0')
batch 76 loss: tensor(0.3537, device='cuda:0')
batch 77 loss: tensor(0.3764, device='cuda:0')
batch 78 loss: tensor(0.3862, device='cuda:0')
batch 79 loss: tensor(0.3602, device='cuda:0')
batch 80 loss: tensor(0.3051, device='cuda:0')
layer 4 training:
batch 1 loss: tensor(0.3999, device='cuda:0')
batch 2 loss: tensor(0.3978, device='cuda:0')
batch 3 loss: tensor(0.3812, device='cuda:0')
batch 4 loss: tensor(0.3359, device='cuda:0')
batch 5 loss: tensor(0.4366, device='cuda:0')
batch 6 loss: tensor(0.3443, device='cuda:0')
batch 7 loss: tensor(0.3606, device='cuda:0')
batch 8 loss: tensor(0.3587, device='cuda:0')
batch 9 loss: tensor(0.3567, device='cuda:0')
batch 10 loss: tensor(0.3758, device='cuda:0')
batch 11 loss: tensor(0.2874, device='cuda:0')
batch 12 loss: tensor(0.3949, device='cuda:0')
batch 13 loss: tensor(0.3473, device='cuda:0')
batch 14 loss: tensor(0.3227, device='cuda:0')
batch 15 loss: tensor(0.3285, device='cuda:0')
batch 16 loss: tensor(0.3165, device='cuda:0')
batch 17 loss: tensor(0.3294, device='cuda:0')
batch 18 loss: tensor(0.3662, device='cuda:0')
batch 19 loss: tensor(0.3703, device='cuda:0')
batch 20 loss: tensor(0.3233, device='cuda:0')
batch 21 loss: tensor(0.3051, device='cuda:0')
batch 22 loss: tensor(0.3285, device='cuda:0')
batch 23 loss: tensor(0.3167, device='cuda:0')
batch 24 loss: tensor(0.3430, device='cuda:0')
batch 25 loss: tensor(0.3994, device='cuda:0')
batch 26 loss: tensor(0.3080, device='cuda:0')
batch 27 loss: tensor(0.3474, device='cuda:0')
batch 28 loss: tensor(0.3022, device='cuda:0')
batch 29 loss: tensor(0.3168, device='cuda:0')
batch 30 loss: tensor(0.3358, device='cuda:0')
batch 31 loss: tensor(0.3399, device='cuda:0')
batch 32 loss: tensor(0.3656, device='cuda:0')
batch 33 loss: tensor(0.3200, device='cuda:0')
batch 34 loss: tensor(0.3483, device='cuda:0')
batch 35 loss: tensor(0.3319, device='cuda:0')
batch 36 loss: tensor(0.3650, device='cuda:0')
batch 37 loss: tensor(0.3515, device='cuda:0')
batch 38 loss: tensor(0.3275, device='cuda:0')
batch 39 loss: tensor(0.3478, device='cuda:0')
batch 40 loss: tensor(0.3504, device='cuda:0')
batch 41 loss: tensor(0.3374, device='cuda:0')
batch 42 loss: tensor(0.3310, device='cuda:0')
batch 43 loss: tensor(0.3231, device='cuda:0')
batch 44 loss: tensor(0.3313, device='cuda:0')
batch 45 loss: tensor(0.3325, device='cuda:0')
batch 46 loss: tensor(0.3268, device='cuda:0')
batch 47 loss: tensor(0.3414, device='cuda:0')
batch 48 loss: tensor(0.3394, device='cuda:0')
batch 49 loss: tensor(0.3140, device='cuda:0')
batch 50 loss: tensor(0.3835, device='cuda:0')
batch 51 loss: tensor(0.3389, device='cuda:0')
batch 52 loss: tensor(0.3623, device='cuda:0')
batch 53 loss: tensor(0.2999, device='cuda:0')
batch 54 loss: tensor(0.3439, device='cuda:0')
batch 55 loss: tensor(0.3247, device='cuda:0')
batch 56 loss: tensor(0.3406, device='cuda:0')
batch 57 loss: tensor(0.3391, device='cuda:0')
batch 58 loss: tensor(0.3144, device='cuda:0')
batch 59 loss: tensor(0.3244, device='cuda:0')
batch 60 loss: tensor(0.3792, device='cuda:0')
batch 61 loss: tensor(0.3187, device='cuda:0')
batch 62 loss: tensor(0.3165, device='cuda:0')
batch 63 loss: tensor(0.3093, device='cuda:0')
batch 64 loss: tensor(0.4042, device='cuda:0')
batch 65 loss: tensor(0.2736, device='cuda:0')
batch 66 loss: tensor(0.3723, device='cuda:0')
batch 67 loss: tensor(0.3840, device='cuda:0')
batch 68 loss: tensor(0.3435, device='cuda:0')
batch 69 loss: tensor(0.4088, device='cuda:0')
batch 70 loss: tensor(0.3488, device='cuda:0')
batch 71 loss: tensor(0.3044, device='cuda:0')
batch 72 loss: tensor(0.3859, device='cuda:0')
batch 73 loss: tensor(0.3741, device='cuda:0')
batch 74 loss: tensor(0.2973, device='cuda:0')
batch 75 loss: tensor(0.3104, device='cuda:0')
batch 76 loss: tensor(0.3609, device='cuda:0')
batch 77 loss: tensor(0.3366, device='cuda:0')
batch 78 loss: tensor(0.3480, device='cuda:0')
batch 79 loss: tensor(0.3654, device='cuda:0')
batch 80 loss: tensor(0.4034, device='cuda:0')
accuracy in val: 0.84603
accuracy in test: 0.8923524739805965
average epoch time: 1.99375856295228
total time: 638.0027401447296

0.8920569807012415 642.2409161090851
0.0016158419624479525 9.6139810794117
